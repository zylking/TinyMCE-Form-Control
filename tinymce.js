// 4.9.2 (2018-12-17)
;(function(){(function(){'use strict';var ba=function(){var a=[];for(var b=0;b<arguments.length;b++){a[b]=arguments[b]}};var bb=function(c,d){return function(){var a=[];for(var b=0;b<arguments.length;b++){a[b]=arguments[b]}return c(d.apply(null,a))}};var bc=function(a){return function(){return a}};var bd=function(x){return x};function curry(d){var e=[];for(var f=1;f<arguments.length;f++){e[f-1]=arguments[f]}return function(){var a=[];for(var b=0;b<arguments.length;b++){a[b]=arguments[b]}var c=e.concat(a);return d.apply(null,c)}}var be=function(f){return function(){var a=[];for(var b=0;b<arguments.length;b++){a[b]=arguments[b]}return!f.apply(null,a)}};var bf=function(a){return function(){throw new Error(a);}};var bg=bc(false);var bh=bc(true);var bi=bg;var bj=bh;var bk=function(){return bl};var bl=function(){var b=function(o){return o.isNone()};var c=function(a){return a()};var d=function(n){return n};var e=function(){};var f=function(){return null};var g=function(){return undefined};var h={fold:function(n,s){return n()},is:bi,isSome:bi,isNone:bj,getOr:d,getOrThunk:c,getOrDie:function(a){throw new Error(a||'error: getOrDie called on none.');},getOrNull:f,getOrUndefined:g,or:d,orThunk:c,map:bk,ap:bk,each:e,bind:bk,flatten:bk,exists:bi,forall:bj,filter:bk,equals:b,equals_:b,toArray:function(){return[]},toString:bc('none()')};if(Object.freeze)Object.freeze(h);return h}();var bm=function(a){var d=function(){return a};var e=function(){return i};var g=function(f){return bm(f(a))};var h=function(f){return f(a)};var i={fold:function(n,s){return s(a)},is:function(v){return a===v},isSome:bj,isNone:bi,getOr:d,getOrThunk:d,getOrDie:d,getOrNull:d,getOrUndefined:d,or:e,orThunk:e,map:g,ap:function(c){return c.fold(bk,function(b){return bm(b(a))})},each:function(f){f(a)},bind:h,flatten:d,exists:h,forall:h,filter:function(f){return f(a)?i:bl},equals:function(o){return o.is(a)},equals_:function(o,c){return o.fold(bi,function(b){return c(a,b)})},toArray:function(){return[a]},toString:function(){return'some('+a+')'}};return i};var bn=function(a){return a===null||a===undefined?bl:bm(a)};var bo={some:bm,none:bk,from:bn};var bp=function(x){if(x===null)return'null';var t=typeof x;if(t==='object'&&Array.prototype.isPrototypeOf(x))return'array';if(t==='object'&&String.prototype.isPrototypeOf(x))return'string';return t};var bq=function(b){return function(a){return bp(a)===b}};var br=bq('string');var bs=bq('object');var bt=bq('array');var bu=bq('null');var bv=bq('boolean');var bw=bq('function');var bx=bq('number');var by=function(){var b=Array.prototype.indexOf;var c=function(a,x){return b.call(a,x)};var d=function(a,x){return bL(a,x)};return b===undefined?d:c}();var bz=function(a,x){var r=by(a,x);return r===-1?bo.none():bo.some(r)};var bA=function(a,x){return by(a,x)>-1};var bB=function(a,b){return bK(a,b).isSome()};var bC=function(a,f){var b=a.length;var r=new Array(b);for(var i=0;i<b;i++){var x=a[i];r[i]=f(x,i,a)}return r};var bD=function(a,f){for(var i=0,len=a.length;i<len;i++){var x=a[i];f(x,i,a)}};var bE=function(a,f){for(var i=a.length-1;i>=0;i--){var x=a[i];f(x,i,a)}};var bF=function(a,b){var c=[];var d=[];for(var i=0,len=a.length;i<len;i++){var x=a[i];var e=b(x,i,a)?c:d;e.push(x)}return{pass:c,fail:d}};var bG=function(a,b){var r=[];for(var i=0,len=a.length;i<len;i++){var x=a[i];if(b(x,i,a)){r.push(x)}}return r};var bH=function(a,f,b){bE(a,function(x){b=f(b,x)});return b};var bI=function(a,f,b){bD(a,function(x){b=f(b,x)});return b};var bJ=function(a,b){for(var i=0,len=a.length;i<len;i++){var x=a[i];if(b(x,i,a)){return bo.some(x)}}return bo.none()};var bK=function(a,b){for(var i=0,len=a.length;i<len;i++){var x=a[i];if(b(x,i,a)){return bo.some(i)}}return bo.none()};var bL=function(a,x){for(var i=0,len=a.length;i<len;++i){if(a[i]===x){return i}}return-1};var bM=Array.prototype.push;var bN=function(a){var r=[];for(var i=0,len=a.length;i<len;++i){if(!Array.prototype.isPrototypeOf(a[i]))throw new Error('Arr.flatten item '+i+' was not an array, input: '+a);bM.apply(r,a[i])}return r};var bO=function(a,f){var b=bC(a,f);return bN(b)};var bP=function(a,b){for(var i=0,len=a.length;i<len;++i){var x=a[i];if(b(x,i,a)!==true){return false}}return true};var bQ=Array.prototype.slice;var bR=function(a){var r=bQ.call(a,0);r.reverse();return r};var bS=function(a,b){return bG(a,function(x){return!bA(b,x)})};var bT=function(a,f){var r={};for(var i=0,len=a.length;i<len;i++){var x=a[i];r[String(x)]=f(x,i)}return r};var bU=function(a,b){var c=bQ.call(a,0);c.sort(b);return c};var bV=function(a){return a.length===0?bo.none():bo.some(a[0])};var bW=function(a){return a.length===0?bo.none():bo.some(a[a.length-1])};var bX=bw(Array.from)?Array.from:function(x){return bQ.call(x)};var bY=typeof window!=='undefined'?window:Function('return this;')();var bZ=function(a,b){var o=b!==undefined&&b!==null?b:bY;for(var i=0;i<a.length&&o!==undefined&&o!==null;++i)o=o[a[i]];return o};var ca=function(p,a){var b=p.split('.');return bZ(b,a)};var cb=function(a,b){return ca(a,b)};var cc=function(a,b){var c=cb(a,b);if(c===undefined||c===null)throw a+' not available on this browser';return c};var cd={getOrDie:cc};var ce=function(){return cd.getOrDie('URL')};var cf=function(a){return ce().createObjectURL(a)};var cg=function(u){ce().revokeObjectURL(u)};var ch={createObjectURL:cf,revokeObjectURL:cg};var cj=navigator,userAgent=cj.userAgent;var ck,webkit,ie,ie11,ie12,gecko,mac,iDevice,android,fileApi,phone,tablet,windowsPhone;var cl=function(a){return'matchMedia'in window?matchMedia(a).matches:false};ck=false;android=/Android/.test(userAgent);webkit=/WebKit/.test(userAgent);ie=!webkit&&!ck&&/MSIE/gi.test(userAgent)&&/Explorer/gi.test(cj.appName);ie=ie&&/MSIE (\w+)\./.exec(userAgent)[1];ie11=userAgent.indexOf('Trident/')!==-1&&(userAgent.indexOf('rv:')!==-1||cj.appName.indexOf('Netscape')!==-1)?11:false;ie12=userAgent.indexOf('Edge/')!==-1&&!ie&&!ie11?12:false;ie=ie||ie11||ie12;gecko=!webkit&&!ie11&&/Gecko/.test(userAgent);mac=userAgent.indexOf('Mac')!==-1;iDevice=/(iPad|iPhone)/.test(userAgent);fileApi='FormData'in window&&'FileReader'in window&&'URL'in window&&!!ch.createObjectURL;phone=cl('only screen and (max-device-width: 480px)')&&(android||iDevice);tablet=cl('only screen and (min-width: 800px)')&&(android||iDevice);windowsPhone=userAgent.indexOf('Windows Phone')!==-1;if(ie12){webkit=false}var cm=!iDevice||fileApi||parseInt(userAgent.match(/AppleWebKit\/(\d*)/)[1],10)>=534;var co={opera:ck,webkit:webkit,ie:ie,gecko:gecko,mac:mac,iOS:iDevice,android:android,contentEditable:cm,transparentSrc:'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7',caretAfter:ie!==8,range:window.getSelection&&'Range'in window,documentMode:ie&&!ie12?document.documentMode||7:10,fileApi:fileApi,ceFalse:ie===false||ie>8,cacheSuffix:null,container:null,overrideViewPort:null,experimentalShadowDom:false,canHaveCSP:ie===false||ie>11,desktop:!phone&&!tablet,windowsPhone:windowsPhone};var cp=function(){function bO(a,b){return function(){a.apply(b,arguments)}}var h=Array.isArray||function(a){return Object.prototype.toString.call(a)==='[object Array]'};var j=function(a){if(typeof this!=='object'){throw new TypeError('Promises must be constructed via new');}if(typeof a!=='function'){throw new TypeError('not a function');}this._state=null;this._value=null;this._deferreds=[];doResolve(a,bO(ca,this),bO(reject,this))};var k=j.immediateFn||typeof setImmediate==='function'&&setImmediate||function(a){setTimeout(a,1)};function wU(c){var d=this;if(this._state===null){this._deferreds.push(c);return}k(function(){var a=d._state?c.onFulfilled:c.onRejected;if(a===null){(d._state?c.resolve:c.reject)(d._value);return}var b;try{b=a(d._value)}catch(e){c.reject(e);return}c.resolve(b)})}function ca(a){try{if(a===this){throw new TypeError('A promise cannot be resolved with itself.');}if(a&&(typeof a==='object'||typeof a==='function')){var b=a.then;if(typeof b==='function'){doResolve(bO(b,a),bO(ca,this),bO(reject,this));return}}this._state=true;this._value=a;finale.call(this)}catch(e){reject.call(this,e)}}function reject(a){this._state=false;this._value=a;finale.call(this)}function finale(){for(var i=0,len=this._deferreds.length;i<len;i++){wU.call(this,this._deferreds[i])}this._deferreds=null}function Handler(a,b,c,d){this.onFulfilled=typeof a==='function'?a:null;this.onRejected=typeof b==='function'?b:null;this.resolve=c;this.reject=d}function doResolve(b,c,d){var e=false;try{b(function(a){if(e){return}e=true;c(a)},function(a){if(e){return}e=true;d(a)})}catch(ex){if(e){return}e=true;d(ex)}}j.prototype.catch=function(a){return this.then(null,a)};j.prototype.then=function(c,d){var e=this;return new j(function(a,b){wU.call(e,new Handler(c,d,a,b))})};j.all=function(){var g=Array.prototype.slice.call(arguments.length===1&&h(arguments[0])?arguments[0]:arguments);return new j(function(d,e){if(g.length===0){return d([])}var f=g.length;function res(i,b){try{if(b&&(typeof b==='object'||typeof b==='function')){var c=b.then;if(typeof c==='function'){c.call(b,function(a){res(i,a)},e);return}}g[i]=b;if(--f===0){d(g)}}catch(ex){e(ex)}}for(var i=0;i<g.length;i++){res(i,g[i])}})};j.resolve=function(b){if(b&&typeof b==='object'&&b.constructor===j){return b}return new j(function(a){a(b)})};j.reject=function(c){return new j(function(a,b){b(c)})};j.race=function(c){return new j(function(a,b){for(var i=0,len=c.length;i<len;i++){c[i].then(a,b)}})};return j};var cq=window.Promise?window.Promise:cp();var cr;var cs=function(b,c){var i,requestAnimationFrameFunc=window.requestAnimationFrame;var d=['ms','moz','webkit'];var e=function(a){window.setTimeout(a,0)};for(i=0;i<d.length&&!requestAnimationFrameFunc;i++){requestAnimationFrameFunc=window[d[i]+'RequestAnimationFrame']}if(!requestAnimationFrameFunc){requestAnimationFrameFunc=e}requestAnimationFrameFunc(b,c)};var ct=function(a,b){if(typeof b!=='number'){b=0}return setTimeout(a,b)};var cu=function(a,b){if(typeof b!=='number'){b=1}return setInterval(a,b)};var cv=function(a){return clearTimeout(a)};var cw=function(a){return clearInterval(a)};var cx=function(b,c){var d,func;func=function(){var a=arguments;clearTimeout(d);d=ct(function(){b.apply(this,a)},c)};func.stop=function(){clearTimeout(d)};return func};var cy={requestAnimationFrame:function(b,c){if(cr){cr.then(b);return}cr=new cq(function(a){if(!c){c=document.body}cs(a,c)}).then(b)},setTimeout:ct,setInterval:cu,setEditorTimeout:function(a,b,c){return ct(function(){if(!a.removed){b()}},c)},setEditorInterval:function(a,b,c){var d;d=cu(function(){if(!a.removed){b()}else{clearInterval(d)}},c);return d},debounce:cx,throttle:cx,clearInterval:cw,clearTimeout:cv};var cz='mce-data-';var cA=/^(?:mouse|contextmenu)|click/;var cB={keyLocation:1,layerX:1,layerY:1,returnValue:1,webkitMovementX:1,webkitMovementY:1,keyIdentifier:1};var cC=function(a){return a.isDefaultPrevented===cE||a.isDefaultPrevented===cD};var cD=function(){return false};var cE=function(){return true};var cF=function(a,b,c,d){if(a.addEventListener){a.addEventListener(b,c,d||false)}else if(a.attachEvent){a.attachEvent('on'+b,c)}};var cG=function(a,b,c,d){if(a.removeEventListener){a.removeEventListener(b,c,d||false)}else if(a.detachEvent){a.detachEvent('on'+b,c)}};var cH=function(a,b){if(a.composedPath){var c=a.composedPath();if(c&&c.length>0){return c[0]}}return b};var cI=function(a,b){var c;var d=b||{};for(c in a){if(!cB[c]){d[c]=a[c]}}if(!d.target){d.target=d.srcElement||document}if(co.experimentalShadowDom){d.target=cH(a,d.target)}if(a&&cA.test(a.type)&&a.pageX===undefined&&a.clientX!==undefined){var e=d.target.ownerDocument||document;var f=e.documentElement;var g=e.body;d.pageX=a.clientX+(f&&f.scrollLeft||g&&g.scrollLeft||0)-(f&&f.clientLeft||g&&g.clientLeft||0);d.pageY=a.clientY+(f&&f.scrollTop||g&&g.scrollTop||0)-(f&&f.clientTop||g&&g.clientTop||0)}d.preventDefault=function(){d.isDefaultPrevented=cE;if(a){if(a.preventDefault){a.preventDefault()}else{a.returnValue=false}}};d.stopPropagation=function(){d.isPropagationStopped=cE;if(a){if(a.stopPropagation){a.stopPropagation()}else{a.cancelBubble=true}}};d.stopImmediatePropagation=function(){d.isImmediatePropagationStopped=cE;d.stopPropagation()};if(cC(d)===false){d.isDefaultPrevented=cD;d.isPropagationStopped=cD;d.isImmediatePropagationStopped=cD}if(typeof d.metaKey==='undefined'){d.metaKey=false}return d};var cJ=function(a,b,c){var d=a.document,event$1={type:'ready'};if(c.domLoaded){b(event$1);return}var e=function(){return d.readyState==='complete'||d.readyState==='interactive'&&d.body};var f=function(){if(!c.domLoaded){c.domLoaded=true;b(event$1)}};var g=function(){if(e()){cG(d,'readystatechange',g);f()}};var h=function(){try{d.documentElement.doScroll('left')}catch(ex){cy.setTimeout(h);return}f()};if(d.addEventListener&&!(co.ie&&co.ie<11)){if(e()){f()}else{cF(a,'DOMContentLoaded',f)}}else{cF(d,'readystatechange',g);if(d.documentElement.doScroll&&a.self===a.top){h()}}cF(a,'load',f)};var cK=function(){var k=this;var m={},yw,expando,hasFocusIn,hasMouseEnterLeave,mouseEnterLeave;expando=cz+(+new Date()).toString(32);hasMouseEnterLeave='onmouseenter'in document.documentElement;hasFocusIn='onfocusin'in document.documentElement;mouseEnterLeave={mouseenter:'mouseover',mouseleave:'mouseout'};yw=1;k.domLoaded=false;k.events=m;var n=function(a,b){var c,i,l,callback;var d=m[b];c=d&&d[a.type];if(c){for(i=0,l=c.length;i<l;i++){callback=c[i];if(callback&&callback.func.call(callback.scope,a)===false){a.preventDefault()}if(a.isImmediatePropagationStopped()){return}}}};k.bind=function(c,d,e,f){var g,callbackList,i,name$1,fakeName,nativeHandler,capture;var h=window;var j=function(a){n(cI(a||h.event),g)};if(!c||c.nodeType===3||c.nodeType===8){return}if(!c[expando]){g=yw++;c[expando]=g;m[g]={}}else{g=c[expando]}f=f||c;d=d.split(' ');i=d.length;while(i--){name$1=d[i];nativeHandler=j;fakeName=capture=false;if(name$1==='DOMContentLoaded'){name$1='ready'}if(k.domLoaded&&name$1==='ready'&&c.readyState==='complete'){e.call(f,cI({type:name$1}));continue}if(!hasMouseEnterLeave){fakeName=mouseEnterLeave[name$1];if(fakeName){nativeHandler=function(a){var b,related;b=a.currentTarget;related=a.relatedTarget;if(related&&b.contains){related=b.contains(related)}else{while(related&&related!==b){related=related.parentNode}}if(!related){a=cI(a||h.event);a.type=a.type==='mouseout'?'mouseleave':'mouseenter';a.target=b;n(a,g)}}}}if(!hasFocusIn&&(name$1==='focusin'||name$1==='focusout')){capture=true;fakeName=name$1==='focusin'?'focus':'blur';nativeHandler=function(a){a=cI(a||h.event);a.type=a.type==='focus'?'focusin':'focusout';n(a,g)}}callbackList=m[g][name$1];if(!callbackList){m[g][name$1]=callbackList=[{func:e,scope:f}];callbackList.fakeName=fakeName;callbackList.capture=capture;callbackList.nativeHandler=nativeHandler;if(name$1==='ready'){cJ(c,nativeHandler,k)}else{cF(c,fakeName||name$1,nativeHandler,capture)}}else{if(name$1==='ready'&&k.domLoaded){e({type:name$1})}else{callbackList.push({func:e,scope:f})}}}c=callbackList=0;return e};k.unbind=function(a,b,c){var d,callbackList,i,ci,name$1,eventMap;if(!a||a.nodeType===3||a.nodeType===8){return k}d=a[expando];if(d){eventMap=m[d];if(b){b=b.split(' ');i=b.length;while(i--){name$1=b[i];callbackList=eventMap[name$1];if(callbackList){if(c){ci=callbackList.length;while(ci--){if(callbackList[ci].func===c){var e=callbackList.nativeHandler;var f=callbackList.fakeName,capture=callbackList.capture;callbackList=callbackList.slice(0,ci).concat(callbackList.slice(ci+1));callbackList.nativeHandler=e;callbackList.fakeName=f;callbackList.capture=capture;eventMap[name$1]=callbackList}}}if(!c||callbackList.length===0){delete eventMap[name$1];cG(a,callbackList.fakeName||name$1,callbackList.nativeHandler,callbackList.capture)}}}}else{for(name$1 in eventMap){callbackList=eventMap[name$1];cG(a,callbackList.fakeName||name$1,callbackList.nativeHandler,callbackList.capture)}eventMap={}}for(name$1 in eventMap){return k}delete m[d];try{delete a[expando]}catch(ex){a[expando]=null}}return k};k.fire=function(a,b,c){var d;if(!a||a.nodeType===3||a.nodeType===8){return k}c=cI(null,c);c.type=b;c.target=a;do{d=a[expando];if(d){n(c,d)}a=a.parentNode||a.ownerDocument||a.defaultView||a.parentWindow}while(a&&!c.isPropagationStopped());return k};k.clean=function(a){var i,gg;var b=k.unbind;if(!a||a.nodeType===3||a.nodeType===8){return k}if(a[expando]){b(a)}if(!a.getElementsByTagName){a=a.document}if(a&&a.getElementsByTagName){b(a);gg=a.getElementsByTagName('*');i=gg.length;while(i--){a=gg[i];if(a[expando]){b(a)}}}return k};k.destroy=function(){m={}};k.cancel=function(e){if(e){e.preventDefault();e.stopImmediatePropagation()}return false}};cK.Event=new cK();cK.Event.bind(window,'ready',function(){});var i,support,Expr,getText,isXML,tokenize,compile,select,outermostContext,sortInput,hasDuplicate,setDocument,document$1,docElem,documentIsHTML,rbuggyQSA,rbuggyMatches,matches,contains$1,expando='sizzle'+ -new Date(),preferredDoc=window.document,dirruns=0,done=0,classCache=createCache(),tokenCache=createCache(),compilerCache=createCache(),sortOrder=function(a,b){if(a===b){hasDuplicate=true}return 0},strundefined=typeof undefined,MAX_NEGATIVE=1<<31,hasOwn={}.hasOwnProperty,arr=[],pop=arr.pop,push_native=arr.push,push$1=arr.push,slice$1=arr.slice,indexOf$1=arr.indexOf||function(a){var i=0,len=this.length;for(;i<len;i++){if(this[i]===a){return i}}return-1},booleans='checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped',whitespace='[\\x20\\t\\r\\n\\f]',identifier='(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+',attributes='\\['+whitespace+'*('+identifier+')(?:'+whitespace+'*([*^$|!~]?=)'+whitespace+'*(?:\'((?:\\\\.|[^\\\\\'])*)\'|"((?:\\\\.|[^\\\\"])*)"|('+identifier+'))|)'+whitespace+'*\\]',pseudos=':('+identifier+')(?:\\(('+'(\'((?:\\\\.|[^\\\\\'])*)\'|"((?:\\\\.|[^\\\\"])*)")|'+'((?:\\\\.|[^\\\\()[\\]]|'+attributes+')*)|'+'.*'+')\\)|)',rtrim=new RegExp('^'+whitespace+'+|((?:^|[^\\\\])(?:\\\\.)*)'+whitespace+'+;,'g'),rcomma=new RegExp('^'+whitespace+'*,'+whitespace+'*'),rcombinators=new RegExp('^'+whitespace+'*([>+~]|'+whitespace+')'+whitespace+'*'),rattributeQuotes=new RegExp('='+whitespace+'*([^\\]\'"]*?)'+whitespace+'*\\]','g'),rpseudo=new RegExp(pseudos),ridentifier=new RegExp('^'+identifier+';),matchExpr={ID:new RegExp('^#('+identifier+')'),CLASS:new RegExp('^\\.('+identifier+')'),TAG:new RegExp('^('+identifier+'|[*])'),ATTR:new RegExp('^'+attributes),PSEUDO:new RegExp('^'+pseudos),CHILD:new RegExp('^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\('+whitespace+'*(even|odd|(([+-]|)(\\d*)n|)'+whitespace+'*(?:([+-]|)'+whitespace+'*(\\d+)|))'+whitespace+'*\\)|)','i'),bool:new RegExp('^(?:'+booleans+');,'i'),needsContext:new RegExp('^'+whitespace+'*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\('+whitespace+'*((?:-\\d)?\\d*)'+whitespace+'*\\)|)(?=[^-]|$)','i')},rinputs=/^(?:input|select|textarea|button)$/i,rheader=/^h\d$/i,rnative=/^[^{]+\{\s*\[native \w/,rquickExpr=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,rsibling=/[+~]/,rescape=/'|\\/g,runescape=new RegExp('\\\\([\\da-f]{1,6}'+whitespace+'?|('+whitespace+')|.)','ig'),funescape=function(_,a,b){var c='0x'+a-65536;return c!==c||b?a:c<0?String.fromCharCode(c+65536):String.fromCharCode(c>>10|55296,c&1023|56320)};try{push$1.apply(arr=slice$1.call(preferredDoc.childNodes),preferredDoc.childNodes);arr[preferredDoc.childNodes.length].nodeType}catch(e){push$1={apply:arr.length?function(a,b){push_native.apply(a,slice$1.call(b))}:function(a,b){var j=a.length,i=0;while(a[j++]=b[i++]){}a.length=j-1}}}var cL=function(a,b,c,d){var e,elem,m,nodeType,i,groups,old,nid,newContext,newSelector;if((b?b.ownerDocument||b:preferredDoc)!==document$1){setDocument(b)}b=b||document$1;c=c||[];if(!a||typeof a!=='string'){return c}if((nodeType=b.nodeType)!==1&&nodeType!==9){return[]}if(documentIsHTML&&!d){if(e=rquickExpr.exec(a)){if(m=e[1]){if(nodeType===9){elem=b.getElementById(m);if(elem&&elem.parentNode){if(elem.id===m){c.push(elem);return c}}else{return c}}else{if(b.ownerDocument&&(elem=b.ownerDocument.getElementById(m))&&contains$1(b,elem)&&elem.id===m){c.push(elem);return c}}}else if(e[2]){push$1.apply(c,b.getElementsByTagName(a));return c}else if((m=e[3])&&support.getElementsByClassName){push$1.apply(c,b.getElementsByClassName(m));return c}}if(support.qsa&&(!rbuggyQSA||!rbuggyQSA.test(a))){nid=old=expando;newContext=b;newSelector=nodeType===9&&a;if(nodeType===1&&b.nodeName.toLowerCase()!=='object'){groups=tokenize(a);if(old=b.getAttribute('id')){nid=old.replace(rescape,'\\{%value}')}else{b.setAttribute('id',nid)}nid='[id=\''+nid+'\'] ';i=groups.length;while(i--){groups[i]=nid+toSelector(groups[i])}newContext=rsibling.test(a)&&testContext(b.parentNode)||b;newSelector=groups.join(',')}if(newSelector){try{push$1.apply(c,newContext.querySelectorAll(newSelector));return c}catch(qsaError){}finally{if(!old){b.removeAttribute('id')}}}}}return select(a.replace(rtrim,'$1'),b,c,d)};function createCache(){var c=[];function cache(a,b){if(c.push(a+' ')>Expr.cacheLength){delete cache[c.shift()]}return cache[a+' ']=b}return cache}function markFunction(a){a[expando]=true;return a}function siblingCheck(a,b){var c=b&&a,At=c&&a.nodeType===1&&b.nodeType===1&&(~b.sourceIndex||MAX_NEGATIVE)-(~a.sourceIndex||MAX_NEGATIVE);if(At){return At}if(c){while(c=c.nextSibling){if(c===b){return-1}}}return a?1:-1}function createInputPseudo(c){return function(a){var b=a.nodeName.toLowerCase();return b==='input'&&a.type===c}}function createButtonPseudo(c){return function(a){var b=a.nodeName.toLowerCase();return(b==='input'||b==='button')&&a.type===c}}function createPositionalPseudo(d){return markFunction(function(c){c=+c;return markFunction(function(a,b){var j,matchIndexes=d([],a.length,c),i=matchIndexes.length;while(i--){if(a[j=matchIndexes[i]]){a[j]=!(b[j]=a[j])}}})})}function testContext(a){return a&&typeof a.getElementsByTagName!==strundefined&&a}support=cL.support={};isXML=cL.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return b?b.nodeName!=='HTML':false};setDocument=cL.setDocument=function(d){var e,dk=d?d.ownerDocument||d:preferredDoc,parent$1=dk.defaultView;function getTop(a){try{return a.top}catch(ex){}return null}if(dk===document$1||dk.nodeType!==9||!dk.documentElement){return document$1}document$1=dk;docElem=dk.documentElement;documentIsHTML=!isXML(dk);if(parent$1&&parent$1!==getTop(parent$1)){if(parent$1.addEventListener){parent$1.addEventListener('unload',function(){setDocument()},false)}else if(parent$1.attachEvent){parent$1.attachEvent('onunload',function(){setDocument()})}}support.attributes=true;support.getElementsByTagName=true;support.getElementsByClassName=rnative.test(dk.getElementsByClassName);support.getById=true;Expr.find.ID=function(a,b){if(typeof b.getElementById!==strundefined&&documentIsHTML){var m=b.getElementById(a);return m&&m.parentNode?[m]:[]}};Expr.filter.ID=function(b){var c=b.replace(runescape,funescape);return function(a){return a.getAttribute('id')===c}};Expr.find.TAG=support.getElementsByTagName?function(a,b){if(typeof b.getElementsByTagName!==strundefined){return b.getElementsByTagName(a)}}:function(a,b){var c,tmp=[],i=0,results=b.getElementsByTagName(a);if(a==='*'){while(c=results[i++]){if(c.nodeType===1){tmp.push(c)}}return tmp}return results};Expr.find.CLASS=support.getElementsByClassName&&function(a,b){if(documentIsHTML){return b.getElementsByClassName(a)}};rbuggyMatches=[];rbuggyQSA=[];support.disconnectedMatch=true;rbuggyQSA=rbuggyQSA.length&&new RegExp(rbuggyQSA.join('|'));rbuggyMatches=rbuggyMatches.length&&new RegExp(rbuggyMatches.join('|'));e=rnative.test(docElem.compareDocumentPosition);contains$1=e||rnative.test(docElem.contains)?function(a,b){var c=a.nodeType===9?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!!(bup&&bup.nodeType===1&&(c.contains?c.contains(bup):a.compareDocumentPosition&&a.compareDocumentPosition(bup)&16))}:function(a,b){if(b){while(b=b.parentNode){if(b===a){return true}}}return false};sortOrder=e?function(a,b){if(a===b){hasDuplicate=true;return 0}var c=!a.compareDocumentPosition-!b.compareDocumentPosition;if(c){return c}c=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1;if(c&1||!support.sortDetached&&b.compareDocumentPosition(a)===c){if(a===dk||a.ownerDocument===preferredDoc&&contains$1(preferredDoc,a)){return-1}if(b===dk||b.ownerDocument===preferredDoc&&contains$1(preferredDoc,b)){return 1}return sortInput?indexOf$1.call(sortInput,a)-indexOf$1.call(sortInput,b):0}return c&4?-1:1}:function(a,b){if(a===b){hasDuplicate=true;return 0}var c,i=0,aup=a.parentNode,bup=b.parentNode,ap=[a],is=[b];if(!aup||!bup){return a===dk?-1:b===dk?1:aup?-1:bup?1:sortInput?indexOf$1.call(sortInput,a)-indexOf$1.call(sortInput,b):0}else if(aup===bup){return siblingCheck(a,b)}c=a;while(c=c.parentNode){ap.unshift(c)}c=b;while(c=c.parentNode){is.unshift(c)}while(ap[i]===is[i]){i++}return i?siblingCheck(ap[i],is[i]):ap[i]===preferredDoc?-1:is[i]===preferredDoc?1:0};return dk};cL.matches=function(a,b){return cL(a,null,null,b)};cL.matchesSelector=function(a,b){if((a.ownerDocument||a)!==document$1){setDocument(a)}b=b.replace(rattributeQuotes,'=\'$1\']');if(support.matchesSelector&&documentIsHTML&&(!rbuggyMatches||!rbuggyMatches.test(b))&&(!rbuggyQSA||!rbuggyQSA.test(b))){try{var c=matches.call(a,b);if(c||support.disconnectedMatch||a.document&&a.document.nodeType!==11){return c}}catch(e){}}return cL(b,document$1,null,[a]).length>0};cL.contains=function(a,b){if((a.ownerDocument||a)!==document$1){setDocument(a)}return contains$1(a,b)};cL.attr=function(a,b){if((a.ownerDocument||a)!==document$1){setDocument(a)}var c=Expr.attrHandle[b.toLowerCase()],val=c&&hasOwn.call(Expr.attrHandle,b.toLowerCase())?c(a,b,!documentIsHTML):undefined;return val!==undefined?val:support.attributes||!documentIsHTML?a.getAttribute(b):(val=a.getAttributeNode(b))&&val.specified?val.value:null};cL.error=function(a){throw new Error('Syntax error, unrecognized expression: '+a);};cL.uniqueSort=function(a){var b,duplicates=[],j=0,i=0;hasDuplicate=!support.detectDuplicates;sortInput=!support.sortStable&&a.slice(0);a.sort(sortOrder);if(hasDuplicate){while(b=a[i++]){if(b===a[i]){j=duplicates.push(i)}}while(j--){a.splice(duplicates[j],1)}}sortInput=null;return a};getText=cL.getText=function(a){var b,ret='',i=0,nodeType=a.nodeType;if(!nodeType){while(b=a[i++]){ret+=getText(b)}}else if(nodeType===1||nodeType===9||nodeType===11){if(typeof a.textContent==='string'){return a.textContent}else{for(a=a.firstChild;a;a=a.nextSibling){ret+=getText(a)}}}else if(nodeType===3||nodeType===4){return a.nodeValue}return ret};Expr=cL.selectors={cacheLength:50,createPseudo:markFunction,match:matchExpr,attrHandle:{},find:{},relative:{'>':{dir:'parentNode',first:true},' ':{dir:'parentNode'},'+':{dir:'previousSibling',first:true},'~':{dir:'previousSibling'}},preFilter:{ATTR:function(a){a[1]=a[1].replace(runescape,funescape);a[3]=(a[3]||a[4]||a[5]||'').replace(runescape,funescape);if(a[2]==='~='){a[3]=' '+a[3]+' '}return a.slice(0,4)},CHILD:function(a){a[1]=a[1].toLowerCase();if(a[1].slice(0,3)==='nth'){if(!a[3]){cL.error(a[0])}a[4]=+(a[4]?a[5]+(a[6]||1):2*(a[3]==='even'||a[3]==='odd'));a[5]=+(a[7]+a[8]||a[3]==='odd')}else if(a[3]){cL.error(a[0])}return a},PSEUDO:function(a){var b,unquoted=!a[6]&&a[2];if(matchExpr.CHILD.test(a[0])){return null}if(a[3]){a[2]=a[4]||a[5]||''}else if(unquoted&&rpseudo.test(unquoted)&&(b=tokenize(unquoted,true))&&(b=unquoted.indexOf(')',unquoted.length-b)-unquoted.length)){a[0]=a[0].slice(0,b);a[2]=unquoted.slice(0,b)}return a.slice(0,3)}},filter:{TAG:function(b){var c=b.replace(runescape,funescape).toLowerCase();return b==='*'?function(){return true}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===c}},CLASS:function(b){var c=classCache[b+' '];return c||(c=new RegExp('(^|'+whitespace+')'+b+'('+whitespace+'|$)'))&&classCache(b,function(a){return c.test(typeof a.className==='string'&&a.className||typeof a.getAttribute!==strundefined&&a.getAttribute('class')||'')})},ATTR:function(c,d,e){return function(a){var b=cL.attr(a,c);if(b==null){return d==='!='}if(!d){return true}b+='';return d==='='?b===e:d==='!='?b!==e:d==='^='?e&&b.indexOf(e)===0:d==='*='?e&&b.indexOf(e)>-1:d==='$='?e&&b.slice(-e.length)===e:d==='~='?(' '+b+' ').indexOf(e)>-1:d==='|='?b===e||b.slice(0,e.length+1)===e+'-':false}},CHILD:function(e,f,g,h,i){var j=e.slice(0,3)!=='nth',forward=e.slice(-4)!=='last',ofType=f==='of-type';return h===1&&i===0?function(a){return!!a.parentNode}:function(a,b,c){var d,outerCache,fH,At,lf,ti,dI=j!==forward?'nextSibling':'previousSibling',parent$1=a.parentNode,name$1=ofType&&a.nodeName.toLowerCase(),useCache=!c&&!ofType;if(parent$1){if(j){while(dI){fH=a;while(fH=fH[dI]){if(ofType?fH.nodeName.toLowerCase()===name$1:fH.nodeType===1){return false}}ti=dI=e==='only'&&!ti&&'nextSibling'}return true}ti=[forward?parent$1.firstChild:parent$1.lastChild];if(forward&&useCache){outerCache=parent$1[expando]||(parent$1[expando]={});d=outerCache[e]||[];lf=d[0]===dirruns&&d[1];At=d[0]===dirruns&&d[2];fH=lf&&parent$1.childNodes[lf];while(fH=++lf&&fH&&fH[dI]||(At=lf=0)||ti.pop()){if(fH.nodeType===1&&++At&&fH===a){outerCache[e]=[dirruns,lf,At];break}}}else if(useCache&&(d=(a[expando]||(a[expando]={}))[e])&&d[0]===dirruns){At=d[1]}else{while(fH=++lf&&fH&&fH[dI]||(At=lf=0)||ti.pop()){if((ofType?fH.nodeName.toLowerCase()===name$1:fH.nodeType===1)&&++At){if(useCache){(fH[expando]||(fH[expando]={}))[e]=[dirruns,At]}if(fH===a){break}}}}At-=i;return At===h||At%h===0&&At/h>=0}}},PSEUDO:function(d,e){var f,fn=Expr.pseudos[d]||Expr.setFilters[d.toLowerCase()]||cL.error('unsupported pseudo: '+d);if(fn[expando]){return fn(e)}if(fn.length>1){f=[d,d,'',e];return Expr.setFilters.hasOwnProperty(d.toLowerCase())?markFunction(function(a,b){var c,matched=fn(a,e),i=matched.length;while(i--){c=indexOf$1.call(a,matched[i]);a[c]=!(b[c]=matched[i])}}):function(a){return fn(a,0,f)}}return fn}},pseudos:{not:markFunction(function(f){var g=[],results=[],matcher=compile(f.replace(rtrim,'$1'));return matcher[expando]?markFunction(function(a,b,c,d){var e,unmatched=matcher(a,null,d,[]),i=a.length;while(i--){if(e=unmatched[i]){a[i]=!(b[i]=e)}}}):function(a,b,c){g[0]=a;matcher(g,null,c,results);return!results.pop()}}),has:markFunction(function(b){return function(a){return cL(b,a).length>0}}),contains:markFunction(function(b){b=b.replace(runescape,funescape);return function(a){return(a.textContent||a.innerText||getText(a)).indexOf(b)>-1}}),lang:markFunction(function(c){if(!ridentifier.test(c||'')){cL.error('unsupported lang: '+c)}c=c.replace(runescape,funescape).toLowerCase();return function(a){var b;do{if(b=documentIsHTML?a.lang:a.getAttribute('xml:lang')||a.getAttribute('lang')){b=b.toLowerCase();return b===c||b.indexOf(c+'-')===0}}while((a=a.parentNode)&&a.nodeType===1);return false}}),target:function(a){var b=window.location&&window.location.hash;return b&&b.slice(1)===a.id},root:function(a){return a===docElem},focus:function(a){return a===document$1.activeElement&&(!document$1.hasFocus||document$1.hasFocus())&&!!(a.type||a.href||~a.tabIndex)},enabled:function(a){return a.disabled===false},disabled:function(a){return a.disabled===true},checked:function(a){var b=a.nodeName.toLowerCase();return b==='input'&&!!a.checked||b==='option'&&!!a.selected},selected:function(a){if(a.parentNode){a.parentNode.selectedIndex}return a.selected===true},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling){if(a.nodeType<6){return false}}return true},parent:function(a){return!Expr.pseudos.empty(a)},header:function(a){return rheader.test(a.nodeName)},input:function(a){return rinputs.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return b==='input'&&a.type==='button'||b==='button'},text:function(a){var b;return a.nodeName.toLowerCase()==='input'&&a.type==='text'&&((b=a.getAttribute('type'))==null||b.toLowerCase()==='text')},first:createPositionalPseudo(function(){return[0]}),last:createPositionalPseudo(function(a,b){return[b-1]}),eq:createPositionalPseudo(function(a,b,c){return[c<0?c+b:c]}),even:createPositionalPseudo(function(a,b){var i=0;for(;i<b;i+=2){a.push(i)}return a}),odd:createPositionalPseudo(function(a,b){var i=1;for(;i<b;i+=2){a.push(i)}return a}),lt:createPositionalPseudo(function(a,b,c){var i=c<0?c+b:c;for(;--i>=0;){a.push(i)}return a}),gt:createPositionalPseudo(function(a,b,c){var i=c<0?c+b:c;for(;++i<b;){a.push(i)}return a})}};Expr.pseudos.nth=Expr.pseudos.eq;for(i in{radio:true,checkbox:true,file:true,password:true,image:true}){Expr.pseudos[i]=createInputPseudo(i)}for(i in{submit:true,reset:true}){Expr.pseudos[i]=createButtonPseudo(i)}function setFilters(){}setFilters.prototype=Expr.filters=Expr.pseudos;Expr.setFilters=new setFilters();tokenize=cL.tokenize=function(a,b){var c,AW,tokens,fd,soFar,groups,preFilters,dM=tokenCache[a+' '];if(dM){return b?0:dM.slice(0)}soFar=a;groups=[];preFilters=Expr.preFilter;while(soFar){if(!c||(AW=rcomma.exec(soFar))){if(AW){soFar=soFar.slice(AW[0].length)||soFar}groups.push(tokens=[])}c=false;if(AW=rcombinators.exec(soFar)){c=AW.shift();tokens.push({value:c,type:AW[0].replace(rtrim,' ')});soFar=soFar.slice(c.length)}for(fd in Expr.filter){if((AW=matchExpr[fd].exec(soFar))&&(!preFilters[fd]||(AW=preFilters[fd](AW)))){c=AW.shift();tokens.push({value:c,type:fd,matches:AW});soFar=soFar.slice(c.length)}}if(!c){break}}return b?soFar.length:soFar?cL.error(a):tokenCache(a,groups).slice(0)};function toSelector(a){var i=0,len=a.length,selector='';for(;i<len;i++){selector+=a[i].value}return selector}function addCombinator(e,f,g){var h=f.dir,checkNonElements=g&&h==='parentNode',doneName=done++;return f.first?function(a,b,c){while(a=a[h]){if(a.nodeType===1||checkNonElements){return e(a,b,c)}}}:function(a,b,c){var d,outerCache,newCache=[dirruns,doneName];if(c){while(a=a[h]){if(a.nodeType===1||checkNonElements){if(e(a,b,c)){return true}}}}else{while(a=a[h]){if(a.nodeType===1||checkNonElements){outerCache=a[expando]||(a[expando]={});if((d=outerCache[h])&&d[0]===dirruns&&d[1]===doneName){return newCache[2]=d[2]}else{outerCache[h]=newCache;if(newCache[2]=e(a,b,c)){return true}}}}}}}function elementMatcher(d){return d.length>1?function(a,b,c){var i=d.length;while(i--){if(!d[i](a,b,c)){return false}}return true}:d[0]}function multipleContexts(a,b,c){var i=0,len=b.length;for(;i<len;i++){cL(a,b[i],c)}return c}function condense(a,b,c,d,e){var f,newUnmatched=[],i=0,len=a.length,mapped=b!=null;for(;i<len;i++){if(f=a[i]){if(!c||c(f,d,e)){newUnmatched.push(f);if(mapped){b.push(i)}}}}return newUnmatched}function setMatcher(f,g,h,j,k,l){if(j&&!j[expando]){j=setMatcher(j)}if(k&&!k[expando]){k=setMatcher(k,l)}return markFunction(function(a,b,c,d){var e,i,elem,preMap=[],postMap=[],preexisting=b.length,elems=a||multipleContexts(g||'*',c.nodeType?[c]:c,[]),matcherIn=f&&(a||!g)?condense(elems,preMap,f,c,d):elems,matcherOut=h?k||(a?f:preexisting||j)?[]:b:matcherIn;if(h){h(matcherIn,matcherOut,c,d)}if(j){e=condense(matcherOut,postMap);j(e,[],c,d);i=e.length;while(i--){if(elem=e[i]){matcherOut[postMap[i]]=!(matcherIn[postMap[i]]=elem)}}}if(a){if(k||f){if(k){e=[];i=matcherOut.length;while(i--){if(elem=matcherOut[i]){e.push(matcherIn[i]=elem)}}k(null,matcherOut=[],e,d)}i=matcherOut.length;while(i--){if((elem=matcherOut[i])&&(e=k?indexOf$1.call(a,elem):preMap[i])>-1){a[e]=!(b[e]=elem)}}}}else{matcherOut=condense(matcherOut===b?matcherOut.splice(preexisting,matcherOut.length):matcherOut);if(k){k(null,b,matcherOut,d)}else{push$1.apply(b,matcherOut)}}})}function matcherFromTokens(d){var e,matcher,j,len=d.length,leadingRelative=Expr.relative[d[0].type],implicitRelative=leadingRelative||Expr.relative[' '],i=leadingRelative?1:0,matchContext=addCombinator(function(a){return a===e},implicitRelative,true),matchAnyContext=addCombinator(function(a){return indexOf$1.call(e,a)>-1},implicitRelative,true),matchers=[function(a,b,c){return!leadingRelative&&(c||b!==outermostContext)||((e=b).nodeType?matchContext(a,b,c):matchAnyContext(a,b,c))}];for(;i<len;i++){if(matcher=Expr.relative[d[i].type]){matchers=[addCombinator(elementMatcher(matchers),matcher)]}else{matcher=Expr.filter[d[i].type].apply(null,d[i].matches);if(matcher[expando]){j=++i;for(;j<len;j++){if(Expr.relative[d[j].type]){break}}return setMatcher(i>1&&elementMatcher(matchers),i>1&&toSelector(d.slice(0,i-1).concat({value:d[i-2].type===' '?'*':''})).replace(rtrim,'$1'),matcher,i<j&&matcherFromTokens(d.slice(i,j)),j<len&&matcherFromTokens(d=d.slice(j)),j<len&&toSelector(d))}matchers.push(matcher)}}return elementMatcher(matchers)}function matcherFromGroupMatchers(g,h){var k=h.length>0,byElement=g.length>0,superMatcher=function(a,b,c,d,e){var f,j,matcher,matchedCount=0,i='0',unmatched=a&&[],setMatched=[],contextBackup=outermostContext,elems=a||byElement&&Expr.find.TAG('*',e),dirrunsUnique=dirruns+=contextBackup==null?1:Math.random()||0.1,len=elems.length;if(e){outermostContext=b!==document$1&&b}for(;i!==len&&(f=elems[i])!=null;i++){if(byElement&&f){j=0;while(matcher=g[j++]){if(matcher(f,b,c)){d.push(f);break}}if(e){dirruns=dirrunsUnique}}if(k){if(f=!matcher&&f){matchedCount--}if(a){unmatched.push(f)}}}matchedCount+=i;if(k&&i!==matchedCount){j=0;while(matcher=h[j++]){matcher(unmatched,setMatched,b,c)}if(a){if(matchedCount>0){while(i--){if(!(unmatched[i]||setMatched[i])){setMatched[i]=pop.call(d)}}}setMatched=condense(setMatched)}push$1.apply(d,setMatched);if(e&&!a&&setMatched.length>0&&matchedCount+h.length>1){cL.uniqueSort(d)}}if(e){dirruns=dirrunsUnique;outermostContext=contextBackup}return unmatched};return k?markFunction(superMatcher):superMatcher}compile=cL.compile=function(a,b){var i,setMatchers=[],elementMatchers=[],dM=compilerCache[a+' '];if(!dM){if(!b){b=tokenize(a)}i=b.length;while(i--){dM=matcherFromTokens(b[i]);if(dM[expando]){setMatchers.push(dM)}else{elementMatchers.push(dM)}}dM=compilerCache(a,matcherFromGroupMatchers(elementMatchers,setMatchers));dM.selector=a}return dM};select=cL.select=function(a,b,c,d){var i,tokens,token,fd,bJ,compiled=typeof a==='function'&&a,AW=!d&&tokenize(a=compiled.selector||a);c=c||[];if(AW.length===1){tokens=AW[0]=AW[0].slice(0);if(tokens.length>2&&(token=tokens[0]).type==='ID'&&support.getById&&b.nodeType===9&&documentIsHTML&&Expr.relative[tokens[1].type]){b=(Expr.find.ID(token.matches[0].replace(runescape,funescape),b)||[])[0];if(!b){return c}else if(compiled){b=b.parentNode}a=a.slice(tokens.shift().value.length)}i=matchExpr.needsContext.test(a)?0:tokens.length;while(i--){token=tokens[i];if(Expr.relative[fd=token.type]){break}if(bJ=Expr.find[fd]){if(d=bJ(token.matches[0].replace(runescape,funescape),rsibling.test(tokens[0].type)&&testContext(b.parentNode)||b)){tokens.splice(i,1);a=d.length&&toSelector(tokens);if(!a){push$1.apply(c,d);return c}break}}}}(compiled||compile(a,AW))(d,b,!documentIsHTML,c,rsibling.test(a)&&testContext(b.parentNode)||b);return c};support.sortStable=expando.split('').sort(sortOrder).join('')===expando;support.detectDuplicates=!!hasDuplicate;setDocument();support.sortDetached=true;var cM=Array.isArray;var cN=function(a){var b=a,i,l;if(!cM(a)){b=[];for(i=0,l=a.length;i<l;i++){b[i]=a[i]}}return b};var cO=function(o,a,s){var n,l;if(!o){return 0}s=s||o;if(o.length!==undefined){for(n=0,l=o.length;n<l;n++){if(a.call(s,o[n],n,o)===false){return 0}}}else{for(n in o){if(o.hasOwnProperty(n)){if(a.call(s,o[n],n,o)===false){return 0}}}}return 1};var cP=function(c,d){var e=[];cO(c,function(a,b){e.push(d(a,b,c))});return e};var cQ=function(a,f){var o=[];cO(a,function(v,b){if(!f||f(v,b,a)){o.push(v)}});return o};var cR=function(a,v){var i,l;if(a){for(i=0,l=a.length;i<l;i++){if(a[i]===v){return i}}}return-1};var cS=function(a,b,c,d){var i=0;if(arguments.length<3){c=a[0]}for(;i<a.length;i++){c=b.call(d,c,a[i],i)}return c};var cT=function(a,b,c){var i,l;for(i=0,l=a.length;i<l;i++){if(b.call(c,a[i],i,a)){return i}}return-1};var cU=function(a,b,c){var d=cT(a,b,c);if(d!==-1){return a[d]}return undefined};var cV=function(a){return a[a.length-1]};var cW={isArray:cM,toArray:cN,each:cO,map:cP,filter:cQ,indexOf:cR,reduce:cS,findIndex:cT,find:cU,last:cV};var cX=/^\s*|\s*$/g;var cY=function(a){return a===null||a===undefined?'':(''+a).replace(cX,'')};var cZ=function(a,b){if(!b){return a!==undefined}if(b==='array'&&cW.isArray(a)){return true}return typeof a===b};var da=function(a,b,c){var i;a=a||[];b=b||',';if(typeof a==='string'){a=a.split(b)}c=c||{};i=a.length;while(i--){c[a[i]]={}}return c};var hasOwnProperty=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};var db=function(s,p,a){var b=this;var d,ns,cn,scn,c,de=0;s=/^((static) )?([\w.]+)(:([\w.]+))?/.exec(s);cn=s[3].match(/(^|\.)(\w+)$/i)[2];ns=b.createNS(s[3].replace(/\.\w+$/,''),a);if(ns[cn]){return}if(s[2]==='static'){ns[cn]=p;if(this.onCreate){this.onCreate(s[2],s[3],ns[cn])}return}if(!p[cn]){p[cn]=function(){};de=1}ns[cn]=p[cn];b.extend(ns[cn].prototype,p);if(s[5]){d=b.resolve(s[5]).prototype;scn=s[5].match(/\.(\w+)$/i)[1];c=ns[cn];if(de){ns[cn]=function(){return d[scn].apply(this,arguments)}}else{ns[cn]=function(){this.parent=d[scn];return c.apply(this,arguments)}}ns[cn].prototype[cn]=ns[cn];b.each(d,function(f,n){ns[cn].prototype[n]=d[n]});b.each(p,function(f,n){if(d[n]){ns[cn].prototype[n]=function(){this.parent=d[n];return f.apply(this,arguments)}}else{if(n!==cn){ns[cn].prototype[n]=f}}})}b.each(p.static,function(f,n){ns[cn][n]=f})};var dc=function(a,b){var x=[];for(var c=2;c<arguments.length;c++){x[c-2]=arguments[c]}var i,l,name$1;var d=arguments;var e;for(i=1,l=d.length;i<l;i++){b=d[i];for(name$1 in b){if(b.hasOwnProperty(name$1)){e=b[name$1];if(e!==undefined){a[name$1]=e}}}}return a};var dd=function(o,f,n,s){s=s||this;if(o){if(n){o=o[n]}cW.each(o,function(o,i){if(f.call(s,o,i,n)===false){return false}dd(o,f,n,s)})}};var df=function(n,o){var i,v;o=o||window;n=n.split('.');for(i=0;i<n.length;i++){v=n[i];if(!o[v]){o[v]={}}o=o[v]}return o};var dg=function(n,o){var i,l;o=o||window;n=n.split('.');for(i=0,l=n.length;i<l;i++){o=o[n[i]];if(!o){break}}return o};var dh=function(s,d){if(!s||cZ(s,'array')){return s}return cW.map(s.split(d||','),cY)};var di=function(a){var b=co.cacheSuffix;if(b){a+=(a.indexOf('?')===-1?'?':'&')+b}return a};var dj={trim:cY,isArray:cW.isArray,is:cZ,toArray:cW.toArray,makeMap:da,each:cW.each,map:cW.map,grep:cW.filter,inArray:cW.indexOf,hasOwn:hasOwnProperty,extend:dc,create:db,walk:dd,createNS:df,resolve:dg,explode:dh,_addCacheSuffix:di};var dk=document,push$2=Array.prototype.push,slice$2=Array.prototype.slice;var dl=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/;var dm=cK.Event;var dn=dj.makeMap('children,contents,next,prev');var dp=function(a){return typeof a!=='undefined'};var dq=function(a){return typeof a==='string'};var dr=function(a){return a&&a===a.window};var ds=function(a,b){var c,fH,container;b=b||dk;container=b.createElement('div');c=b.createDocumentFragment();container.innerHTML=a;while(fH=container.firstChild){c.appendChild(fH)}return c};var dt=function(a,b,c,d){var i;if(dq(b)){b=ds(b,dH(a[0]))}else if(b.length&&!b.nodeType){b=dB.makeArray(b);if(d){for(i=b.length-1;i>=0;i--){dt(a,b[i],c,d)}}else{for(i=0;i<b.length;i++){dt(a,b[i],c,d)}}return a}if(b.nodeType){i=a.length;while(i--){c.call(a[i],b)}}return a};var du=function(a,b){return a&&b&&(' '+a.className+' ').indexOf(' '+b+' ')!==-1};var dv=function(b,c,d){var e,newWrapper;c=dB(c)[0];b.each(function(){var a=this;if(!d||e!==a.parentNode){e=a.parentNode;newWrapper=c.cloneNode(false);a.parentNode.insertBefore(newWrapper,a);newWrapper.appendChild(a)}else{newWrapper.appendChild(a)}});return b};var dw=dj.makeMap('fillOpacity fontWeight lineHeight opacity orphans widows zIndex zoom',' ');var dx=dj.makeMap('checked compact declare defer disabled ismap multiple nohref noshade nowrap readonly selected',' ');var dy={for:'htmlFor',class:'className',readonly:'readOnly'};var dz={float:'cssFloat'};var dA={},cssHooks={};var dB=function(a,b){return new dB.fn.init(a,b)};var dC=function(a,b){var i;if(b.indexOf){return b.indexOf(a)}i=b.length;while(i--){if(b[i]===a){return i}}return-1};var dD=/^\s*|\s*$/g;var dE=function(a){return a===null||a===undefined?'':(''+a).replace(dD,'')};var dF=function(a,b){var c,key,i,value;if(a){c=a.length;if(c===undefined){for(key in a){if(a.hasOwnProperty(key)){value=a[key];if(b.call(value,key,value)===false){break}}}}else{for(i=0;i<c;i++){value=a[i];if(b.call(value,i,value)===false){break}}}}return a};var dG=function(b,c){var d=[];dF(b,function(i,a){if(c(a,i)){d.push(a)}});return d};var dH=function(a){if(!a){return dk}if(a.nodeType===9){return a}return a.ownerDocument};dB.fn=dB.prototype={constructor:dB,selector:'',context:null,length:0,init:function(a,b){var c=this;var d,fH;if(!a){return c}if(a.nodeType){c.context=c[0]=a;c.length=1;return c}if(b&&b.nodeType){c.context=b}else{if(b){return dB(a).attr(b)}c.context=b=document}if(dq(a)){c.selector=a;if(a.charAt(0)==='<'&&a.charAt(a.length-1)==='>'&&a.length>=3){d=[null,a,null]}else{d=dl.exec(a)}if(d){if(d[1]){fH=ds(a,dH(b)).firstChild;while(fH){push$2.call(c,fH);fH=fH.nextSibling}}else{fH=dH(b).getElementById(d[2]);if(!fH){return c}if(fH.id!==d[2]){return c.find(a)}c.length=1;c[0]=fH}}else{return dB(b).find(a)}}else{this.add(a,false)}return c},toArray:function(){return dj.toArray(this)},add:function(a,b){var c=this;var d,i;if(dq(a)){return c.add(dB(a))}if(b!==false){d=dB.unique(c.toArray().concat(dB.makeArray(a)));c.length=d.length;for(i=0;i<d.length;i++){c[i]=d[i]}}else{push$2.apply(c,dB.makeArray(a))}return c},attr:function(c,d){var e=this;var f;if(typeof c==='object'){dF(c,function(a,b){e.attr(a,b)})}else if(dp(d)){this.each(function(){var a;if(this.nodeType===1){a=dA[c];if(a&&a.set){a.set(this,d);return}if(d===null){this.removeAttribute(c,2)}else{this.setAttribute(c,d,2)}}})}else{if(e[0]&&e[0].nodeType===1){f=dA[c];if(f&&f.get){return f.get(e[0],c)}if(dx[c]){return e.prop(c)?c:undefined}d=e[0].getAttribute(c,2);if(d===null){d=undefined}}return d}return e},removeAttr:function(a){return this.attr(a,null)},prop:function(c,d){var e=this;c=dy[c]||c;if(typeof c==='object'){dF(c,function(a,b){e.prop(a,b)})}else if(dp(d)){this.each(function(){if(this.nodeType===1){this[c]=d}})}else{if(e[0]&&e[0].nodeType&&c in e[0]){return e[0][c]}return d}return e},css:function(d,e){var f=this;var g,hook;var h=function(c){return c.replace(/-(\D)/g,function(a,b){return b.toUpperCase()})};var i=function(b){return b.replace(/[A-Z]/g,function(a){return'-'+a})};if(typeof d==='object'){dF(d,function(a,b){f.css(a,b)})}else{if(dp(e)){d=h(d);if(typeof e==='number'&&!dw[d]){e=e.toString()+'px'}f.each(function(){var a=this.style;hook=cssHooks[d];if(hook&&hook.set){hook.set(this,e);return}try{this.style[dz[d]||d]=e}catch(ex){}if(e===null||e===''){if(a.removeProperty){a.removeProperty(i(d))}else{a.removeAttribute(d)}}})}else{g=f[0];hook=cssHooks[d];if(hook&&hook.get){return hook.get(g)}if(g.ownerDocument.defaultView){try{return g.ownerDocument.defaultView.getComputedStyle(g,null).getPropertyValue(i(d))}catch(ex){return undefined}}else if(g.currentStyle){return g.currentStyle[h(d)]}else{return''}}}return f},remove:function(){var a=this;var b,i=this.length;while(i--){b=a[i];dm.clean(b);if(b.parentNode){b.parentNode.removeChild(b)}}return this},empty:function(){var a=this;var b,i=this.length;while(i--){b=a[i];while(b.firstChild){b.removeChild(b.firstChild)}}return this},html:function(a){var b=this;var i;if(dp(a)){i=b.length;try{while(i--){b[i].innerHTML=a}}catch(ex){dB(b[i]).empty().append(a)}return b}return b[0]?b[0].innerHTML:''},text:function(a){var b=this;var i;if(dp(a)){i=b.length;while(i--){if('innerText'in b[i]){b[i].innerText=a}else{b[0].textContent=a}}return b}return b[0]?b[0].innerText||b[0].textContent:''},append:function(){return dt(this,arguments,function(a){if(this.nodeType===1||this.host&&this.host.nodeType===1){this.appendChild(a)}})},prepend:function(){return dt(this,arguments,function(a){if(this.nodeType===1||this.host&&this.host.nodeType===1){this.insertBefore(a,this.firstChild)}},true)},before:function(){var b=this;if(b[0]&&b[0].parentNode){return dt(b,arguments,function(a){this.parentNode.insertBefore(a,this)})}return b},after:function(){var b=this;if(b[0]&&b[0].parentNode){return dt(b,arguments,function(a){this.parentNode.insertBefore(a,this.nextSibling)},true)}return b},appendTo:function(a){dB(a).append(this);return this},prependTo:function(a){dB(a).prepend(this);return this},replaceWith:function(a){return this.before(a).remove()},wrap:function(a){return dv(this,a)},wrapAll:function(a){return dv(this,a,true)},wrapInner:function(a){this.each(function(){dB(this).contents().wrapAll(a)});return this},unwrap:function(){return this.parent().each(function(){dB(this).replaceWith(this.childNodes)})},clone:function(){var a=[];this.each(function(){a.push(this.cloneNode(true))});return dB(a)},addClass:function(a){return this.toggleClass(a,true)},removeClass:function(a){return this.toggleClass(a,false)},toggleClass:function(d,e){var f=this;if(typeof d!=='string'){return f}if(d.indexOf(' ')!==-1){dF(d.split(' '),function(){f.toggleClass(this,e)})}else{f.each(function(a,b){var c,classState;classState=du(b,d);if(classState!==e){c=b.className;if(classState){b.className=dE((' '+c+' ').replace(' '+d+' ',' '))}else{b.className+=c?' '+d:d}}})}return f},hasClass:function(a){return du(this[0],a)},each:function(a){return dF(this,a)},on:function(a,b){return this.each(function(){dm.bind(this,a,b)})},off:function(a,b){return this.each(function(){dm.unbind(this,a,b)})},trigger:function(a){return this.each(function(){if(typeof a==='object'){dm.fire(this,a.type,a)}else{dm.fire(this,a)}})},show:function(){return this.css('display','')},hide:function(){return this.css('display','none')},slice:function(){return new dB(slice$2.apply(this,arguments))},eq:function(a){return a===-1?this.slice(a):this.slice(a,+a+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},find:function(a){var i,l;var b=[];for(i=0,l=this.length;i<l;i++){dB.find(a,this[i],b)}return dB(b)},filter:function(b){if(typeof b==='function'){return dB(dG(this.toArray(),function(a,i){return b(i,a)}))}return dB(dB.filter(b,this.toArray()))},closest:function(b){var c=[];if(b instanceof dB){b=b[0]}this.each(function(i,a){while(a){if(typeof b==='string'&&dB(a).is(b)){c.push(a);break}else if(a===b){c.push(a);break}a=a.parentNode}});return dB(c)},offset:function(a){var b,dk,docElm;var x=0,y=0,pos;if(!a){b=this[0];if(b){dk=b.ownerDocument;docElm=dk.documentElement;if(b.getBoundingClientRect){pos=b.getBoundingClientRect();x=pos.left+(docElm.scrollLeft||dk.body.scrollLeft)-docElm.clientLeft;y=pos.top+(docElm.scrollTop||dk.body.scrollTop)-docElm.clientTop}}return{left:x,top:y}}return this.css(a)},push:push$2,sort:[].sort,splice:[].splice};dj.extend(dB,{extend:dj.extend,makeArray:function(a){if(dr(a)||a.nodeType){return[a]}return dj.toArray(a)},inArray:dC,isArray:dj.isArray,each:dF,trim:dE,grep:dG,find:cL,expr:cL.selectors,unique:cL.uniqueSort,text:cL.getText,contains:cL.contains,filter:function(a,b,c){var i=b.length;if(c){a=':not('+a+')'}while(i--){if(b[i].nodeType!==1){b.splice(i,1)}}if(b.length===1){b=dB.find.matchesSelector(b[0],a)?[b[0]]:[]}else{b=dB.find.matches(a,b)}return b}});var dI=function(a,b,c){var d=[];var e=a[b];if(typeof c!=='string'&&c instanceof dB){c=c[0]}while(e&&e.nodeType!==9){if(c!==undefined){if(e===c){break}if(typeof c==='string'&&dB(e).is(c)){break}}if(e.nodeType===1){d.push(e)}e=e[b]}return d};var dJ=function(a,b,c,d){var e=[];if(d instanceof dB){d=d[0]}for(;a;a=a[b]){if(c&&a.nodeType!==c){continue}if(d!==undefined){if(a===d){break}if(typeof d==='string'&&dB(a).is(d)){break}}e.push(a)}return e};var dK=function(a,b,c){for(a=a[b];a;a=a[b]){if(a.nodeType===c){return a}}return null};dF({parent:function(a){var b=a.parentNode;return b&&b.nodeType!==11?b:null},parents:function(a){return dI(a,'parentNode')},next:function(a){return dK(a,'nextSibling',1)},prev:function(a){return dK(a,'previousSibling',1)},children:function(a){return dJ(a.firstChild,'nextSibling',1)},contents:function(a){return dj.toArray((a.nodeName==='iframe'?a.contentDocument||a.contentWindow.document:a).childNodes)}},function(e,f){dB.fn[e]=function(b){var c=this;var d=[];c.each(function(){var a=f.call(d,this,b,d);if(a){if(dB.isArray(a)){d.push.apply(d,a)}else{d.push(a)}}});if(this.length>1){if(!dn[e]){d=dB.unique(d)}if(e.indexOf('parents')===0){d=d.reverse()}}d=dB(d);if(b){return d.filter(b)}return d}});dF({parentsUntil:function(a,b){return dI(a,'parentNode',b)},nextUntil:function(a,b){return dJ(a,'nextSibling',1,b).slice(1)},prevUntil:function(a,b){return dJ(a,'previousSibling',1,b).slice(1)}},function(f,g){dB.fn[f]=function(b,c){var d=this;var e=[];d.each(function(){var a=g.call(e,this,b,e);if(a){if(dB.isArray(a)){e.push.apply(e,a)}else{e.push(a)}}});if(this.length>1){e=dB.unique(e);if(f.indexOf('parents')===0||f==='prevUntil'){e=e.reverse()}}e=dB(e);if(c){return e.filter(c)}return e}});dB.fn.is=function(a){return!!a&&this.filter(a).length>0};dB.fn.init.prototype=dB.fn;dB.overrideDefaults=function(c){var d;var e=function(a,b){d=d||c();if(arguments.length===0){a=d.element}if(!b){b=d.context}return new e.fn.init(a,b)};dB.extend(e,this);return e};var dL=function(c,d,e){dF(e,function(a,b){c[a]=c[a]||{};c[a][d]=b})};if(co.ie&&co.ie<8){dL(dA,'get',{maxlength:function(a){var b=a.maxLength;if(b===2147483647){return undefined}return b},size:function(a){var b=a.size;if(b===20){return undefined}return b},class:function(a){return a.className},style:function(a){var b=a.style.cssText;if(b.length===0){return undefined}return b}});dL(dA,'set',{class:function(a,b){a.className=b},style:function(a,b){a.style.cssText=b}})}if(co.ie&&co.ie<9){dz.float='styleFloat';dL(cssHooks,'set',{opacity:function(a,b){var c=a.style;if(b===null||b===''){c.removeAttribute('filter')}else{c.zoom=1;c.filter='alpha(opacity='+b*100+')'}}})}dB.attrHooks=dA;dB.cssHooks=cssHooks;var dM=function(f){var c=false;var r;return function(){var a=[];for(var b=0;b<arguments.length;b++){a[b]=arguments[b]}if(!c){c=true;r=f.apply(null,a)}return r}};var dN=function(a,s){for(var i=0;i<a.length;i++){var x=a[i];if(x.test(s))return x}return undefined};var dO=function(a,b){var r=dN(a,b);if(!r)return{major:0,minor:0};var c=function(i){return Number(b.replace(r,';+i))};return dR(c(1),c(2))};var dP=function(a,b){var c=String(b).toLowerCase();if(a.length===0)return dQ();return dO(a,c)};var dQ=function(){return dR(0,0)};var dR=function(a,b){return{major:a,minor:b}};var dS={nu:dR,detect:dP,unknown:dQ};var dT='Edge';var dU='Chrome';var dV='IE';var dW='Opera';var dX='Firefox';var dY='Safari';var dZ=function(a,b){return function(){return b===a}};var ea=function(){return eb({current:undefined,version:dS.unknown()})};var eb=function(a){var b=a.current;var c=a.version;return{current:b,version:c,isEdge:dZ(dT,b),isChrome:dZ(dU,b),isIE:dZ(dV,b),isOpera:dZ(dW,b),isFirefox:dZ(dX,b),isSafari:dZ(dY,b)}};var ec={unknown:ea,nu:eb,edge:bc(dT),chrome:bc(dU),ie:bc(dV),opera:bc(dW),firefox:bc(dX),safari:bc(dY)};var ed='Windows';var ee='iOS';var ef='Android';var eg='Linux';var eh='OSX';var ei='Solaris';var ej='FreeBSD';var ek=function(a,b){return function(){return b===a}};var em=function(){return en({current:undefined,version:dS.unknown()})};var en=function(a){var b=a.current;var c=a.version;return{current:b,version:c,isWindows:ek(ed,b),isiOS:ek(ee,b),isAndroid:ek(ef,b),isOSX:ek(eh,b),isLinux:ek(eg,b),isSolaris:ek(ei,b),isFreeBSD:ek(ej,b)}};var ep={unknown:em,nu:en,windows:bc(ed),ios:bc(ee),android:bc(ef),linux:bc(eg),osx:bc(eh),solaris:bc(ei),freebsd:bc(ej)};var eq=function(a,b,c){var d=a.isiOS()&&/ipad/i.test(c)===true;var e=a.isiOS()&&!d;var f=a.isAndroid()&&a.version.major===3;var g=a.isAndroid()&&a.version.major===4;var h=d||f||g&&/mobile/i.test(c)===true;var i=a.isiOS()||a.isAndroid();var j=i&&!h;var k=b.isSafari()&&a.isiOS()&&/safari/i.test(c)===false;return{isiPad:bc(d),isiPhone:bc(e),isTablet:bc(h),isPhone:bc(j),isTouch:bc(i),isAndroid:a.isAndroid,isiOS:a.isiOS,isWebView:bc(k)}};var er=function(b,c){var d=String(c).toLowerCase();return bJ(b,function(a){return a.search(d)})};var es=function(c,d){return er(c,d).map(function(a){var b=dS.detect(a.versionRegexes,d);return{current:a.name,version:b}})};var et=function(c,d){return er(c,d).map(function(a){var b=dS.detect(a.versionRegexes,d);return{current:a.name,version:b}})};var eu={detectBrowser:es,detectOs:et};var ev=function(a,b){return a.indexOf(b)!==-1};var ew=function(a){return a.replace(/^\s+|\s+$/g,'')};var ez=function(a){return a.replace(/^\s+/g,'')};var eA=function(a){return a.replace(/\s+$/g,'')};var eB=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/;var eC=function(b){return function(a){return ev(a,b)}};var eD=[{name:'Edge',versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(a){var b=ev(a,'edge/')&&ev(a,'chrome')&&ev(a,'safari')&&ev(a,'applewebkit');return b}},{name:'Chrome',versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,eB],search:function(a){return ev(a,'chrome')&&!ev(a,'chromeframe')}},{name:'IE',versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(a){return ev(a,'msie')||ev(a,'trident')}},{name:'Opera',versionRegexes:[eB,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:eC('opera')},{name:'Firefox',versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:eC('firefox')},{name:'Safari',versionRegexes:[eB,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(a){return(ev(a,'safari')||ev(a,'mobile/'))&&ev(a,'applewebkit')}}];var eE=[{name:'Windows',search:eC('win'),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:'iOS',search:function(a){return ev(a,'iphone')||ev(a,'ipad')},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:'Android',search:eC('android'),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:'OSX',search:eC('os x'),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:'Linux',search:eC('linux'),versionRegexes:[]},{name:'Solaris',search:eC('sunos'),versionRegexes:[]},{name:'FreeBSD',search:eC('freebsd'),versionRegexes:[]}];var eF={browsers:bc(eD),oses:bc(eE)};var eG=function(a){var b=eF.browsers();var c=eF.oses();var d=eu.detectBrowser(b,a).fold(ec.unknown,ec.nu);var e=eu.detectOs(c,a).fold(ep.unknown,ep.nu);var f=eq(e,d,a);return{browser:d,os:e,deviceType:f}};var eH={detect:eG};var eI=dM(function(){var a=navigator.userAgent;return eH.detect(a)});var eJ={detect:eI};var eK=function(a,b){var c=b||document;var d=c.createElement('div');d.innerHTML=a;if(!d.hasChildNodes()||d.childNodes.length>1){console.error('HTML does not have a single root node',a);throw'HTML must have a single root node';}return eN(d.childNodes[0])};var eL=function(a,b){var c=b||document;var d=c.createElement(a);return eN(d)};var eM=function(a,b){var c=b||document;var d=c.createTextNode(a);return eN(d)};var eN=function(a){if(a===null||a===undefined)throw new Error('Node cannot be null or undefined');return{dom:bc(a)}};var eO=function(a,x,y){var b=a.dom();return bo.from(b.elementFromPoint(x,y)).map(eN)};var eP={fromHtml:eK,fromTag:eL,fromText:eM,fromDom:eN,fromPoint:eO};var eQ=Node.ATTRIBUTE_NODE;var eR=Node.CDATA_SECTION_NODE;var eS=Node.COMMENT_NODE;var eT=Node.DOCUMENT_NODE;var eU=Node.DOCUMENT_TYPE_NODE;var eV=Node.DOCUMENT_FRAGMENT_NODE;var eW=Node.ELEMENT_NODE;var eX=Node.TEXT_NODE;var eY=Node.PROCESSING_INSTRUCTION_NODE;var eZ=Node.ENTITY_REFERENCE_NODE;var fa=Node.ENTITY_NODE;var fb=Node.NOTATION_NODE;var fc=function(a){var r=a.dom().nodeName;return r.toLowerCase()};var fd=function(a){return a.dom().nodeType};var fe=function(t){return function(a){return fd(a)===t}};var ff=fe(eW);var fg=fe(eX);var fh=Object.keys;var fj=Object.hasOwnProperty;var fk=function(a,f){var b=fh(a);for(var k=0,len=b.length;k<len;k++){var i=b[k];var x=a[i];f(x,i,a)}};var fm=function(b,f){return fo(b,function(x,i,a){return{k:i,v:f(x,i,a)}})};var fo=function(b,f){var r={};fk(b,function(x,i){var a=f(x,i,b);r[a.k]=a.v});return r};var fp=function(b,c){var t={};var f={};fk(b,function(x,i){var a=c(x,i)?t:f;a[i]=x});return{t:t,f:f}};var fq=function(a,b){return fj.call(a,b)};var fr=function(a,b,c){if(br(c)||bv(c)||bx(c)){a.setAttribute(b,c+'')}else{console.error('Invalid call to Attr.set. Key ',b,':: Value ',c,':: Element ',a);throw new Error('Attribute value was not simple');}};var fs=function(a,b,c){fr(a.dom(),b,c)};var ft=function(a,b){var c=a.dom();fk(b,function(v,k){fr(c,k,v)})};var fu=function(a,b){var v=a.dom().getAttribute(b);return v===null?undefined:v};var fv=function(a,b){var c=a.dom();return c&&c.hasAttribute?c.hasAttribute(b):false};var fw=function(a,b){a.dom().removeAttribute(b)};var fx=function(a){var b=fg(a)?a.dom().parentNode:a.dom();return b!==undefined&&b!==null&&b.ownerDocument.body.contains(b)};var fy=function(a){return a.style!==undefined};var fz=function(a,b,c){if(!br(c)){console.error('Invalid call to CSS.set. Property ',b,':: Value ',c,':: Element ',a);throw new Error('CSS value must be a string: '+c);}if(fy(a))a.style.setProperty(b,c)};var fA=function(a,b){var c=a.dom();fk(b,function(v,k){fz(c,k,v)})};var fB=function(a,b){var c=a.dom();var d=window.getComputedStyle(c);var r=d.getPropertyValue(b);var v=r===''&&!fx(a)?fC(c,b):r;return v===null?undefined:v};var fC=function(a,b){return fy(a)?a.style.getPropertyValue(b):''};var fD=function(a,b){var c=a.dom();var d=fC(c,b);return bo.from(d).filter(function(r){return r.length>0})};var fE=function(){var e=[];for(var f=0;f<arguments.length;f++){e[f]=arguments[f]}return function(){var b=[];for(var c=0;c<arguments.length;c++){b[c]=arguments[c]}if(e.length!==b.length){throw new Error('Wrong number of arguments to struct. Expected "['+e.length+']", got '+b.length+' arguments');}var d={};bD(e,function(a,i){d[a]=bc(b[i])});return d}};var fF=function(a,f){var r=[];var b=function(e){r.push(e);return f(e)};var c=f(a);do{c=c.bind(b)}while(c.isSome());return r};var fG={toArray:fF};var fH=function(){var f=cd.getOrDie('Node');return f};var fI=function(a,b,c){return(a.compareDocumentPosition(b)&c)!==0};var fJ=function(a,b){return fI(a,b,fH().DOCUMENT_POSITION_PRECEDING)};var fK=function(a,b){return fI(a,b,fH().DOCUMENT_POSITION_CONTAINED_BY)};var fL={documentPositionPreceding:fJ,documentPositionContainedBy:fK};var fM=eW;var fN=eT;var fO=function(a,b){var c=a.dom();if(c.nodeType!==fM)return false;else if(c.matches!==undefined)return c.matches(b);else if(c.msMatchesSelector!==undefined)return c.msMatchesSelector(b);else if(c.webkitMatchesSelector!==undefined)return c.webkitMatchesSelector(b);else if(c.mozMatchesSelector!==undefined)return c.mozMatchesSelector(b);else throw new Error('Browser lacks native selectors');};var fP=function(a){return a.nodeType!==fM&&a.nodeType!==fN||a.childElementCount===0};var fQ=function(a,b){var c=b===undefined?document:b.dom();return fP(c)?[]:bC(c.querySelectorAll(a),eP.fromDom)};var fR=function(a,b){var c=b===undefined?document:b.dom();return fP(c)?bo.none():bo.from(c.querySelector(a)).map(eP.fromDom)};var fS=function(a,b){return a.dom()===b.dom()};var fT=function(a,b){var c=a.dom(),d2=b.dom();return c===d2?false:c.contains(d2)};var fU=function(a,b){return fL.documentPositionContainedBy(a.dom(),b.dom())};var fV=eJ.detect().browser;var fW=fV.isIE()?fU:fT;var fX=function(a){return eP.fromDom(a.dom().ownerDocument)};var fY=function(a){return eP.fromDom(a.dom().ownerDocument.documentElement)};var fZ=function(a){var b=a.dom();var c=b.ownerDocument.defaultView;return eP.fromDom(c)};var ga=function(a){var b=a.dom();return bo.from(b.parentNode).map(eP.fromDom)};var gb=function(a,b){var c=bw(b)?b:bc(false);var d=a.dom();var e=[];while(d.parentNode!==null&&d.parentNode!==undefined){var f=d.parentNode;var g=eP.fromDom(f);e.push(g);if(c(g)===true)break;else d=f}return e};var gc=function(a){var b=a.dom();return bo.from(b.previousSibling).map(eP.fromDom)};var gd=function(a){var b=a.dom();return bo.from(b.nextSibling).map(eP.fromDom)};var ge=function(a){return bR(fG.toArray(a,gc))};var gf=function(a){return fG.toArray(a,gd)};var gg=function(a){var b=a.dom();return bC(b.childNodes,eP.fromDom)};var gh=function(a,b){var c=a.dom().childNodes;return bo.from(c[b]).map(eP.fromDom)};var gi=function(a){return gh(a,0)};var gj=function(a){return gh(a,a.dom().childNodes.length-1)};var gk=function(a){return a.dom().childNodes.length};var gl=fE('element','offset');var gm=eJ.detect().browser;var gn=function(a){return bJ(a,ff)};var go=function(f){if(gm.isFirefox()&&fc(f)==='table'){return gn(gg(f)).filter(function(a){return fc(a)==='caption'}).bind(function(e){return gn(gf(e)).map(function(a){var b=a.dom().offsetTop;var c=e.dom().offsetTop;var d=e.dom().offsetHeight;return b<=c?-d:0})}).getOr(0)}else{return 0}};var gp=function(a,b,c){var x=0,y=0,offsetParent$1;var d=a.ownerDocument;var e;c=c?c:a;if(b){if(c===a&&b.getBoundingClientRect&&fB(eP.fromDom(a),'position')==='static'){e=b.getBoundingClientRect();x=e.left+(d.documentElement.scrollLeft||a.scrollLeft)-d.documentElement.clientLeft;y=e.top+(d.documentElement.scrollTop||a.scrollTop)-d.documentElement.clientTop;return{x:x,y:y}}offsetParent$1=b;while(offsetParent$1&&offsetParent$1!==c&&offsetParent$1.nodeType){x+=offsetParent$1.offsetLeft||0;y+=offsetParent$1.offsetTop||0;offsetParent$1=offsetParent$1.offsetParent}offsetParent$1=b.parentNode;while(offsetParent$1&&offsetParent$1!==c&&offsetParent$1.nodeType){x-=offsetParent$1.scrollLeft||0;y-=offsetParent$1.scrollTop||0;offsetParent$1=offsetParent$1.parentNode}y+=go(eP.fromDom(b))}return{x:x,y:y}};var gq={getPos:gp};var gr=function(c){var d=bo.none();var e=[];var g=function(f){return gr(function(b){h(function(a){b(f(a))})})};var h=function(a){if(j())l(a);else e.push(a)};var i=function(x){d=bo.some(x);k(e);e=[]};var j=function(){return d.isSome()};var k=function(a){bD(a,l)};var l=function(a){d.each(function(x){setTimeout(function(){a(x)},0)})};c(i);return{get:h,map:g,isReady:j}};var gs=function(a){return gr(function(b){b(a)})};var gt={nu:gr,pure:gs};var gu=function(f){return function(){var a=[];for(var b=0;b<arguments.length;b++){a[b]=arguments[b]}var c=this;setTimeout(function(){f.apply(c,a)},0)}};var gv=function(e){var f=function(a){e(gu(a))};var g=function(d){return gv(function(c){f(function(a){var b=d(a);c(b)})})};var h=function(c){return gv(function(b){f(function(a){c(a).get(b)})})};var i=function(c){return gv(function(b){f(function(a){c.get(b)})})};var j=function(){return gt.nu(f)};var k=function(){var b=null;return gv(function(a){if(b===null){b=j()}b.get(a)})};return{map:g,bind:h,anonBind:i,toLazy:j,toCached:k,get:f}};var gw=function(a){return gv(function(b){b(a)})};var gx={nu:gv,pure:gw};var gy=function(e,f){return f(function(b){var r=[];var c=0;var d=function(i){return function(a){r[i]=a;c++;if(c>=e.length){b(r)}}};if(e.length===0){b([])}else{bD(e,function(a,i){a.get(d(i))})}})};var gz=function(a){return gy(a,gx.nu)};var gA=function(o){var b=function(v){return o===v};var c=function(a){return gA(o)};var d=function(f){return gA(o)};var e=function(f){return gA(f(o))};var g=function(f){return gA(o)};var h=function(f){f(o)};var i=function(f){return f(o)};var j=function(_,a){return a(o)};var k=function(f){return f(o)};var l=function(f){return f(o)};var m=function(){return bo.some(o)};return{is:b,isValue:bh,isError:bg,getOr:bc(o),getOrThunk:bc(o),getOrDie:bc(o),or:c,orThunk:d,fold:j,map:e,mapError:g,each:h,bind:i,exists:k,forall:l,toOption:m}};var gB=function(b){var c=function(f){return f()};var d=function(){return bf(String(b))()};var e=function(a){return a};var g=function(f){return f()};var h=function(f){return gB(b)};var i=function(f){return gB(f(b))};var j=function(f){return gB(b)};var k=function(a,_){return a(b)};return{is:bg,isValue:bg,isError:bh,getOr:bd,getOrThunk:c,getOrDie:d,or:e,orThunk:g,fold:k,map:h,mapError:i,each:ba,bind:j,exists:bg,forall:bh,toOption:bo.none}};var gC={value:gA,error:gB};function StyleSheetLoader(n,o){if(o===void 0){o={}}var p=0;var q={};var s;s=o.maxLoadTime||5000;var t=function(a){n.getElementsByTagName('head')[0].appendChild(a)};var u=function(c,d,e){var f,style,startTime,state;var g=function(){var a=state.passed;var i=a.length;while(i--){a[i]()}state.status=2;state.passed=[];state.failed=[]};var h=function(){var a=state.failed;var i=a.length;while(i--){a[i]()}state.status=3;state.passed=[];state.failed=[]};var j=function(){var a=navigator.userAgent.match(/WebKit\/(\d*)/);return!!(a&&parseInt(a[1],10)<536)};var k=function(a,b){if(!a()){if(new Date().getTime()-startTime<s){cy.setTimeout(b)}else{h()}}};var l=function(){k(function(){var a=n.styleSheets;var b,i=a.length,fX;while(i--){b=a[i];fX=b.ownerNode?b.ownerNode:b.owningElement;if(fX&&fX.id===f.id){g();return true}}},l)};var m=function(){k(function(){try{var a=style.sheet.cssRules;g();return!!a}catch(ex){}},m)};c=dj._addCacheSuffix(c);if(!q[c]){state={passed:[],failed:[]};q[c]=state}else{state=q[c]}if(d){state.passed.push(d)}if(e){state.failed.push(e)}if(state.status===1){return}if(state.status===2){g();return}if(state.status===3){h();return}state.status=1;f=n.createElement('link');f.rel='stylesheet';f.type='text/css';f.id='u'+p++;f.async=false;f.defer=false;startTime=new Date().getTime();if(o.contentCssCors){f.crossOrigin='anonymous'}if('onload'in f&&!j()){f.onload=l;f.onerror=h}else{if(navigator.userAgent.indexOf('Firefox')>0){style=n.createElement('style');style.textContent='@import "'+c+'"';m();t(style);return}l()}t(f);f.href=c};var v=function(b){return gx.nu(function(a){u(b,bb(a,bc(gC.value(b))),bb(a,bc(gC.error(b))))})};var w=function(a){return a.fold(bd,bd)};var x=function(c,d,e){gz(bC(c,v)).get(function(a){var b=bF(a,function(r){return r.isValue()});if(b.fail.length>0){e(b.fail.map(w))}else{d(b.pass.map(w))}})};return{load:u,loadAll:x}}function TreeWalker(f,g){var h=f;var i=function(a,b,c,d){var e,ga;if(a){if(!d&&a[b]){return a[b]}if(a!==g){e=a[c];if(e){return e}for(ga=a.parentNode;ga&&ga!==g;ga=ga.parentNode){e=ga[c];if(e){return e}}}}};var j=function(a,b,c,d){var e,ga,gh;if(a){e=a[c];if(g&&e===g){return}if(e){if(!d){for(gh=e[b];gh;gh=gh[b]){if(!gh[b]){return gh}}}return e}ga=a.parentNode;if(ga&&ga!==g){return ga}}};this.current=function(){return h};this.next=function(a){h=i(h,'firstChild','nextSibling',a);return h};this.prev=function(a){h=i(h,'lastChild','previousSibling',a);return h};this.prev2=function(a){h=j(h,'lastChild','previousSibling',a);return h}}var gD=['article','aside','details','div','dt','figcaption','footer','form','fieldset','header','hgroup','html','main','nav','section','summary','body','p','dl','multicol','dd','figure','address','center','blockquote','h1','h2','h3','h4','h5','h6','listing','xmp','pre','plaintext','menu','dir','ul','ol','li','hr','table','tbody','thead','tfoot','th','tr','td','caption'];var gE=['area','base','basefont','br','col','frame','hr','img','input','isindex','link','meta','param','embed','source','wbr','track'];var gF=['td','th'];var gG=['thead','tbody','tfoot'];var gH=['h1','h2','h3','h4','h5','h6','p','div','address','pre','form','blockquote','center','dir','fieldset','header','footer','article','section','hgroup','aside','nav','figure'];var gI=['h1','h2','h3','h4','h5','h6'];var gJ=['li','dd','dt'];var gK=['ul','ol','dl'];var gL=['pre','script','textarea','style'];var gM=function(b){var c;return function(a){c=c?c:bT(b,bc(true));return c.hasOwnProperty(fc(a))}};var gN=gM(gI);var gO=gM(gD);var gP=function(a){return ff(a)&&!gO(a)};var gQ=function(a){return ff(a)&&fc(a)==='br'};var gR=gM(gH);var gS=gM(gK);var gT=gM(gJ);var gU=gM(gE);var gV=gM(gG);var gW=gM(gF);var gX=gM(gL);var gY=function(b){return function(a){return!!a&&a.nodeType===b}};var gZ=gY(1);var ha=function(b){var c=b.toLowerCase().split(' ');return function(a){var i,fc;if(a&&a.nodeType){fc=a.nodeName.toLowerCase();for(i=0;i<c.length;i++){if(fc===c[i]){return true}}}return false}};var hb=function(c,d){var e=d.toLowerCase().split(' ');return function(a){var i,cssValue;if(gZ(a)){for(i=0;i<e.length;i++){var b=a.ownerDocument.defaultView.getComputedStyle(a,null);cssValue=b?b.getPropertyValue(c):null;if(cssValue===e[i]){return true}}}return false}};var hc=function(b,c){return function(a){return gZ(a)&&a[b]===c}};var hd=function(b,c){return function(a){return gZ(a)&&a.hasAttribute(b)}};var he=function(b,c){return function(a){return gZ(a)&&a.getAttribute(b)===c}};var hf=function(a){return gZ(a)&&a.hasAttribute('data-mce-bogus')};var hg=function(a){return gZ(a)&&a.getAttribute('data-mce-bogus')==='all'};var hh=function(a){return gZ(a)&&a.tagName==='TABLE'};var hj=function(b){return function(a){if(gZ(a)){if(a.contentEditable===b){return true}if(a.getAttribute('data-mce-contenteditable')===b){return true}}return false}};var hk=gY(3);var hl=gY(8);var hm=gY(9);var hn=ha('br');var ho=hj('true');var hp=hj('false');var hq={isText:hk,isElement:gZ,isComment:hl,isDocument:hm,isBr:hn,isContentEditableTrue:ho,isContentEditableFalse:hp,matchNodeNames:ha,hasPropValue:hc,hasAttribute:hd,hasAttributeValue:he,matchStyleValues:hb,isBogus:hf,isBogusAll:hg,isTable:hh};var hr=function(a){var b=a.previousSibling&&a.previousSibling.nodeName==='SPAN';var c=a.nextSibling&&a.nextSibling.nodeName==='SPAN';return b&&c};var hs=function(a){return a&&a.tagName==='SPAN'&&a.getAttribute('data-mce-type')==='bookmark'};var ht=function(a,b){var i,gg=b.childNodes;if(hq.isElement(b)&&hs(b)){return}for(i=gg.length-1;i>=0;i--){ht(a,gg[i])}if(hq.isDocument(b)===false){if(hq.isText(b)&&b.nodeValue.length>0){var c=dj.trim(b.nodeValue).length;if(a.isBlock(b.parentNode)||c>0){return}if(c===0&&hr(b)){return}}else if(hq.isElement(b)){gg=b.childNodes;if(gg.length===1&&hs(gg[0])){b.parentNode.insertBefore(gg[0],b)}if(gg.length||gU(eP.fromDom(b))){return}}a.remove(b)}return b};var hu={trimNode:ht};var hv=dj.makeMap;var hw,baseEntities,reverseEntities;var hx=/[&<>\"\u0060\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g;var hy=/[<>&\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g;var hz=/[<>&\"\']/g;var hA=/&#([a-z0-9]+);?|&([a-z0-9]+);/gi;var hB={128:'\u20AC',130:'\u201A',131:'\u0192',132:'\u201E',133:'\u2026',134:'\u2020',135:'\u2021',136:'\u02c6',137:'\u2030',138:'\u0160',139:'\u2039',140:'\u0152',142:'\u017d',145:'\u2018',146:'\u2019',147:'\u201C',148:'\u201D',149:'\u2022',150:'\u2013',151:'\u2014',152:'\u02DC',153:'\u2122',154:'\u0161',155:'\u203A',156:'\u0153',158:'\u017e',159:'\u0178'};baseEntities={'"':'&quot;','\'':'&#39;','<':'&lt;','>':'&gt;','&':'&amp;','`':'&#96;'};reverseEntities={'&lt;':'<','&gt;':'>','&amp;':'&','&quot;':'"','&apos;':'\''};var hC=function(a){var b;b=eP.fromTag('div').dom();b.innerHTML=a;return b.textContent||b.innerText||a};var hD=function(a,b){var i,chr,entity;var c={};if(a){a=a.split(',');b=b||10;for(i=0;i<a.length;i+=2){chr=String.fromCharCode(parseInt(a[i],b));if(!baseEntities[chr]){entity='&'+a[i+1]+';';c[chr]=entity;c[entity]=chr}}return c}};hw=hD('50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,'+'5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,'+'5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,'+'5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,'+'68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,'+'6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,'+'6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,'+'75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,'+'7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,'+'7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,'+'sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,'+'st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,'+'t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,'+'tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,'+'u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,'+'81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,'+'8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,'+'8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,'+'8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,'+'8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,'+'nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,'+'rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,'+'Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,'+'80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,'+'811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro',32);var hE=function(b,c){return b.replace(c?hx:hy,function(a){return baseEntities[a]||a})};var hF=function(b){return(''+b).replace(hz,function(a){return baseEntities[a]||a})};var hG=function(b,c){return b.replace(c?hx:hy,function(a){if(a.length>1){return'&#'+((a.charCodeAt(0)-55296)*1024+(a.charCodeAt(1)-56320)+65536)+';'}return baseEntities[a]||'&#'+a.charCodeAt(0)+';'})};var hH=function(b,c,d){d=d||hw;return b.replace(c?hx:hy,function(a){return baseEntities[a]||d[a]||a})};var hI=function(d,e){var f=hD(e)||hw;var g=function(b,c){return b.replace(c?hx:hy,function(a){if(baseEntities[a]!==undefined){return baseEntities[a]}if(f[a]!==undefined){return f[a]}if(a.length>1){return'&#'+((a.charCodeAt(0)-55296)*1024+(a.charCodeAt(1)-56320)+65536)+';'}return'&#'+a.charCodeAt(0)+';'})};var h=function(a,b){return hH(a,b,f)};var i=hv(d.replace(/\+/g,','));if(i.named&&i.numeric){return g}if(i.named){if(e){return h}return hH}if(i.numeric){return hG}return hE};var hJ=function(c){return c.replace(hA,function(a,b){if(b){if(b.charAt(0).toLowerCase()==='x'){b=parseInt(b.substr(1),16)}else{b=parseInt(b,10)}if(b>65535){b-=65536;return String.fromCharCode(55296+(b>>10),56320+(b&1023))}return hB[b]||String.fromCharCode(b)}return reverseEntities[a]||hw[a]||hC(a)})};var hK={encodeRaw:hE,encodeAllRaw:hF,encodeNumeric:hG,encodeNamed:hH,getEncodeFunc:hI,decode:hJ};var hL={},dummyObj={};var hM=dj.makeMap,each$4=dj.each,extend$1=dj.extend,explode$1=dj.explode,inArray$1=dj.inArray;var hN=function(a,b){a=dj.trim(a);return a?a.split(b||' '):[]};var hO=function(j){var k={};var m,blockContent;var n,flowContent,html4BlockContent,html4PhrasingContent;var o=function(d,e,f){var g,attributesOrder,element;var h=function(a,b){var c={};var i,l;for(i=0,l=a.length;i<l;i++){c[a[i]]=b||{}}return c};f=f||[];e=e||'';if(typeof f==='string'){f=hN(f)}d=hN(d);g=d.length;while(g--){attributesOrder=hN([m,e].join(' '));element={attributes:h(attributesOrder),attributesOrder:attributesOrder,children:h(f,dummyObj)};k[d[g]]=element}};var p=function(a,b){var c,schemaItem,i,l;a=hN(a);c=a.length;b=hN(b);while(c--){schemaItem=k[a[c]];for(i=0,l=b.length;i<l;i++){schemaItem.attributes[b[i]]={};schemaItem.attributesOrder.push(b[i])}}};if(hL[j]){return hL[j]}m='id accesskey class dir lang style tabindex title role';blockContent='address blockquote div dl fieldset form h1 h2 h3 h4 h5 h6 hr menu ol p pre table ul';n='a abbr b bdo br button cite code del dfn em embed i iframe img input ins kbd '+'label map noscript object q s samp script select small span strong sub sup '+'textarea u var #text #comment';if(j!=='html4'){m+=' contenteditable contextmenu draggable dropzone '+'hidden spellcheck translate';blockContent+=' article aside details dialog figure main header footer hgroup section nav';n+=' audio canvas command datalist mark meter output picture '+'progress time wbr video ruby bdi keygen'}if(j!=='html5-strict'){m+=' xml:lang';html4PhrasingContent='acronym applet basefont big font strike tt';n=[n,html4PhrasingContent].join(' ');each$4(hN(html4PhrasingContent),function(a){o(a,'',n)});html4BlockContent='center dir isindex noframes';blockContent=[blockContent,html4BlockContent].join(' ');flowContent=[blockContent,n].join(' ');each$4(hN(html4BlockContent),function(a){o(a,'',flowContent)})}flowContent=flowContent||[blockContent,n].join(' ');o('html','manifest','head body');o('head','','base command link meta noscript script style title');o('title hr noscript br');o('base','href target');o('link','href rel media hreflang type sizes hreflang');o('meta','name http-equiv content charset');o('style','media type scoped');o('script','src async defer type charset');o('body','onafterprint onbeforeprint onbeforeunload onblur onerror onfocus '+'onhashchange onload onmessage onoffline ononline onpagehide onpageshow '+'onpopstate onresize onscroll onstorage onunload',flowContent);o('address dt dd div caption','',flowContent);o('h1 h2 h3 h4 h5 h6 pre p abbr code var samp kbd sub sup i b u bdo span legend em strong small s cite dfn','',n);o('blockquote','cite',flowContent);o('ol','reversed start type','li');o('ul','','li');o('li','value',flowContent);o('dl','','dt dd');o('a','href target rel media hreflang type',n);o('q','cite',n);o('ins del','cite datetime',flowContent);o('img','src sizes srcset alt usemap ismap width height');o('iframe','src name width height',flowContent);o('embed','src type width height');o('object','data type typemustmatch name usemap form width height',[flowContent,'param'].join(' '));o('param','name value');o('map','name',[flowContent,'area'].join(' '));o('area','alt coords shape href target rel media hreflang type');o('table','border','caption colgroup thead tfoot tbody tr'+(j==='html4'?' col':''));o('colgroup','span','col');o('col','span');o('tbody thead tfoot','','tr');o('tr','','td th');o('td','colspan rowspan headers',flowContent);o('th','colspan rowspan headers scope abbr',flowContent);o('form','accept-charset action autocomplete enctype method name novalidate target',flowContent);o('fieldset','disabled form name',[flowContent,'legend'].join(' '));o('label','form for',n);o('input','accept alt autocomplete checked dirname disabled form formaction formenctype formmethod formnovalidate '+'formtarget height list max maxlength min multiple name pattern readonly required size src step type value width');o('button','disabled form formaction formenctype formmethod formnovalidate formtarget name type value',j==='html4'?flowContent:n);o('select','disabled form multiple name required size','option optgroup');o('optgroup','disabled label','option');o('option','disabled label selected value');o('textarea','cols dirname disabled form maxlength name readonly required rows wrap');o('menu','type label',[flowContent,'li'].join(' '));o('noscript','',flowContent);if(j!=='html4'){o('wbr');o('ruby','',[n,'rt rp'].join(' '));o('figcaption','',flowContent);o('mark rt rp summary bdi','',n);o('canvas','width height',flowContent);o('video','src crossorigin poster preload autoplay mediagroup loop '+'muted controls width height buffered',[flowContent,'track source'].join(' '));o('audio','src crossorigin preload autoplay mediagroup loop muted controls '+'buffered volume',[flowContent,'track source'].join(' '));o('picture','','img source');o('source','src srcset type media sizes');o('track','kind src srclang label default');o('datalist','',[n,'option'].join(' '));o('article section nav aside main header footer','',flowContent);o('hgroup','','h1 h2 h3 h4 h5 h6');o('figure','',[flowContent,'figcaption'].join(' '));o('time','datetime',n);o('dialog','open',flowContent);o('command','type label icon disabled checked radiogroup command');o('output','for form name',n);o('progress','value max',n);o('meter','value min max low high optimum',n);o('details','open',[flowContent,'summary'].join(' '));o('keygen','autofocus challenge disabled form keytype name')}if(j!=='html5-strict'){p('script','language xml:space');p('style','xml:space');p('object','declare classid code codebase codetype archive standby align border hspace vspace');p('embed','align name hspace vspace');p('param','valuetype type');p('a','charset name rev shape coords');p('br','clear');p('applet','codebase archive code object alt name width height align hspace vspace');p('img','name longdesc align border hspace vspace');p('iframe','longdesc frameborder marginwidth marginheight scrolling align');p('font basefont','size color face');p('input','usemap align');p('select','onchange');p('textarea');p('h1 h2 h3 h4 h5 h6 div p legend caption','align');p('ul','type compact');p('li','type');p('ol dl menu dir','compact');p('pre','width xml:space');p('hr','align noshade size width');p('isindex','prompt');p('table','summary width frame rules cellspacing cellpadding align bgcolor');p('col','width align char charoff valign');p('colgroup','width align char charoff valign');p('thead','align char charoff valign');p('tr','align char charoff valign bgcolor');p('th','axis align char charoff valign nowrap bgcolor width height');p('form','accept');p('td','abbr axis scope align char charoff valign nowrap bgcolor width height');p('tfoot','align char charoff valign');p('tbody','align char charoff valign');p('area','nohref');p('body','background bgcolor text link vlink alink')}if(j!=='html4'){p('input button select textarea','autofocus');p('input textarea','placeholder');p('a','download');p('link script img','crossorigin');p('iframe','sandbox seamless allowfullscreen')}each$4(hN('a form meter progress dfn'),function(a){if(k[a]){delete k[a].children[a]}});delete k.caption.children.table;delete k.script;hL[j]=k;return k};var hP=function(c,d){var e;if(c){e={};if(typeof c==='string'){c={'*':c}}each$4(c,function(a,b){e[b]=e[b.toUpperCase()]=d==='map'?hM(a,/[, ]/):explode$1(a,/[, ]/)})}return e};function Schema(h){var j={};var k={};var l=[];var m;var n;var o;var p,selfClosingElementsMap,shortEndedElementsMap,boolAttrMap,validClasses;var q,nonEmptyElementsMap,moveCaretBeforeOnEnterElementsMap,textBlockElementsMap,textInlineElementsMap;var r={},specialElements={};var s=function(a,b,c){var d=h[a];if(!d){d=hL[a];if(!d){d=hM(b,' ',hM(b.toUpperCase(),' '));d=extend$1(d,c);hL[a]=d}}else{d=hM(d,/[, ]/,hM(d.toUpperCase(),/[, ]/))}return d};h=h||{};o=hO(h.schema);if(h.verify_html===false){h.valid_elements='*[*]'}m=hP(h.valid_styles);n=hP(h.invalid_styles,'map');validClasses=hP(h.valid_classes,'map');p=s('whitespace_elements','pre script noscript style textarea video audio iframe object code');selfClosingElementsMap=s('self_closing_elements','colgroup dd dt li option p td tfoot th thead tr');shortEndedElementsMap=s('short_ended_elements','area base basefont br col frame hr img input isindex link '+'meta param embed source wbr track');boolAttrMap=s('boolean_attributes','checked compact declare defer disabled ismap multiple nohref noresize '+'noshade nowrap readonly selected autoplay loop controls');nonEmptyElementsMap=s('non_empty_elements','td th iframe video audio object '+'script pre code',shortEndedElementsMap);moveCaretBeforeOnEnterElementsMap=s('move_caret_before_on_enter_elements','table',nonEmptyElementsMap);textBlockElementsMap=s('text_block_elements','h1 h2 h3 h4 h5 h6 p div address pre form '+'blockquote center dir fieldset header footer article section hgroup aside main nav figure');q=s('block_elements','hr table tbody thead tfoot '+'th tr td li ol ul caption dl dt dd noscript menu isindex option '+'datalist select optgroup figcaption details summary',textBlockElementsMap);textInlineElementsMap=s('text_inline_elements','span strong b em i font strike u var cite '+'dfn code mark q sup sub samp');each$4((h.special||'script noscript noframes noembed title style textarea xmp').split(' '),function(a){specialElements[a]=new RegExp('</'+a+'[^>]*>','gi')});var t=function(a){return new RegExp('^'+a.replace(/([?+*])/g,'.$1')+';)};var u=function(a){var b,el,ai,al,matches,element,attr,attrData,elementName,attrName,attrType,attributes,attributesOrder,prefix,outputName,globalAttributes,globalAttributesOrder,key,value;var c=/^([#+\-])?([^\[!\/]+)(?:\/([^\[!]+))?(?:(!?)\[([^\]]+)\])?$/,attrRuleRegExp=/^([!\-])?(\w+[\\:]:\w+|[^=:<]+)?(?:([=:<])(.*))?$/,hasPatternsRegExp=/[*?+]/;if(a){a=hN(a,',');if(j['@']){globalAttributes=j['@'].attributes;globalAttributesOrder=j['@'].attributesOrder}for(b=0,el=a.length;b<el;b++){matches=c.exec(a[b]);if(matches){prefix=matches[1];elementName=matches[2];outputName=matches[3];attrData=matches[5];attributes={};attributesOrder=[];element={attributes:attributes,attributesOrder:attributesOrder};if(prefix==='#'){element.paddEmpty=true}if(prefix==='-'){element.removeEmpty=true}if(matches[4]==='!'){element.removeEmptyAttrs=true}if(globalAttributes){for(key in globalAttributes){attributes[key]=globalAttributes[key]}attributesOrder.push.apply(attributesOrder,globalAttributesOrder)}if(attrData){attrData=hN(attrData,'|');for(ai=0,al=attrData.length;ai<al;ai++){matches=attrRuleRegExp.exec(attrData[ai]);if(matches){attr={};attrType=matches[1];attrName=matches[2].replace(/[\\:]:/g,':');prefix=matches[3];value=matches[4];if(attrType==='!'){element.attributesRequired=element.attributesRequired||[];element.attributesRequired.push(attrName);attr.required=true}if(attrType==='-'){delete attributes[attrName];attributesOrder.splice(inArray$1(attributesOrder,attrName),1);continue}if(prefix){if(prefix==='='){element.attributesDefault=element.attributesDefault||[];element.attributesDefault.push({name:attrName,value:value});attr.defaultValue=value}if(prefix===':'){element.attributesForced=element.attributesForced||[];element.attributesForced.push({name:attrName,value:value});attr.forcedValue=value}if(prefix==='<'){attr.validValues=hM(value,'?')}}if(hasPatternsRegExp.test(attrName)){element.attributePatterns=element.attributePatterns||[];attr.pattern=t(attrName);element.attributePatterns.push(attr)}else{if(!attributes[attrName]){attributesOrder.push(attrName)}attributes[attrName]=attr}}}}if(!globalAttributes&&elementName==='@'){globalAttributes=attributes;globalAttributesOrder=attributesOrder}if(outputName){element.outputName=elementName;j[outputName]=element}if(hasPatternsRegExp.test(elementName)){element.pattern=t(elementName);l.push(element)}else{j[elementName]=element}}}}};var v=function(c){j={};l=[];u(c);each$4(o,function(a,b){k[b]=a.children})};var w=function(f){var g=/^(~)?(.+)$/;if(f){hL.text_block_elements=hL.block_elements=null;each$4(hN(f,','),function(c){var d=g.exec(c),inline=d[1]==='~',cloneName=inline?'span':'div',fc=d[2];k[fc]=k[cloneName];r[fc]=cloneName;if(!inline){q[fc.toUpperCase()]={};q[fc]={}}if(!j[fc]){var e=j[cloneName];e=extend$1({},e);delete e.removeEmptyAttrs;delete e.removeEmpty;j[fc]=e}each$4(k,function(a,b){if(a[cloneName]){k[b]=a=extend$1({},k[b]);a[fc]=a[cloneName]}})})}};var x=function(e){var f=/^([+\-]?)(\w+)\[([^\]]+)\]$/;hL[h.schema]=null;if(e){each$4(hN(e,','),function(b){var c=f.exec(b);var d,prefix;if(c){prefix=c[1];if(prefix){d=k[c[2]]}else{d=k[c[2]]={'#comment':{}}}d=k[c[2]];each$4(hN(c[3],'|'),function(a){if(prefix==='-'){delete d[a]}else{d[a]={}}})}})}};var y=function(a){var b=j[a],i;if(b){return b}i=l.length;while(i--){b=l[i];if(b.pattern.test(a)){return b}}};if(!h.valid_elements){each$4(o,function(a,b){j[b]={attributes:a.attributes,attributesOrder:a.attributesOrder};k[b]=a.children});if(h.schema!=='html5'){each$4(hN('strong/b em/i'),function(a){a=hN(a,'/');j[a[1]].outputName=a[0]})}each$4(hN('ol ul sub sup blockquote span font a table tbody tr strong em b i'),function(a){if(j[a]){j[a].removeEmpty=true}});each$4(hN('p h1 h2 h3 h4 h5 h6 th td pre div address caption li'),function(a){j[a].paddEmpty=true});each$4(hN('span'),function(a){j[a].removeEmptyAttrs=true})}else{v(h.valid_elements)}w(h.custom_elements);x(h.valid_children);u(h.extended_valid_elements);x('+ol[ul|ol],+ul[ul|ol]');each$4({dd:'dl',dt:'dl',li:'ul ol',td:'tr',th:'tr',tr:'tbody thead tfoot',tbody:'table',thead:'table',tfoot:'table',legend:'fieldset',area:'map',param:'video audio object'},function(a,b){if(j[b]){j[b].parentsRequired=hN(a)}});if(h.invalid_elements){each$4(explode$1(h.invalid_elements),function(a){if(j[a]){delete j[a]}})}if(!y('span')){u('span[!data-mce-type|*]')}var z=function(){return m};var A=function(){return n};var B=function(){return validClasses};var C=function(){return boolAttrMap};var D=function(){return q};var E=function(){return textBlockElementsMap};var F=function(){return textInlineElementsMap};var G=function(){return shortEndedElementsMap};var H=function(){return selfClosingElementsMap};var I=function(){return nonEmptyElementsMap};var J=function(){return moveCaretBeforeOnEnterElementsMap};var K=function(){return p};var L=function(){return specialElements};var M=function(a,b){var c=k[a.toLowerCase()];return!!(c&&c[b.toLowerCase()])};var N=function(a,b){var c,i;var d=y(a);if(d){if(b){if(d.attributes[b]){return true}c=d.attributePatterns;if(c){i=c.length;while(i--){if(c[i].pattern.test(a)){return true}}}}else{return true}}return false};var O=function(){return r};return{children:k,elements:j,getValidStyles:z,getValidClasses:B,getBlockElements:D,getInvalidStyles:A,getShortEndedElements:G,getTextBlockElements:E,getTextInlineElements:F,getBoolAttrs:C,getElementRule:y,getSelfClosingElements:H,getNonEmptyElements:I,getMoveCaretBeforeOnEnterElements:J,getWhiteSpaceElements:K,getSpecialElements:L,isValidChild:M,isValid:N,getCustomElements:O,addValidElements:u,setValidElements:v,addCustomElements:w,addValidChildren:x}}var hQ=function(c,r,g,b){var d=function(a){a=parseInt(a,10).toString(16);return a.length>1?a:'0'+a};return'#'+d(r)+d(g)+d(b)};function Styles(v,w){var x=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/gi;var y=/(?:url(?:(?:\(\s*\"([^\"]+)\"\s*\))|(?:\(\s*\'([^\']+)\'\s*\))|(?:\(\s*([^)\s]+)\s*\))))|(?:\'([^\']+)\')|(?:\"([^\"]+)\")/gi;var z=/\s*([^:]+):\s*([^;]+);?/g;var A=/\s+$/;var i;var B={};var C;var D;var E;var F='\uFEFF';v=v||{};if(w){D=w.getValidStyles();E=w.getInvalidStyles()}C=('\\" \\\' \\; \\: ; : '+F).split(' ');for(i=0;i<C.length;i++){B[C[i]]=F+i;B[F+i]=C[i]}return{toHex:function(a){return a.replace(x,hQ)},parse:function(h){var j={};var k,fc,value,isEncoded;var l=v.url_converter;var m=v.url_converter_scope||this;var n=function(a,b,c){var d,right,bottom,left;d=j[a+'-top'+b];if(!d){return}right=j[a+'-right'+b];if(!right){return}bottom=j[a+'-bottom'+b];if(!bottom){return}left=j[a+'-left'+b];if(!left){return}var e=[d,right,bottom,left];i=e.length-1;while(i--){if(e[i]!==e[i+1]){break}}if(i>-1&&c){return}j[a+b]=i===-1?e[0]:e.join(' ');delete j[a+'-top'+b];delete j[a+'-right'+b];delete j[a+'-bottom'+b];delete j[a+'-left'+b]};var o=function(a){var b=j[a],i;if(!b){return}b=b.split(' ');i=b.length;while(i--){if(b[i]!==b[0]){return false}}j[a]=b[0];return true};var p=function(d,a,b,c){if(!o(a)){return}if(!o(b)){return}if(!o(c)){return}j[d]=j[a]+' '+j[b]+' '+j[c];delete j[a];delete j[b];delete j[c]};var q=function(a){isEncoded=true;return B[a]};var r=function(b,c){if(isEncoded){b=b.replace(/\uFEFF[0-9]/g,function(a){return B[a]})}if(!c){b=b.replace(/\\([\'\";:])/g,'$1')}return b};var s=function(a){return String.fromCharCode(parseInt(a.slice(1),16))};var t=function(a){return a.replace(/\\[0-9a-f]+/gi,s)};var u=function(a,b,c,d,e,f){e=e||f;if(e){e=r(e);return'\''+e.replace(/\'/g,'\\\'')+'\''}b=r(b||c||d);if(!v.allow_script_urls){var g=b.replace(/[\s\r\n]+/g,'');if(/(java|vb)script:/i.test(g)){return''}if(!v.allow_svg_data_urls&&/^data:image\/svg/i.test(g)){return''}}if(l){b=l.call(m,b,'style')}return'url(\''+b.replace(/\'/g,'\\\'')+'\')'};if(h){h=h.replace(/[\u0000-\u001F]/g,'');h=h.replace(/\\[\"\';:\uFEFF]/g,q).replace(/\"[^\"]+\"|\'[^\']+\'/g,function(a){return a.replace(/[;:]/g,q)});while(k=z.exec(h)){z.lastIndex=k.index+k[0].length;fc=k[1].replace(A,'').toLowerCase();value=k[2].replace(A,'');if(fc&&value){fc=t(fc);value=t(value);if(fc.indexOf(F)!==-1||fc.indexOf('"')!==-1){continue}if(!v.allow_script_urls&&(fc==='behavior'||/expression\s*\(|\/\*|\*\//.test(value))){continue}if(fc==='font-weight'&&value==='700'){value='bold'}else if(fc==='color'||fc==='background-color'){value=value.toLowerCase()}value=value.replace(x,hQ);value=value.replace(y,u);j[fc]=isEncoded?r(value,true):value}}n('border','',true);n('border','-width');n('border','-color');n('border','-style');n('padding','');n('margin','');p('border','border-width','border-style','border-color');if(j.border==='medium none'){delete j.border}if(j['border-image']==='none'){delete j['border-image']}}return j},serialize:function(d,e){var f='',fc,value;var g=function(a){var b,i,l,value;b=D[a];if(b){for(i=0,l=b.length;i<l;i++){a=b[i];value=d[a];if(value){f+=(f.length>0?' ':'')+a+': '+value+';'}}}};var h=function(a,b){var c;c=E['*'];if(c&&c[a]){return false}c=E[b];if(c&&c[a]){return false}return true};if(e&&D){g('*');g(e)}else{for(fc in d){value=d[fc];if(value&&(!E||h(fc,e))){f+=(f.length>0?' ':'')+fc+': '+value+';'}}}return f}}}var hR=dj.each;var hS=dj.grep;var hT=co.ie;var hU=/^([a-z0-9],?)+$/i;var hV=/^[ \t\r\n]*$/;var hW=function(d,e,f){var g={};var h=e.keep_values;var i={set:function(a,b,c){if(e.url_converter){b=e.url_converter.call(e.url_converter_scope||f(),b,c,a[0])}a.attr('data-mce-'+c,b).attr(c,b)},get:function(a,b){return a.attr('data-mce-'+b)||a.attr(b)}};g={style:{set:function(a,b){if(b!==null&&typeof b==='object'){a.css(b);return}if(h){a.attr('data-mce-style',b)}a.attr('style',b)},get:function(a){var b=a.attr('data-mce-style')||a.attr('style');b=d.serialize(d.parse(b),a[0].nodeName);return b}}};if(h){g.href=g.src=i}return g};var hX=function(a,b){var c=b.attr('style');var d=a.serialize(a.parse(c),b[0].nodeName);if(!d){d=null}b.attr('data-mce-style',d)};var hY=function(a,b){var c=0,lastNodeType,nodeType;if(a){for(lastNodeType=a.nodeType,a=a.previousSibling;a;a=a.previousSibling){nodeType=a.nodeType;if(b&&nodeType===3){if(nodeType===lastNodeType||!a.nodeValue.length){continue}}c++;lastNodeType=nodeType}}return c};function DOMUtils(j,k){var l=this;if(k===void 0){k={}}var m;var n={};var o=window;var p={};var q=0;var s=true;var t=true;var u=StyleSheetLoader(j,{contentCssCors:k.contentCssCors});var v=[];var x=k.schema?k.schema:Schema({});var y=Styles({url_converter:k.url_converter,url_converter_scope:k.url_converter_scope},k.schema);var z=k.ownEvents?new cK(k.proxy):cK.Event;var A=x.getBlockElements();var $=dB.overrideDefaults(function(){return{context:j,element:iP.getRoot()}});var B=function(a){if(typeof a==='string'){return!!A[a]}else if(a){var b=a.nodeType;if(b){return!!(b===1&&A[a.nodeName])}}return false};var C=function(a){if(a&&j&&typeof a==='string'){var b=j.getElementById(a);if(b&&b.id!==a){return j.getElementsByName(a)[1]}else{return b}}return a};var D=function(a){if(typeof a==='string'){a=C(a)}return $(a)};var E=function(a,b,c){var d,value;var e=D(a);if(e.length){d=m[b];if(d&&d.get){value=d.get(e,b)}else{value=e.attr(b)}}if(typeof value==='undefined'){value=c||''}return value};var F=function(a){var b=C(a);if(!b){return[]}return b.attributes};var G=function(a,b,c){var d,hook;if(c===''){c=null}var e=D(a);d=e.attr(b);if(!e.length){return}hook=m[b];if(hook&&hook.set){hook.set(e,c,b)}else{e.attr(b,c)}if(d!==c&&k.onSetAttrib){k.onSetAttrib({attrElm:e,attrName:b,attrValue:c})}};var H=function(b,c){if(!hT||b.nodeType!==1||c){return b.cloneNode(c)}if(!c){var d=j.createElement(b.nodeName);hR(F(b),function(a){G(d,a.nodeName,E(b,a.nodeName))});return d}return null};var I=function(){return k.root_element||j.body};var J=function(a){var b=!a?o:a;var c=b.document;var d=t?c.documentElement:c.body;return{x:b.pageXOffset||d.scrollLeft,y:b.pageYOffset||d.scrollTop,w:b.innerWidth||d.clientWidth,h:b.innerHeight||d.clientHeight}};var K=function(a,b){return gq.getPos(j.body,C(a),b)};var L=function(a,b,c){var d=D(a).css(b,c);if(k.update_styles){hX(y,d)}};var M=function(a,b){var c=D(a).css(b);if(k.update_styles){hX(y,c)}};var N=function(c,d,e){var f=D(c);if(e){return f.css(d)}d=d.replace(/-(\D)/g,function(a,b){return b.toUpperCase()});if(d==='float'){d=co.ie&&co.ie<12?'styleFloat':'cssFloat'}return f[0]&&f[0].style?f[0].style[d]:undefined};var O=function(a){var w,h;a=C(a);w=N(a,'width');h=N(a,'height');if(w.indexOf('px')===-1){w=0}if(h.indexOf('px')===-1){h=0}return{w:parseInt(w,10)||a.offsetWidth||a.clientWidth,h:parseInt(h,10)||a.offsetHeight||a.clientHeight}};var P=function(a){var b,size;a=C(a);b=K(a);size=O(a);return{x:b.x,y:b.y,w:size.w,h:size.h}};var Q=function(a,b){var i;if(!a){return false}if(!Array.isArray(a)){if(b==='*'){return a.nodeType===1}if(hU.test(b)){var c=b.toLowerCase().split(/,/);var d=a.nodeName.toLowerCase();for(i=c.length-1;i>=0;i--){if(c[i]===d){return true}}return false}if(a.nodeType&&a.nodeType!==1){return false}}var e=!Array.isArray(a)?[a]:a;return cL(b,e[0].ownerDocument||e[0],null,e).length>0};var R=function(b,c,d,e){var f=[];var g;var h=C(b);e=e===undefined;d=d||(I().nodeName!=='BODY'?I().parentNode:null);if(dj.is(c,'string')){g=c;if(c==='*'){c=function(a){return a.nodeType===1}}else{c=function(a){return Q(a,g)}}}while(h){if(h===d||!h.nodeType||h.nodeType===9){break}if(!c||typeof c==='function'&&c(h)){if(e){f.push(h)}else{return[h]}}h=h.parentNode}return e?f:null};var S=function(a,b,c){var d=R(a,b,c,false);return d&&d.length>0?d[0]:null};var T=function(b,c,d){var e=c;if(b){if(typeof c==='string'){e=function(a){return Q(a,c)}}for(b=b[d];b;b=b[d]){if(typeof e==='function'&&e(b)){return b}}}return null};var U=function(a,b){return T(a,b,'nextSibling')};var V=function(a,b){return T(a,b,'previousSibling')};var W=function(a,b){return cL(a,C(b)||k.root_element||j,[])};var X=function(b,c,d){var e;var f=typeof b==='string'?C(b):b;if(!f){return false}if(dj.isArray(f)&&(f.length||f.length===0)){e=[];hR(f,function(a,i){if(a){if(typeof a==='string'){a=C(a)}e.push(c.call(d,a,i))}});return e}var g=d?d:l;return c.call(g,f)};var Y=function(d,e){D(d).each(function(i,c){hR(e,function(a,b){G(c,b,a)})})};var Z=function(b,c){var d=D(b);if(hT){d.each(function(i,a){if(a.canHaveHTML===false){return}while(a.firstChild){a.removeChild(a.firstChild)}try{a.innerHTML='<br>'+c;a.removeChild(a.firstChild)}catch(ex){dB('<div></div>').html('<br>'+c).contents().slice(1).appendTo(a)}return c})}else{d.html(c)}};var hZ=function(c,d,e,f,g){return X(c,function(a){var b=typeof d==='string'?j.createElement(d):d;Y(b,e);if(f){if(typeof f!=='string'&&f.nodeType){b.appendChild(f)}else if(typeof f==='string'){Z(b,f)}}return!g?a.appendChild(b):b})};var ia=function(a,b,c){return hZ(j.createElement(a),a,b,c,true)};var ib=hK.decode;var ic=hK.encodeAllRaw;var ig=function(a,b,c){var d='',key;d+='<'+a;for(key in b){if(b.hasOwnProperty(key)&&b[key]!==null&&typeof b[key]!=='undefined'){d+=' '+key+'="'+ic(b[key])+'"'}}if(typeof c!=='undefined'){return d+'>'+c+'</'+a+'>'}return d+' />'};var ih=function(a){var b;var c=j.createElement('div');var d=j.createDocumentFragment();if(a){c.innerHTML=a}while(b=c.firstChild){d.appendChild(b)}return d};var ii=function(b,c){var d=D(b);if(c){d.each(function(){var a;while(a=this.firstChild){if(a.nodeType===3&&a.data.length===0){this.removeChild(a)}else{this.parentNode.insertBefore(a,this)}}}).remove()}else{d.remove()}return d.length>1?d.toArray():d[0]};var ij=function(e){return X(e,function(e){var i;var a=e.attributes;for(i=a.length-1;i>=0;i--){e.removeAttributeNode(a.item(i))}})};var ik=function(a){return y.parse(a)};var il=function(a,b){return y.serialize(a,b)};var im=function(a){var b,styleElm;if(iP!==DOMUtils.DOM&&j===document){if(n[a]){return}n[a]=true}styleElm=j.getElementById('mceDefaultStyles');if(!styleElm){styleElm=j.createElement('style');styleElm.id='mceDefaultStyles';styleElm.type='text/css';b=j.getElementsByTagName('head')[0];if(b.firstChild){b.insertBefore(styleElm,b.firstChild)}else{b.appendChild(styleElm)}}if(styleElm.styleSheet){styleElm.styleSheet.cssText+=a}else{styleElm.appendChild(j.createTextNode(a))}};var io=function(c){var d;if(iP!==DOMUtils.DOM&&j===document){DOMUtils.DOM.loadCSS(c);return}if(!c){c=''}d=j.getElementsByTagName('head')[0];hR(c.split(','),function(a){var b;a=dj._addCacheSuffix(a);if(p[a]){return}p[a]=true;b=ia('link',{rel:'stylesheet',href:a});d.appendChild(b)})};var ip=function(a,b,c){D(a).toggleClass(b,c).each(function(){if(this.className===''){dB(this).attr('class',null)}})};var iq=function(a,b){D(a).addClass(b)};var ir=function(a,b){ip(a,b,false)};var is=function(a,b){return D(a).hasClass(b)};var it=function(a){D(a).show()};var iu=function(a){D(a).hide()};var iv=function(a){return D(a).css('display')==='none'};var iw=function(a){return(!a?'mce_':a)+q++};var ix=function(a){var b=typeof a==='string'?C(a):a;return hq.isElement(b)?b.outerHTML:dB('<div></div>').append(dB(b).clone()).html()};var iy=function(a,b){D(a).each(function(){try{if('outerHTML'in this){this.outerHTML=b;return}}catch(ex){}ii(dB(this).html(b),true)})};var iz=function(c,d){var e=C(d);return X(c,function(a){var b,gd;b=e.parentNode;gd=e.nextSibling;if(gd){b.insertBefore(a,gd)}else{b.appendChild(a)}return a})};var iA=function(c,d,e){return X(d,function(b){if(dj.is(b,'array')){c=c.cloneNode(true)}if(e){hR(hS(b.childNodes),function(a){c.appendChild(a)})}return b.parentNode.replaceChild(c,b)})};var iB=function(b,c){var d;if(b.nodeName!==c.toUpperCase()){d=ia(c);hR(F(b),function(a){G(d,a.nodeName,E(b,a.nodeName))});iA(d,b,true)}return d||b};var iC=function(a,b){var c=a,pe;while(c){pe=b;while(pe&&c!==pe){pe=pe.parentNode}if(c===pe){break}c=c.parentNode}if(!c&&a.ownerDocument){return a.ownerDocument.documentElement}return c};var iD=function(a){return y.toHex(dj.trim(a))};var iE=function(a,b){var i,attributes,fd,whitespace,walker,name$1,brCount=0;a=a.firstChild;if(a){walker=new TreeWalker(a,a.parentNode);b=b||(x?x.getNonEmptyElements():null);whitespace=x?x.getWhiteSpaceElements():{};do{fd=a.nodeType;if(hq.isElement(a)){var c=a.getAttribute('data-mce-bogus');if(c){a=walker.next(c==='all');continue}name$1=a.nodeName.toLowerCase();if(b&&b[name$1]){if(name$1==='br'){brCount++;a=walker.next();continue}return false}attributes=F(a);i=attributes.length;while(i--){name$1=attributes[i].nodeName;if(name$1==='name'||name$1==='data-mce-bookmark'){return false}}}if(fd===8){return false}if(fd===3&&!hV.test(a.nodeValue)){return false}if(fd===3&&a.parentNode&&whitespace[a.parentNode.nodeName]&&hV.test(a.nodeValue)){return false}a=walker.next()}while(a)}return brCount<=1};var iF=function(){return j.createRange()};var iG=function(a,b,c){var r=iF(),bef,aft,pa;if(a&&b){r.setStart(a.parentNode,hY(a));r.setEnd(b.parentNode,hY(b));bef=r.extractContents();r=iF();r.setStart(b.parentNode,hY(b)+1);r.setEnd(a.parentNode,hY(a)+1);aft=r.extractContents();pa=a.parentNode;pa.insertBefore(hu.trimNode(iP,bef),a);if(c){pa.insertBefore(c,a)}else{pa.insertBefore(b,a)}pa.insertBefore(hu.trimNode(iP,aft),a);ii(a);return c||b}};var iH=function(a,b,c,d){if(dj.isArray(a)){var i=a.length;while(i--){a[i]=iH(a[i],b,c,d)}return a}if(k.collect&&(a===j||a===o)){v.push([a,b,c,d])}return z.bind(a,b,c,d||iP)};var iI=function(a,b,c){var i;if(dj.isArray(a)){i=a.length;while(i--){a[i]=iI(a[i],b,c)}return a}if(v&&(a===j||a===o)){i=v.length;while(i--){var d=v[i];if(a===d[0]&&(!b||b===d[1])&&(!c||c===d[2])){z.unbind(d[0],d[1],d[2])}}}return z.unbind(a,b,c)};var iJ=function(a,b,c){return z.fire(a,b,c)};var iK=function(a){if(a&&hq.isElement(a)){var b=a.getAttribute('data-mce-contenteditable');if(b&&b!=='inherit'){return b}return a.contentEditable!=='inherit'?a.contentEditable:null}else{return null}};var iL=function(a){var b=I();var c=null;for(;a&&a!==b;a=a.parentNode){c=iK(a);if(c!==null){break}}return c};var iM=function(){if(v){var i=v.length;while(i--){var a=v[i];z.unbind(a[0],a[1],a[2])}}if(cL.setDocument){cL.setDocument()}};var iN=function(a,b){while(a){if(b===a){return true}a=a.parentNode}return false};var iO=function(r){return'startContainer: '+r.startContainer.nodeName+', startOffset: '+r.startOffset+', endContainer: '+r.endContainer.nodeName+', endOffset: '+r.endOffset};var iP={doc:j,settings:k,win:o,files:p,stdMode:s,boxModel:t,styleSheetLoader:u,boundEvents:v,styles:y,schema:x,events:z,isBlock:B,$:$,$:D,root:null,clone:H,getRoot:I,getViewPort:J,getRect:P,getSize:O,getParent:S,getParents:R,get:C,getNext:U,getPrev:V,select:W,is:Q,add:hZ,create:ia,createHTML:ig,createFragment:ih,remove:ii,setStyle:L,getStyle:N,setStyles:M,removeAllAttribs:ij,setAttrib:G,setAttribs:Y,getAttrib:E,getPos:K,parseStyle:ik,serializeStyle:il,addStyle:im,loadCSS:io,addClass:iq,removeClass:ir,hasClass:is,toggleClass:ip,show:it,hide:iu,isHidden:iv,uniqueId:iw,setHTML:Z,getOuterHTML:ix,setOuterHTML:iy,decode:ib,encode:ic,insertAfter:iz,replace:iA,rename:iB,findCommonAncestor:iC,toHex:iD,run:X,getAttribs:F,isEmpty:iE,createRng:iF,nodeIndex:hY,split:iG,bind:iH,unbind:iI,fire:iJ,getContentEditable:iK,getContentEditableParent:iL,destroy:iM,isChildOf:iN,dumpRng:iO};m=hW(y,k,function(){return iP});return iP}(function(a){a.DOM=a(document);a.nodeIndex=hY}(DOMUtils||(DOMUtils={})));var iQ=DOMUtils;var iR=iQ.DOM;var iS=dj.each,grep$2=dj.grep;var iT=function(f){return typeof f==='function'};var iU=function(){var k=0;var l=1;var m=2;var n=3;var o={};var p=[];var q={};var r=[];var s=0;var t=function(a,b,c){var d=iR;var e,id;var f=function(){d.remove(id);if(e){e.onreadystatechange=e.onload=e=null}b()};var g=function(){if(iT(c)){c()}else{if(typeof console!=='undefined'&&console.log){console.log('Failed to load script: '+a)}}};id=d.uniqueId();e=document.createElement('script');e.id=id;e.type='text/javascript';e.src=dj._addCacheSuffix(a);e.onload=f;e.onerror=g;(document.getElementsByTagName('head')[0]||document.body).appendChild(e)};this.isDone=function(a){return o[a]===m};this.markDone=function(a){o[a]=m};this.add=this.load=function(a,b,c,d){var e=o[a];if(e===undefined){p.push(a);o[a]=k}if(b){if(!q[a]){q[a]=[]}q[a].push({success:b,failure:d,scope:c||this})}};this.remove=function(a){delete o[a];delete q[a]};this.loadQueue=function(a,b,c){this.loadScripts(p,a,b,c)};this.loadScripts=function(d,e,f,g){var h;var i=[];var j=function(b,c){iS(q[c],function(a){if(iT(a[b])){a[b].call(a.scope)}});q[c]=undefined};r.push({success:e,failure:g,scope:f||this});h=function(){var b=grep$2(d);d.length=0;iS(b,function(a){if(o[a]===m){j('success',a);return}if(o[a]===n){j('failure',a);return}if(o[a]!==l){o[a]=l;s++;t(a,function(){o[a]=m;s--;j('success',a);h()},function(){o[a]=n;s--;i.push(a);j('failure',a);h()})}});if(!s){var c=r.slice(0);r.length=0;iS(c,function(a){if(i.length===0){if(iT(a.success)){a.success.call(a.scope)}}else{if(iT(a.failure)){a.failure.call(a.scope,i)}}})}};h()}};iU.ScriptLoader=new iU();var iV=dj.each;function AddOnManager(){var h=this;var i=[];var j={};var k={};var l=[];var m=function(a){if(k[a]){return k[a].instance}return undefined};var n=function(a){var b;if(k[a]){b=k[a].dependencies}return b||[]};var o=function(a,b){var c=AddOnManager.language;if(c&&AddOnManager.languageLoad!==false){if(b){b=','+b+',';if(b.indexOf(','+c.substr(0,2)+',')!==-1){c=c.substr(0,2)}else if(b.indexOf(','+c+',')===-1){return}}iU.ScriptLoader.add(j[a]+'/langs/'+c+'.js')}};var p=function(b,c,d){i.push(c);k[b]={instance:c,dependencies:d};var e=bF(l,function(a){return a.name===b});l=e.fail;iV(e.pass,function(a){a.callback()});return c};var q=function(a){delete j[a];delete k[a]};var r=function(a,b){if(typeof b==='object'){return b}return typeof a==='string'?{prefix:'',resource:b,suffix:''}:{prefix:a.prefix,resource:b,suffix:a.suffix}};var s=function(b,c){var d=h.urls[b];iV(c,function(a){iU.ScriptLoader.add(d+'/'+a)})};var t=function(c,d,e,f){var g=n(c);iV(g,function(a){var b=r(d,a);u(b.resource,b,undefined,undefined)});if(e){if(f){e.call(f)}else{e.call(iU)}}};var u=function(a,b,c,d,e){if(j[a]){return}var f=typeof b==='string'?b:b.prefix+b.resource+b.suffix;if(f.indexOf('/')!==0&&f.indexOf('://')===-1){f=AddOnManager.baseURL+'/'+f}j[a]=f.substring(0,f.lastIndexOf('/'));if(k[a]){t(a,b,c,d)}else{iU.ScriptLoader.add(f,function(){return t(a,b,c,d)},d,e)}};var v=function(a,b){if(k.hasOwnProperty(a)){b()}else{l.push({name:a,callback:b})}};return{items:i,urls:j,lookup:k,_listeners:l,get:m,dependencies:n,requireLangPack:o,add:p,remove:q,createUrl:r,addComponents:s,load:u,waitFor:v}}(function(a){a.PluginManager=a();a.ThemeManager=a()}(AddOnManager||(AddOnManager={})));var iW=function(a,b){var c=ga(a);c.each(function(v){v.dom().insertBefore(b.dom(),a.dom())})};var iX=function(b,c){var d=gd(b);d.fold(function(){var a=ga(b);a.each(function(v){iZ(v,c)})},function(v){iW(v,c)})};var iY=function(a,b){var c=gi(a);c.fold(function(){iZ(a,b)},function(v){a.dom().insertBefore(b.dom(),v.dom())})};var iZ=function(a,b){a.dom().appendChild(b.dom())};var ja=function(a,b){iW(a,b);iZ(b,a)};var jb=function(a,b){bD(b,function(x){iW(a,x)})};var jc=function(a,b){bD(b,function(x){iZ(a,x)})};var jd=function(b){b.dom().textContent='';bD(gg(b),function(a){je(a)})};var je=function(a){var b=a.dom();if(b.parentNode!==null)b.parentNode.removeChild(b)};var jf=function(a){var b=gg(a);if(b.length>0)jb(a,b);je(a)};var jg=function(c,d){var e=null;var f=function(){if(e!==null){clearTimeout(e);e=null}};var g=function(){var a=[];for(var b=0;b<arguments.length;b++){a[b]=arguments[b]}if(e===null){e=setTimeout(function(){c.apply(null,a);e=null},d)}};return{cancel:f,throttle:g}};var jh=function(c,d){var e=null;var f=function(){if(e!==null){clearTimeout(e);e=null}};var g=function(){var a=[];for(var b=0;b<arguments.length;b++){a[b]=arguments[b]}if(e!==null)clearTimeout(e);e=setTimeout(function(){c.apply(null,a);e=null},d)};return{cancel:f,throttle:g}};var ji=function(a){var b=a;var c=function(){return b};var d=function(v){b=v};var e=function(){return ji(c())};return{get:c,set:d,clone:e}};var jj=function(a,b){var c=fu(a,b);return c===undefined||c===''?[]:c.split(' ')};var jk=function(a,b,c){var d=jj(a,b);var e=d.concat([c]);fs(a,b,e.join(' '));return true};var jl=function(a,b,c){var d=bG(jj(a,b),function(v){return v!==c});if(d.length>0)fs(a,b,d.join(' '));else fw(a,b);return false};var jm=function(a){return a.dom().classList!==undefined};var jn=function(a){return jj(a,'class')};var jo=function(a,b){return jk(a,'class',b)};var jp=function(a,b){return jl(a,'class',b)};var jq=function(a,b){if(jm(a))a.dom().classList.add(b);else jo(a,b)};var jr=function(a){var b=jm(a)?a.dom().classList:jn(a);if(b.length===0){fw(a,'class')}};var js=function(a,b){if(jm(a)){var c=a.dom().classList;c.remove(b)}else jp(a,b);jr(a)};var jt=function(a,b){return jm(a)&&a.dom().classList.contains(b)};var ju=function(a,b){var c=[];bD(gg(a),function(x){if(b(x)){c=c.concat([x])}c=c.concat(ju(x,b))});return c};var jv=function(a,b){return fQ(b,a)};function ClosestOrAncestor(b,c,d,a,e){return b(d,a)?bo.some(d):bw(e)&&e(d)?bo.none():c(d,a,e)}var jw=function(a,b,c){var d=a.dom();var e=bw(c)?c:bc(false);while(d.parentNode){d=d.parentNode;var f=eP.fromDom(d);if(b(f))return bo.some(f);else if(e(f))break}return bo.none()};var jx=function(b,c,d){var e=function(a){return c(a)};return ClosestOrAncestor(e,jw,b,c,d)};var jy=function(a,b,c){return jw(a,function(e){return fO(e,b)},c)};var jz=function(a,b){return fR(b,a)};var jA=function(a,b,c){return ClosestOrAncestor(fO,jy,a,b,c)};var jB=bc('mce-annotation');var jC=bc('data-mce-annotation');var jD=bc('data-mce-annotation-uid');var jE=function(e,f){var g=e.selection.getRng();var h=eP.fromDom(g.startContainer);var i=eP.fromDom(e.getBody());var j=f.fold(function(){return'.'+jB()},function(a){return'['+jC()+'="'+a+'"]'});var k=gh(h,g.startOffset).getOr(h);var l=jA(k,j,function(n){return fS(n,i)});var m=function(c,a){if(fv(c,a)){return bo.some(fu(c,a))}else{return bo.none()}};return l.bind(function(c){return m(c,''+jD()).bind(function(d){return m(c,''+jC()).map(function(a){var b=jG(e,d);return{uid:d,name:a,elements:b}})})})};var jF=function(a){return ff(a)&&jt(a,jB())};var jG=function(a,b){var c=eP.fromDom(a.getBody());return jv(c,'['+jD()+'="'+b+'"]')};var jH=function(c,d){var e=eP.fromDom(c.getBody());var f=jv(e,'['+jC()+'="'+d+'"]');var g={};bD(f,function(m){var a=fu(m,jD());var b=g.hasOwnProperty(a)?g[a]:[];g[a]=b.concat([m])});return g};var jI=function(h,i){var j=ji({});var k=function(){return{listeners:[],previous:ji(bo.none())}};var l=function(b,f){m(b,function(a){f(a);return a})};var m=function(a,f){var b=j.get();var c=b.hasOwnProperty(a)?b[a]:k();var d=f(c);b[a]=d;j.set(b)};var n=function(c,d,e){l(c,function(b){bD(b.listeners,function(f){return f(true,c,{uid:d,nodes:bC(e,function(a){return a.dom()})})})})};var o=function(b){l(b,function(a){bD(a.listeners,function(f){return f(false,b)})})};var p=jh(function(){var f=j.get();var g=bU(fh(f));bD(g,function(e){m(e,function(c){var d=c.previous.get();jE(h,bo.some(e)).fold(function(){if(d.isSome()){o(e);c.previous.set(bo.none())}},function(a){var b=a.uid,e=a.name,elements=a.elements;if(!d.is(b)){n(e,b,elements);c.previous.set(bo.some(b))}});return{previous:c.previous,listeners:c.listeners}})})},30);h.on('remove',function(){p.cancel()});h.on('nodeChange',function(){p.throttle()});var q=function(b,f){m(b,function(a){return{previous:a.previous,listeners:a.listeners.concat([f])}})};return{addListener:q}};var jJ=function(d,e){var f=function(a){var b=bo.from(a.attributes.map[jC()]);return b.bind(e.lookup)};d.on('init',function(){d.serializer.addNodeFilter('span',function(c){bD(c,function(b){f(b).each(function(a){if(a.persistent===false){b.unwrap()}})})})})};var jK=function(){var c={};var d=function(a,b){c[a]={name:a,settings:b}};var e=function(b){return c.hasOwnProperty(b)?bo.from(c[b]).map(function(a){return a.settings}):bo.none()};return{register:d,lookup:e}};function __rest(s,e){var t={};for(var p in s)if(Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0)t[p]=s[p];if(s!=null&&typeof Object.getOwnPropertySymbols==='function')for(var i=0,p=Object.getOwnPropertySymbols(s);i<p.length;i++)if(e.indexOf(p[i])<0)t[p[i]]=s[p[i]];return t}var jL=0;var jM=function(a){var b=new Date();var c=b.getTime();var d=Math.floor(Math.random()*1000000000);jL++;return a+'_'+d+jL+String(c)};var jN=function(a,b){bD(b,function(x){jq(a,x)})};var jO=function(a,b){return eP.fromDom(a.dom().cloneNode(b))};var jP=function(a){return jO(a,false)};var jQ=function(a){return jO(a,true)};var jR=function(a,b){var c=b||document;var d=c.createElement('div');d.innerHTML=a;return gg(eP.fromDom(d))};var jS=function(a){return a.dom().innerHTML};var jT=function(a,b){var c=fX(a);var d=c.dom();var e=eP.fromDom(d.createDocumentFragment());var f=jR(b,d);jc(e,f);jd(a);iZ(a,e)};var jU='\uFEFF';var jV=function(a){return a===jU};var jW=function(a){return a.replace(new RegExp(jU,'g'),'')};var jX={isZwsp:jV,ZWSP:jU,trim:jW};var jY=hq.isElement;var jZ=hq.isText;var ka=function(a){if(jZ(a)){a=a.parentNode}return jY(a)&&a.hasAttribute('data-mce-caret')};var kb=function(a){return jZ(a)&&jX.isZwsp(a.data)};var kc=function(a){return ka(a)||kb(a)};var kd=function(a){return a.firstChild!==a.lastChild||!hq.isBr(a.firstChild)};var ke=function(a,b){var c,dJ,textNode,parentNode;c=a.ownerDocument;textNode=c.createTextNode(jX.ZWSP);parentNode=a.parentNode;if(!b){dJ=a.nextSibling;if(jZ(dJ)){if(kc(dJ)){return dJ}if(kj(dJ)){dJ.splitText(1);return dJ}}if(a.nextSibling){parentNode.insertBefore(textNode,a.nextSibling)}else{parentNode.appendChild(textNode)}}else{dJ=a.previousSibling;if(jZ(dJ)){if(kc(dJ)){return dJ}if(kk(dJ)){return dJ.splitText(dJ.data.length-1)}}parentNode.insertBefore(textNode,a)}return textNode};var kf=function(a){var b=a.container();return a&&hq.isText(b)&&b.data.charAt(a.offset())===jX.ZWSP};var kg=function(a){var b=a.container();return a&&hq.isText(b)&&b.data.charAt(a.offset()-1)===jX.ZWSP};var kh=function(){var a=document.createElement('br');a.setAttribute('data-mce-bogus','1');return a};var ki=function(a,b,c){var d,blockNode,parentNode;d=b.ownerDocument;blockNode=d.createElement(a);blockNode.setAttribute('data-mce-caret',c?'before':'after');blockNode.setAttribute('data-mce-bogus','all');blockNode.appendChild(kh());parentNode=b.parentNode;if(!c){if(b.nextSibling){parentNode.insertBefore(blockNode,b.nextSibling)}else{parentNode.appendChild(blockNode)}}else{parentNode.insertBefore(blockNode,b)}return blockNode};var kj=function(a){return jZ(a)&&a.data[0]===jX.ZWSP};var kk=function(a){return jZ(a)&&a.data[a.data.length-1]===jX.ZWSP};var kl=function(a){var b=a.getElementsByTagName('br');var c=b[b.length-1];if(hq.isBogus(c)){c.parentNode.removeChild(c)}};var km=function(a){if(a&&a.hasAttribute('data-mce-caret')){kl(a);a.removeAttribute('data-mce-caret');a.removeAttribute('data-mce-bogus');a.removeAttribute('style');a.removeAttribute('_moz_abspos');return a}return null};var kn=function(a){return ka(a.startContainer)};var ko=hq.isContentEditableTrue;var kp=hq.isContentEditableFalse;var kq=hq.isBr;var kr=hq.isText;var ks=hq.matchNodeNames('script style textarea');var kt=hq.matchNodeNames('img input textarea hr iframe video audio object');var ku=hq.matchNodeNames('table');var kv=kc;var kw=function(a){if(kv(a)){return false}if(kr(a)){if(ks(a.parentNode)){return false}return true}return kt(a)||kq(a)||ku(a)||ky(a)};var kx=function(a){return hq.isElement(a)&&a.getAttribute('unselectable')==='true'};var ky=function(a){return kx(a)===false&&kp(a)};var kz=function(a,b){for(a=a.parentNode;a&&a!==b;a=a.parentNode){if(ky(a)){return false}if(ko(a)){return true}}return true};var kA=function(c){if(!ky(c)){return false}return bI(bX(c.getElementsByTagName('*')),function(a,b){return a||ko(b)},false)!==true};var kB=function(a){return kt(a)||kA(a)};var kC=function(a,b){return kw(a)&&kz(a,b)};var kD=Math.round;var kE=function(a){if(!a){return{left:0,top:0,bottom:0,right:0,width:0,height:0}}return{left:kD(a.left),top:kD(a.top),bottom:kD(a.bottom),right:kD(a.right),width:kD(a.width),height:kD(a.height)}};var kF=function(a,b){a=kE(a);if(b){a.right=a.left}else{a.left=a.left+a.width;a.right=a.left}a.width=0;return a};var kG=function(a,b){return a.left===b.left&&a.top===b.top&&a.bottom===b.bottom&&a.right===b.right};var kH=function(a,b,c){return a>=0&&a<=Math.min(b.height,c.height)/2};var kI=function(a,b){if(a.bottom-a.height/2<b.top){return true}if(a.top>b.bottom){return false}return kH(b.top-a.bottom,a,b)};var kJ=function(a,b){if(a.top>b.bottom){return true}if(a.bottom<b.top){return false}return kH(b.bottom-a.top,a,b)};var kK=function(a,b,c){return b>=a.left&&b<=a.right&&c>=a.top&&c<=a.bottom};var kL=function(a,b){if(b.left>a.left&&b.right<a.right){return 0}else{return b.left<a.left?b.left-a.left:b.right-a.right}};var kM=function(a,b){if(b.top>a.top&&b.bottom<a.bottom){return 0}else{return b.top<a.top?b.top-a.top:b.bottom-a.bottom}};var kN=function(a,b){return{x:kL(a,b),y:kM(a,b)}};var kO=function(a){var b=a.startContainer,startOffset=a.startOffset;if(b.hasChildNodes()&&a.endOffset===startOffset+1){return b.childNodes[startOffset]}return null};var kP=function(a,b){if(a.nodeType===1&&a.hasChildNodes()){if(b>=a.childNodes.length){b=a.childNodes.length-1}a=a.childNodes[b]}return a};var kQ=new RegExp('[\u0300-\u036f\u0483-\u0487\u0488-\u0489\u0591-\u05bd\u05bf\u05c1-\u05c2\u05c4-\u05c5\u05c7\u0610-\u061a'+'\u064b-\u065f\u0670\u06d6-\u06dc\u06df-\u06e4\u06e7-\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0'+'\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0859-\u085b\u08E3-\u0902\u093a\u093c'+'\u0941-\u0948\u094d\u0951-\u0957\u0962-\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2-\u09e3'+'\u0a01-\u0a02\u0a3c\u0a41-\u0a42\u0a47-\u0a48\u0a4b-\u0a4d\u0a51\u0a70-\u0a71\u0a75\u0a81-\u0a82\u0abc'+'\u0ac1-\u0ac5\u0ac7-\u0ac8\u0acd\u0ae2-\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57'+'\u0b62-\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c00\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55-\u0c56'+'\u0c62-\u0c63\u0c81\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc-\u0ccd\u0cd5-\u0cd6\u0ce2-\u0ce3\u0d01\u0d3e\u0d41-\u0d44'+'\u0d4d\u0d57\u0d62-\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9'+'\u0ebb-\u0ebc\u0ec8-\u0ecd\u0f18-\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86-\u0f87\u0f8d-\u0f97'+'\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039-\u103a\u103d-\u103e\u1058-\u1059\u105e-\u1060\u1071-\u1074'+'\u1082\u1085-\u1086\u108d\u109d\u135d-\u135f\u1712-\u1714\u1732-\u1734\u1752-\u1753\u1772-\u1773\u17b4-\u17b5'+'\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927-\u1928\u1932\u1939-\u193b\u1a17-\u1a18'+'\u1a1b\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1ab0-\u1abd\u1ABE\u1b00-\u1b03\u1b34'+'\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80-\u1b81\u1ba2-\u1ba5\u1ba8-\u1ba9\u1bab-\u1bad\u1be6\u1be8-\u1be9'+'\u1bed\u1bef-\u1bf1\u1c2c-\u1c33\u1c36-\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1cf4\u1cf8-\u1cf9'+'\u1dc0-\u1df5\u1dfc-\u1dff\u200c-\u200d\u20d0-\u20dc\u20DD-\u20E0\u20e1\u20E2-\u20E4\u20e5-\u20f0\u2cef-\u2cf1'+'\u2d7f\u2de0-\u2dff\u302a-\u302d\u302e-\u302f\u3099-\u309a\ua66f\uA670-\uA672\ua674-\ua67d\uA69E-\ua69f\ua6f0-\ua6f1'+'\ua802\ua806\ua80b\ua825-\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc'+'\ua9e5\uaa29-\uaa2e\uaa31-\uaa32\uaa35-\uaa36\uaa43\uaa4c\uaa7c\uaab0\uaab2-\uaab4\uaab7-\uaab8\uaabe-\uaabf\uaac1'+'\uaaec-\uaaed\uaaf6\uabe5\uabe8\uabed\ufb1e\ufe00-\ufe0f\ufe20-\uFE2F\uff9e-\uff9f]');var kR=function(a){return typeof a==='string'&&a.charCodeAt(0)>=768&&kQ.test(a)};var kS=function(a,f){var r=[];for(var i=0;i<a.length;i++){var x=a[i];if(x.isSome()){r.push(x.getOrDie())}else{return bo.none()}}return bo.some(f.apply(null,r))};var kT=[].slice;var kU=function(){var x=[];for(var a=0;a<arguments.length;a++){x[a]=arguments[a]}var b=kT.call(arguments);return function(x){for(var i=0;i<b.length;i++){if(b[i](x)){return true}}return false}};var kV=function(){var x=[];for(var a=0;a<arguments.length;a++){x[a]=arguments[a]}var b=kT.call(arguments);return function(x){for(var i=0;i<b.length;i++){if(!b[i](x)){return false}}return true}};var kW={and:kV,or:kU};var kX=hq.isElement;var kY=kw;var kZ=hq.matchStyleValues('display','block table');var la=hq.matchStyleValues('float','left right');var lb=kW.and(kX,kY,be(la));var lc=be(hq.matchStyleValues('white-space','pre pre-line pre-wrap'));var ld=hq.isText;var le=hq.isBr;var lf=iQ.nodeIndex;var lg=kP;var lh=function(a){return'createRange'in a?a.createRange():iQ.DOM.createRng()};var li=function(a){return a&&/[\r\n\t ]/.test(a)};var lj=function(a){return!!a.setStart&&!!a.setEnd};var lk=function(a){var b=a.startContainer;var c=a.startOffset;var d;if(li(a.toString())&&lc(b.parentNode)&&hq.isText(b)){d=b.data;if(li(d[c-1])||li(d[c+1])){return true}}return false};var ll=function(a){var b=a.ownerDocument;var c=lh(b);var d=b.createTextNode('\xA0');var e=a.parentNode;var f;e.insertBefore(d,a);c.setStart(d,0);c.setEnd(d,1);f=kE(c.getBoundingClientRect());e.removeChild(d);return f};var lm=function(a){var b=a.startContainer;var c=a.endContainer;var d=a.startOffset;var e=a.endOffset;if(b===c&&hq.isText(c)&&d===0&&e===1){var f=a.cloneRange();f.setEndAfter(c);return lo(f)}else{return null}};var ln=function(r){return r.left===0&&r.right===0&&r.top===0&&r.bottom===0};var lo=function(a){var b,clientRects;clientRects=a.getClientRects();if(clientRects.length>0){b=kE(clientRects[0])}else{b=kE(a.getBoundingClientRect())}if(!lj(a)&&le(a)&&ln(b)){return ll(a)}if(ln(b)&&lj(a)){return lm(a)}return b};var lp=function(a,b){var c=kF(a,b);c.width=1;c.right=c.left+1;return c};var lq=function(d){var e=[];var f,fH;var g=function(a){if(a.height===0){return}if(e.length>0){if(kG(a,e[e.length-1])){return}}e.push(a)};var h=function(a,b){var c=lh(a.ownerDocument);if(b<a.data.length){if(kR(a.data[b])){return e}if(kR(a.data[b-1])){c.setStart(a,b);c.setEnd(a,b+1);if(!lk(c)){g(lp(lo(c),false));return e}}}if(b>0){c.setStart(a,b-1);c.setEnd(a,b);if(!lk(c)){g(lp(lo(c),false))}}if(b<a.data.length){c.setStart(a,b);c.setEnd(a,b+1);if(!lk(c)){g(lp(lo(c),true))}}};if(ld(d.container())){h(d.container(),d.offset());return e}if(kX(d.container())){if(d.isAtEnd()){fH=lg(d.container(),d.offset());if(ld(fH)){h(fH,fH.data.length)}if(lb(fH)&&!le(fH)){g(lp(lo(fH),false))}}else{fH=lg(d.container(),d.offset());if(ld(fH)){h(fH,0)}if(lb(fH)&&d.isAtEnd()){g(lp(lo(fH),false));return e}f=lg(d.container(),d.offset()-1);if(lb(f)&&!le(f)){if(kZ(f)||kZ(fH)||!lb(fH)){g(lp(lo(f),false))}}if(lb(fH)){g(lp(lo(fH),true))}}}return e};function CaretPosition(b,c,d){var e=function(){if(ld(b)){return c===0}return c===0};var f=function(){if(ld(b)){return c>=b.data.length}return c>=b.childNodes.length};var g=function(){var a;a=lh(b.ownerDocument);a.setStart(b,c);a.setEnd(b,c);return a};var h=function(){if(!d){d=lq(CaretPosition(b,c))}return d};var i=function(){return h().length>0};var j=function(a){return a&&b===a.container()&&c===a.offset()};var k=function(a){return lg(b,a?c-1:c)};return{container:bc(b),offset:bc(c),toRange:g,getClientRects:h,isVisible:i,isAtStart:e,isAtEnd:f,isEqual:j,getNode:k}}(function(c){c.fromRangeStart=function(a){return c(a.startContainer,a.startOffset)};c.fromRangeEnd=function(a){return c(a.endContainer,a.endOffset)};c.after=function(a){return c(a.parentNode,lf(a)+1)};c.before=function(a){return c(a.parentNode,lf(a))};c.isAbove=function(a,b){return kS([bV(b.getClientRects()),bW(a.getClientRects())],kI).getOr(false)};c.isBelow=function(a,b){return kS([bW(b.getClientRects()),bV(a.getClientRects())],kJ).getOr(false)};c.isAtStart=function(a){return a?a.isAtStart():false};c.isAtEnd=function(a){return a?a.isAtEnd():false};c.isTextPosition=function(a){return a?hq.isText(a.container()):false};c.isElementPosition=function(a){return c.isTextPosition(a)===false}}(CaretPosition||(CaretPosition={})));var lr=CaretPosition;var ls=hq.isText;var lt=hq.isBogus;var lu=iQ.nodeIndex;var lv=function(a){var b=a.parentNode;if(lt(b)){return lv(b)}return b};var lw=function(c){if(!c){return[]}return cW.reduce(c.childNodes,function(a,b){if(lt(b)&&b.nodeName!=='BR'){a=a.concat(lw(b))}else{a.push(b)}return a},[])};var lx=function(a,b){while(a=a.previousSibling){if(!ls(a)){break}b+=a.data.length}return b};var ly=function(a){return function(b){return a===b}};var lz=function(c){var d,index,numTextFragments;d=lw(lv(c));index=cW.findIndex(d,ly(c),c);d=d.slice(0,index+1);numTextFragments=cW.reduce(d,function(a,b,i){if(ls(b)&&ls(d[i-1])){a++}return a},0);d=cW.filter(d,hq.matchNodeNames(c.nodeName));index=cW.findIndex(d,ly(c),c);return index-numTextFragments};var lA=function(a){var b;if(ls(a)){b='text()'}else{b=a.nodeName.toLowerCase()}return b+'['+lz(a)+']'};var lB=function(a,b,c){var d=[];for(b=b.parentNode;b!==a;b=b.parentNode){if(c&&c(b)){break}d.push(b)}return d};var lC=function(b,c){var d,offset,bZ=[],outputOffset,childNodes,gb;d=c.container();offset=c.offset();if(ls(d)){outputOffset=lx(d,offset)}else{childNodes=d.childNodes;if(offset>=childNodes.length){outputOffset='after';offset=childNodes.length-1}else{outputOffset='before'}d=childNodes[offset]}bZ.push(lA(d));gb=lB(b,d);gb=cW.filter(gb,be(hq.isBogus));bZ=bZ.concat(cW.map(gb,function(a){return lA(a)}));return bZ.reverse().join('/')+','+outputOffset};var lD=function(c,d,e){var f=lw(c);f=cW.filter(f,function(a,b){return!ls(a)||!ls(f[b-1])});f=cW.filter(f,hq.matchNodeNames(d));return f[e]};var lE=function(a,b){var c=a,targetOffset=0,dataLen;while(ls(c)){dataLen=c.data.length;if(b>=targetOffset&&b<=targetOffset+dataLen){a=c;b=b-targetOffset;break}if(!ls(c.nextSibling)){a=c;b=dataLen;break}targetOffset+=dataLen;c=c.nextSibling}if(ls(a)&&b>a.data.length){b=a.data.length}return lr(a,b)};var lF=function(c,d){var e,container,offset;if(!d){return null}e=d.split(',');d=e[0].split('/');offset=e.length>1?e[1]:'before';container=cW.reduce(d,function(a,b){b=/([\w\-\(\)]+)\[([0-9]+)\]/.exec(b);if(!b){return null}if(b[1]==='text()'){b[1]='#text'}return lD(a,b[1],parseInt(b[2],10))},c);if(!container){return null}if(!ls(container)){if(offset==='after'){offset=lu(container)+1}else{offset=lu(container)}return lr(container.parentNode,offset)}return lE(container,parseInt(offset,10))};var lG=hq.isContentEditableFalse;var lH=function(a,b,c){var d,trimmedOffset;trimmedOffset=a(b.data.slice(0,c)).length;for(d=b.previousSibling;d&&hq.isText(d);d=d.previousSibling){trimmedOffset+=a(d.data).length}return trimmedOffset};var lI=function(a,b,c,d,e){var f=d[e?'startContainer':'endContainer'];var g=d[e?'startOffset':'endOffset'];var h=[];var i,iX=0;var j=a.getRoot();if(hq.isText(f)){h.push(c?lH(b,f,g):g)}else{i=f.childNodes;if(g>=i.length&&i.length){iX=1;g=Math.max(0,i.length-1)}h.push(a.nodeIndex(i[g],c)+iX)}for(;f&&f!==j;f=f.parentNode){h.push(a.nodeIndex(f,c))}return h};var lJ=function(a,b,c,d){var e=b.dom,bookmark={};bookmark.start=lI(e,a,c,d,true);if(!b.isCollapsed()){bookmark.end=lI(e,a,c,d,false)}return bookmark};var lK=function(a){if(hq.isText(a)&&a.data.length===0){a.parentNode.removeChild(a)}};var lL=function(b,c,d){var e=0;dj.each(b.select(c),function(a){if(a.getAttribute('data-mce-bogus')==='all'){return}if(a===d){return false}e++});return e};var lM=function(a,b){var c,offset,childNodes;var d=b?'start':'end';c=a[d+'Container'];offset=a[d+'Offset'];if(hq.isElement(c)&&c.nodeName==='TR'){childNodes=c.childNodes;c=childNodes[Math.min(b?offset:offset-1,childNodes.length-1)];if(c){offset=b?0:c.childNodes.length;a['set'+(b?'Start':'End')](c,offset)}}};var lN=function(a){lM(a,true);lM(a,false);return a};var lO=function(a,b){var c;if(hq.isElement(a)){a=kP(a,b);if(lG(a)){return a}}if(kc(a)){if(hq.isText(a)&&ka(a)){a=a.parentNode}c=a.previousSibling;if(lG(c)){return c}c=a.nextSibling;if(lG(c)){return c}}};var lP=function(a){return lO(a.startContainer,a.startOffset)||lO(a.endContainer,a.endOffset)};var lQ=function(a,b,c){var d=c.getNode();var e=d?d.nodeName:null;var f=c.getRng();if(lG(d)||e==='IMG'){return{name:e,index:lL(c.dom,e,d)}}var g=lP(f);if(g){e=g.tagName;return{name:e,index:lL(c.dom,e,g)}}return lJ(a,c,b,f)};var lR=function(a){var b=a.getRng();return{start:lC(a.dom.getRoot(),lr.fromRangeStart(b)),end:lC(a.dom.getRoot(),lr.fromRangeEnd(b))}};var lS=function(a){return{rng:a.getRng()}};var lT=function(a,b,c){var d={'data-mce-type':'bookmark','id':b,'style':'overflow:hidden;line-height:0px'};return c?a.create('span',d,'&#xFEFF;'):a.create('span',d)};var lU=function(a,b){var c=a.dom;var d=a.getRng();var e=c.uniqueId();var f=a.isCollapsed();var g=a.getNode();var h=g.nodeName;if(h==='IMG'){return{name:h,index:lL(c,h,g)}}var i=lN(d.cloneRange());if(!f){i.collapse(false);var j=lT(c,e+'_end',b);i.insertNode(j);lK(j.nextSibling)}d=lN(d);d.collapse(true);var k=lT(c,e+'_start',b);d.insertNode(k);lK(k.previousSibling);lK(k.nextSibling);a.moveToBookmark({id:e,keep:1});return{id:e}};var lV=function(a,b,c){if(b===2){return lQ(jX.trim,c,a)}else if(b===3){return lR(a)}else if(b){return lS(a)}else{return lU(a,false)}};var lW={getBookmark:lV,getUndoBookmark:curry(lQ,bd,true),getPersistentBookmark:lU};var lX='_mce_caret';var lY=function(a){return hq.isElement(a)&&a.id===lX};var lZ=function(a,b){while(b&&b!==a){if(b.id===lX){return b}b=b.parentNode}return null};var ma=hq.isElement;var mb=hq.isText;var mc=function(a){var b=a.parentNode;if(b){b.removeChild(a)}};var md=function(a){try{return a.nodeValue}catch(ex){return''}};var me=function(a,b){if(b.length===0){mc(a)}else{a.nodeValue=b}};var mf=function(a){var b=jX.trim(a);return{count:a.length-b.length,text:b}};var mg=function(a,b){mm(a);return b};var mh=function(a,b){var c=mf(a.data.substr(0,b.offset()));var d=mf(a.data.substr(b.offset()));var e=c.text+d.text;if(e.length>0){me(a,e);return lr(a,b.offset()-c.count)}else{return b}};var mi=function(b,c){var d=c.container();var e=bz(bX(d.childNodes),b).map(function(a){return a<c.offset()?lr(d,c.offset()-1):c}).getOr(c);mm(b);return e};var mj=function(a,b){return mb(a)&&b.container()===a?mh(a,b):mg(a,b)};var mk=function(a,b){return b.container()===a.parentNode?mi(a,b):mg(a,b)};var ml=function(a,b){return lr.isTextPosition(b)?mj(a,b):mk(a,b)};var mm=function(a){if(ma(a)&&kc(a)){if(kd(a)){a.removeAttribute('data-mce-caret')}else{mc(a)}}if(mb(a)){var b=jX.trim(md(a));me(a,b)}};var mn={removeAndReposition:ml,remove:mm};var mo=eJ.detect().browser;var mp=hq.isContentEditableFalse;var mq=function(a){return hq.isElement(a)&&/^(TD|TH)$/i.test(a.tagName)};var mr=function(a,b,c){var d=kF(b.getBoundingClientRect(),c);var e,scrollX,scrollY,margin,rootRect;if(a.tagName==='BODY'){e=a.ownerDocument.documentElement;scrollX=a.scrollLeft||e.scrollLeft;scrollY=a.scrollTop||e.scrollTop}else{rootRect=a.getBoundingClientRect();scrollX=a.scrollLeft-rootRect.left;scrollY=a.scrollTop-rootRect.top}d.left+=scrollX;d.right+=scrollX;d.top+=scrollY;d.bottom+=scrollY;d.width=1;margin=b.offsetWidth-b.clientWidth;if(margin>0){if(c){margin*=-1}d.left+=margin;d.right+=margin}return d};var ms=function(a){var b,fH,dJ,i,JY;b=dB('*[contentEditable=false]',a);for(i=0;i<b.length;i++){fH=b[i];dJ=fH.previousSibling;if(kk(dJ)){JY=dJ.data;if(JY.length===1){dJ.parentNode.removeChild(dJ)}else{dJ.deleteData(JY.length-1,1)}}dJ=fH.nextSibling;if(kj(dJ)){JY=dJ.data;if(JY.length===1){dJ.parentNode.removeChild(dJ)}else{dJ.deleteData(0,1)}}}};var mt=function(f,g,h){var i=ji(bo.none());var j,caretContainerNode;var k=function(b,c){var d,rng;l();if(mq(c)){return null}if(g(c)){caretContainerNode=ki('p',c,b);d=mr(f,c,b);dB(caretContainerNode).css('top',d.top);var e=dB('<div class="mce-visual-caret" data-mce-bogus="all"></div>').css(d).appendTo(f)[0];i.set(bo.some({caret:e,element:c,before:b}));i.get().each(function(a){if(b){dB(a.caret).addClass('mce-visual-caret-before')}});m();rng=c.ownerDocument.createRange();rng.setStart(caretContainerNode,0);rng.setEnd(caretContainerNode,0)}else{caretContainerNode=ke(c,b);rng=c.ownerDocument.createRange();if(mp(caretContainerNode.nextSibling)){rng.setStart(caretContainerNode,0);rng.setEnd(caretContainerNode,0)}else{rng.setStart(caretContainerNode,1);rng.setEnd(caretContainerNode,1)}return rng}return rng};var l=function(){ms(f);if(caretContainerNode){mn.remove(caretContainerNode);caretContainerNode=null}i.get().each(function(a){dB(a.caret).remove();i.set(bo.none())});clearInterval(j)};var m=function(){j=cy.setInterval(function(){if(h()){dB('div.mce-visual-caret',f).toggleClass('mce-visual-caret-hidden')}else{dB('div.mce-visual-caret',f).addClass('mce-visual-caret-hidden')}},500)};var n=function(){i.get().each(function(a){var b=mr(f,a.element,a.before);dB(a.caret).css(b)})};var o=function(){return cy.clearInterval(j)};var p=function(){return'.mce-visual-caret {'+'position: absolute;'+'background-color: black;'+'background-color: currentcolor;'+'}'+'.mce-visual-caret-hidden {'+'display: none;'+'}'+'*[data-mce-caret] {'+'position: absolute;'+'left: -1000px;'+'right: auto;'+'top: 0;'+'margin: 0;'+'padding: 0;'+'}'};return{show:k,hide:l,getCss:p,reposition:n,destroy:o}};var mu=function(){return mo.isIE()||mo.isEdge()||mo.isFirefox()};var mv=function(a){return mp(a)||hq.isTable(a)&&mu()};var mw=function(b){return function(a){return b===a}};var mx=mw('\xA0');var my=function(a){return/^[\r\n\t]$/.test(a)};var mz=function(a){return!my(a)&&!mx(a)};var mA=hq.isContentEditableFalse;var mB=hq.matchStyleValues('display','block table table-cell table-caption list-item');var mC=kc;var mD=ka;var mE=hq.isElement;var mF=kw;var mG=function(a){return a>0};var mH=function(a){return a<0};var mI=function(a,b){var c;while(c=a(b)){if(!mD(c)){return c}}return null};var mJ=function(a,b,c,d,e){var f=new TreeWalker(a,d);if(mH(b)){if(mA(a)||mD(a)){a=mI(f.prev,true);if(c(a)){return a}}while(a=mI(f.prev,e)){if(c(a)){return a}}}if(mG(b)){if(mA(a)||mD(a)){a=mI(f.next,true);if(c(a)){return a}}while(a=mI(f.next,e)){if(c(a)){return a}}}return null};var mK=function(a,b){while(a&&a!==b){if(mB(a)){return a}a=a.parentNode}return null};var mL=function(a,b,c){return mK(a.container(),c)===mK(b.container(),c)};var mM=function(a,b){var c,offset;if(!b){return null}c=b.container();offset=b.offset();if(!mE(c)){return null}return c.childNodes[offset+a]};var mN=function(a,b){var c=b.ownerDocument.createRange();if(a){c.setStartBefore(b);c.setEndBefore(b)}else{c.setStartAfter(b);c.setEndAfter(b)}return c};var mO=function(a,b,c){return mK(b,a)===mK(c,a)};var mP=function(a,b,c){var d,siblingName;if(a){siblingName='previousSibling'}else{siblingName='nextSibling'}while(c&&c!==b){d=c[siblingName];if(mC(d)){d=d[siblingName]}if(mA(d)){if(mO(b,d,c)){return d}break}if(mF(d)){break}c=c.parentNode}return null};var mQ=curry(mN,true);var mR=curry(mN,false);var mS=function(a,b,c){var d,container,offset,location;var e=curry(mP,true,b);var f=curry(mP,false,b);container=c.startContainer;offset=c.startOffset;if(ka(container)){if(!mE(container)){container=container.parentNode}location=container.getAttribute('data-mce-caret');if(location==='before'){d=container.nextSibling;if(mv(d)){return mQ(d)}}if(location==='after'){d=container.previousSibling;if(mv(d)){return mR(d)}}}if(!c.collapsed){return c}if(hq.isText(container)){if(mC(container)){if(a===1){d=f(container);if(d){return mQ(d)}d=e(container);if(d){return mR(d)}}if(a===-1){d=e(container);if(d){return mR(d)}d=f(container);if(d){return mQ(d)}}return c}if(kk(container)&&offset>=container.data.length-1){if(a===1){d=f(container);if(d){return mQ(d)}}return c}if(kj(container)&&offset<=1){if(a===-1){d=e(container);if(d){return mR(d)}}return c}if(offset===container.data.length){d=f(container);if(d){return mQ(d)}return c}if(offset===0){d=e(container);if(d){return mR(d)}return c}}return c};var mT=function(a,b){var c=mM(a,b);return mA(c)&&!hq.isBogusAll(c)};var mU=function(a,b){return hq.isTable(mM(a,b))};var mV=function(a,b){return bo.from(mM(a?0:-1,b)).filter(mA)};var mW=function(a,b,c){var d=mS(a,b,c);if(a===-1){return CaretPosition.fromRangeStart(d)}return CaretPosition.fromRangeEnd(d)};var mX=curry(mT,0);var mY=curry(mT,-1);var mZ=curry(mU,0);var na=curry(mU,-1);var nc=function(c,d,e){return bo.from(e.container()).filter(hq.isText).exists(function(a){var b=c?0:-1;return d(a.data.charAt(e.offset()+b))})};var nd=curry(nc,true,my);var ne=curry(nc,false,my);var nf=function(a){return bo.from(a.getNode()).map(eP.fromDom)};var ng=function(a){return bo.from(a.getNode(true)).map(eP.fromDom)};var nh;(function(a){a[a['Backwards']=-1]='Backwards';a[a['Forwards']=1]='Forwards'}(nh||(nh={})));var ni=hq.isContentEditableFalse;var nj=hq.isText;var nk=hq.isElement;var nl=hq.isBr;var nm=kw;var nn=kB;var no=kC;var np=function(a,b){var c=[];while(a&&a!==b){c.push(a);a=a.parentNode}return c};var nq=function(a,b){if(a.hasChildNodes()&&b<a.childNodes.length){return a.childNodes[b]}return null};var nr=function(a,b){if(mG(a)){if(nm(b.previousSibling)&&!nj(b.previousSibling)){return lr.before(b)}if(nj(b)){return lr(b,0)}}if(mH(a)){if(nm(b.nextSibling)&&!nj(b.nextSibling)){return lr.after(b)}if(nj(b)){return lr(b,b.data.length)}}if(mH(a)){if(nl(b)){return lr.before(b)}return lr.after(b)}return lr.before(b)};var nt=function(a,b){var c=b.nextSibling;if(c&&nm(c)){if(nj(c)){return lr(c,0)}else{return lr.before(c)}}else{return nu(nh.Forwards,lr.after(b),a)}};var nu=function(a,b,c){var d,nextNode,innerNode;var e,caretPosition;if(!nk(c)||!b){return null}if(b.isEqual(lr.after(c))&&c.lastChild){caretPosition=lr.after(c.lastChild);if(mH(a)&&nm(c.lastChild)&&nk(c.lastChild)){return nl(c.lastChild)?lr.before(c.lastChild):caretPosition}}else{caretPosition=b}var f=caretPosition.container();var g=caretPosition.offset();if(nj(f)){if(mH(a)&&g>0){return lr(f,--g)}if(mG(a)&&g<f.length){return lr(f,++g)}d=f}else{if(mH(a)&&g>0){nextNode=nq(f,g-1);if(nm(nextNode)){if(!nn(nextNode)){innerNode=mJ(nextNode,a,no,nextNode);if(innerNode){if(nj(innerNode)){return lr(innerNode,innerNode.data.length)}return lr.after(innerNode)}}if(nj(nextNode)){return lr(nextNode,nextNode.data.length)}return lr.before(nextNode)}}if(mG(a)&&g<f.childNodes.length){nextNode=nq(f,g);if(nm(nextNode)){if(nl(nextNode)){return nt(c,nextNode)}if(!nn(nextNode)){innerNode=mJ(nextNode,a,no,nextNode);if(innerNode){if(nj(innerNode)){return lr(innerNode,0)}return lr.before(innerNode)}}if(nj(nextNode)){return lr(nextNode,0)}return lr.after(nextNode)}}d=nextNode?nextNode:caretPosition.getNode()}if(mG(a)&&caretPosition.isAtEnd()||mH(a)&&caretPosition.isAtStart()){d=mJ(d,a,bc(true),c,true);if(no(d,c)){return nr(a,d)}}nextNode=mJ(d,a,no,c);e=cW.last(bG(np(f,c),ni));if(e&&(!nextNode||!e.contains(nextNode))){if(mG(a)){caretPosition=lr.after(e)}else{caretPosition=lr.before(e)}return caretPosition}if(nextNode){return nr(a,nextNode)}return null};var nv=function(b){return{next:function(a){return nu(nh.Forwards,a,b)},prev:function(a){return nu(nh.Backwards,a,b)}}};var nw=function(a,b,c){var d=a?lr.before(c):lr.after(c);return nD(a,b,d)};var nx=function(a){return hq.isBr(a)?lr.before(a):lr.after(a)};var ny=function(a){if(lr.isTextPosition(a)){return a.offset()===0}else{return kw(a.getNode())}};var nz=function(a){if(lr.isTextPosition(a)){var b=a.container();return a.offset()===b.data.length}else{return kw(a.getNode(true))}};var nA=function(a,b){return!lr.isTextPosition(a)&&!lr.isTextPosition(b)&&a.getNode()===b.getNode(true)};var nB=function(a){return!lr.isTextPosition(a)&&hq.isBr(a.getNode())};var nC=function(a,b,c){if(a){return!nA(b,c)&&!nB(b)&&nz(b)&&ny(c)}else{return!nA(c,b)&&ny(b)&&nz(c)}};var nD=function(a,b,c){var d=nv(b);return bo.from(a?d.next(c):d.prev(c))};var nE=function(b,c,d){return nD(b,c,d).bind(function(a){if(mL(d,a,c)&&nC(b,d,a)){return nD(b,c,a)}else{return bo.some(a)}})};var nF=function(a,b){var c=a?b.firstChild:b.lastChild;if(hq.isText(c)){return bo.some(lr(c,a?0:c.data.length))}else if(c){if(kw(c)){return bo.some(a?lr.before(c):nx(c))}else{return nw(a,b,c)}}else{return bo.none()}};var nG=curry(nD,true);var nH=curry(nD,false);var nI={fromPosition:nD,nextPosition:nG,prevPosition:nH,navigate:nE,positionIn:nF,firstPositionIn:curry(nF,true),lastPositionIn:curry(nF,false)};var nJ=function(a){return typeof a.start==='string'};var nK=function(a){return a.hasOwnProperty('rng')};var nL=function(a){return a.hasOwnProperty('id')};var nM=function(a){return a.hasOwnProperty('name')};var nN=function(a){return dj.isArray(a.start)};var nO=function(a,b){if(a.isBlock(b)&&!b.innerHTML&&!co.ie){b.innerHTML='<br data-mce-bogus="1" />'}return b};var nP=function(a,b){var c,pos;c=a.createRng();pos=lF(a.getRoot(),b.start);c.setStart(pos.container(),pos.offset());pos=lF(a.getRoot(),b.end);c.setEnd(pos.container(),pos.offset());return c};var nQ=function(a,b){var c=a.ownerDocument.createTextNode(jX.ZWSP);a.appendChild(c);b.setStart(c,0);b.setEnd(c,0)};var nR=function(a){return a.hasChildNodes()===false};var nS=function(b,c){return nI.lastPositionIn(b).fold(function(){return false},function(a){c.setStart(a.container(),a.offset());c.setEnd(a.container(),a.offset());return true})};var nT=function(a,b,c){if(nR(b)&&lZ(a,b)){nQ(b,c);return true}else{return false}};var nU=function(a,b,c,d){var e=c[b?'start':'end'];var i,fH,offset,gg;var f=a.getRoot();if(e){offset=e[0];for(fH=f,i=e.length-1;i>=1;i--){gg=fH.childNodes;if(nT(f,fH,d)){return true}if(e[i]>gg.length-1){if(nT(f,fH,d)){return true}return nS(fH,d)}fH=gg[e[i]]}if(fH.nodeType===3){offset=Math.min(e[0],fH.nodeValue.length)}if(fH.nodeType===1){offset=Math.min(e[0],fH.childNodes.length)}if(b){d.setStart(fH,offset)}else{d.setEnd(fH,offset)}}return true};var nV=function(a){return hq.isText(a)&&a.data.length>0};var nW=function(b,c,d){var e=b.get(d.id+'_'+c),fH,idx,next,prev;var f=d.keep;var g,offset;if(e){fH=e.parentNode;if(c==='start'){if(!f){idx=b.nodeIndex(e)}else{if(e.hasChildNodes()){fH=e.firstChild;idx=1}else if(nV(e.nextSibling)){fH=e.nextSibling;idx=0}else if(nV(e.previousSibling)){fH=e.previousSibling;idx=e.previousSibling.data.length}else{fH=e.parentNode;idx=b.nodeIndex(e)+1}}g=fH;offset=idx}else{if(!f){idx=b.nodeIndex(e)}else{if(e.hasChildNodes()){fH=e.firstChild;idx=1}else if(nV(e.previousSibling)){fH=e.previousSibling;idx=e.previousSibling.data.length}else{fH=e.parentNode;idx=b.nodeIndex(e)}}g=fH;offset=idx}if(!f){prev=e.previousSibling;next=e.nextSibling;dj.each(dj.grep(e.childNodes),function(a){if(hq.isText(a)){a.nodeValue=a.nodeValue.replace(/\uFEFF/g,'')}});while(e=b.get(d.id+'_'+c)){b.remove(e,true)}if(prev&&next&&prev.nodeType===next.nodeType&&hq.isText(prev)&&!co.opera){idx=prev.nodeValue.length;prev.appendData(next.nodeValue);b.remove(next);if(c==='start'){g=prev;offset=idx}else{g=prev;offset=idx}}}return bo.some(lr(g,offset))}else{return bo.none()}};var nX=function(a,b){return a.isSome()?a:b};var nY=function(a,b){var c=a.createRng();if(nU(a,true,b,c)&&nU(a,false,b,c)){return bo.some(c)}else{return bo.none()}};var nZ=function(d,e){var f=nW(d,'start',e);var g=nW(d,'end',e);return kS([f,nX(g,f)],function(a,b){var c=d.createRng();c.setStart(nO(d,a.container()),a.offset());c.setEnd(nO(d,b.container()),b.offset());return c})};var oa=function(c,d){return bo.from(c.select(d.name)[d.index]).map(function(a){var b=c.createRng();b.selectNode(a);return b})};var ob=function(a,b){var c=a.dom;if(b){if(nN(b)){return nY(c,b)}else if(nJ(b)){return bo.some(nP(c,b))}else if(nL(b)){return nZ(c,b)}else if(nM(b)){return oa(c,b)}else if(nK(b)){return bo.some(b.rng)}}return bo.none()};var oc={resolve:ob};var od=function(a,b,c){return lW.getBookmark(a,b,c)};var oe=function(b,c){oc.resolve(b,c).each(function(a){b.setRng(a)})};var of=function(a){return hq.isElement(a)&&a.tagName==='SPAN'&&a.getAttribute('data-mce-type')==='bookmark'};var og={getBookmark:od,moveToBookmark:oe,isBookmarkNode:of};var oh=function(a){return a&&/^(IMG)$/.test(a.nodeName)};var oi=function(a,b,c){var d=c.startOffset;var e=c.startContainer,walker,fH,nodes;if(c.startContainer===c.endContainer){if(oh(c.startContainer.childNodes[c.startOffset])){return}}if(e.nodeType===1){nodes=e.childNodes;if(d<nodes.length){e=nodes[d];walker=new TreeWalker(e,a.getParent(e,a.isBlock))}else{e=nodes[nodes.length-1];walker=new TreeWalker(e,a.getParent(e,a.isBlock));walker.next(true)}for(fH=walker.current();fH;fH=walker.next()){if(fH.nodeType===3&&!om(fH)){c.setStart(fH,0);b.setRng(c);return}}}};var oj=function(a,b,c){if(a){b=b?'nextSibling':'previousSibling';for(a=c?a:a[b];a;a=a[b]){if(a.nodeType===1||!om(a)){return a}}}};var ok=function(a,b){if(b.nodeType){b=b.nodeName}return!!a.schema.getTextBlockElements()[b.toLowerCase()]};var ol=function(a,b,c){return a.schema.isValidChild(b,c)};var om=function(a){return a&&a.nodeType===3&&/^([\t \r\n]+|)$/.test(a.nodeValue)};var on=function(c,d){if(typeof c!=='string'){c=c(d)}else if(d){c=c.replace(/%(\w+)/g,function(a,b){return d[b]||a})}return c};var oo=function(a,b){a=a||'';b=b||'';a=''+(a.nodeName||a);b=''+(b.nodeName||b);return a.toLowerCase()===b.toLowerCase()};var op=function(a,b,c){if(c==='color'||c==='backgroundColor'){b=a.toHex(b)}if(c==='fontWeight'&&b===700){b='bold'}if(c==='fontFamily'){b=b.replace(/[\'\"]/g,'').replace(/,\s+/g,',')}return''+b};var oq=function(a,b,c){return op(a,a.getStyle(b,c),c)};var or=function(a,b){var c;a.getParent(b,function(n){c=a.getStyle(n,'text-decoration');return c&&c!=='none'});return c};var os=function(a,b,c){return a.getParents(b,c,a.getRoot())};var ot={isInlineBlock:oh,moveStart:oi,getNonWhiteSpaceSibling:oj,isTextBlock:ok,isValid:ol,isWhiteSpaceNode:om,replaceVars:on,isEq:oo,normalizeStyleValue:op,getStyle:oq,getTextDecoration:or,getParents:os};var ou=og.isBookmarkNode;var ov=ot.getParents,isWhiteSpaceNode$1=ot.isWhiteSpaceNode,isTextBlock$2=ot.isTextBlock;var ow=function(a,b){if(typeof b==='undefined'){b=a.nodeType===3?a.length:a.childNodes.length}while(a&&a.hasChildNodes()){a=a.childNodes[b];if(a){b=a.nodeType===3?a.length:a.childNodes.length}}return{node:a,offset:b}};var ox=function(a,b){var c=ow(a,b);if(c.node){while(c.node&&c.offset===0&&c.node.previousSibling){c=ow(c.node.previousSibling)}if(c.node&&c.offset>0&&c.node.nodeType===3&&c.node.nodeValue.charAt(c.offset-1)===' '){if(c.offset>1){a=c.node;a.splitText(c.offset-1)}}}return a};var oy=function(a){return a.nodeName==='BR'&&a.getAttribute('data-mce-bogus')&&!a.nextSibling};var oz=function(a,b){var c=b;while(c){if(c.nodeType===1&&a.getContentEditable(c)){return a.getContentEditable(c)==='false'?c:b}c=c.parentNode}return b};var oA=function(a,b,c,d){var e,pos2;var f=c.nodeValue;if(typeof d==='undefined'){d=a?f.length:0}if(a){e=f.lastIndexOf(' ',d);pos2=f.lastIndexOf('\xA0',d);e=e>pos2?e:pos2;if(e!==-1&&!b&&(e<d||!a)&&e<=f.length){e++}}else{e=f.indexOf(' ',d);pos2=f.indexOf('\xA0',d);e=e!==-1&&(pos2===-1||e<pos2)?e:pos2}return e};var oB=function(a,b,c,d,e,f){var g,fH,pos,lastTextNode;if(c.nodeType===3){pos=oA(e,f,c,d);if(pos!==-1){return{container:c,offset:pos}}lastTextNode=c}g=new TreeWalker(c,a.getParent(c,a.isBlock)||b);while(fH=g[e?'prev':'next']()){if(fH.nodeType===3&&!ou(fH.parentNode)){lastTextNode=fH;pos=oA(e,f,fH);if(pos!==-1){return{container:fH,offset:pos}}}else if(a.isBlock(fH)||ot.isEq(fH,'BR')){break}}if(lastTextNode){if(e){d=0}else{d=lastTextNode.length}return{container:lastTextNode,offset:d}}};var oC=function(a,b,c,d,e){var f,i,y,curFormat;if(d.nodeType===3&&d.nodeValue.length===0&&d[e]){d=d[e]}f=ov(a,d);for(i=0;i<f.length;i++){for(y=0;y<b.length;y++){curFormat=b[y];if('collapsed'in curFormat&&curFormat.collapsed!==c.collapsed){continue}if(a.is(f[i],curFormat.selector)){return f[i]}}}return d};var oD=function(b,c,d,e){var f;var g=b.dom;var h=g.getRoot();if(!c[0].wrapper){f=g.getParent(d,c[0].block,h)}if(!f){var i=g.getParent(d,'LI,TD,TH');f=g.getParent(d.nodeType===3?d.parentNode:d,function(a){return a!==h&&isTextBlock$2(b,a)},i)}if(f&&c[0].wrapper){f=ov(g,f,'ul,ol').reverse()[0]||f}if(!f){f=d;while(f[e]&&!g.isBlock(f[e])){f=f[e];if(ot.isEq(f,'br')){break}}}return f||d};var oE=function(a,b,c,d,e,f,g){var h,ga,dJ,siblingName,root;h=ga=g?c:e;siblingName=g?'previousSibling':'nextSibling';root=a.getRoot();if(h.nodeType===3&&!isWhiteSpaceNode$1(h)){if(g?d>0:f<h.nodeValue.length){return h}}while(true){if(!b[0].block_expand&&a.isBlock(ga)){return ga}for(dJ=ga[siblingName];dJ;dJ=dJ[siblingName]){if(!ou(dJ)&&!isWhiteSpaceNode$1(dJ)&&!oy(dJ)){return ga}}if(ga===root||ga.parentNode===root){h=ga;break}ga=ga.parentNode}return h};var oF=function(a,b,c,d){var e,startContainer=b.startContainer,startOffset=b.startOffset,endContainer=b.endContainer,endOffset=b.endOffset;var f=a.dom;if(startContainer.nodeType===1&&startContainer.hasChildNodes()){startContainer=kP(startContainer,startOffset);if(startContainer.nodeType===3){startOffset=0}}if(endContainer.nodeType===1&&endContainer.hasChildNodes()){endContainer=kP(endContainer,b.collapsed?endOffset:endOffset-1);if(endContainer.nodeType===3){endOffset=endContainer.nodeValue.length}}startContainer=oz(f,startContainer);endContainer=oz(f,endContainer);if(ou(startContainer.parentNode)||ou(startContainer)){startContainer=ou(startContainer)?startContainer:startContainer.parentNode;if(b.collapsed){startContainer=startContainer.previousSibling||startContainer}else{startContainer=startContainer.nextSibling||startContainer}if(startContainer.nodeType===3){startOffset=b.collapsed?startContainer.length:0}}if(ou(endContainer.parentNode)||ou(endContainer)){endContainer=ou(endContainer)?endContainer:endContainer.parentNode;if(b.collapsed){endContainer=endContainer.nextSibling||endContainer}else{endContainer=endContainer.previousSibling||endContainer}if(endContainer.nodeType===3){endOffset=b.collapsed?0:endContainer.length}}if(b.collapsed){e=oB(f,a.getBody(),startContainer,startOffset,true,d);if(e){startContainer=e.container;startOffset=e.offset}e=oB(f,a.getBody(),endContainer,endOffset,false,d);if(e){endContainer=e.container;endOffset=e.offset}}if(c[0].inline){endContainer=d?endContainer:ox(endContainer,endOffset)}if(c[0].inline||c[0].block_expand){if(!c[0].inline||(startContainer.nodeType!==3||startOffset===0)){startContainer=oE(f,c,startContainer,startOffset,endContainer,endOffset,true)}if(!c[0].inline||(endContainer.nodeType!==3||endOffset===endContainer.nodeValue.length)){endContainer=oE(f,c,startContainer,startOffset,endContainer,endOffset,false)}}if(c[0].selector&&c[0].expand!==false&&!c[0].inline){startContainer=oC(f,c,b,startContainer,'previousSibling');endContainer=oC(f,c,b,endContainer,'nextSibling')}if(c[0].block||c[0].selector){startContainer=oD(a,c,startContainer,'previousSibling');endContainer=oD(a,c,endContainer,'nextSibling');if(c[0].block){if(!f.isBlock(startContainer)){startContainer=oE(f,c,startContainer,startOffset,endContainer,endOffset,true)}if(!f.isBlock(endContainer)){endContainer=oE(f,c,startContainer,startOffset,endContainer,endOffset,false)}}}if(startContainer.nodeType===1){startOffset=f.nodeIndex(startContainer);startContainer=startContainer.parentNode}if(endContainer.nodeType===1){endOffset=f.nodeIndex(endContainer)+1;endContainer=endContainer.parentNode}return{startContainer:startContainer,startOffset:startOffset,endContainer:endContainer,endOffset:endOffset}};var oG={expandRng:oF};var oH=dj.each;var oI=function(a,b){var c=a.childNodes;b--;if(b>c.length-1){b=c.length-1}else if(b<0){b=0}return c[b]||a};var oJ=function(e,f,g){var h=f.startContainer;var i=f.startOffset;var j=f.endContainer;var k=f.endOffset;var l;var m;var n;var o;var p;var q;var r;r=e.select('td[data-mce-selected],th[data-mce-selected]');if(r.length>0){oH(r,function(a){g([a])});return}var s=function(a){var b;b=a[0];if(b.nodeType===3&&b===h&&i>=b.nodeValue.length){a.splice(0,1)}b=a[a.length-1];if(k===0&&a.length>0&&b===j&&b.nodeType===3){a.splice(a.length-1,1)}return a};var t=function(a,b,c){var d=[];for(;a&&a!==c;a=a[b]){d.push(a)}return d};var u=function(a,b){do{if(a.parentNode===b){return a}a=a.parentNode}while(a)};var v=function(a,b,c){var d=c?'nextSibling':'previousSibling';for(o=a,p=o.parentNode;o&&o!==b;o=p){p=o.parentNode;q=t(o===a?o:o[d],d);if(q.length){if(!c){q.reverse()}g(s(q))}}};if(h.nodeType===1&&h.hasChildNodes()){h=h.childNodes[i]}if(j.nodeType===1&&j.hasChildNodes()){j=oI(j,k)}if(h===j){return g(s([h]))}l=e.findCommonAncestor(h,j);for(o=h;o;o=o.parentNode){if(o===j){return v(h,l,true)}if(o===l){break}}for(o=j;o;o=o.parentNode){if(o===h){return v(j,l)}if(o===l){break}}m=u(h,l)||h;n=u(j,l)||j;v(h,m,true);q=t(m===h?m:m.nextSibling,'nextSibling',n===j?n.nextSibling:n);if(q.length){g(s(q))}v(j,n)};var oK={walk:oJ};var oL=function(){return'\uFEFF'};function NodeValue(c,d){var f=function(a){if(!c(a))throw new Error('Can only get '+d+' value of a '+d+' node');return j(a).getOr('')};var g=function(a){try{return h(a)}catch(e){return bo.none()}};var h=function(a){return c(a)?bo.from(a.dom().nodeValue):bo.none()};var i=eJ.detect().browser;var j=i.isIE()&&i.version.major===10?g:h;var k=function(a,b){if(!c(a))throw new Error('Can only set raw '+d+' value of a '+d+' node');a.dom().nodeValue=b};return{get:f,getOption:j,set:k}}var oM=NodeValue(fg,'text');var oN=function(a){return oM.get(a)};var oO=function(a){return fg(a)&&oN(a)===oL()};var oP=function(b,c,d,e){return ga(c).fold(function(){return'skipping'},function(a){if(e==='br'||oO(c)){return'valid'}else if(jF(c)){return'existing'}else if(lY(c)){return'caret'}else if(!ot.isValid(b,d,e)||!ot.isValid(b,fc(a),d)){return'invalid-child'}else{return'valid'}})};var oQ=function(a){return a.startContainer.nodeType===3&&a.startContainer.nodeValue.length>=a.startOffset&&a.startContainer.nodeValue[a.startOffset]==='\xA0'};var oR=function(a,b){var r=oG.expandRng(a,b,[{inline:true}],oQ(b));b.setStart(r.startContainer,r.startOffset);b.setEnd(r.endContainer,r.endOffset);a.selection.setRng(b)};var oS=function(a,b,c,d){var e=b.uid,uid=e===void 0?jM('mce-annotation'):e,JY=__rest(b,['uid']);var f=eP.fromTag('span',a);jq(f,jB());fs(f,''+jD(),uid);fs(f,''+jC(),c);var g=d(uid,JY),_d=g.attributes,attributes=_d===void 0?{}:_d,_e=g.classes,classes=_e===void 0?[]:_e;ft(f,attributes);jN(f,classes);return f};var oT=function(d,e,f,g,h){var i=[];var j=oS(d.getDoc(),h,f,g);var k=ji(bo.none());var l=function(){k.set(bo.none())};var m=function(){return k.get().getOrThunk(function(){var a=jP(j);i.push(a);k.set(bo.some(a));return a})};var n=function(a){bD(a,o)};var o=function(a){var b=oP(d,a,'span',fc(a));switch(b){case'invalid-child':{l();var c=gg(a);n(c);l();break}case'valid':{var w=m();ja(a,w);break}case'skipping':case'existing':case'caret':}};var p=function(a){var b=bC(a,eP.fromDom);n(b)};oK.walk(d.dom,e,function(a){l();p(a)});return i};var oU=function(e,f,g,h){e.undoManager.transact(function(){var a=e.selection.getRng();if(a.collapsed){oR(e,a)}if(e.selection.getRng().collapsed){var b=oS(e.getDoc(),h,f,g.decorate);jT(b,'\xA0');e.selection.getRng().insertNode(b.dom());e.selection.select(b.dom())}else{var c=lW.getPersistentBookmark(e.selection,false);var d=e.selection.getRng();oT(e,d,f,g.decorate,h);e.selection.moveToBookmark(c)}})};function Annotator(e){var f=jK();jJ(e,f);var g=jI(e,f);return{register:function(a,b){f.register(a,b)},annotate:function(b,c){f.lookup(b).each(function(a){oU(e,b,a,c)})},annotationChanged:function(a,b){g.addListener(a,b)},remove:function(c){jE(e,bo.some(c)).each(function(a){var b=a.elements;bD(b,jf)})},getAll:function(c){var d=jH(e,c);return fm(d,function(b){return bC(b,function(a){return a.dom()})})}}}var oV=function(a){return a.firstChild&&a.firstChild===a.lastChild};var oW=function(a){return a.name==='br'||a.value==='\xA0'};var oX=function(a,b){var c=a.getBlockElements();return c[b.name]&&oV(b)&&oW(b.firstChild)};var oY=function(a,b){var c=a.getNonEmptyElements();return b&&(b.isEmpty(c)||oX(a,b))};var oZ=function(a,b){var c=b.firstChild;var d=b.lastChild;if(c&&c.name==='meta'){c=c.next}if(d&&d.attr('id')==='mce_marker'){d=d.prev}if(oY(a,d)){d=d.prev}if(!c||c!==d){return false}return c.name==='ul'||c.name==='ol'};var pb=function(a){var b=a.firstChild;var c=a.lastChild;if(b&&b.nodeName==='META'){b.parentNode.removeChild(b)}if(c&&c.id==='mce_marker'){c.parentNode.removeChild(c)}return a};var pc=function(a,b,c){var d=b.serialize(c);var e=a.createFragment(d);return pb(e)};var pd=function(b){return dj.grep(b.childNodes,function(a){return a.nodeName==='LI'})};var pf=function(a){return a.data==='\xA0'||hq.isBr(a)};var pg=function(a){return a&&a.firstChild&&a.firstChild===a.lastChild&&pf(a.firstChild)};var ph=function(a){return!a.firstChild||pg(a)};var pj=function(a){return a.length>0&&ph(a[a.length-1])?a.slice(0,-1):a};var pk=function(a,b){var c=a.getParent(b,a.isBlock);return c&&c.nodeName==='LI'?c:null};var pl=function(a,b){return!!pk(a,b)};var pm=function(a,b){var c=b.cloneRange();var d=b.cloneRange();c.setStartBefore(a);d.setEndAfter(a);return[c.cloneContents(),d.cloneContents()]};var pn=function(a,b){var c=lr.before(a);var d=nv(b);var e=d.next(c);return e?e.toRange():null};var po=function(a,b){var c=lr.after(a);var d=nv(b);var e=d.prev(c);return e?e.toRange():null};var pp=function(b,c,d,e){var f=pm(b,e);var g=b.parentNode;g.insertBefore(f[0],b);dj.each(c,function(a){g.insertBefore(a,b)});g.insertBefore(f[1],b);g.removeChild(b);return po(c[c.length-1],d)};var pq=function(b,c,d){var e=b.parentNode;dj.each(c,function(a){e.insertBefore(a,b)});return pn(b,d)};var pr=function(a,b,c,d){d.insertAfter(b.reverse(),a);return po(b[0],c)};var ps=function(e,f,g,h){var i=pc(f,e,h);var j=pk(f,g.startContainer);var k=pj(pd(i.firstChild));var l=1,END=2;var m=f.getRoot();var n=function(a){var b=lr.fromRangeStart(g);var c=nv(f.getRoot());var d=a===l?c.prev(b):c.next(b);return d?pk(f,d.getNode())!==j:true};if(n(l)){return pq(j,k,m)}else if(n(END)){return pr(j,k,m,f)}return pp(j,k,m,g)};var pt={isListFragment:oZ,insertAtCaret:ps,isParentBlockLi:pl,trimListItems:pj,listItems:pd};var pu=dj.each;var pv=function(i){this.compare=function(e,f){if(e.nodeName!==f.nodeName){return false}var g=function(c){var d={};pu(i.getAttribs(c),function(a){var b=a.nodeName.toLowerCase();if(b.indexOf('_')!==0&&b!=='style'&&b.indexOf('data-')!==0){d[b]=i.getAttrib(c,b)}});return d};var h=function(a,b){var c,fc;for(fc in a){if(a.hasOwnProperty(fc)){c=b[fc];if(typeof c==='undefined'){return false}if(a[fc]!==c){return false}delete b[fc]}}for(fc in b){if(b.hasOwnProperty(fc)){return false}}return true};if(!h(g(e),g(f))){return false}if(!h(i.parseStyle(i.getAttrib(e,'style')),i.parseStyle(i.getAttrib(f,'style')))){return false}return!og.isBookmarkNode(e)&&!og.isBookmarkNode(f)}};var pw=function(a){var b=[];var c=a.dom();while(c){b.push(eP.fromDom(c));c=c.lastChild}return b};var px=function(a){var b=jv(a,'br');var c=bG(pw(a).slice(-1),gQ);if(b.length===c.length){bD(c,je)}};var py=function(a){jd(a);iZ(a,eP.fromHtml('<br data-mce-bogus="1">'))};var pz=function(a){return fg(a)?oN(a)==='\xA0':gQ(a)};var pA=function(a){return bG(gg(a),pz).length===1};var pB=function(c){gj(c).each(function(b){gc(b).each(function(a){if(gO(c)&&gQ(b)&&gO(a)){je(b)}})})};var pC={removeTrailingBr:px,fillWithPaddingBr:py,isPaddedElement:pA,trimBlockTrailingBr:pB};var pD=dj.makeMap;function Writer(d){var e=[];var f,indentBefore,indentAfter,encode,htmlOutput;d=d||{};f=d.indent;indentBefore=pD(d.indent_before||'');indentAfter=pD(d.indent_after||'');encode=hK.getEncodeFunc(d.entity_encoding||'raw',d.entities);htmlOutput=d.element_format==='html';return{start:function(a,b,c){var i,l,attr,value;if(f&&indentBefore[a]&&e.length>0){value=e[e.length-1];if(value.length>0&&value!=='\n'){e.push('\n')}}e.push('<',a);if(b){for(i=0,l=b.length;i<l;i++){attr=b[i];e.push(' ',attr.name,'="',encode(attr.value,true),'"')}}if(!c||htmlOutput){e[e.length]='>'}else{e[e.length]=' />'}if(c&&f&&indentAfter[a]&&e.length>0){value=e[e.length-1];if(value.length>0&&value!=='\n'){e.push('\n')}}},end:function(a){var b;e.push('</',a,'>');if(f&&indentAfter[a]&&e.length>0){b=e[e.length-1];if(b.length>0&&b!=='\n'){e.push('\n')}}},text:function(a,b){if(a.length>0){e[e.length]=b?a:encode(a)}},cdata:function(a){e.push('<![CDATA[',a,']]>')},comment:function(a){e.push('<!--',a,'-->')},pi:function(a,b){if(b){e.push('<?',a,' ',encode(b),'?>')}else{e.push('<?',a,'?>')}if(f){e.push('\n')}},doctype:function(a){e.push('<!DOCTYPE',a,'>',f?'\n':'')},reset:function(){e.length=0},getContent:function(){return e.join('').replace(/\n$/,'')}}}function Serializer(g,h){if(h===void 0){h=Schema()}var j=Writer(g);g=g||{};g.validate='validate'in g?g.validate:true;var k=function(d){var e,wJ;wJ=g.validate;e={3:function(a){j.text(a.value,a.raw)},8:function(a){j.comment(a.value)},7:function(a){j.pi(a.name,a.value)},10:function(a){j.doctype(a.value)},4:function(a){j.cdata(a.value)},11:function(a){if(a=a.firstChild){do{f(a)}while(a=a.next)}}};j.reset();var f=function(a){var b=e[a.type];var c,nR,attrs,attrName,attrValue,sortedAttrs,i,l,elementRule;if(!b){c=a.name;nR=a.shortEnded;attrs=a.attributes;if(wJ&&attrs&&attrs.length>1){sortedAttrs=[];sortedAttrs.map={};elementRule=h.getElementRule(a.name);if(elementRule){for(i=0,l=elementRule.attributesOrder.length;i<l;i++){attrName=elementRule.attributesOrder[i];if(attrName in attrs.map){attrValue=attrs.map[attrName];sortedAttrs.map[attrName]=attrValue;sortedAttrs.push({name:attrName,value:attrValue})}}for(i=0,l=attrs.length;i<l;i++){attrName=attrs[i].name;if(!(attrName in sortedAttrs.map)){attrValue=attrs.map[attrName];sortedAttrs.map[attrName]=attrValue;sortedAttrs.push({name:attrName,value:attrValue})}}attrs=sortedAttrs}}j.start(a.name,attrs,nR);if(!nR){if(a=a.firstChild){do{f(a)}while(a=a.next)}j.end(c)}}else{b(a)}};if(d.type===1&&!g.inner){f(d)}else{e[11](d)}return j.getContent()};return{serialize:k}}var pE=function(a,b,c,d){var e=document.createRange();e.setStart(a,b);e.setEnd(c,d);return e};var pF=function(b){var c=lr.fromRangeStart(b);var d=lr.fromRangeEnd(b);var e=b.commonAncestorContainer;return nI.fromPosition(false,e,d).map(function(a){if(!mL(c,d,e)&&mL(c,a,e)){return pE(c.container(),c.offset(),a.container(),a.offset())}else{return b}}).getOr(b)};var pG=function(a){return a.collapsed?a:pF(a)};var pH={normalize:pG};var pI=function(a,b){return hq.isText(a)&&a.nodeValue[b-1]==='\xA0'};var pJ=function(b,c){var d,offset;d=b.startContainer;offset=b.startOffset;var e=function(a){return d[a]&&d[a].nodeType===3};if(d.nodeType===3){if(offset>0){c=c.replace(/^&nbsp;/,' ')}else if(!e('previousSibling')){c=c.replace(/^ /,'&nbsp;')}if(offset<d.length){c=c.replace(/&nbsp;(<br>|)$/,' ')}else if(!e('nextSibling')){c=c.replace(/(&nbsp;| )(<br>|)$/,'&nbsp;')}}return c};var pK=function(a,b){var c,offset;c=a.startContainer;offset=a.startOffset;if(c.nodeType===3&&a.collapsed){if(c.data[offset]==='\xA0'){c.deleteData(offset,1);if(!/[\u00a0| ]$/.test(b)){b+=' '}}else if(c.data[offset-1]==='\xA0'){c.deleteData(offset-1,1);if(!/[\u00a0| ]$/.test(b)){b=' '+b}}}return b};var pL=hq.matchNodeNames('td th');var pM=function(a,b){var c=a.selection.getRng();var d=c.startContainer;var e=c.startOffset;if(c.collapsed&&pI(d,e)&&hq.isText(d)){d.insertData(e-1,' ');d.deleteData(e,1);c.setStart(d,e);c.setEnd(d,e);a.selection.setRng(c)}a.selection.setContent(b)};var pN=function(a,b,c){if(c.getAttribute('data-mce-bogus')==='all'){c.parentNode.insertBefore(a.dom.createFragment(b),c)}else{var d=c.firstChild;var e=c.lastChild;if(!d||d===e&&d.nodeName==='BR'){a.dom.setHTML(c,b)}else{pM(a,b)}}};var pO=function(a,b){bo.from(a.getParent(b,'td,th')).map(eP.fromDom).each(pC.trimBlockTrailingBr)};var pP=function(c,d){var e=c.schema.getTextInlineElements();var f=c.dom;if(d){var g=c.getBody(),elementUtils_1=new pv(f);dj.each(f.select('*[data-mce-fragment]'),function(a){for(var b=a.parentNode;b&&b!==g;b=b.parentNode){if(e[a.nodeName.toLowerCase()]&&elementUtils_1.compare(b,a)){f.remove(a,true)}}})}};var pQ=function(a){var b=a;while(b=b.walk()){if(b.type===1){b.attr('data-mce-fragment','1')}}};var pR=function(b){dj.each(b.getElementsByTagName('*'),function(a){a.removeAttribute('data-mce-fragment')})};var pS=function(a){return!!a.getAttribute('data-mce-fragment')};var pT=function(a,b){return b&&!a.schema.getShortEndedElements()[b.nodeName]};var pU=function(d,e){var f,parentBlock,nextRng;var g=d.dom,selection=d.selection;var h,node2;var i=function(a){var b=d.getBody();for(;a&&a!==b;a=a.parentNode){if(d.dom.getContentEditable(a)==='false'){return a}}return null};if(!e){return}d.selection.scrollIntoView(e);f=i(e);if(f){g.remove(e);selection.select(f);return}var j=g.createRng();h=e.previousSibling;if(h&&h.nodeType===3){j.setStart(h,h.nodeValue.length);if(!co.ie){node2=e.nextSibling;if(node2&&node2.nodeType===3){h.appendData(node2.data);node2.parentNode.removeChild(node2)}}}else{j.setStartBefore(e);j.setEndBefore(e)}var k=function(a){var b=lr.fromRangeStart(a);var c=nv(d.getBody());b=c.next(b);if(b){return b.toRange()}};parentBlock=g.getParent(e,g.isBlock);g.remove(e);if(parentBlock&&g.isEmpty(parentBlock)){d.$(parentBlock).empty();j.setStart(parentBlock,0);j.setEnd(parentBlock,0);if(!pL(parentBlock)&&!pS(parentBlock)&&(nextRng=k(j))){j=nextRng;g.remove(parentBlock)}else{g.add(parentBlock,g.create('br',{'data-mce-bogus':'1'}))}}selection.setRng(j)};var pV=function(a,b,c){var d,serializer,parentNode,rootNode,fragment,args;var e,rng,fH,bookmarkHtml,CI;var f=a.selection,Cu=a.dom;if(/^ | $/.test(b)){b=pJ(f.getRng(),b)}d=a.parser;CI=c.merge;serializer=Serializer({validate:a.settings.validate},a.schema);bookmarkHtml='<span id="mce_marker" data-mce-type="bookmark">&#xFEFF;&#x200B;</span>';args={content:b,format:'html',selection:true,paste:c.paste};args=a.fire('BeforeSetContent',args);if(args.isDefaultPrevented()){a.fire('SetContent',{content:args.content,format:'html',selection:true,paste:c.paste});return}b=args.content;if(b.indexOf('{$caret}')===-1){b+='{$caret}'}b=b.replace(/\{\$caret\}/,bookmarkHtml);rng=f.getRng();var g=rng.startContainer||(rng.parentElement?rng.parentElement():null);var h=a.getBody();if(g===h&&f.isCollapsed()){if(Cu.isBlock(h.firstChild)&&pT(a,h.firstChild)&&Cu.isEmpty(h.firstChild)){rng=Cu.createRng();rng.setStart(h.firstChild,0);rng.setEnd(h.firstChild,0);f.setRng(rng)}}if(!f.isCollapsed()){a.selection.setRng(pH.normalize(a.selection.getRng()));a.getDoc().execCommand('Delete',false,null);b=pK(a.selection.getRng(),b)}parentNode=f.getNode();var i={context:parentNode.nodeName.toLowerCase(),data:c.data,insert:true};fragment=d.parse(b,i);if(c.paste===true&&pt.isListFragment(a.schema,fragment)&&pt.isParentBlockLi(Cu,parentNode)){rng=pt.insertAtCaret(serializer,Cu,a.selection.getRng(),fragment);a.selection.setRng(rng);a.fire('SetContent',args);return}pQ(fragment);fH=fragment.lastChild;if(fH.attr('id')==='mce_marker'){e=fH;for(fH=fH.prev;fH;fH=fH.walk(true)){if(fH.type===3||!Cu.isBlock(fH.name)){if(a.schema.isValidChild(fH.parent.name,'span')){fH.parent.insert(e,fH,fH.name==='br')}break}}}a._selectionOverrides.showBlockCaretContainer(parentNode);if(!i.invalid){b=serializer.serialize(fragment);pN(a,b,parentNode)}else{pM(a,bookmarkHtml);parentNode=f.getNode();rootNode=a.getBody();if(parentNode.nodeType===9){parentNode=fH=rootNode}else{fH=parentNode}while(fH!==rootNode){parentNode=fH;fH=fH.parentNode}b=parentNode===rootNode?rootNode.innerHTML:Cu.getOuterHTML(parentNode);b=serializer.serialize(d.parse(b.replace(/<span (id="mce_marker"|id=mce_marker).+?<\/span>/i,function(){return serializer.serialize(fragment)})));if(parentNode===rootNode){Cu.setHTML(rootNode,b)}else{Cu.setOuterHTML(parentNode,b)}}pP(a,CI);pU(a,Cu.get('mce_marker'));pR(a.getBody());pO(a.dom,a.selection.getStart());a.fire('SetContent',args);a.addVisual()};var pW=function(a){var b;if(typeof a!=='string'){b=dj.extend({paste:a.paste,data:{paste:a.paste}},a);return{content:a.content,details:b}}return{content:a,details:{}}};var pX=function(a,b){var c=pW(b);pV(a,c.content,c.details)};var pY={insertAtCaret:pX};var pZ=fE('sections','settings');var qa=eJ.detect();var qb=qa.deviceType.isTouch();var qc=['lists','autolink','autosave'];var qd={theme:'mobile'};var qe=function(b){var c=bt(b)?b.join(' '):b;var d=bC(br(c)?c.split(' '):[],ew);return bG(d,function(a){return a.length>0})};var qf=function(a){return bG(a,curry(bA,qc))};var qg=function(c,d){var e=fp(d,function(a,b){return bA(c,b)});return pZ(e.t,e.f)};var qh=function(a,b,c){var d=a.sections();var e=d.hasOwnProperty(b)?d[b]:{};return dj.extend({},c,e)};var qi=function(a,b){return a.sections().hasOwnProperty(b)};var qj=function(a,b,c){return{id:a,theme:'modern',delta_width:0,delta_height:0,popup_css:'',plugins:'',document_base_url:b,add_form_submit_trigger:true,submit_patch:true,add_unload_trigger:true,convert_urls:true,relative_urls:true,remove_script_host:true,object_resizing:true,doctype:'<!DOCTYPE html>',visual:true,font_size_style_values:'xx-small,x-small,small,medium,large,x-large,xx-large',font_size_legacy_values:'xx-small,small,medium,large,x-large,xx-large,300%',forced_root_block:'p',hidden_input:true,render_ui:true,indentation:'40px',inline_styles:true,convert_fonts_to_spans:true,indent:'simple',indent_before:'p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,'+'tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist',indent_after:'p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,'+'tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist',entity_encoding:'named',url_converter:c.convertURL,url_converter_scope:c,ie7_compat:true}};var qk=function(a,b){var c=b.external_plugins?b.external_plugins:{};if(a&&a.external_plugins){return dj.extend({},a.external_plugins,c)}else{return c}};var ql=function(a,b){return[].concat(qe(a)).concat(qe(b))};var qm=function(a,b,c,d){var e=qe(c.forced_plugins);var f=qe(d.plugins);var g=a&&qi(b,'mobile')?qf(f):f;var h=ql(e,g);return dj.extend(d,{plugins:h.join(' ')})};var qn=function(a,b){var c=b.settings().inline;return a&&qi(b,'mobile')&&!c};var qo=function(a,b,c,d){var e=qg(['mobile'],d);var f=dj.extend(b,c,e.settings(),qn(a,e)?qh(e,'mobile',qd):{},{validate:true,content_editable:e.settings().inline,external_plugins:qk(c,e.settings())});return qm(a,e,c,f)};var qp=function(a,b,c,d,e){var f=qj(b,c,a);return qo(qb,f,d,e)};var qq=function(a,b,c){return bo.from(b.settings[c]).filter(a)};var qr=curry(qq,br);var qs=function(c){var d={};if(typeof c==='string'){bD(c.indexOf('=')>0?c.split(/[;,](?![^=;,]*(?:[;,]|$))/):c.split(','),function(a){var b=a.split('=');if(b.length>1){d[dj.trim(b[0])]=dj.trim(b[1])}else{d[dj.trim(b[0])]=dj.trim(b)}})}else{d=c}return d};var qt=function(p){return function(a){return bt(a)&&bP(a,p)}};var qu=function(a,b,c,d){var e=b in a.settings?a.settings[b]:c;if(d==='hash'){return qs(e)}else if(d==='string'){return qq(br,a,b).getOr(c)}else if(d==='number'){return qq(bx,a,b).getOr(c)}else if(d==='boolean'){return qq(bv,a,b).getOr(c)}else if(d==='object'){return qq(bs,a,b).getOr(c)}else if(d==='array'){return qq(bt,a,b).getOr(c)}else if(d==='string[]'){return qq(qt(br),a,b).getOr(c)}else if(d==='function'){return qq(bw,a,b).getOr(c)}else{return e}};var qv=/[\u0591-\u07FF\uFB1D-\uFDFF\uFE70-\uFEFC]/;var qw=function(a){return qv.test(a)};var qx=function(a,b){var c=qr(a,'inline_boundaries_selector').getOr('a[href],code');return fO(eP.fromDom(b),c)};var qy=function(a){return iQ.DOM.getStyle(a,'direction',true)==='rtl'||qw(a.textContent)};var qz=function(a,b,c){return bG(iQ.DOM.getParents(c.container(),'*',b),a)};var qA=function(a,b,c){var d=qz(a,b,c);return bo.from(d[d.length-1])};var qB=function(a,b,c){var d=mK(b,a);var e=mK(c,a);return d&&d===e};var qC=function(a){return kf(a)||kg(a)};var qD=function(a,b){var c=b.container(),offset=b.offset();if(a){if(kb(c)){if(hq.isText(c.nextSibling)){return lr(c.nextSibling,0)}else{return lr.after(c)}}else{return kf(b)?lr(c,offset+1):b}}else{if(kb(c)){if(hq.isText(c.previousSibling)){return lr(c.previousSibling,c.previousSibling.data.length)}else{return lr.before(c)}}else{return kg(b)?lr(c,offset-1):b}}};var qE=curry(qD,true);var qF=curry(qD,false);var qG={isInlineTarget:qx,findRootInline:qA,isRtl:qy,isAtZwsp:qC,normalizePosition:qD,normalizeForwards:qE,normalizeBackwards:qF,hasSameParentBlock:qB};var qH=function(b){return function(a){return fS(b,eP.fromDom(a.dom().parentNode))}};var qI=function(b,c){return fW(b,c)?jx(c,function(a){return gR(a)||gT(a)},qH(b)):bo.none()};var qJ=function(a){var b=a.getBody();var c=b.firstChild&&a.dom.isBlock(b.firstChild)?b.firstChild:b;a.selection.setCursorLocation(c,0)};var qK=function(a){if(a.dom.isEmpty(a.getBody())){a.setContent('');qJ(a)}};var qL=function(g,h,i){return kS([nI.firstPositionIn(i),nI.lastPositionIn(i)],function(b,c){var d=qG.normalizePosition(true,b);var e=qG.normalizePosition(false,c);var f=qG.normalizePosition(false,h);if(g){return nI.nextPosition(i,f).map(function(a){return a.isEqual(e)&&h.isEqual(d)}).getOr(false)}else{return nI.prevPosition(i,f).map(function(a){return a.isEqual(d)&&h.isEqual(e)}).getOr(false)}}).getOr(true)};var qM={getParentBlock:qI,paddEmptyBody:qK,willDeleteLastPositionInElement:qL};var qN=function(a,b,c){return jy(a,b,c).isSome()};var qO=function(a,b){var c=eP.fromDom(a);var d=eP.fromDom(b);return qN(d,'pre,code',curry(fS,c))};var qP=function(a,b){return hq.isText(b)&&/^[ \t\r\n]*$/.test(b.data)&&qO(a,b)===false};var qQ=function(a){return hq.isElement(a)&&a.nodeName==='A'&&a.hasAttribute('name')};var qR=function(a,b){return kw(b)&&qP(a,b)===false||qQ(b)||qS(b)};var qS=hq.hasAttribute('data-mce-bookmark');var qT=hq.hasAttribute('data-mce-bogus');var qU=hq.hasAttributeValue('data-mce-bogus','all');var qV=function(a){var b,fH,brCount=0;if(qR(a,a)){return false}else{fH=a.firstChild;if(!fH){return true}b=new TreeWalker(fH,a);do{if(qU(fH)){fH=b.next(true);continue}if(qT(fH)){fH=b.next();continue}if(hq.isBr(fH)){brCount++;fH=b.next();continue}if(qR(a,fH)){return false}fH=b.next()}while(fH);return brCount<=1}};var qW=function(a){return qV(a.dom())};var qX={isEmpty:qW};var qY=fE('block','position');var qZ=fE('from','to');var ra=function(b,c){var d=eP.fromDom(b);var e=eP.fromDom(c.container());return qM.getParentBlock(d,e).map(function(a){return qY(a,c)})};var rb=function(a){return fS(a.from().block(),a.to().block())===false};var rc=function(c){return ga(c.from().block()).bind(function(b){return ga(c.to().block()).filter(function(a){return fS(b,a)})}).isSome()};var rd=function(a){return hq.isContentEditableFalse(a.from().block())===false&&hq.isContentEditableFalse(a.to().block())===false};var rf=function(c,d,e){if(hq.isBr(e.position().getNode())&&qX.isEmpty(e.block())===false){return nI.positionIn(false,e.block().dom()).bind(function(b){if(b.isEqual(e.position())){return nI.fromPosition(d,c,b).bind(function(a){return ra(c,a)})}else{return bo.some(e)}}).getOr(e)}else{return e}};var rg=function(d,e,f){var g=ra(d,lr.fromRangeStart(f));var h=g.bind(function(c){return nI.fromPosition(e,d,c.position()).bind(function(b){return ra(d,b).map(function(a){return rf(d,e,a)})})});return kS([g,h],qZ).filter(function(a){return rb(a)&&rc(a)&&rd(a)})};var rh=function(a,b,c){return c.collapsed?rg(a,b,c):bo.none()};var ri={read:rh};var rj=function(a){return a.slice(0,-1)};var rk=function(b,c,d){if(fW(c,b)){return rj(gb(b,function(a){return d(a)||fS(a,c)}))}else{return[]}};var rl=function(a,b){return rk(a,b,bc(false))};var rm=function(a,b){return[a].concat(rl(a,b))};var rn={parentsUntil:rk,parents:rl,parentsAndSelf:rm};var ro=function(b){var c=gg(b);return bK(c,gO).fold(function(){return c},function(a){return c.slice(0,a)})};var rp=function(a){var b=ro(a);bD(b,je);return b};var rq=function(a,b){var c=rn.parentsAndSelf(b,a);return bJ(c.reverse(),qX.isEmpty).each(je)};var rr=function(b){return bG(ge(b),function(a){return!qX.isEmpty(a)}).length===0};var rs=function(b,c,d,e){if(qX.isEmpty(d)){pC.fillWithPaddingBr(d);return nI.firstPositionIn(d.dom())}if(rr(e)&&qX.isEmpty(c)){iW(e,eP.fromTag('br'))}var f=nI.prevPosition(d.dom(),lr.before(e.dom()));bD(rp(c),function(a){iW(e,a)});rq(b,c);return f};var rt=function(b,c,d){if(qX.isEmpty(d)){je(d);if(qX.isEmpty(c)){pC.fillWithPaddingBr(c)}return nI.firstPositionIn(c.dom())}var e=nI.lastPositionIn(d.dom());bD(rp(c),function(a){iZ(d,a)});rq(b,c);return e};var ru=function(a,b){var c=rn.parentsAndSelf(b,a);return bo.from(c[c.length-1])};var rv=function(a,b){return fW(b,a)?ru(b,a):bo.none()};var rw=function(b,c){nI.positionIn(b,c.dom()).map(function(a){return a.getNode()}).map(eP.fromDom).filter(gQ).each(je)};var rx=function(a,b,c){rw(true,b);rw(false,c);return rv(b,c).fold(curry(rt,a,b,c),curry(rs,a,b,c))};var ry=function(a,b,c,d){return b?rx(a,d,c):rx(a,c,d)};var rz={mergeBlocks:ry};var rA=function(b,c){var d;var e=eP.fromDom(b.getBody());d=ri.read(e.dom(),c,b.selection.getRng()).bind(function(a){return rz.mergeBlocks(e,c,a.from().block(),a.to().block())});d.each(function(a){b.selection.setRng(a.toRange())});return d.isSome()};var rB={backspaceDelete:rA};var rC=function(d,e){var f=e.getRng();return kS([qM.getParentBlock(d,eP.fromDom(f.startContainer)),qM.getParentBlock(d,eP.fromDom(f.endContainer))],function(b,c){if(fS(b,c)===false){f.deleteContents();rz.mergeBlocks(d,true,b,c).each(function(a){e.setRng(a.toRange())});return true}else{return false}}).getOr(false)};var rD=function(a,b){var c=eP.fromDom(b);var d=curry(fS,a);return jw(c,gW,d).isSome()};var rE=function(a,b){return rD(a,b.startContainer)||rD(a,b.endContainer)};var rF=function(a,b){var c=nI.prevPosition(a.dom(),lr.fromRangeStart(b)).isNone();var d=nI.nextPosition(a.dom(),lr.fromRangeEnd(b)).isNone();return!rE(a,b)&&c&&d};var rG=function(a){a.setContent('');a.selection.setCursorLocation();return true};var rH=function(a){var b=eP.fromDom(a.getBody());var c=a.selection.getRng();return rF(b,c)?rG(a):rC(b,a.selection)};var rI=function(a,b){return a.selection.isCollapsed()?false:rH(a)};var rJ={backspaceDelete:rI};var rK=function(n){if(!bt(n)){throw new Error('cases must be an array');}if(n.length===0){throw new Error('there must be at least one case');}var o=[];var p={};bD(n,function(h,j){var k=fh(h);if(k.length!==1){throw new Error('one and only one name per case');}var l=k[0];var m=h[l];if(p[l]!==undefined){throw new Error('duplicate key detected:'+l);}else if(l==='cata'){throw new Error('cannot have a case named cata (sorry)');}else if(!bt(m)){throw new Error('case arguments must be an array');}o.push(l);p[l]=function(){var e=arguments.length;if(e!==m.length){throw new Error('Wrong number of arguments to case '+l+'. Expected '+m.length+' ('+m+'), got '+e);}var f=new Array(e);for(var i=0;i<f.length;i++)f[i]=arguments[i];var g=function(b){var c=fh(b);if(o.length!==c.length){throw new Error('Wrong number of arguments to match. Expected: '+o.join(',')+'\nActual: '+c.join(','));}var d=bP(o,function(a){return bA(c,a)});if(!d)throw new Error('Not all branches were specified when using match. Specified: '+c.join(', ')+'\nRequired: '+o.join(', '));return b[l].apply(null,f)};return{fold:function(){if(arguments.length!==n.length){throw new Error('Wrong number of arguments to fold. Expected '+n.length+', got '+arguments.length);}var a=arguments[j];return a.apply(null,f)},match:g,log:function(a){console.log(a,{constructors:o,constructor:l,params:f})}}}});return p};var rL={generate:rK};var rM=function(a){return nf(a).exists(gQ)};var rN=function(a,b,c){var d=bG(rn.parentsAndSelf(eP.fromDom(c.container()),b),gO);var e=bV(d).getOr(b);return nI.fromPosition(a,e.dom(),c).filter(rM)};var rO=function(a,b){return nf(b).exists(gQ)||rN(true,a,b).isSome()};var rP=function(a,b){return ng(b).exists(gQ)||rN(false,a,b).isSome()};var rQ=curry(rN,false);var rR=curry(rN,true);var rS=function(a){return gW(eP.fromDom(a))||gT(eP.fromDom(a))};var rT=rL.generate([{remove:['element']},{moveToElement:['element']},{moveToPosition:['position']}]);var rU=function(a,b){var c=b.getNode(a===false);var d=a?'after':'before';return hq.isElement(c)&&c.getAttribute('data-mce-caret')===d};var rV=function(b,c,d,e){var f=function(a){return gP(eP.fromDom(a))&&!mL(d,e,b)};return mV(!c,d).fold(function(){return mV(c,e).fold(bc(false),f)},f)};var rW=function(b,c,d,e){var f=e.getNode(c===false);return qM.getParentBlock(eP.fromDom(b),eP.fromDom(d.getNode())).map(function(a){return qX.isEmpty(a)?rT.remove(a.dom()):rT.moveToElement(f)}).orThunk(function(){return bo.some(rT.moveToElement(f))})};var rX=function(b,c,d){return nI.fromPosition(c,b,d).bind(function(a){if(rS(a.getNode())){return bo.none()}else if(rV(b,c,d,a)){return bo.none()}else if(c&&hq.isContentEditableFalse(a.getNode())){return rW(b,c,d,a)}else if(c===false&&hq.isContentEditableFalse(a.getNode(true))){return rW(b,c,d,a)}else if(c&&mY(d)){return bo.some(rT.moveToPosition(a))}else if(c===false&&mX(d)){return bo.some(rT.moveToPosition(a))}else{return bo.none()}})};var rY=function(a,b){if(a&&hq.isContentEditableFalse(b.nextSibling)){return bo.some(rT.moveToElement(b.nextSibling))}else if(a===false&&hq.isContentEditableFalse(b.previousSibling)){return bo.some(rT.moveToElement(b.previousSibling))}else{return bo.none()}};var rZ=function(b,c,d){return d.fold(function(a){return bo.some(rT.remove(a))},function(a){return bo.some(rT.moveToElement(a))},function(a){if(mL(c,a,b)){return bo.none()}else{return bo.some(rT.moveToPosition(a))}})};var sa=function(b,c,d){if(rU(c,d)){return rY(c,d.getNode(c===false)).fold(function(){return rX(b,c,d)},bo.some)}else{return rX(b,c,d).bind(function(a){return rZ(b,d,a)})}};var sb=function(b,c,d){var e=mS(c?1:-1,b,d);var f=lr.fromRangeStart(e);var g=eP.fromDom(b);if(c===false&&mY(f)){return bo.some(rT.remove(f.getNode(true)))}else if(c&&mX(f)){return bo.some(rT.remove(f.getNode()))}else if(c===false&&mX(f)&&rP(g,f)){return rQ(g,f).map(function(a){return rT.remove(a.getNode())})}else if(c&&mY(f)&&rO(g,f)){return rR(g,f).map(function(a){return rT.remove(a.getNode())})}else{return sa(b,c,f)}};var sc=function(c){return' \f\n\r\t\x0B'.indexOf(c)!==-1};var sd=function(b,d,e){var f=bI(b.split(''),function(a,c){if(sc(c)||c==='\xA0'){if(a.previousCharIsSpace||a.str===''&&d||a.str.length===b.length-1&&e){return{previousCharIsSpace:false,str:a.str+'\xA0'}}else{return{previousCharIsSpace:true,str:a.str+' '}}}else{return{previousCharIsSpace:false,str:a.str+c}}},{previousCharIsSpace:false,str:''});return f.str};var se=function(a,b,c){if(c===0){return}var d=a.data.slice(b,b+c);var e=b+c>=a.data.length;var f=b===0;a.replaceData(b,c,sd(d,f,e))};var sf=function(a,b){var c=a.data.slice(b);var d=c.length-ez(c).length;return se(a,b,d)};var sg=function(a,b){var c=a.data.slice(0,b);var d=c.length-eA(c).length;return se(a,b-d,d)};var sh=function(a,b,c){var d=eA(a.data).length;a.appendData(b.data);je(eP.fromDom(b));if(c){sf(a,d)}return a};var si=function(a,b){var c=a.container();var d=a.offset();return lr.isTextPosition(a)===false&&c===b.parentNode&&d>lr.before(b).offset()};var sj=function(a,b){return si(b,a)?lr(b.container(),b.offset()-1):b};var sk=function(a){return hq.isText(a)?lr(a,0):lr.before(a)};var sl=function(a){return hq.isText(a)?lr(a,a.data.length):lr.after(a)};var sm=function(a){if(kw(a.previousSibling)){return bo.some(sl(a.previousSibling))}else{return a.previousSibling?nI.lastPositionIn(a.previousSibling):bo.none()}};var sn=function(a){if(kw(a.nextSibling)){return bo.some(sk(a.nextSibling))}else{return a.nextSibling?nI.firstPositionIn(a.nextSibling):bo.none()}};var sp=function(a,b){var c=lr.before(b.previousSibling?b.previousSibling:b.parentNode);return nI.prevPosition(a,c).fold(function(){return nI.nextPosition(a,lr.after(b))},bo.some)};var sq=function(a,b){return nI.nextPosition(a,lr.after(b)).fold(function(){return nI.prevPosition(a,lr.before(b))},bo.some)};var sr=function(a,b){return sm(b).orThunk(function(){return sn(b)}).orThunk(function(){return sp(a,b)})};var ss=function(a,b){return sn(b).orThunk(function(){return sm(b)}).orThunk(function(){return sq(a,b)})};var st=function(a,b,c){return a?ss(b,c):sr(b,c)};var su=function(a,b,c){return st(a,b,c).map(curry(sj,c))};var sv=function(b,c,d){d.fold(function(){b.focus()},function(a){b.selection.setRng(a.toRange(),c)})};var sw=function(b){return function(a){return a.dom()===b}};var sx=function(a,b){return b&&a.schema.getBlockElements().hasOwnProperty(fc(b))};var sz=function(a){if(qX.isEmpty(a)){var b=eP.fromHtml('<br data-mce-bogus="1">');jd(a);iZ(a,b);return bo.some(lr.before(b.dom()))}else{return bo.none()}};var sA=function(f,g,h){var i=gc(f).filter(function(e){return hq.isText(e.dom())});var j=gd(f).filter(function(e){return hq.isText(e.dom())});je(f);return kS([i,j,g],function(a,b,c){var d=a.dom(),nextNode=b.dom();var e=d.data.length;sh(d,nextNode,h);return c.container()===nextNode?lr(d,e):c}).orThunk(function(){if(h){i.each(function(a){return sg(a.dom(),a.dom().length)});j.each(function(a){return sf(a.dom(),0)})}return g})};var sB=function(a,b){return fq(a.schema.getTextInlineElements(),fc(b))};var sC=function(b,c,d,e){if(e===void 0){e=true}var f=su(c,b.getBody(),d.dom());var g=jw(d,curry(sx,b),sw(b.getBody()));var h=sA(d,f,sB(b,d));if(b.dom.isEmpty(b.getBody())){b.setContent('');b.selection.setCursorLocation()}else{g.bind(sz).fold(function(){if(e){sv(b,c,h)}},function(a){if(e){sv(b,c,bo.some(a))}})}};var sD={deleteElement:sC};var sE=function(b,c){return function(a){b._selectionOverrides.hideFakeCaret();sD.deleteElement(b,c,eP.fromDom(a));return true}};var sF=function(c,d){return function(a){var b=d?lr.before(a):lr.after(a);c.selection.setRng(b.toRange());return true}};var sG=function(b){return function(a){b.selection.setRng(a.toRange());return true}};var sH=function(b,c){var d=sb(b.getBody(),c,b.selection.getRng()).map(function(a){return a.fold(sE(b,c),sF(b,c),sG(b))});return d.getOr(false)};var sI=function(a){bD(jv(a,'.mce-offscreen-selection'),je)};var sJ=function(a,b){var c=a.selection.getNode();if(hq.isContentEditableFalse(c)){sI(eP.fromDom(a.getBody()));sD.deleteElement(a,b,eP.fromDom(a.selection.getNode()));qM.paddEmptyBody(a);return true}else{return false}};var sK=function(a,b){while(b&&b!==a){if(hq.isContentEditableTrue(b)||hq.isContentEditableFalse(b)){return b}b=b.parentNode}return null};var sL=function(a){var b;var c=sK(a.getBody(),a.selection.getNode());if(hq.isContentEditableTrue(c)&&a.dom.isBlock(c)&&a.dom.isEmpty(c)){b=a.dom.create('br',{'data-mce-bogus':'1'});a.dom.setHTML(c,'');c.appendChild(b);a.selection.setRng(lr.before(b).toRange())}return true};var sM=function(a,b){if(a.selection.isCollapsed()){return sH(a,b)}else{return sJ(a,b)}};var sN={backspaceDelete:sM,paddEmptyElement:sL};var sO=hq.isText;var sP=function(a){return sO(a)&&a.data[0]===jX.ZWSP};var sQ=function(a){return sO(a)&&a.data[a.data.length-1]===jX.ZWSP};var sR=function(a){return a.ownerDocument.createTextNode(jX.ZWSP)};var sS=function(a){if(sO(a.previousSibling)){if(sQ(a.previousSibling)){return a.previousSibling}else{a.previousSibling.appendData(jX.ZWSP);return a.previousSibling}}else if(sO(a)){if(sP(a)){return a}else{a.insertData(0,jX.ZWSP);return a}}else{var b=sR(a);a.parentNode.insertBefore(b,a);return b}};var sT=function(a){if(sO(a.nextSibling)){if(sP(a.nextSibling)){return a.nextSibling}else{a.nextSibling.insertData(0,jX.ZWSP);return a.nextSibling}}else if(sO(a)){if(sQ(a)){return a}else{a.appendData(jX.ZWSP);return a}}else{var b=sR(a);if(a.nextSibling){a.parentNode.insertBefore(b,a.nextSibling)}else{a.parentNode.appendChild(b)}return b}};var sU=function(a,b){return a?sS(b):sT(b)};var sV=curry(sU,true);var sW=curry(sU,false);var sX=function(a,b){if(hq.isText(a.container())){return sU(b,a.container())}else{return sU(b,a.getNode())}};var sY=function(a,b){var c=b.get();return c&&a.container()===c&&kb(c)};var sZ=function(d,e){return e.fold(function(a){mn.remove(d.get());var b=sV(a);d.set(b);return bo.some(lr(b,b.length-1))},function(c){return nI.firstPositionIn(c).map(function(a){if(!sY(a,d)){mn.remove(d.get());var b=sX(a,true);d.set(b);return lr(b,1)}else{return lr(d.get(),1)}})},function(c){return nI.lastPositionIn(c).map(function(a){if(!sY(a,d)){mn.remove(d.get());var b=sX(a,false);d.set(b);return lr(b,b.length-1)}else{return lr(d.get(),d.get().length-1)}})},function(a){mn.remove(d.get());var b=sW(a);d.set(b);return bo.some(lr(b,1))})};var ta={renderCaret:sZ};var tb=function(a,b){for(var i=0;i<a.length;i++){var c=a[i].apply(null,b);if(c.isSome()){return c}}return bo.none()};var tc={evaluateUntil:tb};var td=rL.generate([{before:['element']},{start:['element']},{end:['element']},{after:['element']}]);var te=function(a,b){var c=mK(b,a);return c?c:a};var tf=function(b,c,d){var e=qG.normalizeForwards(d);var f=te(c,e.container());return qG.findRootInline(b,f,e).fold(function(){return nI.nextPosition(f,e).bind(curry(qG.findRootInline,b,f)).map(function(a){return td.before(a)})},bo.none)};var tg=function(a,b){return lZ(a,b)===null};var th=function(a,b,c){return qG.findRootInline(a,b,c).filter(curry(tg,b))};var ti=function(c,d,e){var f=qG.normalizeBackwards(e);return th(c,d,f).bind(function(a){var b=nI.prevPosition(a,f);return b.isNone()?bo.some(td.start(a)):bo.none()})};var tj=function(c,d,e){var f=qG.normalizeForwards(e);return th(c,d,f).bind(function(a){var b=nI.nextPosition(a,f);return b.isNone()?bo.some(td.end(a)):bo.none()})};var tk=function(b,c,d){var e=qG.normalizeBackwards(d);var f=te(c,e.container());return qG.findRootInline(b,f,e).fold(function(){return nI.prevPosition(f,e).bind(curry(qG.findRootInline,b,f)).map(function(a){return td.after(a)})},bo.none)};var tl=function(a){return qG.isRtl(tn(a))===false};var tm=function(a,b,c){var d=tc.evaluateUntil([tf,ti,tj,tk],[a,b,c]);return d.filter(tl)};var tn=function(a){return a.fold(bd,bd,bd,bd)};var to=function(a){return a.fold(bc('before'),bc('start'),bc('end'),bc('after'))};var tp=function(a){return a.fold(td.before,td.before,td.after,td.after)};var tq=function(a){return a.fold(td.start,td.start,td.end,td.end)};var ts=function(a,b){return to(a)===to(b)&&tn(a)===tn(b)};var tt=function(c,d,e,f,g,h){return kS([qG.findRootInline(d,e,f),qG.findRootInline(d,e,g)],function(a,b){if(a!==b&&qG.hasSameParentBlock(e,a,b)){return td.after(c?a:b)}else{return h}}).getOr(h)};var tu=function(b,c){return b.fold(bc(true),function(a){return!ts(a,c)})};var tv=function(b,c,d,e,f){var g=qG.normalizePosition(b,f);var h=nI.fromPosition(b,d,g).map(curry(qG.normalizePosition,b));var i=h.fold(function(){return e.map(tp)},function(a){return tm(c,d,a).map(curry(tt,b,c,d,g,a)).filter(curry(tu,e))});return i.filter(tl)};var tw=function(a,b){if(a){return b.fold(bb(bo.some,td.start),bo.none,bb(bo.some,td.after),bo.none)}else{return b.fold(bo.none,bb(bo.some,td.before),bo.none,bb(bo.some,td.end))}};var tx=function(a,b,c,d){var e=qG.normalizePosition(a,d);var f=tm(b,c,e);return tm(b,c,e).bind(curry(tw,a)).orThunk(function(){return tv(a,b,c,f,d)})};var ty={readLocation:tm,findLocation:tx,prevLocation:curry(tx,false),nextLocation:curry(tx,true),getElement:tn,outside:tp,inside:tq};var tz=function(a){return bw(a.selection.getSel().modify)};var tA=function(a,b,c){var d=a?1:-1;b.setRng(lr(c.container(),c.offset()+d).toRange());b.getSel().modify('move',a?'forward':'backward','word');return true};var tB=function(a,b){var c=b.selection.getRng();var d=a?lr.fromRangeEnd(c):lr.fromRangeStart(c);if(!tz(b)){return false}else if(a&&kf(d)){return tA(true,b.selection,d)}else if(!a&&kg(d)){return tA(false,b.selection,d)}else{return false}};var tC={hasSelectionModifyApi:tz,moveByWord:tB};var tD=function(a,b){var c=a.dom.createRng();c.setStart(b.container(),b.offset());c.setEnd(b.container(),b.offset());a.selection.setRng(c)};var tE=function(a){return a.settings.inline_boundaries!==false};var tF=function(a,b){if(a){b.setAttribute('data-mce-selected','inline-boundary')}else{b.removeAttribute('data-mce-selected')}};var tG=function(b,c,d){return ta.renderCaret(c,d).map(function(a){tD(b,a);return d})};var tH=function(b,c,d){var e=b.getBody();var f=lr.fromRangeStart(b.selection.getRng());var g=curry(qG.isInlineTarget,b);var h=ty.findLocation(d,g,e,f);return h.bind(function(a){return tG(b,c,a)})};var tI=function(a,b,c){var d=bG(b.select('*[data-mce-selected="inline-boundary"]'),a);var e=bG(c,a);bD(bS(d,e),curry(tF,false));bD(bS(e,d),curry(tF,true))};var tJ=function(a,b){if(a.selection.isCollapsed()&&a.composing!==true&&b.get()){var c=lr.fromRangeStart(a.selection.getRng());if(lr.isTextPosition(c)&&qG.isAtZwsp(c)===false){tD(a,mn.removeAndReposition(b.get(),c));b.set(null)}}};var tK=function(d,e,f,g){if(e.selection.isCollapsed()){var h=bG(g,d);bD(h,function(b){var c=lr.fromRangeStart(e.selection.getRng());ty.readLocation(d,e.getBody(),c).bind(function(a){return tG(e,f,a)})})}};var tL=function(a,b,c){return function(){return tE(a)?tH(a,b,c).isSome():false}};var tM=function(a,b,c){return function(){return tE(b)?tC.moveByWord(a,b):false}};var tN=function(a){var b=ji(null);var c=curry(qG.isInlineTarget,a);a.on('NodeChange',function(e){if(tE(a)){tI(c,a.dom,e.parents);tJ(a,b);tK(c,a,b,e.parents)}});return b};var tO=curry(tM,true);var tP=curry(tM,false);var tQ={move:tL,moveNextWord:tO,movePrevWord:tP,setupSelectedState:tN,setCaretPosition:tD};var tR=function(a){return a.settings.inline_boundaries!==false};var tS=function(a,b){var c=document.createRange();c.setStart(a.container(),a.offset());c.setEnd(b.container(),b.offset());return c};var tT=function(f){return kS([nI.firstPositionIn(f),nI.lastPositionIn(f)],function(b,c){var d=qG.normalizePosition(true,b);var e=qG.normalizePosition(false,c);return nI.nextPosition(f,d).map(function(a){return a.isEqual(e)}).getOr(true)}).getOr(true)};var tU=function(c,d){return function(b){return ta.renderCaret(d,b).map(function(a){tQ.setCaretPosition(c,a);return true}).getOr(false)}};var tV=function(a,b,c,d){var e=a.getBody();var f=curry(qG.isInlineTarget,a);a.undoManager.ignore(function(){a.selection.setRng(tS(c,d));a.execCommand('Delete');ty.readLocation(f,e,lr.fromRangeStart(a.selection.getRng())).map(ty.inside).map(tU(a,b))});a.nodeChanged()};var tW=function(a,b){var c=mK(b,a);return c?c:a};var tX=function(d,e,f,g){var h=tW(d.getBody(),g.container());var i=curry(qG.isInlineTarget,d);var j=ty.readLocation(i,h,g);return j.bind(function(a){if(f){return a.fold(bc(bo.some(ty.inside(a))),bo.none,bc(bo.some(ty.outside(a))),bo.none)}else{return a.fold(bo.none,bc(bo.some(ty.outside(a))),bo.none,bc(bo.some(ty.inside(a))))}}).map(tU(d,e)).getOrThunk(function(){var b=nI.navigate(f,h,g);var c=b.bind(function(a){return ty.readLocation(i,h,a)});if(j.isSome()&&c.isSome()){return qG.findRootInline(i,h,g).map(function(a){if(tT(a)){sD.deleteElement(d,f,eP.fromDom(a));return true}else{return false}}).getOr(false)}else{return c.bind(function(_){return b.map(function(a){if(f){tV(d,e,g,a)}else{tV(d,e,a,g)}return true})}).getOr(false)}})};var tY=function(a,b,c){if(a.selection.isCollapsed()&&tR(a)){var d=lr.fromRangeStart(a.selection.getRng());return tX(a,b,c,d)}return false};var tZ={backspaceDelete:tY};var ua=fE('start','end');var ub=fE('rng','table','cells');var uc=rL.generate([{removeTable:['element']},{emptyCells:['cells']}]);var ud=function(a){return curry(fS,a)};var ue=function(a,b){return jA(eP.fromDom(a),'td,th',b)};var uf=function(a,b){return jy(a,'table',b)};var ug=function(a){return fS(a.start(),a.end())===false};var uh=function(c,d){return uf(c.start(),d).bind(function(b){return uf(c.end(),d).bind(function(a){return fS(b,a)?bo.some(b):bo.none()})})};var ui=function(a){return jv(a,'td,th')};var uj=function(c,d){return uf(c.start(),d).bind(function(b){return bW(ui(b)).map(function(a){return ua(c.start(),a)})})};var uk=function(d,e){var f=ue(e.startContainer,d);var g=ue(e.endContainer,d);return e.collapsed?bo.none():kS([f,g],ua).fold(function(){return f.fold(function(){return g.bind(function(c){return uf(c,d).bind(function(b){return bV(ui(b)).map(function(a){return ua(a,c)})})})},function(c){return uf(c,d).bind(function(b){return bW(ui(b)).map(function(a){return ua(c,a)})})})},function(a){return ul(d,a)?bo.none():uj(a,d)})};var ul=function(a,b){return uh(b,a).isSome()};var um=function(b,c){var d=ue(b.startContainer,c);var e=ue(b.endContainer,c);return kS([d,e],ua).filter(ug).filter(function(a){return ul(c,a)}).orThunk(function(){return uk(c,b)})};var un=function(b,c){return uh(b,c).map(function(a){return ub(b,a,ui(a))})};var uo=function(b,c){var d=ud(b);return um(c,d).bind(function(a){return un(a,d)})};var up=function(a,b){return bK(a,function(x){return fS(x,b)})};var uq=function(c){return kS([up(c.cells(),c.rng().start()),up(c.cells(),c.rng().end())],function(a,b){return c.cells().slice(a,b+1)})};var ur=function(c){return uq(c).map(function(a){var b=c.cells();return a.length===b.length?uc.removeTable(c.table()):uc.emptyCells(a)})};var us=function(a){return uc.emptyCells(a)};var ut=function(a,b){return uo(a,b).bind(ur)};var uv={getActionFromRange:ut,getActionFromCells:us};var uw=function(a){var b=[];if(a){for(var i=0;i<a.rangeCount;i++){b.push(a.getRangeAt(i))}}return b};var ux=function(c){return bO(c,function(a){var b=kO(a);return b?[eP.fromDom(b)]:[]})};var uy=function(a){return uw(a).length>1};var uz={getRanges:uw,getSelectedNodes:ux,hasMultipleRanges:uy};var uA=function(a){return bG(uz.getSelectedNodes(a),gW)};var uB=function(a){var b=jv(a,'td[data-mce-selected],th[data-mce-selected]');return b};var uC=function(a,b){var c=uB(b);var d=uA(a);return c.length>0?c:d};var uD=function(a){return uC(uz.getRanges(a.selection.getSel()),eP.fromDom(a.getBody()))};var uE={getCellsFromRanges:uA,getCellsFromElement:uB,getCellsFromElementOrRanges:uC,getCellsFromEditor:uD};var uF=function(a,b){bD(b,pC.fillWithPaddingBr);a.selection.setCursorLocation(b[0].dom(),0);return true};var uG=function(a,b){sD.deleteElement(a,false,b);return true};var uH=function(b,c,d){return uv.getActionFromRange(c,d).map(function(a){return a.fold(curry(uG,b),curry(uF,b))})};var uI=function(a,b){return uO(a,b)};var uJ=function(b,c,d,e){return uM(c,e).fold(function(){return uH(b,c,d)},function(a){return uI(b,a)}).getOr(false)};var uK=function(a,b){var c=eP.fromDom(a.getBody());var d=a.selection.getRng();var e=uE.getCellsFromEditor(a);return e.length!==0?uF(a,e):uJ(a,c,d,b)};var uL=function(a,b){return bJ(rn.parentsAndSelf(b,a),gW)};var uM=function(b,c){return bJ(rn.parentsAndSelf(c,b),function(a){return fc(a)==='caption'})};var uN=function(c,d,e,f,g){return nI.navigate(e,c.getBody(),g).bind(function(b){return uL(d,eP.fromDom(b.getNode())).map(function(a){return fS(a,f)===false})})};var uO=function(a,b){pC.fillWithPaddingBr(b);a.selection.setCursorLocation(b.dom(),0);return bo.some(true)};var uP=function(c,d,e,f){return nI.firstPositionIn(c.dom()).bind(function(b){return nI.lastPositionIn(c.dom()).map(function(a){return d?e.isEqual(b)&&f.isEqual(a):e.isEqual(a)&&f.isEqual(b)})}).getOr(true)};var uQ=function(a,b){return uO(a,b)};var uR=function(b,c,d){return uM(b,eP.fromDom(d.getNode())).map(function(a){return fS(a,c)===false})};var uS=function(b,c,d,e,f){return nI.navigate(d,b.getBody(),f).bind(function(a){return uP(e,d,f,a)?uQ(b,e):uR(c,e,a)}).or(bo.some(true))};var uT=function(b,c,d,e){var f=lr.fromRangeStart(b.selection.getRng());return uL(d,e).bind(function(a){return qX.isEmpty(a)?uO(b,a):uN(b,d,c,a,f)})};var uU=function(a,b,c,d){var e=lr.fromRangeStart(a.selection.getRng());return qX.isEmpty(d)?uO(a,d):uS(a,c,b,d,e)};var uV=function(b,c,d){var e=eP.fromDom(b.getBody());return uM(e,d).fold(function(){return uT(b,c,e,d)},function(a){return uU(b,c,e,a)}).getOr(false)};var uW=function(a,b){var c=eP.fromDom(a.selection.getStart(true));var d=uE.getCellsFromEditor(a);return a.selection.isCollapsed()&&d.length===0?uV(a,b,c):uK(a,c)};var uX={backspaceDelete:uW};var uY=function(a,b){a.getDoc().execCommand(b,false,null)};var uZ=function(a){if(sN.backspaceDelete(a,false)){return}else if(tZ.backspaceDelete(a,false)){return}else if(rB.backspaceDelete(a,false)){return}else if(uX.backspaceDelete(a)){return}else if(rJ.backspaceDelete(a,false)){return}else{uY(a,'Delete');qM.paddEmptyBody(a)}};var va=function(a){if(sN.backspaceDelete(a,true)){return}else if(tZ.backspaceDelete(a,true)){return}else if(rB.backspaceDelete(a,true)){return}else if(uX.backspaceDelete(a)){return}else if(rJ.backspaceDelete(a,true)){return}else{uY(a,'ForwardDelete')}};var vb={deleteCommand:uZ,forwardDeleteCommand:va};var vc=function(a,b,c){var d=a.getParam(b,c);if(d.indexOf('=')!==-1){var e=a.getParam(b,'','hash');return e.hasOwnProperty(a.id)?e[a.id]:c}else{return d}};var vd=function(a){return a.getParam('iframe_attrs',{})};var ve=function(a){return a.getParam('doctype','<!DOCTYPE html>')};var vf=function(a){return a.getParam('document_base_url','')};var vg=function(a){return vc(a,'body_id','tinymce')};var vh=function(a){return vc(a,'body_class','')};var vi=function(a){return a.getParam('content_security_policy','')};var vj=function(a){return a.getParam('br_in_pre',true)};var vk=function(a){if(a.getParam('force_p_newlines',false)){return'p'}var b=a.getParam('forced_root_block','p');return b===false?'':b};var vl=function(a){return a.getParam('forced_root_block_attrs',{})};var vm=function(a){return a.getParam('br_newline_selector','.mce-toc h2,figcaption,caption')};var vn=function(a){return a.getParam('no_newline_selector','')};var vo=function(a){return a.getParam('keep_styles',true)};var vp=function(a){return a.getParam('end_container_on_empty_block',false)};var vq=function(a){return dj.explode(a.getParam('font_size_style_values',''))};var vr=function(a){return dj.explode(a.getParam('font_size_classes',''))};var vs=function(a){return a.getParam('images_dataimg_filter',bc(true),'function')};var vt=function(a){return a.getParam('automatic_uploads',true,'boolean')};var vu=function(a){return a.getParam('images_reuse_filename',false,'boolean')};var vv=function(a){return a.getParam('images_replace_blob_uris',true,'boolean')};var vw=function(a){return a.getParam('images_upload_url','','string')};var vx=function(a){return a.getParam('images_upload_base_path','','string')};var vy=function(a){return a.getParam('images_upload_credentials',false,'boolean')};var vz=function(a){return a.getParam('images_upload_handler',null,'function')};var vA=function(a){return a.getParam('content_css_cors',false,'boolean')};var vB={getIframeAttrs:vd,getDocType:ve,getDocumentBaseUrl:vf,getBodyId:vg,getBodyClass:vh,getContentSecurityPolicy:vi,shouldPutBrInPre:vj,getForcedRootBlock:vk,getForcedRootBlockAttrs:vl,getBrNewLineSelector:vm,getNoNewLineSelector:vn,shouldKeepStyles:vo,shouldEndContainerOnEmptyBlock:vp,getFontStyleValues:vq,getFontSizeClasses:vr,getImagesDataImgFilter:vs,isAutomaticUploadsEnabled:vt,shouldReuseFileName:vu,shouldReplaceBlobUris:vv,getImageUploadUrl:vw,getImageUploadBasePath:vx,getImagesUploadCredentials:vy,getImagesUploadHandler:vz,shouldUseContentCssCors:vA};var vC=function(b,c,d){var e=function(a){return fD(a,b)};var f=function(a){return fS(eP.fromDom(c),a)};return jx(eP.fromDom(d),function(a){return e(a).isSome()},f).bind(e)};var vD=function(a,b){var c=Math.pow(10,b);return Math.round(a*c)/c};var vE=function(a,b){if(/[0-9.]+px$/.test(a)){return vD(parseInt(a,10)*72/96,b||0)+'pt'}return a};var vF=function(a){return a.replace(/[\'\"\\]/g,'').replace(/,\s+/g,',')};var vG=function(a,b){return bo.from(iQ.DOM.getStyle(b,a,true))};var vH=function(d){return function(b,c){return bo.from(c).map(eP.fromDom).filter(ff).bind(function(a){return vC(d,b,a.dom()).or(vG(d,a.dom()))}).getOr('')}};var vI={getFontSize:vH('font-size'),getFontFamily:bb(vF,vH('font-family')),toPt:vE};var vJ=function(c){return nI.firstPositionIn(c.getBody()).map(function(a){var b=a.container();return hq.isText(b)?b.parentNode:b})};var vK=function(a,b){return a.startContainer===b&&a.startOffset===0};var vL=function(c){return bo.from(c.selection.getRng()).bind(function(a){var b=c.getBody();return vK(a,b)?bo.none():bo.from(c.selection.getStart(true))})};var vM=function(a,b){if(/^[0-9\.]+$/.test(b)){var c=parseInt(b,10);if(c>=1&&c<=7){var d=vB.getFontStyleValues(a);var e=vB.getFontSizeClasses(a);if(e){return e[c-1]||b}else{return d[c-1]||b}}else{return b}}else{return b}};var vN=function(a,b){a.formatter.toggle('fontname',{value:vM(a,b)});a.nodeChanged()};var vO=function(b){return vL(b).fold(function(){return vJ(b).map(function(a){return vI.getFontFamily(b.getBody(),a)}).getOr('')},function(a){return vI.getFontFamily(b.getBody(),a)})};var vP=function(a,b){a.formatter.toggle('fontsize',{value:vM(a,b)});a.nodeChanged()};var vQ=function(b){return vL(b).fold(function(){return vJ(b).map(function(a){return vI.getFontSize(b.getBody(),a)}).getOr('')},function(a){return vI.getFontSize(b.getBody(),a)})};var vR=function(a,b){return a&&b&&(a.startContainer===b.startContainer&&a.startOffset===b.startOffset)&&(a.endContainer===b.endContainer&&a.endOffset===b.endOffset)};var vS={isEq:vR};var vT=function(a,b,c){while(a&&a!==b){if(c(a)){return a}a=a.parentNode}return null};var vU=function(a,b,c){return vT(a,b,c)!==null};var vV=function(b,c,d){return vU(b,c,function(a){return a.nodeName===d})};var vW=function(a){return a&&a.nodeName==='TABLE'};var vX=function(a){return a&&/^(TD|TH|CAPTION)$/.test(a.nodeName)};var vY=function(a,b){return kc(a)&&vU(a,b,lY)===false};var vZ=function(a,b,c){var d=new TreeWalker(b,a.getParent(b.parentNode,a.isBlock)||a.getRoot());while(b=d[c?'prev':'next']()){if(hq.isBr(b)){return true}}};var wa=function(a,b){return a.previousSibling&&a.previousSibling.nodeName===b};var wb=function(a,b){while(b&&b!==a){if(hq.isContentEditableFalse(b)){return true}b=b.parentNode}return false};var wc=function(a,b,c,d,e){var f,lastInlineElement,parentBlockContainer;var g=a.getRoot();var h;var i=a.schema.getNonEmptyElements();parentBlockContainer=a.getParent(e.parentNode,a.isBlock)||g;if(d&&hq.isBr(e)&&b&&a.isEmpty(parentBlockContainer)){return bo.some(CaretPosition(e.parentNode,a.nodeIndex(e)))}f=new TreeWalker(e,parentBlockContainer);while(h=f[d?'prev':'next']()){if(a.getContentEditableParent(h)==='false'||vY(h,g)){return bo.none()}if(hq.isText(h)&&h.nodeValue.length>0){if(vV(h,g,'A')===false){return bo.some(CaretPosition(h,d?h.nodeValue.length:0))}return bo.none()}if(a.isBlock(h)||i[h.nodeName.toLowerCase()]){return bo.none()}lastInlineElement=h}if(c&&lastInlineElement){return bo.some(CaretPosition(lastInlineElement,0))}return bo.none()};var wd=function(b,c,d,e){var f,offset,walker;var g=b.getRoot();var h,nonEmptyElementsMap;var i,isAfterNode,normalized=false;f=e[(d?'start':'end')+'Container'];offset=e[(d?'start':'end')+'Offset'];isAfterNode=hq.isElement(f)&&offset===f.childNodes.length;nonEmptyElementsMap=b.schema.getNonEmptyElements();i=d;if(kc(f)){return bo.none()}if(hq.isElement(f)&&offset>f.childNodes.length-1){i=false}if(hq.isDocument(f)){f=g;offset=0}if(f===g){if(i){h=f.childNodes[offset>0?offset-1:0];if(h){if(kc(h)){return bo.none()}if(nonEmptyElementsMap[h.nodeName]||vW(h)){return bo.none()}}}if(f.hasChildNodes()){offset=Math.min(!i&&offset>0?offset-1:offset,f.childNodes.length-1);f=f.childNodes[offset];offset=hq.isText(f)&&isAfterNode?f.data.length:0;if(!c&&f===g.lastChild&&vW(f)){return bo.none()}if(wb(g,f)||kc(f)){return bo.none()}if(f.hasChildNodes()&&vW(f)===false){h=f;walker=new TreeWalker(f,g);do{if(hq.isContentEditableFalse(h)||kc(h)){normalized=false;break}if(hq.isText(h)&&h.nodeValue.length>0){offset=i?0:h.nodeValue.length;f=h;normalized=true;break}if(nonEmptyElementsMap[h.nodeName.toLowerCase()]&&!vX(h)){offset=b.nodeIndex(h);f=h.parentNode;if(!i){offset++}normalized=true;break}}while(h=i?walker.next():walker.prev())}}}if(c){if(hq.isText(f)&&offset===0){wc(b,isAfterNode,c,true,f).each(function(a){f=a.container();offset=a.offset();normalized=true})}if(hq.isElement(f)){h=f.childNodes[offset];if(!h){h=f.childNodes[offset-1]}if(h&&hq.isBr(h)&&!wa(h,'A')&&!vZ(b,h,false)&&!vZ(b,h,true)){wc(b,isAfterNode,c,true,h).each(function(a){f=a.container();offset=a.offset();normalized=true})}}}if(i&&!c&&hq.isText(f)&&offset===f.nodeValue.length){wc(b,isAfterNode,c,false,f).each(function(a){f=a.container();offset=a.offset();normalized=true})}return normalized?bo.some(CaretPosition(f,offset)):bo.none()};var we=function(b,c){var d=c.collapsed,normRng=c.cloneRange();var e=CaretPosition.fromRangeStart(c);wd(b,d,true,normRng).each(function(a){if(!d||!CaretPosition.isAbove(e,a)){normRng.setStart(a.container(),a.offset())}});if(!d){wd(b,d,false,normRng).each(function(a){normRng.setEnd(a.container(),a.offset())})}if(d){normRng.collapse(true)}return vS.isEq(c,normRng)?bo.none():bo.some(normRng)};var wf={normalize:we};var wg=function(a,b,c){var d=new TreeWalker(b,c);var e;var f=a.getNonEmptyElements();while(e=d.next()){if(f[e.nodeName.toLowerCase()]||e.length>0){return true}}};var wh=function(a,b,c){var d=a.create('span',{},'&nbsp;');c.parentNode.insertBefore(d,c);b.scrollIntoView(d);a.remove(d)};var wi=function(a,b,c,d){var e=a.createRng();if(!d){e.setStartAfter(c);e.setEndAfter(c)}else{e.setStartBefore(c);e.setEndBefore(c)}b.setRng(e)};var wj=function(b,c){var d=b.selection,Cu=b.dom;var e,extraBr;var f=d.getRng();wf.normalize(Cu,f).each(function(a){f.setStart(a.startContainer,a.startOffset);f.setEnd(a.endContainer,a.endOffset)});var g=f.startOffset;var h=f.startContainer;if(h.nodeType===1&&h.hasChildNodes()){var i=g>h.childNodes.length-1;h=h.childNodes[Math.min(g,h.childNodes.length-1)]||h;if(i&&h.nodeType===3){g=h.nodeValue.length}else{g=0}}var j=Cu.getParent(h,Cu.isBlock);var k=j?Cu.getParent(j.parentNode,Cu.isBlock):null;var l=k?k.nodeName.toUpperCase():'';var m=c&&c.ctrlKey;if(l==='LI'&&!m){j=k}if(h&&h.nodeType===3&&g>=h.nodeValue.length){if(!wg(b.schema,h,j)){e=Cu.create('br');f.insertNode(e);f.setStartAfter(e);f.setEndAfter(e);extraBr=true}}e=Cu.create('br');f.insertNode(e);wh(Cu,d,e);wi(Cu,d,e,extraBr);b.undoManager.add()};var wk=function(a,b){var c=eP.fromTag('br');iW(eP.fromDom(b),c);a.undoManager.add()};var wl=function(a,b){if(!wn(a.getBody(),b)){iX(eP.fromDom(b),eP.fromTag('br'))}var c=eP.fromTag('br');iX(eP.fromDom(b),c);wh(a.dom,a.selection,c.dom());wi(a.dom,a.selection,c.dom(),false);a.undoManager.add()};var wm=function(a){return hq.isBr(a.getNode())};var wn=function(b,c){if(wm(lr.after(c))){return true}else{return nI.nextPosition(b,lr.after(c)).map(function(a){return hq.isBr(a.getNode())}).getOr(false)}};var wo=function(a){return a&&a.nodeName==='A'&&'href'in a};var wp=function(a){return a.fold(bc(false),wo,wo,bc(false))};var wq=function(a){var b=curry(qG.isInlineTarget,a);var c=lr.fromRangeStart(a.selection.getRng());return ty.readLocation(b,a.getBody(),c).filter(wp)};var wr=function(a,b){b.fold(ba,curry(wk,a),curry(wl,a),ba)};var ws=function(a,b){var c=wq(a);if(c.isSome()){c.each(curry(wr,a))}else{wj(a,b)}};var wt={insert:ws};var wu=rL.generate([{'before':['element']},{'on':['element','offset']},{after:['element']}]);var wv=rL.generate([{domRange:['rng']},{relative:['startSitu','finishSitu']},{exact:['start','soffset','finish','foffset']}]);var ww=fE('start','soffset','finish','foffset');var wx=wv.domRange;var wy=wv.relative;var wz=wv.exact;var wA=eJ.detect().browser;var wB=function(a,b){var c=fg(b)?oN(b).length:gg(b).length+1;if(a>c){return c}else if(a<0){return 0}return a};var wC=function(a){return ww(a.start(),wB(a.soffset(),a.start()),a.finish(),wB(a.foffset(),a.finish()))};var wD=function(a,b){return fW(a,b)||fS(a,b)};var wE=function(b){return function(a){return wD(b,a.start())&&wD(b,a.finish())}};var wF=function(a){return a.inline===true||wA.isIE()};var wG=function(r){return ww(eP.fromDom(r.startContainer),r.startOffset,eP.fromDom(r.endContainer),r.endOffset)};var wH=function(a){var b=a.getSelection();var c=!b||b.rangeCount===0?bo.none():bo.from(b.getRangeAt(0));return c.map(wG)};var wI=function(a){var b=fZ(a);return wH(b.dom()).filter(wE(a))};var wJ=function(a,b){return bo.from(b).filter(wE(a)).map(wC)};var wK=function(a){var b=document.createRange();try{b.setStart(a.start().dom(),a.soffset());b.setEnd(a.finish().dom(),a.foffset());return bo.some(b)}catch(_){return bo.none()}};var wL=function(a){var b=wF(a)?wI(eP.fromDom(a.getBody())):bo.none();a.bookmark=b.isSome()?b:a.bookmark};var wM=function(a,b){var c=eP.fromDom(a.getBody());var d=wF(a)?bo.from(b):bo.none();var e=d.map(wG).filter(wE(c));a.bookmark=e.isSome()?e:a.bookmark};var wN=function(a){var b=a.bookmark?a.bookmark:bo.none();return b.bind(curry(wJ,eP.fromDom(a.getBody()))).bind(wK)};var wO=function(b){wN(b).each(function(a){b.selection.setRng(a)})};var wP={store:wL,storeNative:wM,readRange:wH,restore:wO,getRng:wN,getBookmark:wI,validate:wJ};var wQ=function(a,b,c,d,e,f){if(a.getContentEditable(f)==='false'){return}var g=c?'margin':'padding';g=f.nodeName==='TABLE'?'margin':g;g+=a.getStyle(f,'direction',true)==='rtl'?'Right':'Left';if(b==='outdent'){var h=Math.max(0,parseInt(f.style[g]||0,10)-d);a.setStyle(f,g,h?h+e:'')}else{var h=parseInt(f.style[g]||0,10)+d+e;a.setStyle(f,g,h)}};var wR=function(a){return gS(a)||gT(a)};var wS=function(a){return ga(a).map(wR).getOr(false)};var wT=function(b){return bG(bC(b.selection.getSelectedBlocks(),eP.fromDom),function(a){return!wR(a)&&!wS(a)})};var wU=function(b,c){var d=b.settings,Cu=b.dom,selection=b.selection,formatter=b.formatter;var e=/[a-z%]+$/i.exec(d.indentation)[0];var f=parseInt(d.indentation,10);var g=b.getParam('indent_use_margin',false);if(!b.queryCommandState('InsertUnorderedList')&&!b.queryCommandState('InsertOrderedList')){if(!d.forced_root_block&&!Cu.getParent(selection.getNode(),Cu.isBlock)){formatter.apply('div')}}bD(wT(b),function(a){wQ(Cu,c,g,f,e,a.dom())})};var wV=dj.each,extend$2=dj.extend;var wW=dj.map,inArray$2=dj.inArray;function EditorCommands(h){var i,selection,formatter;var j={state:{},exec:{},value:{}};var k=h.settings,bookmark;h.on('PreInit',function(){i=h.dom;selection=h.selection;k=h.settings;formatter=h.formatter});var l=function(a,b,c,d){var e,customCommand,state=false;if(h.removed){return}if(!/^(mceAddUndoLevel|mceEndUndoLevel|mceBeginUndoLevel|mceRepaint)$/.test(a)&&(!d||!d.skip_focus)){h.focus()}else{wP.restore(h)}d=h.fire('BeforeExecCommand',{command:a,ui:b,value:c});if(d.isDefaultPrevented()){return false}customCommand=a.toLowerCase();if(e=j.exec[customCommand]){e(customCommand,b,c);h.fire('ExecCommand',{command:a,ui:b,value:c});return true}wV(h.plugins,function(p){if(p.execCommand&&p.execCommand(a,b,c)){h.fire('ExecCommand',{command:a,ui:b,value:c});state=true;return false}});if(state){return state}if(h.theme&&h.theme.execCommand&&h.theme.execCommand(a,b,c)){h.fire('ExecCommand',{command:a,ui:b,value:c});return true}try{state=h.getDoc().execCommand(a,b,c)}catch(ex){}if(state){h.fire('ExecCommand',{command:a,ui:b,value:c});return true}return false};var m=function(a){var b;if(h.quirks.isHidden()||h.removed){return}a=a.toLowerCase();if(b=j.state[a]){return b(a)}try{return h.getDoc().queryCommandState(a)}catch(ex){}return false};var n=function(a){var b;if(h.quirks.isHidden()||h.removed){return}a=a.toLowerCase();if(b=j.value[a]){return b(a)}try{return h.getDoc().queryCommandValue(a)}catch(ex){}};var o=function(d,e){e=e||'exec';wV(d,function(b,c){wV(c.toLowerCase().split(','),function(a){j[e][a]=b})})};var q=function(e,f,g){e=e.toLowerCase();j.exec[e]=function(a,b,c,d){return f.call(g||h,b,c,d)}};var r=function(a){a=a.toLowerCase();if(j.exec[a]){return true}try{return h.getDoc().queryCommandSupported(a)}catch(ex){}return false};var s=function(a,b,c){a=a.toLowerCase();j.state[a]=function(){return b.call(c||h)}};var t=function(a,b,c){a=a.toLowerCase();j.value[a]=function(){return b.call(c||h)}};var u=function(a){a=a.toLowerCase();return!!j.exec[a]};extend$2(this,{execCommand:l,queryCommandState:m,queryCommandValue:n,queryCommandSupported:r,addCommands:o,addCommand:q,addQueryStateHandler:s,addQueryValueHandler:t,hasCustomCommand:u});var v=function(a,b,c){if(b===undefined){b=false}if(c===undefined){c=null}return h.getDoc().execCommand(a,b,c)};var w=function(a){return formatter.match(a)};var x=function(a,b){formatter.toggle(a,b?{value:b}:undefined);h.nodeChanged()};var y=function(a){bookmark=selection.getBookmark(a)};var z=function(){selection.moveToBookmark(bookmark)};o({'mceResetDesignMode,mceBeginUndoLevel':function(){},'mceEndUndoLevel,mceAddUndoLevel':function(){h.undoManager.add()},'Cut,Copy,Paste':function(a){var b=h.getDoc();var c;try{v(a)}catch(ex){c=true}if(a==='paste'&&!b.queryCommandEnabled(a)){c=true}if(c||!b.queryCommandSupported(a)){var d=h.translate('Your browser doesn\'t support direct access to the clipboard. '+'Please use the Ctrl+X/C/V keyboard shortcuts instead.');if(co.mac){d=d.replace(/Ctrl\+/g,'\u2318+')}h.notificationManager.open({text:d,type:'error'})}},'unlink':function(){if(selection.isCollapsed()){var a=h.dom.getParent(h.selection.getStart(),'a');if(a){h.dom.remove(a,true)}return}formatter.remove('link')},'JustifyLeft,JustifyCenter,JustifyRight,JustifyFull,JustifyNone':function(b){var c=b.substring(7);if(c==='full'){c='justify'}wV('left,center,right,justify'.split(','),function(a){if(c!==a){formatter.remove('align'+a)}});if(c!=='none'){x('align'+c)}},'InsertUnorderedList,InsertOrderedList':function(a){var b,listParent;v(a);b=i.getParent(selection.getNode(),'ol,ul');if(b){listParent=b.parentNode;if(/^(H[1-6]|P|ADDRESS|PRE)$/.test(listParent.nodeName)){y();i.split(listParent,b);z()}}},'Bold,Italic,Underline,Strikethrough,Superscript,Subscript':function(a){x(a)},'ForeColor,HiliteColor':function(a,b,c){x(a,c)},'FontName':function(a,b,c){vN(h,c)},'FontSize':function(a,b,c){vP(h,c)},'RemoveFormat':function(a){formatter.remove(a)},'mceBlockQuote':function(){x('blockquote')},'FormatBlock':function(a,b,c){return x(c||'p')},'mceCleanup':function(){var a=selection.getBookmark();h.setContent(h.getContent());selection.moveToBookmark(a)},'mceRemoveNode':function(a,b,c){var d=c||selection.getNode();if(d!==h.getBody()){y();h.dom.remove(d,true);z()}},'mceSelectNodeDepth':function(b,c,d){var e=0;i.getParent(selection.getNode(),function(a){if(a.nodeType===1&&e++===d){selection.select(a);return false}},h.getBody())},'mceSelectNode':function(a,b,c){selection.select(c)},'mceInsertContent':function(a,b,c){pY.insertAtCaret(h,c)},'mceInsertRawHTML':function(a,b,c){selection.setContent('tiny_mce_marker');var d=h.getContent();h.setContent(d.replace(/tiny_mce_marker/g,function(){return c}))},'mceToggleFormat':function(a,b,c){x(c)},'mceSetContent':function(a,b,c){h.setContent(c)},'Indent,Outdent':function(a){wU(h,a)},'mceRepaint':function(){},'InsertHorizontalRule':function(){h.execCommand('mceInsertContent',false,'<hr />')},'mceToggleVisualAid':function(){h.hasVisual=!h.hasVisual;h.addVisual()},'mceReplaceContent':function(a,b,c){h.execCommand('mceInsertContent',false,c.replace(/\{\$selection\}/g,selection.getContent({format:'text'})))},'mceInsertLink':function(a,b,c){var d;if(typeof c==='string'){c={href:c}}d=i.getParent(selection.getNode(),'a');c.href=c.href.replace(' ','%20');if(!d||!c.href){formatter.remove('link')}if(c.href){formatter.apply('link',c,d)}},'selectAll':function(){var a=i.getParent(selection.getStart(),hq.isContentEditableTrue);if(a){var b=i.createRng();b.selectNodeContents(a);selection.setRng(b)}},'delete':function(){vb.deleteCommand(h)},'forwardDelete':function(){vb.forwardDeleteCommand(h)},'mceNewDocument':function(){h.setContent('')},'InsertLineBreak':function(a,b,c){wt.insert(h,c);return true}});var A=function(d){return function(){var b=selection.isCollapsed()?[i.getParent(selection.getNode(),i.isBlock)]:selection.getSelectedBlocks();var c=wW(b,function(a){return!!formatter.matchNode(a,d)});return inArray$2(c,true)!==-1}};o({'JustifyLeft':A('alignleft'),'JustifyCenter':A('aligncenter'),'JustifyRight':A('alignright'),'JustifyFull':A('alignjustify'),'Bold,Italic,Underline,Strikethrough,Superscript,Subscript':function(a){return w(a)},'mceBlockQuote':function(){return w('blockquote')},'Outdent':function(){var a;if(k.inline_styles){if((a=i.getParent(selection.getStart(),i.isBlock))&&parseInt(a.style.paddingLeft,10)>0){return true}if((a=i.getParent(selection.getEnd(),i.isBlock))&&parseInt(a.style.paddingLeft,10)>0){return true}}return m('InsertUnorderedList')||m('InsertOrderedList')||!k.inline_styles&&!!i.getParent(selection.getNode(),'BLOCKQUOTE')},'InsertUnorderedList,InsertOrderedList':function(a){var b=i.getParent(selection.getNode(),'ul,ol');return b&&(a==='insertunorderedlist'&&b.tagName==='UL'||a==='insertorderedlist'&&b.tagName==='OL')}},'state');o({Undo:function(){h.undoManager.undo()},Redo:function(){h.undoManager.redo()}});t('FontName',function(){return vO(h)},this);t('FontSize',function(){return vQ(h)},this)}var wX=dj.makeMap('focus blur focusin focusout click dblclick mousedown mouseup mousemove mouseover beforepaste paste cut copy selectionchange '+'mouseout mouseenter mouseleave wheel keydown keypress keyup input contextmenu dragstart dragend dragover '+'draggesture dragdrop drop drag submit '+'compositionstart compositionend compositionupdate touchstart touchmove touchend',' ');var wY=function(f){var g=this;var h,bindings={},toggleEvent;var j=function(){return false};var k=function(){return true};f=f||{};h=f.scope||g;toggleEvent=f.toggleEvent||j;var m=function(a,b){var c,i,l,callback;a=a.toLowerCase();b=b||{};b.type=a;if(!b.target){b.target=h}if(!b.preventDefault){b.preventDefault=function(){b.isDefaultPrevented=k};b.stopPropagation=function(){b.isPropagationStopped=k};b.stopImmediatePropagation=function(){b.isImmediatePropagationStopped=k};b.isDefaultPrevented=j;b.isPropagationStopped=j;b.isImmediatePropagationStopped=j}if(f.beforeFire){f.beforeFire(b)}c=bindings[a];if(c){for(i=0,l=c.length;i<l;i++){callback=c[i];if(callback.once){o(a,callback.func)}if(b.isImmediatePropagationStopped()){b.stopPropagation();return b}if(callback.func.call(h,b)===false){b.preventDefault();return b}}}return b};var n=function(a,b,c,d){var e,names,i;if(b===false){b=j}if(b){b={func:b};if(d){dj.extend(b,d)}names=a.toLowerCase().split(' ');i=names.length;while(i--){a=names[i];e=bindings[a];if(!e){e=bindings[a]=[];toggleEvent(a,true)}if(c){e.unshift(b)}else{e.push(b)}}}return g};var o=function(a,b){var i,handlers,bindingName,names,hi;if(a){names=a.toLowerCase().split(' ');i=names.length;while(i--){a=names[i];handlers=bindings[a];if(!a){for(bindingName in bindings){toggleEvent(bindingName,false);delete bindings[bindingName]}return g}if(handlers){if(!b){handlers.length=0}else{hi=handlers.length;while(hi--){if(handlers[hi].func===b){handlers=handlers.slice(0,hi).concat(handlers.slice(hi+1));bindings[a]=handlers}}}if(!handlers.length){toggleEvent(a,false);delete bindings[a]}}}}else{for(a in bindings){toggleEvent(a,false)}bindings={}}return g};var p=function(a,b,c){return n(a,b,c,{once:true})};var q=function(a){a=a.toLowerCase();return!(!bindings[a]||bindings[a].length===0)};g.fire=m;g.on=n;g.off=o;g.once=p;g.has=q};wY.isNative=function(a){return!!wX[a.toLowerCase()]};var wZ=function(c){if(!c._eventDispatcher){c._eventDispatcher=new wY({scope:c,toggleEvent:function(a,b){if(wY.isNative(a)&&c.toggleNativeEvent){c.toggleNativeEvent(a,b)}}})}return c._eventDispatcher};var xa={fire:function(a,b,c){var d=this;if(d.removed&&a!=='remove'){return b}b=wZ(d).fire(a,b,c);if(c!==false&&d.parent){var e=d.parent();while(e&&!b.isPropagationStopped()){e.fire(a,b,false);e=e.parent()}}return b},on:function(a,b,c){return wZ(this).on(a,b,c)},off:function(a,b){return wZ(this).off(a,b)},once:function(a,b){return wZ(this).once(a,b)},hasEventListeners:function(a){return wZ(this).has(a)}};var xb=function(a,b){return a.fire('PreProcess',b)};var xc=function(a,b){return a.fire('PostProcess',b)};var xd=function(a){return a.fire('remove')};var xe=function(a,b){return a.fire('SwitchMode',{mode:b})};var xf=function(a,b,c,d){a.fire('ObjectResizeStart',{target:b,width:c,height:d})};var xg=function(a,b,c,d){a.fire('ObjectResized',{target:b,width:c,height:d})};var xh={firePreProcess:xb,firePostProcess:xc,fireRemove:xd,fireSwitchMode:xe,fireObjectResizeStart:xf,fireObjectResized:xg};var xi=function(a,b,c){try{a.getDoc().execCommand(b,false,c)}catch(ex){}};var xj=function(a,b,c){if(jt(a,b)&&c===false){js(a,b)}else if(c){jq(a,b)}};var xk=function(a,b){xj(eP.fromDom(a.getBody()),'mce-content-readonly',b);if(b){a.selection.controlSelection.hideResizeRect();a.readonly=true;a.getBody().contentEditable='false'}else{a.readonly=false;a.getBody().contentEditable='true';xi(a,'StyleWithCSS',false);xi(a,'enableInlineTableEditing',false);xi(a,'enableObjectResizing',false);a.focus();a.nodeChanged()}};var xl=function(a,b){if(b===xm(a)){return}if(a.initialized){xk(a,b==='readonly')}else{a.on('init',function(){xk(a,b==='readonly')})}xh.fireSwitchMode(a,b)};var xm=function(a){return a.readonly?'readonly':'design'};var xn=function(a){return a.readonly===true};var xo=iQ.DOM;var xp;var xq=function(a,b){if(b==='selectionchange'){return a.getDoc()}if(!a.inline&&/^mouse|touch|click|contextmenu|drop|dragover|dragend/.test(b)){return a.getDoc().documentElement}if(a.settings.event_root){if(!a.eventRoot){a.eventRoot=xo.select(a.settings.event_root)[0]}return a.eventRoot}return a.getBody()};var xr=function(a){return!a.hidden&&!a.readonly};var xs=function(a,b,e){if(xr(a)){a.fire(b,e)}else if(xn(a)){e.preventDefault()}};var xt=function(d,f){var g,delegate;if(!d.delegates){d.delegates={}}if(d.delegates[f]||d.removed){return}g=xq(d,f);if(d.settings.event_root){if(!xp){xp={};d.editorManager.on('removeEditor',function(){var a;if(!d.editorManager.activeEditor){if(xp){for(a in xp){d.dom.unbind(xq(d,a))}xp=null}}})}if(xp[f]){return}delegate=function(e){var a=e.target;var b=d.editorManager.get();var i=b.length;while(i--){var c=b[i].getBody();if(c===a||xo.isChildOf(a,c)){xs(b[i],f,e)}}};xp[f]=delegate;xo.bind(g,f,delegate)}else{delegate=function(e){xs(d,f,e)};xo.bind(g,f,delegate);d.delegates[f]=delegate}};var xu={bindPendingEventDelegates:function(){var b=this;dj.each(b._pendingNativeEvents,function(a){xt(b,a)})},toggleNativeEvent:function(a,b){var c=this;if(a==='focus'||a==='blur'){return}if(b){if(c.initialized){xt(c,a)}else{if(!c._pendingNativeEvents){c._pendingNativeEvents=[a]}else{c._pendingNativeEvents.push(a)}}}else if(c.initialized){c.dom.unbind(xq(c,a),a,c.delegates[a]);delete c.delegates[a]}},unbindAllNativeEvents:function(){var a=this;var b=a.getBody();var c=a.dom;var d;if(a.delegates){for(d in a.delegates){a.dom.unbind(xq(a,d),d,a.delegates[d])}delete a.delegates}if(!a.inline&&b&&c){b.onload=null;c.unbind(a.getWin());c.unbind(a.getDoc())}if(c){c.unbind(b);c.unbind(a.getContainer())}}};xu=dj.extend({},xa,xu);var xv=xu;var xw=dj.each,explode$2=dj.explode;var xx={f9:120,f10:121,f11:122};var xy=dj.makeMap('alt,ctrl,shift,meta,access');function Shortcuts(h){var i=this;var j={};var k=[];var l=function(b){var c,key;var d={};xw(explode$2(b,'+'),function(a){if(a in xy){d[a]=true}else{if(/^[0-9]{2,}$/.test(a)){d.keyCode=parseInt(a,10)}else{d.charCode=a.charCodeAt(0);d.keyCode=xx[a]||a.toUpperCase().charCodeAt(0)}}});c=[d.keyCode];for(key in xy){if(d[key]){c.push(key)}else{d[key]=false}}d.id=c.join(',');if(d.access){d.alt=true;if(co.mac){d.ctrl=true}else{d.shift=true}}if(d.meta){if(co.mac){d.meta=true}else{d.ctrl=true;d.meta=false}}return d};var m=function(a,b,c,d){var e;e=dj.map(explode$2(a,'>'),l);e[e.length-1]=dj.extend(e[e.length-1],{func:c,scope:d||h});return dj.extend(e[0],{desc:h.translate(b),subpatterns:e.slice(1)})};var n=function(e){return e.altKey||e.ctrlKey||e.metaKey};var o=function(e){return e.type==='keydown'&&e.keyCode>=112&&e.keyCode<=123};var p=function(e,a){if(!a){return false}if(a.ctrl!==e.ctrlKey||a.meta!==e.metaKey){return false}if(a.alt!==e.altKey||a.shift!==e.shiftKey){return false}if(e.keyCode===a.keyCode||e.charCode&&e.charCode===a.charCode){e.preventDefault();return true}return false};var q=function(a){return a.func?a.func.call(a.scope):null};h.on('keyup keypress keydown',function(e){if((n(e)||o(e))&&!e.isDefaultPrevented()){xw(j,function(a){if(p(e,a)){k=a.subpatterns.slice(0);if(e.type==='keydown'){q(a)}return true}});if(p(e,k[0])){if(k.length===1){if(e.type==='keydown'){q(k[0])}}k.shift()}}});i.add=function(c,d,e,f){var g;g=e;if(typeof e==='string'){e=function(){h.execCommand(g,false,null)}}else if(dj.isArray(g)){e=function(){h.execCommand(g[0],g[1],g[2])}}xw(explode$2(dj.trim(c.toLowerCase())),function(a){var b=m(a,d,e,f);j[b.id]=b});return true};i.remove=function(a){var b=m(a);if(j[b.id]){delete j[b.id];return true}return false}}var xz=function(a){var b=fX(a).dom();return a.dom()===b.activeElement};var xA=function(a){var b=a!==undefined?a.dom():document;return bo.from(b.activeElement).map(eP.fromDom)};var xB=function(a){return xA(fX(a)).filter(function(e){return a.dom().contains(e.dom())})};var xC=function(b,c){return b.dom.getParent(c,function(a){return b.dom.getContentEditable(a)==='true'})};var xD=function(a){return a.collapsed?bo.from(kP(a.startContainer,a.startOffset)).map(eP.fromDom):bo.none()};var xE=function(b,c){return xD(c).bind(function(a){if(gV(a)){return bo.some(a)}else if(fW(b,a)===false){return bo.some(b)}else{return bo.none()}})};var xF=function(b,c){xE(eP.fromDom(b.getBody()),c).bind(function(a){return nI.firstPositionIn(a.dom())}).fold(function(){b.selection.normalize();return},function(a){return b.selection.setRng(a.toRange())})};var xG=function(a){if(a.setActive){try{a.setActive()}catch(ex){a.focus()}}else{a.focus()}};var xH=function(a){return xz(a)||xB(a).isSome()};var xI=function(a){return a.iframeElement&&xz(eP.fromDom(a.iframeElement))};var xJ=function(a){var b=a.getBody();return b&&xH(eP.fromDom(b))};var xK=function(a){return a.inline?xJ(a):xI(a)};var xL=function(b){var c=b.selection,cm=b.settings.content_editable;var d=b.getBody();var e=c.getRng();b.quirks.refreshContentEditable();var f=xC(b,c.getNode());if(b.$.contains(d,f)){xG(f);xF(b,e);xM(b);return}if(b.bookmark!==undefined&&xK(b)===false){wP.getRng(b).each(function(a){b.selection.setRng(a);e=a})}if(!cm){if(!co.opera){xG(d)}b.getWin().focus()}if(co.gecko||cm){xG(d);xF(b,e)}xM(b)};var xM=function(a){return a.editorManager.setActive(a)};var xN=function(a,b){if(a.removed){return}b?xM(a):xL(a)};var xO={focus:xN,hasFocus:xK};var xP=function(a,b){var c=b.dom();return c[a]};var xQ=function(a,b){return parseInt(fB(b,a),10)};var xR=curry(xP,'clientWidth');var xS=curry(xP,'clientHeight');var xT=curry(xQ,'margin-top');var xU=curry(xQ,'margin-left');var xV=function(a){return a.dom().getBoundingClientRect()};var xW=function(a,b,c){var d=xR(a);var e=xS(a);return b>=0&&c>=0&&b<=d&&c<=e};var xX=function(a,b,c,d){var e=xV(b);var f=a?e.left+b.dom().clientLeft+xU(b):0;var g=a?e.top+b.dom().clientTop+xT(b):0;var x=c-f;var y=d-g;return{x:x,y:y}};var xY=function(a,b,c){var d=eP.fromDom(a.getBody());var e=a.inline?d:fY(d);var f=xX(a.inline,e,b,c);return xW(e,f.x,f.y)};var xZ=function(a){return bo.from(a).map(eP.fromDom)};var ya=function(b){var c=b.inline?b.getBody():b.getContentAreaContainer();return xZ(c).map(function(a){return fW(fX(a),a)}).getOr(false)};var yb={isXYInContentArea:xY,isEditorAttachedToDom:ya};function NotificationManagerImpl(){var a=function(){throw new Error('Theme did not provide a NotificationManager implementation.');};return{open:a,close:a,reposition:a,getArgs:a}}function NotificationManager(c){var d=[];var e=function(){var a=c.theme;return a&&a.getNotificationManagerImpl?a.getNotificationManagerImpl():NotificationManagerImpl()};var f=function(){return bo.from(d[0])};var g=function(a,b){return a.type===b.type&&a.text===b.text&&!a.progressBar&&!a.timeout&&!b.progressBar&&!b.timeout};var h=function(){if(d.length>0){e().reposition(d)}};var i=function(a){d.push(a)};var j=function(b){bK(d,function(a){return a===b}).each(function(a){d.splice(a,1)})};var k=function(b){if(c.removed||!yb.isEditorAttachedToDom(c)){return}return bJ(d,function(a){return g(e().getArgs(a),b)}).getOrThunk(function(){c.editorManager.setActive(c);var a=e().open(b,function(){j(a);h()});i(a);h();return a})};var l=function(){f().each(function(a){e().close(a);j(a);h()})};var m=function(){return d};var n=function(b){b.on('SkinLoaded',function(){var a=b.settings.service_message;if(a){k({text:a,type:'warning',timeout:0,icon:''})}});b.on('ResizeEditor ResizeWindow',function(){cy.requestAnimationFrame(h)});b.on('remove',function(){bD(d.slice(),function(a){e().close(a)})})};n(c);return{open:k,close:l,getNotifications:m}}function WindowManagerImpl(){var a=function(){throw new Error('Theme did not provide a WindowManager implementation.');};return{open:a,alert:a,confirm:a,close:a,getParams:a,setParams:a}}function WindowManager(e){var g=[];var h=function(){var a=e.theme;return a&&a.getWindowManagerImpl?a.getWindowManagerImpl():WindowManagerImpl()};var i=function(a,f){return function(){return f?f.apply(a,arguments):undefined}};var j=function(a){e.fire('OpenWindow',{win:a})};var k=function(a){e.fire('CloseWindow',{win:a})};var l=function(a){g.push(a);j(a)};var m=function(b){bK(g,function(a){return a===b}).each(function(a){g.splice(a,1);k(b);if(g.length===0){e.focus()}})};var n=function(){return bo.from(g[g.length-1])};var o=function(a,b){e.editorManager.setActive(e);wP.store(e);var c=h().open(a,b,m);l(c);return c};var p=function(a,b,c){var d=h().alert(a,i(c?c:this,b),m);l(d)};var q=function(a,b,c){var d=h().confirm(a,i(c?c:this,b),m);l(d)};var r=function(){n().each(function(a){h().close(a);m(a)})};var s=function(){return n().map(h().getParams).getOr(null)};var t=function(b){n().each(function(a){h().setParams(a,b)})};var u=function(){return g};e.on('remove',function(){bD(g.slice(0),function(a){h().close(a)})});return{windows:g,open:o,alert:p,confirm:q,close:r,getParams:s,setParams:t,getWindows:u}}var yc=AddOnManager.PluginManager;var yd=function(a,b){for(var c in yc.urls){var d=yc.urls[c]+'/plugin'+b+'.js';if(d===a){return c}}return null};var ye=function(a,b){var c=yd(b,a.suffix);return c?'Failed to load plugin: '+c+' from url '+b:'Failed to load plugin url: '+b};var yf=function(a,b){a.notificationManager.open({type:'error',text:b})};var yg=function(a,b){if(a._skinLoaded){yf(a,b)}else{a.on('SkinLoaded',function(){yf(a,b)})}};var yh=function(a,b){yg(a,'Failed to upload image: '+b)};var yi=function(a,b){yg(a,ye(a,b))};var yj=function(a){var x=[];for(var b=1;b<arguments.length;b++){x[b-1]=arguments[b]}var c=window.console;if(c){if(c.error){c.error.apply(c,arguments)}else{c.log.apply(c,arguments)}}};var yk={pluginLoadError:yi,uploadError:yh,displayError:yg,initError:yj};var yl=AddOnManager.PluginManager;var ym=AddOnManager.ThemeManager;function XMLHttpRequest(){var f=cd.getOrDie('XMLHttpRequest');return new f()}function Uploader(k,l){var m={};var n=function(a,b){if(a){return a.replace(/\/$/,'')+'/'+b.replace(/^\//,'')}return b};var o=function(b,c,d,f){var g,formData;g=XMLHttpRequest();g.open('POST',l.url);g.withCredentials=l.credentials;g.upload.onprogress=function(e){f(e.loaded/e.total*100)};g.onerror=function(){d('Image upload failed due to a XHR Transport error. Code: '+g.status)};g.onload=function(){var a;if(g.status<200||g.status>=300){d('HTTP Error: '+g.status);return}a=JSON.parse(g.responseText);if(!a||typeof a.location!=='string'){d('Invalid JSON: '+g.responseText);return}c(n(l.basePath,a.location))};formData=new FormData();formData.append('file',b.blob(),b.filename());g.send(formData)};var p=function(){return new cq(function(a){a([])})};var q=function(a,b){return{url:b,blobInfo:a,status:true}};var r=function(a,b){return{url:'',blobInfo:a,status:false,error:b}};var s=function(b,c){dj.each(m[b],function(a){a(c)});delete m[b]};var t=function(h,i,j){k.markPending(h.blobUri());return new cq(function(b){var c,progress;var d=function(){};try{var e=function(){if(c){c.close();progress=d}};var f=function(a){e();k.markUploaded(h.blobUri(),a);s(h.blobUri(),q(h,a));b(q(h,a))};var g=function(a){e();k.removeFailed(h.blobUri());s(h.blobUri(),r(h,a));b(r(h,a))};progress=function(a){if(a<0||a>100){return}if(!c){c=j()}c.progressBar.value(a)};i(h,f,g,progress)}catch(ex){b(r(h,ex.message))}})};var u=function(a){return a===o};var v=function(b){var c=b.blobUri();return new cq(function(a){m[c]=m[c]||[];m[c].push(a)})};var w=function(b,c){b=dj.grep(b,function(a){return!k.isUploaded(a.blobUri())});return cq.all(dj.map(b,function(a){return k.isPending(a.blobUri())?v(a):t(a,l.handler,c)}))};var x=function(a,b){return!l.url&&u(l.handler)?p():w(a,b)};if(bw(l.handler)===false){l.handler=o}return{upload:x}}function FileReader(){var f=cd.getOrDie('FileReader');return new f()}function Uint8Array(a){var f=cd.getOrDie('Uint8Array');return new f(a)}var yn=function(a){var f=cd.getOrDie('requestAnimationFrame');f(a)};var yo=function(a){var f=cd.getOrDie('atob');return f(a)};var yp={atob:yo,requestAnimationFrame:yn};var yq=function(e){return new cq(function(a,b){var c=function(){b('Cannot convert '+e+' to Blob. Resource might not exist or is inaccessible.')};try{var d=XMLHttpRequest();d.open('GET',e,true);d.responseType='blob';d.onload=function(){if(this.status===200){a(this.response)}else{c()}};d.onerror=c;d.send()}catch(ex){c()}})};var yr=function(a){var b,matches;var c=decodeURIComponent(a).split(',');matches=/data:([^;]+)/.exec(c[0]);if(matches){b=matches[1]}return{type:b,data:c[1]}};var ys=function(d){return new cq(function(a){var b,arr,i;var c=yr(d);try{b=yp.atob(c.data)}catch(e){a(new Blob([]));return}arr=Uint8Array(b.length);for(i=0;i<arr.length;i++){arr[i]=b.charCodeAt(i)}a(new Blob([arr],{type:c.type}))})};var yt=function(a){if(a.indexOf('blob:')===0){return yq(a)}if(a.indexOf('data:')===0){return ys(a)}return null};var yu=function(c){return new cq(function(a){var b=FileReader();b.onloadend=function(){a(b.result)};b.readAsDataURL(c)})};var yv={uriToBlob:yt,blobToDataUri:yu,parseDataUri:yr};var yw=0;var yx=function(a){return(a||'blobid')+yw++};var yy=function(c,d,e,f){var g,blobInfo;if(d.src.indexOf('blob:')===0){blobInfo=c.getByUri(d.src);if(blobInfo){e({image:d,blobInfo:blobInfo})}else{yv.uriToBlob(d.src).then(function(b){yv.blobToDataUri(b).then(function(a){g=yv.parseDataUri(a).data;blobInfo=c.create(yx(),b,g);c.add(blobInfo);e({image:d,blobInfo:blobInfo})})},function(a){f(a)})}return}g=yv.parseDataUri(d.src).data;blobInfo=c.findFirst(function(a){return a.base64()===g});if(blobInfo){e({image:d,blobInfo:blobInfo})}else{yv.uriToBlob(d.src).then(function(a){blobInfo=c.create(yx(),a,g);c.add(blobInfo);e({image:d,blobInfo:blobInfo})},function(a){f(a)})}};var yz=function(a){return a?bX(a.getElementsByTagName('img')):[]};function ImageScanner(i,j){var k={};var l=function(e,f){var g;if(!f){f=bc(true)}g=bG(yz(e),function(a){var b=a.src;if(!co.fileApi){return false}if(a.hasAttribute('data-mce-bogus')){return false}if(a.hasAttribute('data-mce-placeholder')){return false}if(!b||b===co.transparentSrc){return false}if(b.indexOf('blob:')===0){return!i.isUploaded(b)&&f(a)}if(b.indexOf('data:')===0){return f(a)}return false});var h=bC(g,function(c){if(k[c.src]){return new cq(function(b){k[c.src].then(function(a){if(typeof a==='string'){return a}b({image:c,blobInfo:a.blobInfo})})})}var d=new cq(function(a,b){yy(j,c,a,b)}).then(function(a){delete k[a.image.src];return a}).catch(function(a){delete k[c.src];return a});k[c.src]=d;return d});return cq.all(h)};return{findAll:l}}var yA=0;var yB=function(){var a=function(){return Math.round(Math.random()*4294967295).toString(36)};var b=new Date().getTime();return's'+b.toString(36)+a()+a()+a()};var yC=function(a){return a+yA++ +yB()};var yD={uuid:yC};function BlobCache(){var e=[];var f=function(a){var b={'image/jpeg':'jpg','image/jpg':'jpg','image/gif':'gif','image/png':'png'};return b[a.toLowerCase()]||'dat'};var g=function(o,a,b,c){if(br(o)){var d=o;return h({id:d,name:c,blob:a,base64:b})}else if(bs(o)){return h(o)}else{throw new Error('Unknown input type');}};var h=function(o){var a,fc;if(!o.blob||!o.base64){throw new Error('blob and base64 representations of the image are required for BlobInfo to be created');}a=o.id||yD.uuid('blobid');fc=o.name||a;return{id:bc(a),name:bc(fc),filename:bc(fc+'.'+f(o.blob.type)),blob:bc(o.blob),base64:bc(o.base64),blobUri:bc(o.blobUri||ch.createObjectURL(o.blob)),uri:bc(o.uri)}};var i=function(a){if(!j(a.id())){e.push(a)}};var j=function(b){return k(function(a){return a.id()===b})};var k=function(a){return bG(e,a)[0]};var l=function(b){return k(function(a){return a.blobUri()===b})};var m=function(b){e=bG(e,function(a){if(a.blobUri()===b){ch.revokeObjectURL(a.blobUri());return false}return true})};var n=function(){bD(e,function(a){ch.revokeObjectURL(a.blobUri())});e=[]};return{create:g,add:i,get:j,getByUri:l,findFirst:k,removeByUri:m,destroy:n}}function UploadStatus(){var c=1,UPLOADED=2;var d={};var e=function(a,b){return{status:a,resultUri:b}};var f=function(a){return a in d};var g=function(a){var b=d[a];return b?b.resultUri:null};var h=function(a){return f(a)?d[a].status===c:false};var i=function(a){return f(a)?d[a].status===UPLOADED:false};var j=function(a){d[a]=e(c,null)};var k=function(a,b){d[a]=e(UPLOADED,b)};var l=function(a){delete d[a]};var m=function(){d={}};return{hasBlobUri:f,getResultUri:g,isPending:h,isUploaded:i,markPending:j,markUploaded:k,removeFailed:l,destroy:m}}function EditorUpload(i){var j=BlobCache();var k,imageScanner;var l=UploadStatus();var m=[];var n=function(b){return function(a){if(i.selection){return b(a)}return[]}};var o=function(){return'?'+new Date().getTime()};var p=function(a,b,c){var d=0;do{d=a.indexOf(b,d);if(d!==-1){a=a.substring(0,d)+c+a.substr(d+b.length);d+=c.length-b.length+1}}while(d!==-1);return a};var q=function(a,b,c){a=p(a,'src="'+b+'"','src="'+c+'"');a=p(a,'data-mce-src="'+b+'"','data-mce-src="'+c+'"');return a};var r=function(c,d){bD(i.undoManager.data,function(b){if(b.type==='fragmented'){b.fragments=bC(b.fragments,function(a){return q(a,c,d)})}else{b.content=q(b.content,c,d)}})};var s=function(){return i.notificationManager.open({text:i.translate('Image uploading...'),type:'info',timeout:-1,progressBar:true})};var t=function(a,b){j.removeByUri(a.src);r(a.src,b);i.$(a).attr({'src':vB.shouldReuseFileName(i)?b+o():b,'data-mce-src':i.convertURL(b,'src')})};var u=function(h){if(!k){k=Uploader(l,{url:vB.getImageUploadUrl(i),basePath:vB.getImageUploadBasePath(i),credentials:vB.getImagesUploadCredentials(i),handler:vB.getImagesUploadHandler(i)})}return y().then(n(function(f){var g;g=bC(f,function(a){return a.blobInfo});return k.upload(g,s).then(n(function(d){var e=bC(d,function(a,b){var c=f[b].image;if(a.status&&vB.shouldReplaceBlobUris(i)){t(c,a.url)}else if(a.error){yk.uploadError(i,a.error)}return{element:c,status:a.status}});if(h){h(e)}return e}))}))};var v=function(a){if(vB.isAutomaticUploadsEnabled(i)){return u(a)}};var w=function(b){if(bP(m,function(a){return a(b)})===false){return false}if(b.getAttribute('src').indexOf('data:')===0){var c=vB.getImagesDataImgFilter(i);return c(b)}return true};var x=function(a){m.push(a)};var y=function(){if(!imageScanner){imageScanner=ImageScanner(l,j)}return imageScanner.findAll(i.getBody(),w).then(n(function(b){b=bG(b,function(a){if(typeof a==='string'){yk.displayError(i,a);return false}return true});bD(b,function(a){r(a.image.src,a.blobInfo.blobUri());a.image.src=a.blobInfo.blobUri();a.image.removeAttribute('data-mce-src')});return b}))};var z=function(){j.destroy();l.destroy();imageScanner=k=null};var A=function(h){return h.replace(/src="(blob:[^"]+)"/g,function(c,d){var e=l.getResultUri(d);if(e){return'src="'+e+'"'}var f=j.getByUri(d);if(!f){f=bI(i.editorManager.get(),function(a,b){return a||b.editorUpload&&b.editorUpload.blobCache.getByUri(d)},null)}if(f){var g=f.blob();return'src="data:'+g.type+';base64,'+f.base64()+'"'}return c})};i.on('setContent',function(){if(vB.isAutomaticUploadsEnabled(i)){v()}else{y()}});i.on('RawSaveContent',function(e){e.content=A(e.content)});i.on('getContent',function(e){if(e.source_view||e.format==='raw'){return}e.content=A(e.content)});i.on('PostRender',function(){i.parser.addNodeFilter('img',function(d){bD(d,function(a){var b=a.attr('src');if(j.getByUri(b)){return}var c=l.getResultUri(b);if(c){a.attr('src',c)}})})});return{blobCache:j,addFilter:x,uploadImages:u,uploadImagesAuto:v,scanForImages:y,destroy:z}}var yE=function(a,b){return a.hasOwnProperty(b.nodeName)};var yF=function(a,b){if(hq.isText(b)){return true}else if(hq.isElement(b)){return!yE(a,b)&&!og.isBookmarkNode(b)}else{return false}};var yG=function(b,c,d){return bB(rn.parents(eP.fromDom(d),eP.fromDom(c)),function(a){return yE(b,a.dom())})};var yH=function(a,b){if(hq.isText(b)){if(b.nodeValue.length===0){return true}else if(/^\s+$/.test(b.nodeValue)&&(!b.nextSibling||yE(a,b.nextSibling))){return true}}return false};var yI=function(a){var b=a.settings,Cu=a.dom,selection=a.selection;var c=a.schema,blockElements=c.getBlockElements();var d=selection.getStart();var e=a.getBody();var f;var g,startOffset,endContainer,endOffset,rootBlockNode;var h,wrapped,restoreSelection;var i,forcedRootBlock;forcedRootBlock=b.forced_root_block;if(!d||!hq.isElement(d)||!forcedRootBlock){return}i=e.nodeName.toLowerCase();if(!c.isValidChild(i,forcedRootBlock.toLowerCase())||yG(blockElements,e,d)){return}f=selection.getRng();g=f.startContainer;startOffset=f.startOffset;endContainer=f.endContainer;endOffset=f.endOffset;restoreSelection=xO.hasFocus(a);d=e.firstChild;while(d){if(yF(blockElements,d)){if(yH(blockElements,d)){h=d;d=d.nextSibling;Cu.remove(h);continue}if(!rootBlockNode){rootBlockNode=Cu.create(forcedRootBlock,a.settings.forced_root_block_attrs);d.parentNode.insertBefore(rootBlockNode,d);wrapped=true}h=d;d=d.nextSibling;rootBlockNode.appendChild(h)}else{rootBlockNode=null;d=d.nextSibling}}if(wrapped&&restoreSelection){f.setStart(g,startOffset);f.setEnd(endContainer,endOffset);selection.setRng(f);a.nodeChanged()}};var yJ=function(a){if(a.settings.forced_root_block){a.on('NodeChange',curry(yI,a))}};var yK={setup:yJ};var yL=function(a){var b=a.startContainer,so=a.startOffset;if(hq.isText(b)){return so===0?bo.some(eP.fromDom(b)):bo.none()}else{return bo.from(b.childNodes[so]).map(eP.fromDom)}};var yM=function(a){var b=a.endContainer,eo=a.endOffset;if(hq.isText(b)){return eo===b.data.length?bo.some(eP.fromDom(b)):bo.none()}else{return bo.from(b.childNodes[eo-1]).map(eP.fromDom)}};var yN=function(b){return gi(b).fold(bc([b]),function(a){return[b].concat(yN(a))})};var yO=function(c){return gj(c).fold(bc([c]),function(b){if(fc(b)==='br'){return gc(b).map(function(a){return[c].concat(yO(a))}).getOr([])}else{return[c].concat(yO(b))}})};var yP=function(e,f){return kS([yL(f),yM(f)],function(a,b){var c=bJ(yN(e),curry(fS,a));var d=bJ(yO(e),curry(fS,b));return c.isSome()&&d.isSome()}).getOr(false)};var yQ=function(a,b,c,d){var e=c,walker=new TreeWalker(c,e);var f=a.schema.getNonEmptyElements();do{if(c.nodeType===3&&dj.trim(c.nodeValue).length!==0){if(d){b.setStart(c,0)}else{b.setEnd(c,c.nodeValue.length)}return}if(f[c.nodeName]&&!/^(TD|TH)$/.test(c.nodeName)){if(d){b.setStartBefore(c)}else{if(c.nodeName==='BR'){b.setEndBefore(c)}else{b.setEndAfter(c)}}return}if(co.ie&&co.ie<11&&a.isBlock(c)&&a.isEmpty(c)){if(d){b.setStart(c,0)}else{b.setEnd(c,0)}return}}while(c=d?walker.next():walker.prev());if(e.nodeName==='BODY'){if(d){b.setStart(e,0)}else{b.setEnd(e,e.childNodes.length)}}};var yR=function(a){var b=a.selection.getSel();return b&&b.rangeCount>0};function NodeChange(f){var g,lastPath=[];var h=function(a){var i,currentPath;currentPath=f.$(a).parentsUntil(f.getBody()).add(a);if(currentPath.length===lastPath.length){for(i=currentPath.length;i>=0;i--){if(currentPath[i]!==lastPath[i]){break}}if(i===-1){lastPath=currentPath;return true}}lastPath=currentPath;return false};if(!('onselectionchange'in f.getDoc())){f.on('NodeChange Click MouseUp KeyUp Focus',function(e){var a,fakeRng;a=f.selection.getRng();fakeRng={startContainer:a.startContainer,startOffset:a.startOffset,endContainer:a.endContainer,endOffset:a.endOffset};if(e.type==='nodechange'||!vS.isEq(fakeRng,g)){f.fire('SelectionChange')}g=fakeRng})}f.on('contextmenu',function(){f.fire('SelectionChange')});f.on('SelectionChange',function(){var a=f.selection.getStart(true);if(!a||!co.range&&f.selection.isCollapsed()){return}if(yR(f)&&!h(a)&&f.dom.isChildOf(a,f.getBody())){f.nodeChanged({selectionChange:true})}});f.on('MouseUp',function(e){if(!e.isDefaultPrevented()&&yR(f)){if(f.selection.getNode().nodeName==='IMG'){cy.setEditorTimeout(f,function(){f.nodeChanged()})}else{f.nodeChanged()}}});this.nodeChanged=function(b){var c=f.selection;var d,gb,root;if(f.initialized&&c&&!f.settings.disable_nodechange&&!f.readonly){root=f.getBody();d=c.getStart(true)||root;if(d.ownerDocument!==f.getDoc()||!f.dom.isChildOf(d,root)){d=root}gb=[];f.dom.getParent(d,function(a){if(a===root){return true}gb.push(a)});b=b||{};b.element=d;b.parents=gb;f.fire('NodeChange',b)}}}var yS=function(a){var b,docElem,win,clientRect;clientRect=a.getBoundingClientRect();b=a.ownerDocument;docElem=b.documentElement;win=b.defaultView;return{top:clientRect.top+win.pageYOffset-docElem.clientTop,left:clientRect.left+win.pageXOffset-docElem.clientLeft}};var yT=function(a){return a.inline?yS(a.getBody()):{left:0,top:0}};var yU=function(a){var b=a.getBody();return a.inline?{left:b.scrollLeft,top:b.scrollTop}:{left:0,top:0}};var yV=function(a){var b=a.getBody(),docElm=a.getDoc().documentElement;var c={left:b.scrollLeft,top:b.scrollTop};var d={left:b.scrollLeft||docElm.scrollLeft,top:b.scrollTop||docElm.scrollTop};return a.inline?c:d};var yW=function(a,b){if(b.target.ownerDocument!==a.getDoc()){var c=yS(a.getContentAreaContainer());var d=yV(a);return{left:b.pageX-c.left+d.left,top:b.pageY-c.top+d.top}}return{left:b.pageX,top:b.pageY}};var yX=function(a,b,c){return{pageX:c.left-a.left+b.left,pageY:c.top-a.top+b.top}};var yY=function(a,b){return yX(yT(a),yU(a),yW(a,b))};var yZ={calc:yY};var za=hq.isContentEditableFalse,isContentEditableTrue$3=hq.isContentEditableTrue;var zb=function(a,b){return za(b)&&b!==a};var zc=function(a,b,c){if(b===c||a.dom.isChildOf(b,c)){return false}if(za(b)){return false}return true};var zd=function(a){var b=a.cloneNode(true);b.removeAttribute('data-mce-selected');return b};var ze=function(a,b,c,d){var e=b.cloneNode(true);a.dom.setStyles(e,{width:c,height:d});a.dom.setAttrib(e,'data-mce-selected',null);var f=a.dom.create('div',{'class':'mce-drag-container','data-mce-bogus':'all','unselectable':'on','contenteditable':'false'});a.dom.setStyles(f,{position:'absolute',opacity:0.5,overflow:'hidden',border:0,padding:0,margin:0,width:c,height:d});a.dom.setStyles(e,{margin:0,boxSizing:'border-box'});f.appendChild(e);return f};var zf=function(a,b){if(a.parentNode!==b){b.appendChild(a)}};var zg=function(a,b,c,d,e,f){var g=0,kM=0;a.style.left=b.pageX+'px';a.style.top=b.pageY+'px';if(b.pageX+c>e){g=b.pageX+c-e}if(b.pageY+d>f){kM=b.pageY+d-f}a.style.width=c-g+'px';a.style.height=d-kM+'px'};var zh=function(a){if(a&&a.parentNode){a.parentNode.removeChild(a)}};var zi=function(e){return e.button===0};var zj=function(a){return a.element};var zk=function(a,b){return{pageX:b.pageX-a.relX,pageY:b.pageY+5}};var zl=function(f,g){return function(e){if(zi(e)){var a=bJ(g.dom.getParents(e.target),kW.or(za,isContentEditableTrue$3)).getOr(null);if(zb(g.getBody(),a)){var b=g.dom.getPos(a);var c=g.getBody();var d=g.getDoc().documentElement;f.element=a;f.screenX=e.screenX;f.screenY=e.screenY;f.maxX=(g.inline?c.scrollWidth:d.offsetWidth)-2;f.maxY=(g.inline?c.scrollHeight:d.offsetHeight)-2;f.relX=e.pageX-b.x;f.relY=e.pageY-b.y;f.width=a.offsetWidth;f.height=a.offsetHeight;f.ghost=ze(g,a,f.width,f.height)}}}};var zm=function(d,f){var g=cy.throttle(function(a,b){f._selectionOverrides.hideFakeCaret();f.selection.placeCaretAt(a,b)},0);return function(e){var a=Math.max(Math.abs(e.screenX-d.screenX),Math.abs(e.screenY-d.screenY));if(zj(d)&&!d.dragging&&a>10){var b=f.fire('dragstart',{target:d.element});if(b.isDefaultPrevented()){return}d.dragging=true;f.focus()}if(d.dragging){var c=zk(d,yZ.calc(f,e));zf(d.ghost,f.getBody());zg(d.ghost,c,d.width,d.height,d.maxX,d.maxY);g(e.clientX,e.clientY)}}};var zn=function(a){var b=a.getSel().getRangeAt(0);var c=b.startContainer;return c.nodeType===3?c.parentNode:c};var zo=function(c,d){return function(e){if(c.dragging){if(zc(d,zn(d.selection),c.element)){var a=zd(c.element);var b=d.fire('drop',{targetClone:a,clientX:e.clientX,clientY:e.clientY});if(!b.isDefaultPrevented()){a=b.targetClone;d.undoManager.transact(function(){zh(c.element);d.insertContent(d.dom.getOuterHTML(a));d._selectionOverrides.hideFakeCaret()})}}}zq(c)}};var zp=function(a,b){return function(){if(a.dragging){b.fire('dragend')}zq(a)}};var zq=function(a){a.dragging=false;a.element=null;zh(a.ghost)};var zr=function(a){var b={};var c,dragStartHandler,dragHandler,dropHandler,dragEndHandler,rootDocument;c=iQ.DOM;rootDocument=document;dragStartHandler=zl(b,a);dragHandler=zm(b,a);dropHandler=zo(b,a);dragEndHandler=zp(b,a);a.on('mousedown',dragStartHandler);a.on('mousemove',dragHandler);a.on('mouseup',dropHandler);c.bind(rootDocument,'mousemove',dragHandler);c.bind(rootDocument,'mouseup',dragEndHandler);a.on('remove',function(){c.unbind(rootDocument,'mousemove',dragHandler);c.unbind(rootDocument,'mouseup',dragEndHandler)})};var zs=function(b){b.on('drop',function(e){var a=typeof e.clientX!=='undefined'?b.getDoc().elementFromPoint(e.clientX,e.clientY):null;if(za(a)||za(b.dom.getContentEditableParent(a))){e.preventDefault()}})};var zt=function(a){zr(a);zs(a)};var zu={init:zt};var zv=function(c){var d=function(b){return bC(b,function(a){a=kE(a);a.node=c;return a})};if(hq.isElement(c)){return d(c.getClientRects())}if(hq.isText(c)){var e=c.ownerDocument.createRange();e.setStart(c,0);e.setEnd(c,c.data.length);return d(e.getClientRects())}};var zw=function(c){return bI(c,function(a,b){return a.concat(zv(b))},[])};var zx;(function(a){a[a['Up']=-1]='Up';a[a['Down']=1]='Down'}(zx||(zx={})));var zy=function(a,b,c,d){while(d=mJ(d,a,kC,b)){if(c(d)){return}}};var zz=function(b,c,d,e,f,g){var h=0,fH;var j=[];var k;var l=function(a){var i,clientRect,clientRects;clientRects=zw([a]);if(b===-1){clientRects=clientRects.reverse()}for(i=0;i<clientRects.length;i++){clientRect=clientRects[i];if(d(clientRect,k)){continue}if(j.length>0&&c(clientRect,cW.last(j))){h++}clientRect.line=h;if(f(clientRect)){return true}j.push(clientRect)}};k=cW.last(g.getClientRects());if(!k){return j}fH=g.getNode();l(fH);zy(b,e,l,fH);return j};var zA=function(a,b){return b.line>a};var zB=function(a,b){return b.line===a};var zC=curry(zz,zx.Up,kI,kJ);var zD=curry(zz,zx.Down,kJ,kI);var zE=function(b,c,d,e){var f=nv(c);var g,isBelowFn,isAboveFn,caretPosition;var h=[];var i=0,clientRect,targetClientRect;var j=function(a){if(b===1){return cW.last(a.getClientRects())}return cW.last(a.getClientRects())};if(b===1){g=f.next;isBelowFn=kJ;isAboveFn=kI;caretPosition=lr.after(e)}else{g=f.prev;isBelowFn=kI;isAboveFn=kJ;caretPosition=lr.before(e)}targetClientRect=j(caretPosition);do{if(!caretPosition.isVisible()){continue}clientRect=j(caretPosition);if(isAboveFn(clientRect,targetClientRect)){continue}if(h.length>0&&isBelowFn(clientRect,cW.last(h))){i++}clientRect=kE(clientRect);clientRect.position=caretPosition;clientRect.line=i;if(d(clientRect)){return h}h.push(clientRect)}while(caretPosition=g(caretPosition));return h};var zF=function(b){return function(a){return zA(b,a)}};var zG=function(b){return function(a){return zB(b,a)}};var zH=hq.isContentEditableFalse;var zI=mJ;var zJ=function(a,b){return Math.abs(a.left-b)};var zK=function(a,b){return Math.abs(a.right-b)};var zL=function(a,b){return a>=b.left&&a<=b.right};var zM=function(d,e){return cW.reduce(d,function(a,b){var c,newDistance;c=Math.min(zJ(a,e),zK(a,e));newDistance=Math.min(zJ(b,e),zK(b,e));if(zL(e,b)){return b}if(zL(e,a)){return a}if(newDistance===c&&zH(b.node)){return b}if(newDistance<c){return b}return a})};var zN=function(a,b,c,d){while(d=zI(d,a,kC,b)){if(c(d)){return}}};var zO=function(e,f){var g=[];var h=function(b,c){var d;d=bG(zw([c]),function(a){return!b(a,f)});g=g.concat(d);return d.length===0};g.push(f);zN(zx.Up,e,curry(h,kI),f.node);zN(zx.Down,e,curry(h,kJ),f.node);return g};var zP=function(a){return bG(bX(a.getElementsByTagName('*')),mv)};var zQ=function(a,b){return{node:a.node,before:zJ(a,b)<zK(a,b)}};var zR=function(b,c,d){var e;var f=zw(zP(b));var g=bG(f,function(a){return d>=a.top&&d<=a.bottom});e=zM(g,c);if(e){e=zM(zO(b,e),c);if(e&&mv(e.node)){return zQ(e,c)}}return null};var zS=function(c,d,e){if(e.collapsed){return false}return bI(e.getClientRects(),function(a,b){return a||kK(b,c,d)},false)};var zT={isXYWithinRange:zS};var zU=hq.isContentEditableTrue;var zV=hq.isContentEditableFalse;var zW=function(a,b,c,d,e){return b._selectionOverrides.showCaret(a,c,d,e)};var zX=function(a){var b=a.ownerDocument.createRange();b.selectNode(a);return b};var zY=function(a,b){var e=a.fire('BeforeObjectSelected',{target:b});if(e.isDefaultPrevented()){return null}return zX(b)};var zZ=function(b,c,d){var e=mS(1,b.getBody(),c);var f=lr.fromRangeStart(e);var g=f.getNode();if(zV(g)){return zW(1,b,g,!f.isAtEnd(),false)}var h=f.getNode(true);if(zV(h)){return zW(1,b,h,false,false)}var i=b.dom.getParent(f.getNode(),function(a){return zV(a)||zU(a)});if(zV(i)){return zW(1,b,i,false,d)}return null};var Aa=function(a,b,c){if(!b||!b.collapsed){return b}var d=zZ(a,b,c);if(d){return d}return b};var Ab=function(c){var d=jg(function(){if(!c.removed){var a=c.selection.getRng();if(a.collapsed){var b=Aa(c,c.selection.getRng(),false);c.selection.setRng(b)}}},0);c.on('focus',function(){d.throttle()});c.on('blur',function(){d.cancel()})};var Ac={setup:Ab};var Ad={BACKSPACE:8,DELETE:46,DOWN:40,ENTER:13,LEFT:37,RIGHT:39,SPACEBAR:32,TAB:9,UP:38,modifierPressed:function(e){return e.shiftKey||e.ctrlKey||e.altKey||this.metaKeyPressed(e)},metaKeyPressed:function(e){return co.mac?e.metaKey:e.ctrlKey&&!e.altKey}};var Ae=hq.isContentEditableTrue;var Af=hq.isContentEditableFalse;var Ag=mY;var Ah=mX;var Ai=function(a,b){var c=a.getBody();while(b&&b!==c){if(Ae(b)||Af(b)){return b}b=b.parentNode}return null};var Aj=function(k){var l=function(a){return k.dom.isBlock(a)};var m=k.getBody();var n=mt(k.getBody(),l,function(){return xO.hasFocus(k)});var o='sel-'+k.dom.uniqueId();var p;var q=function(a){return k.dom.hasClass(a,'mce-offscreen-selection')};var r=function(){var a=k.dom.get(o);return a?a.getElementsByTagName('*')[0]:a};var s=function(a){if(a){k.selection.setRng(a)}};var t=function(){return k.selection.getRng()};var u=function(a,b,c,d){if(d===void 0){d=true}var e;e=k.fire('ShowCaret',{target:b,direction:a,before:c});if(e.isDefaultPrevented()){return null}if(d){k.selection.scrollIntoView(b,a===-1)}return n.show(c,b)};var v=function(a,b){b=mS(a,m,b);if(a===-1){return lr.fromRangeStart(b)}return lr.fromRangeEnd(b)};var w=function(a){if(a.hasAttribute('data-mce-caret')){km(a);s(t());k.selection.scrollIntoView(a[0])}};var x=function(){k.on('mouseup',function(e){var a=t();if(a.collapsed&&yb.isXYInContentArea(k,e.clientX,e.clientY)){s(zZ(k,a,false))}});k.on('click',function(e){var a;a=Ai(k,e.target);if(a){if(Af(a)){e.preventDefault();k.focus()}if(Ae(a)){if(k.dom.isChildOf(a,k.selection.getNode())){C()}}}});k.on('blur NewBlock',function(){C()});k.on('ResizeWindow FullscreenStateChanged',function(){return n.reposition()});var f=function(b){var c=false;b.on('touchstart',function(){c=false});b.on('touchmove',function(){c=true});b.on('touchend',function(e){var a=Ai(b,e.target);if(Af(a)){if(!c){e.preventDefault();B(zY(b,a))}}})};var g=function(a){var b=nv(a);if(!a.firstChild){return false}var c=lr.before(a.firstChild);var d=b.next(c);return d&&!Ah(d)&&!Ag(d)};var h=function(a,b){var c=k.dom.getParent(a,k.dom.isBlock);var d=k.dom.getParent(b,k.dom.isBlock);return c===d};var i=function(a,b){var c=k.dom.getParent(a,k.dom.isBlock);var d=k.dom.getParent(b,k.dom.isBlock);if(c&&k.dom.isChildOf(c,d)&&Af(Ai(k,c))===false){return true}return c&&!h(c,d)&&g(c)};f(k);k.on('mousedown',function(e){var a;var b=e.target;if(b!==m&&b.nodeName!=='HTML'&&!k.dom.isChildOf(b,m)){return}if(yb.isXYInContentArea(k,e.clientX,e.clientY)===false){return}a=Ai(k,b);if(a){if(Af(a)){e.preventDefault();B(zY(k,a))}else{C();if(!(Ae(a)&&e.shiftKey)&&!zT.isXYWithinRange(e.clientX,e.clientY,k.selection.getRng())){E();k.selection.placeCaretAt(e.clientX,e.clientY)}}}else if(mv(b)===false){C();E();var c=zR(m,e.clientX,e.clientY);if(c){if(!i(e.target,c.node)){e.preventDefault();var d=u(1,c.node,c.before,false);k.getBody().focus();s(d)}}}});k.on('keypress',function(e){if(Ad.modifierPressed(e)){return}switch(e.keyCode){default:if(Af(k.selection.getNode())){e.preventDefault()}break}});k.on('getSelectionRange',function(e){var a=e.range;if(p){if(!p.parentNode){p=null;return}a=a.cloneRange();a.selectNode(p);e.range=a}});k.on('setSelectionRange',function(e){var a;a=B(e.range,e.forward);if(a){e.range=a}});var j=function(a){return a.id==='mcepastebin'};k.on('AfterSetSelectionRange',function(e){var a=e.range;if(!A(a)&&!j(a.startContainer.parentNode)){E()}if(!q(a.startContainer.parentNode)){C()}});k.on('copy',function(e){var a=e.clipboardData;if(!e.isDefaultPrevented()&&e.clipboardData&&!co.ie){var b=r();if(b){e.preventDefault();a.clearData();a.setData('text/html',b.outerHTML);a.setData('text/plain',b.outerText)}}});zu.init(k);Ac.setup(k)};var y=function(){var a=k.contentStyles,rootClass='.mce-content-body';a.push(n.getCss());a.push(rootClass+' .mce-offscreen-selection {'+'position: absolute;'+'left: -9999999999px;'+'max-width: 1000000px;'+'}'+rootClass+' *[contentEditable=false] {'+'cursor: default;'+'}'+rootClass+' *[contentEditable=true] {'+'cursor: text;'+'}')};var z=function(a){return kc(a)||kj(a)||kk(a)};var A=function(a){return z(a.startContainer)||z(a.endContainer)};var B=function(b,c){var d;var $=k.$;var f=k.dom;var g,sel,startContainer,startOffset,endOffset,e,caretPosition,targetClone,origTargetClone;if(!b){return null}if(b.collapsed){if(!A(b)){if(c===false){caretPosition=v(-1,b);if(mv(caretPosition.getNode(true))){return u(-1,caretPosition.getNode(true),false,false)}if(mv(caretPosition.getNode())){return u(-1,caretPosition.getNode(),!caretPosition.isAtEnd(),false)}}else{caretPosition=v(1,b);if(mv(caretPosition.getNode())){return u(1,caretPosition.getNode(),!caretPosition.isAtEnd(),false)}if(mv(caretPosition.getNode(true))){return u(1,caretPosition.getNode(true),false,false)}}}return null}startContainer=b.startContainer;startOffset=b.startOffset;endOffset=b.endOffset;if(startContainer.nodeType===3&&startOffset===0&&Af(startContainer.parentNode)){startContainer=startContainer.parentNode;startOffset=f.nodeIndex(startContainer);startContainer=startContainer.parentNode}if(startContainer.nodeType!==1){return null}if(endOffset===startOffset+1){d=startContainer.childNodes[startOffset]}if(!Af(d)){return null}targetClone=origTargetClone=d.cloneNode(true);e=k.fire('ObjectSelected',{target:d,targetClone:targetClone});if(e.isDefaultPrevented()){return null}g=jz(eP.fromDom(k.getBody()),'#'+o).fold(function(){return $([])},function(a){return $([a.dom()])});targetClone=e.targetClone;if(g.length===0){g=$('<div data-mce-bogus="all" class="mce-offscreen-selection"></div>').attr('id',o);g.appendTo(k.getBody())}b=k.dom.createRng();if(targetClone===origTargetClone&&co.ie){g.empty().append('<p style="font-size: 0" data-mce-bogus="all">\xA0</p>').append(targetClone);b.setStartAfter(g[0].firstChild.firstChild);b.setEndAfter(targetClone)}else{g.empty().append('\xA0').append(targetClone).append('\xA0');b.setStart(g[0].firstChild,1);b.setEnd(g[0].lastChild,0)}g.css({top:f.getPos(d,k.getBody()).y});g[0].focus();sel=k.selection.getSel();sel.removeAllRanges();sel.addRange(b);bD(jv(eP.fromDom(k.getBody()),'*[data-mce-selected]'),function(a){fw(a,'data-mce-selected')});d.setAttribute('data-mce-selected','1');p=d;E();return b};var C=function(){if(p){p.removeAttribute('data-mce-selected');jz(eP.fromDom(k.getBody()),'#'+o).each(je);p=null}jz(eP.fromDom(k.getBody()),'#'+o).each(je);p=null};var D=function(){n.destroy();p=null};var E=function(){n.hide()};if(co.ceFalse){x();y()}return{showCaret:u,showBlockCaretContainer:w,hideFakeCaret:E,destroy:D}};var Ak=function(a){return a.indexOf('data-')===0||a.indexOf('aria-')===0};var Al=function(a){return a.replace(/<!--|-->/g,'')};var Am=function(a,b){if(a.allow_html_data_urls){return false}else if(/^data:image\//i.test(b)){return a.allow_svg_data_urls===false&&/^data:image\/svg\+xml/i.test(b)}else{return/^JY:/i.test(uri);}};var findEndTagIndex=function(schema,html,startIndex){var count=1,index,matches,tokenRegExp,shortEndedElements;shortEndedElements=schema.getShortEndedElements();tokenRegExp=/<([!?\/])?([A-Za-z0-9\-_\:\.]+)((?:\s+[^"\'>]+(?:(?:"[^"]*")|(?:\'[^\']*\')|[^>]*))*|\/|\s+)>/g;tokenRegExp.lastIndex=index=startIndex;while(matches=tokenRegExp.exec(html)){index=tokenRegExp.lastIndex;if(matches[1]==='/'){count--;}else if(!matches[1]){if(matches[2]in shortEndedElements){continue;}count++;}if(count===0){break;}}return index;};function SaxParser(settings,schema){if(schema===void 0){schema=Schema();}var noop=function(){};settings=settings||{};if(settings.fix_self_closing!==false){settings.fix_self_closing=true;}var comment=settings.comment?settings.comment:noop;var cdata=settings.cdata?settings.cdata:noop;var text=settings.text?settings.text:noop;var start=settings.start?settings.start:noop;var end=settings.end?settings.end:noop;var pi=settings.pi?settings.pi:noop;var doctype=settings.doctype?settings.doctype:noop;var parse=function(html){var matches,index=0,value,endRegExp;var stack=[];var attrList,i,textData,name;var isInternalElement,removeInternalElements,shortEndedElements,fillAttrsMap,isShortEnded;var validate,elementRule,isValidElement,attr,attribsValue,validAttributesMap,validAttributePatterns;var attributesRequired,attributesDefault,attributesForced,processHtml;var anyAttributesRequired,selfClosing,tokenRegExp,attrRegExp,specialElements,attrValue,idCount=0;var decode=Entities.decode;var fixSelfClosing;var filteredUrlAttrs=Tools.makeMap('src,href,JY,background,formaction,poster,xlink:href');var scriptUriRegExp=/((java|vb)script|mhtml):/i;var processEndTag=function(name){var pos,i;pos=stack.length;while(pos--){if(stack[pos].name===name){break;}}if(pos>=0){for(i=stack.length-1;i>=pos;i--){name=stack[i];if(name.valid){end(name.name);}}stack.length=pos;}};var parseAttribute=function(match,name,value,val2,val3){var attrRule,i;var trimRegExp=/[\s\u0000-\u001F]+/g;name=name.toLowerCase();value=name in fillAttrsMap?name:decode(value||val2||val3||'');if(validate&&!isInternalElement&&isValidPrefixAttrName(name)===false){attrRule=validAttributesMap[name];if(!attrRule&&validAttributePatterns){i=validAttributePatterns.length;while(i--){attrRule=validAttributePatterns[i];if(attrRule.pattern.test(name)){break;}}if(i===-1){attrRule=null;}}if(!attrRule){return;}if(attrRule.validValues&&!(value in attrRule.validValues)){return;}}if(filteredUrlAttrs[name]&&!settings.allow_script_urls){var uri=value.replace(trimRegExp,'');try{uri=decodeURIComponent(uri);}catch(ex){uri=unescape(uri);}if(scriptUriRegExp.test(uri)){return;}if(isInvalidUri(settings,uri)){return;}}if(isInternalElement&&(name in filteredUrlAttrs||name.indexOf('on')===0)){return;}attrList.map[name]=value;attrList.push({name:name,value:value});};tokenRegExp=new RegExp('<(?:'+'(?:!--([\\w\\W]*?)-->)|'+'(?:!\\[CDATA\\[([\\w\\W]*?)\\]\\]>)|'+'(?:!DOCTYPE([\\w\\W]*?)>)|'+'(?:\\?([^\\s\\/<>]+) ?([\\w\\W]*?)[?/]>)|'+'(?:\\/([A-Za-z][A-Za-z0-9\\-_\\:\\.]*)>)|'+'(?:([A-Za-z][A-Za-z0-9\\-_\\:\\.]*)((?:\\s+[^"\'>]+(?:(?:"[^"]*")|(?:\'[^\']*\')|[^>]*))*|\\/|\\s+)>)'+')','g');attrRegExp=/([\w:\-]+)(?:\s*=\s*(?:(?:\"((?:[^\"])*)\")|(?:\'((?:[^\'])*)\')|([^>\s]+)))?/g;shortEndedElements=schema.getShortEndedElements();selfClosing=a.self_closing_elements||schema.getSelfClosingElements();fillAttrsMap=schema.getBoolAttrs();wJ=a.validate;removeInternalElements=a.remove_internals;fixSelfClosing=a.fix_self_closing;specialElements=schema.getSpecialElements();processHtml=html+'>';while(matches=tokenRegExp.exec(processHtml)){if(index<matches.index){text(hJ(html.substr(index,matches.index-index)))}if(value=matches[6]){value=value.toLowerCase();if(value.charAt(0)===':'){value=value.substr(1)}processEndTag(value)}else if(value=matches[7]){if(matches.index+matches[0].length>html.length){text(hJ(html.substr(matches.index)));index=matches.index+matches[0].length;continue}value=value.toLowerCase();if(value.charAt(0)===':'){value=value.substr(1)}isShortEnded=value in shortEndedElements;if(fixSelfClosing&&selfClosing[value]&&stack.length>0&&stack[stack.length-1].name===value){processEndTag(value)}if(!wJ||(elementRule=schema.getElementRule(value))){isValidElement=true;if(wJ){validAttributesMap=elementRule.attributes;validAttributePatterns=elementRule.attributePatterns}if(attribsValue=matches[8]){isInternalElement=attribsValue.indexOf('data-mce-type')!==-1;if(isInternalElement&&removeInternalElements){isValidElement=false}attrList=[];attrList.map={};attribsValue.replace(attrRegExp,parseAttribute)}else{attrList=[];attrList.map={}}if(wJ&&!isInternalElement){attributesRequired=elementRule.attributesRequired;attributesDefault=elementRule.attributesDefault;attributesForced=elementRule.attributesForced;anyAttributesRequired=elementRule.removeEmptyAttrs;if(anyAttributesRequired&&!attrList.length){isValidElement=false}if(attributesForced){i=attributesForced.length;while(i--){attr=attributesForced[i];fc=attr.name;attrValue=attr.value;if(attrValue==='{$uid}'){attrValue='mce_'+idCount++}attrList.map[fc]=attrValue;attrList.push({name:fc,value:attrValue})}}if(attributesDefault){i=attributesDefault.length;while(i--){attr=attributesDefault[i];fc=attr.name;if(!(fc in attrList.map)){attrValue=attr.value;if(attrValue==='{$uid}'){attrValue='mce_'+idCount++}attrList.map[fc]=attrValue;attrList.push({name:fc,value:attrValue})}}}if(attributesRequired){i=attributesRequired.length;while(i--){if(attributesRequired[i]in attrList.map){break}}if(i===-1){isValidElement=false}}if(attr=attrList.map['data-mce-bogus']){if(attr==='all'){index=findEndTagIndex(schema,html,tokenRegExp.lastIndex);tokenRegExp.lastIndex=index;continue}isValidElement=false}}if(isValidElement){ti(value,attrList,isShortEnded)}}else{isValidElement=false}if(endRegExp=specialElements[value]){endRegExp.lastIndex=index=matches.index+matches[0].length;if(matches=endRegExp.exec(html)){if(isValidElement){textData=html.substr(index,matches.index-index)}index=matches.index+matches[0].length}else{textData=html.substr(index);index=html.length}if(isValidElement){if(textData.length>0){text(textData,true)}tj(value)}tokenRegExp.lastIndex=index;continue}if(!isShortEnded){if(!attribsValue||attribsValue.indexOf('/')!==attribsValue.length-1){stack.push({name:value,valid:isValidElement})}else if(isValidElement){tj(value)}}}else if(value=matches[1]){if(value.charAt(0)==='>'){value=' '+value}if(!a.allow_conditional_comments&&value.substr(0,3).toLowerCase()==='[if'){value=' '+value}comment(value)}else if(value=matches[2]){cdata(Al(value))}else if(value=matches[3]){doctype(value)}else if(value=matches[4]){pi(value,matches[5])}index=matches.index+matches[0].length}if(index<html.length){text(hJ(html.substr(index)))}for(i=stack.length-1;i>=0;i--){value=stack[i];if(value.valid){tj(value.name)}}};return{parse:parse}}(function(a){a.findEndTag=findEndTagIndex}(SaxParser||(SaxParser={})));var An=SaxParser;var Ao=function(a,b){var c=new RegExp(['\\s?('+a.join('|')+')="[^"]+"'].join('|'),'gi');return b.replace(c,'')};var Ap=function(a,b){var c=b;var d=/<(\w+) [^>]*data-mce-bogus="all"[^>]*>/g;var e,index,matchLength,matches,shortEndedElements;var f=a.schema;c=Ao(a.getTempAttrs(),c);shortEndedElements=f.getShortEndedElements();while(matches=d.exec(c)){index=d.lastIndex;matchLength=matches[0].length;if(shortEndedElements[matches[1]]){e=index}else{e=An.findEndTag(f,c,index)}c=c.substring(0,index-matchLength)+c.substring(e);d.lastIndex=index-matchLength}return jX.trim(c)};var Aq=Ap;var Ar={trimExternal:Aq,trimInternal:Ap};var As=0,INSERT=1,DELETE=2;var At=function(l,o){var p=l.length+o.length+2;var q=new Array(p);var r=new Array(p);var s=function(a,b,c){return{start:a,end:b,diag:c}};var t=function(a,b,c,d,e){var f=v(a,b,c,d);if(f===null||f.start===b&&f.diag===b-d||f.end===a&&f.diag===a-c){var i=a;var j=c;while(i<b||j<d){if(i<b&&j<d&&l[i]===o[j]){e.push([As,l[i]]);++i;++j}else{if(b-a>d-c){e.push([DELETE,l[i]]);++i}else{e.push([INSERT,o[j]]);++j}}}}else{t(a,f.start,c,f.start-f.diag,e);for(var g=f.start;g<f.end;++g){e.push([As,l[g]])}t(f.end,b,f.end-f.diag,d,e)}};var u=function(a,b,c,d){var e=a;while(e-b<d&&e<c&&l[e]===o[e-b]){++e}return s(a,e,b)};var v=function(a,b,c,e){var m=b-a;var n=e-c;if(m===0||n===0){return null}var f=m-n;var g=n+m;var h=(g%2===0?g:g+1)/2;q[1+h]=a;r[1+h]=b+1;var d,k,i,x,y;for(d=0;d<=h;++d){for(k=-d;k<=d;k+=2){i=k+h;if(k===-d||k!==d&&q[i-1]<q[i+1]){q[i]=q[i+1]}else{q[i]=q[i-1]+1}x=q[i];y=x-a+c-k;while(x<b&&y<e&&l[x]===o[y]){q[i]=++x;++y}if(f%2!==0&&f-d<=k&&k<=f+d){if(r[i-f]<=q[i]){return u(r[i-f],k+a-c,b,e)}}}for(k=f-d;k<=f+d;k+=2){i=k+h-f;if(k===f-d||k!==f+d&&r[i+1]<=r[i-1]){r[i]=r[i+1]-1}else{r[i]=r[i-1]}x=r[i]-1;y=x-a+c-k;while(x>=a&&y>=c&&l[x]===o[y]){r[i]=x--;y--}if(f%2===0&&-d<=k&&k<=d){if(r[i]<=q[i+f]){return u(r[i],k+a-c,b,e)}}}}};var w=[];t(0,l.length,0,o.length,w);return w};var Au={KEEP:As,DELETE:DELETE,INSERT:INSERT,diff:At};var Av=function(a){if(hq.isElement(a)){return a.outerHTML}else if(hq.isText(a)){return hK.encodeRaw(a.data,false)}else if(hq.isComment(a)){return'<!--'+a.data+'-->'}return''};var Aw=function(a){var b,fH,container;container=document.createElement('div');b=document.createDocumentFragment();if(a){container.innerHTML=a}while(fH=container.firstChild){b.appendChild(fH)}return b};var Ax=function(a,b,c){var d=Aw(b);if(a.hasChildNodes()&&c<a.childNodes.length){var e=a.childNodes[c];e.parentNode.insertBefore(d,e)}else{a.appendChild(d)}};var Ay=function(a,b){if(a.hasChildNodes()&&b<a.childNodes.length){var c=a.childNodes[b];c.parentNode.removeChild(c)}};var Az=function(b,c){var d=0;bD(b,function(a){if(a[0]===Au.KEEP){d++}else if(a[0]===Au.INSERT){Ax(c,a[1],d);d++}else if(a[0]===Au.DELETE){Ay(c,d)}})};var AA=function(b){return bG(bC(bX(b.childNodes),Av),function(a){return a.length>0})};var AB=function(a,b){var c=bC(bX(b.childNodes),Av);Az(Au.diff(c,a),b);return b};var AC={read:AA,write:AB};var AD=ji(bo.none());var AE=function(){return AD.get().getOrThunk(function(){var a=document.implementation.createHTMLDocument('undo');AD.set(bo.some(a));return a})};var AF=function(a){return a.indexOf('</iframe>')!==-1};var AG=function(a){return{type:'fragmented',fragments:a,content:'',bookmark:null,beforeBookmark:null}};var AH=function(a){return{type:'complete',fragments:null,content:a,bookmark:null,beforeBookmark:null}};var AI=function(c){var d,content,trimmedFragments;d=AC.read(c.getBody());trimmedFragments=bO(d,function(a){var b=Ar.trimInternal(c.serializer,a);return b.length>0?[b]:[]});content=trimmedFragments.join('');return AF(content)?AG(trimmedFragments):AH(content)};var AJ=function(a,b,c){if(b.type==='fragmented'){AC.write(b.fragments,a.getBody())}else{a.setContent(b.content,{format:'raw'})}a.selection.moveToBookmark(c?b.beforeBookmark:b.bookmark)};var AK=function(a){return a.type==='fragmented'?a.fragments.join(''):a.content};var AL=function(a){var b=eP.fromTag('body',AE());jT(b,AK(a));bD(jv(b,'*[data-mce-bogus]'),jf);return jS(b)};var AM=function(a,b){return AK(a)===AK(b)};var AN=function(a,b){return AL(a)===AL(b)};var AO=function(a,b){if(!a||!b){return false}else if(AM(a,b)){return true}else{return AN(a,b)}};var AP={createFragmentedLevel:AG,createCompleteLevel:AH,createFromEditor:AI,applyToEditor:AJ,isEq:AO};function UndoManager(f){var g=this,index=0,JY=[],beforeBookmark,isFirstTypedCharacter,locks=0;var h=function(){return locks===0};var j=function(a){if(h()){g.typing=a}};var k=function(a){f.setDirty(a)};var l=function(e){j(false);g.add({},e)};var m=function(){if(g.typing){j(false);g.add()}};f.on('init',function(){g.add()});f.on('BeforeExecCommand',function(e){var a=e.command;if(a!=='Undo'&&a!=='Redo'&&a!=='mceRepaint'){m();g.beforeChange()}});f.on('ExecCommand',function(e){var a=e.command;if(a!=='Undo'&&a!=='Redo'&&a!=='mceRepaint'){l(e)}});f.on('ObjectResizeStart Cut',function(){g.beforeChange()});f.on('SaveContent ObjectResized blur',l);f.on('DragEnd',l);f.on('KeyUp',function(e){var a=e.keyCode;if(e.isDefaultPrevented()){return}if(a>=33&&a<=36||a>=37&&a<=40||a===45||e.ctrlKey){l();f.nodeChanged()}if(a===46||a===8){f.nodeChanged()}if(isFirstTypedCharacter&&g.typing&&AP.isEq(AP.createFromEditor(f),JY[0])===false){if(f.isDirty()===false){k(true);f.fire('change',{level:JY[0],lastLevel:null})}f.fire('TypingUndo');isFirstTypedCharacter=false;f.nodeChanged()}});f.on('KeyDown',function(e){var a=e.keyCode;if(e.isDefaultPrevented()){return}if(a>=33&&a<=36||a>=37&&a<=40||a===45){if(g.typing){l(e)}return}var b=e.ctrlKey&&!e.altKey||e.metaKey;if((a<16||a>20)&&a!==224&&a!==91&&!g.typing&&!b){g.beforeChange();j(true);g.add({},e);isFirstTypedCharacter=true}});f.on('MouseDown',function(e){if(g.typing){l(e)}});var n=function(a){return a.inputType==='insertReplacementText'};var o=function(a){return a.inputType==='insertText'&&a.data===null};f.on('input',function(e){if(e.inputType&&(n(e)||o(e))){l(e)}});f.addShortcut('meta+z','','Undo');f.addShortcut('meta+y,meta+shift+z','','Redo');f.on('AddUndo Undo Redo ClearUndos',function(e){if(!e.isDefaultPrevented()){f.nodeChanged()}});g={data:JY,typing:false,beforeChange:function(){if(h()){beforeBookmark=lW.getUndoBookmark(f.selection)}},add:function(a,b){var i;var c=f.settings;var d,currentLevel;currentLevel=AP.createFromEditor(f);a=a||{};a=dj.extend(a,currentLevel);if(h()===false||f.removed){return null}d=JY[index];if(f.fire('BeforeAddUndo',{level:a,lastLevel:d,originalEvent:b}).isDefaultPrevented()){return null}if(d&&AP.isEq(d,a)){return null}if(JY[index]){JY[index].beforeBookmark=beforeBookmark}if(c.custom_undo_redo_levels){if(JY.length>c.custom_undo_redo_levels){for(i=0;i<JY.length-1;i++){JY[i]=JY[i+1]}JY.length--;index=JY.length}}a.bookmark=lW.getUndoBookmark(f.selection);if(index<JY.length-1){JY.length=index+1}JY.push(a);index=JY.length-1;var e={level:a,lastLevel:d,originalEvent:b};f.fire('AddUndo',e);if(index>0){k(true);f.fire('change',e)}return a},undo:function(){var a;if(g.typing){g.add();g.typing=false;j(false)}if(index>0){a=JY[--index];AP.applyToEditor(f,a,true);k(true);f.fire('undo',{level:a})}return a},redo:function(){var a;if(index<JY.length-1){a=JY[++index];AP.applyToEditor(f,a,false);k(true);f.fire('redo',{level:a})}return a},clear:function(){JY=[];index=0;g.typing=false;g.data=JY;f.fire('ClearUndos')},hasUndo:function(){return index>0||g.typing&&JY[0]&&!AP.isEq(AP.createFromEditor(f),JY[0])},hasRedo:function(){return index<JY.length-1&&!g.typing},transact:function(a){m();g.beforeChange();g.ignore(a);return g.add()},ignore:function(a){try{locks++;a()}finally{locks--}},extra:function(a,b){var c,bookmark;if(g.transact(a)){bookmark=JY[index].bookmark;c=JY[index-1];AP.applyToEditor(f,c,true);if(g.transact(b)){JY[index-1].beforeBookmark=bookmark}}}};return g}var AQ=ot.isEq;var AR=function(a,b,c){var d=a.formatter.get(c);if(d){for(var i=0;i<d.length;i++){if(d[i].inherit===false&&a.dom.is(b,d[i].selector)){return true}}}return false};var AS=function(b,c,d,e){var f=b.dom.getRoot();if(c===f){return false}c=b.dom.getParent(c,function(a){if(AR(b,a,d)){return true}return a.parentNode===f||!!AV(b,a,d,e,true)});return AV(b,c,d,e)};var AT=function(a,b,c){if(AQ(b,c.inline)){return true}if(AQ(b,c.block)){return true}if(c.selector){return b.nodeType===1&&a.is(b,c.selector)}};var AU=function(a,b,c,d,e,f){var g,value;var h=c[d];var i;if(c.onmatch){return c.onmatch(b,c,d)}if(h){if(typeof h.length==='undefined'){for(g in h){if(h.hasOwnProperty(g)){if(d==='attributes'){value=a.getAttrib(b,g)}else{value=ot.getStyle(a,b,g)}if(e&&!value&&!c.exact){return}if((!e||c.exact)&&!AQ(value,ot.normalizeStyleValue(a,ot.replaceVars(h[g],f),g))){return}}}}else{for(i=0;i<h.length;i++){if(d==='attributes'?a.getAttrib(b,h[i]):ot.getStyle(a,b,h[i])){return c}}}}return c};var AV=function(a,b,c,d,e){var f=a.formatter.get(c);var g,i,x,classes;var h=a.dom;if(f&&b){for(i=0;i<f.length;i++){g=f[i];if(AT(a.dom,b,g)&&AU(h,b,g,'attributes',e,d)&&AU(h,b,g,'styles',e,d)){if(classes=g.classes){for(x=0;x<classes.length;x++){if(!a.dom.hasClass(b,classes[x])){return}}}return g}}}};var AW=function(a,b,c,d){var e;if(d){return AS(a,d,b,c)}d=a.selection.getNode();if(AS(a,d,b,c)){return true}e=a.selection.getStart();if(e!==d){if(AS(a,e,b,c)){return true}}return false};var AX=function(b,c,d){var e;var f=[];var g={};e=b.selection.getStart();b.dom.getParent(e,function(a){var i,fc;for(i=0;i<c.length;i++){fc=c[i];if(!g[fc]&&AV(b,a,fc,d)){g[fc]=true;f.push(fc)}}},b.dom.getRoot());return f};var AY=function(a,b){var c=a.formatter.get(b);var d,gb,i,x,selector;var e=a.dom;if(c){d=a.selection.getStart();gb=ot.getParents(e,d);for(x=c.length-1;x>=0;x--){selector=c[x].selector;if(!selector||c[x].defaultBlock){return true}for(i=gb.length-1;i>=0;i--){if(e.is(gb[i],selector)){return true}}}}return false};var AZ={matchNode:AV,matchName:AT,match:AW,matchAll:AX,canApply:AY,matchesUnInheritedFormatSelector:AR};var Ba=function(a,b){return a.splitText(b)};var Bb=function(a){var b=a.startContainer,startOffset=a.startOffset,endContainer=a.endContainer,endOffset=a.endOffset;if(b===endContainer&&hq.isText(b)){if(startOffset>0&&startOffset<b.nodeValue.length){endContainer=Ba(b,startOffset);b=endContainer.previousSibling;if(endOffset>startOffset){endOffset=endOffset-startOffset;b=endContainer=Ba(endContainer,endOffset).previousSibling;endOffset=endContainer.nodeValue.length;startOffset=0}else{endOffset=0}}}else{if(hq.isText(b)&&startOffset>0&&startOffset<b.nodeValue.length){b=Ba(b,startOffset);startOffset=0}if(hq.isText(endContainer)&&endOffset>0&&endOffset<endContainer.nodeValue.length){endContainer=Ba(endContainer,endOffset).previousSibling;endOffset=endContainer.nodeValue.length}}return{startContainer:b,startOffset:startOffset,endContainer:endContainer,endOffset:endOffset}};var Bc={split:Bb};var Bd=jX.ZWSP,CARET_ID$1='_mce_caret';var Be=function(a,b){return a.importNode(b,true)};var Bf=function(a){var b=[];while(a){if(a.nodeType===3&&a.nodeValue!==Bd||a.childNodes.length>1){return[]}if(a.nodeType===1){b.push(a)}a=a.firstChild}return b};var Bg=function(a){return Bf(a).length>0};var Bh=function(a){var b;if(a){b=new TreeWalker(a,a);for(a=b.current();a;a=b.next()){if(a.nodeType===3){return a}}}return null};var Bi=function(a){var b=eP.fromTag('span');ft(b,{'id':CARET_ID$1,'data-mce-bogus':'1','data-mce-type':'format-caret'});if(a){iZ(b,eP.fromText(Bd))}return b};var Bj=function(a){var b=Bh(a);if(b&&b.nodeValue.charAt(0)===Bd){b.deleteData(0,1)}return b};var Bk=function(a,b,c){if(c===void 0){c=true}var d=a.dom,selection=a.selection;if(Bg(b)){sD.deleteElement(a,false,eP.fromDom(b),c)}else{var e=selection.getRng();var f=d.getParent(b,d.isBlock);var g=Bj(b);if(e.startContainer===g&&e.startOffset>0){e.setStart(g,e.startOffset-1)}if(e.endContainer===g&&e.endOffset>0){e.setEnd(g,e.endOffset-1)}d.remove(b,true);if(f&&d.isEmpty(f)){pC.fillWithPaddingBr(eP.fromDom(f))}selection.setRng(e)}};var Bl=function(a,b,c){if(c===void 0){c=true}var d=a.dom,selection=a.selection;if(!b){b=lZ(a.getBody(),selection.getStart());if(!b){while(b=d.get(CARET_ID$1)){Bk(a,b,false)}}}else{Bk(a,b,c)}};var Bm=function(a,b,c){var d=a.dom,block=d.getParent(c,curry(ot.isTextBlock,a));if(block&&d.isEmpty(block)){c.parentNode.replaceChild(b,c)}else{pC.removeTrailingBr(eP.fromDom(c));if(d.isEmpty(c)){c.parentNode.replaceChild(b,c)}else{d.insertAfter(b,c)}}};var Bn=function(a,b){a.appendChild(b);return b};var Bo=function(c,d){var e=bH(c,function(a,b){return Bn(a,b.cloneNode(false))},d);return Bn(e,e.ownerDocument.createTextNode(Bd))};var Bp=function(a,b,c){var d,caretContainer,textNode,offset,bookmark,container,text;var e=a.selection;d=e.getRng(true);offset=d.startOffset;container=d.startContainer;text=container.nodeValue;caretContainer=lZ(a.getBody(),e.getStart());if(caretContainer){textNode=Bh(caretContainer)}var f=/[^\s\u00a0\u00ad\u200b\ufeff]/;if(text&&offset>0&&offset<text.length&&f.test(text.charAt(offset))&&f.test(text.charAt(offset-1))){bookmark=e.getBookmark();d.collapse(true);d=oG.expandRng(a,d,a.formatter.get(b));d=Bc.split(d);a.formatter.apply(b,c,d);e.moveToBookmark(bookmark)}else{if(!caretContainer||textNode.nodeValue!==Bd){caretContainer=Be(a.getDoc(),Bi(true).dom());textNode=caretContainer.firstChild;d.insertNode(caretContainer);offset=1;a.formatter.apply(b,c,caretContainer)}else{a.formatter.apply(b,c,caretContainer)}e.setCursorLocation(textNode,offset)}};var Bq=function(a,b,c,d){var e=a.dom,selection=a.selection;var f,offset,bookmark;var g,fH,formatNode;var h=[],rng=selection.getRng();var i;f=rng.startContainer;offset=rng.startOffset;fH=f;if(f.nodeType===3){if(offset!==f.nodeValue.length){g=true}fH=fH.parentNode}while(fH){if(AZ.matchNode(a,fH,b,c,d)){formatNode=fH;break}if(fH.nextSibling){g=true}h.push(fH);fH=fH.parentNode}if(!formatNode){return}if(g){bookmark=selection.getBookmark();rng.collapse(true);var j=oG.expandRng(a,rng,a.formatter.get(b),true);j=Bc.split(j);a.formatter.remove(b,c,j);selection.moveToBookmark(bookmark)}else{i=lZ(a.getBody(),formatNode);var k=Bi(false).dom();var l=Bo(h,k);if(i){Bm(a,k,i)}else{Bm(a,k,formatNode)}Bk(a,i,false);selection.setCursorLocation(l,1);if(e.isEmpty(formatNode)){e.remove(formatNode)}}};var Br=function(a,b){var c=a.selection,body=a.getBody();Bl(a,null,false);if((b===8||b===46)&&c.isCollapsed()&&c.getStart().innerHTML===Bd){Bl(a,lZ(body,c.getStart()))}if(b===37||b===39){Bl(a,lZ(body,c.getStart()))}};var Bs=function(a){a.on('mouseup keydown',function(e){Br(a,e.keyCode)})};var Bt=function(a,b){var c=Bi(false);var d=Bo(b,c.dom());iW(eP.fromDom(a),c);je(eP.fromDom(a));return lr(d,0)};var Bu=function(a,b){var c=a.schema.getTextInlineElements();return c.hasOwnProperty(fc(b))&&!lY(b.dom())&&!hq.isBogus(b.dom())};var Bv=function(a){return lY(a.dom())&&Bg(a.dom())};var Bw={},filter$2=cW.filter,each$c=cW.each;var Bx=function(a,b){var c=Bw[a];if(!c){Bw[a]=c=[]}Bw[a].push(b)};var By=function(b,c){each$c(Bw[b],function(a){a(c)})};Bx('pre',function(c){var d=c.selection.getRng();var e,gD;var f=function(a){return e(a.previousSibling)&&cW.indexOf(gD,a.previousSibling)!==-1};var g=function(a,b){dB(b).remove();dB(a).append('<br><br>').append(b.childNodes)};e=hq.matchNodeNames('pre');if(!d.collapsed){gD=c.selection.getSelectedBlocks();each$c(filter$2(filter$2(gD,e),f),function(a){g(a.previousSibling,a)})}});var Bz={postProcess:By};var BA=/^(src|href|style)$/;var BB=dj.each;var BC=ot.isEq;var BD=function(a){return/^(TH|TD)$/.test(a.nodeName)};var BE=function(a,b,c){return a.isChildOf(b,c)&&b!==c&&!a.isBlock(c)};var BF=function(a,b,c){var d,offset,lastIdx;d=b[c?'startContainer':'endContainer'];offset=b[c?'startOffset':'endOffset'];if(hq.isElement(d)){lastIdx=d.childNodes.length-1;if(!c&&offset){offset--}d=d.childNodes[offset>lastIdx?lastIdx:offset]}if(hq.isText(d)&&c&&offset>=d.nodeValue.length){d=new TreeWalker(d,a.getBody()).next()||d}if(hq.isText(d)&&!c&&offset===0){d=new TreeWalker(d,a.getBody()).prev()||d}return d};var BG=function(a,b,c,d){var e=a.create(c,d);b.parentNode.insertBefore(e,b);e.appendChild(b);return e};var BH=function(a,b,c,d,e){var f=eP.fromDom(b);var g=eP.fromDom(a.create(d,e));var h=c?gf(f):ge(f);jc(g,h);if(c){iW(f,g);iY(g,f)}else{iX(f,g);iZ(g,f)}return g.dom()};var BI=function(a,b,c){if(BC(b,c.inline)){return true}if(BC(b,c.block)){return true}if(c.selector){return hq.isElement(b)&&a.is(b,c.selector)}};var BJ=function(a,b){return b.links&&a.tagName==='A'};var BK=function(a,b,c,d){b=ot.getNonWhiteSpaceSibling(b,c,d);return!b||(b.nodeName==='BR'||a.isBlock(b))};var BL=function(b,c,d){var e=c.parentNode;var f;var g=b.dom,forcedRootBlock=b.settings.forced_root_block;if(d.block){if(!forcedRootBlock){if(g.isBlock(c)&&!g.isBlock(e)){if(!BK(g,c,false)&&!BK(g,c.firstChild,true,1)){c.insertBefore(g.create('br'),c.firstChild)}if(!BK(g,c,true)&&!BK(g,c.lastChild,false,1)){c.appendChild(g.create('br'))}}}else{if(e===g.getRoot()){if(!d.list_block||!BC(c,d.list_block)){BB(dj.grep(c.childNodes),function(a){if(ot.isValid(b,forcedRootBlock,a.nodeName.toLowerCase())){if(!f){f=BG(g,a,forcedRootBlock);g.setAttribs(f,b.settings.forced_root_block_attrs)}else{f.appendChild(a)}}else{f=0}})}}}}if(d.selector&&d.inline&&!BC(d.inline,c)){return}g.remove(c,1)};var BM=function(e,f,g,h,j){var i,attrs,stylesModified;var k=e.dom;if(!BI(k,h,f)&&!BJ(h,f)){return false}if(f.remove!=='all'){BB(f.styles,function(a,b){a=ot.normalizeStyleValue(k,ot.replaceVars(a,g),b);if(typeof b==='number'){b=a;j=0}if(f.remove_similar||(!j||BC(ot.getStyle(k,j,b),a))){k.setStyle(h,b,'')}stylesModified=1});if(stylesModified&&k.getAttrib(h,'style')===''){h.removeAttribute('style');h.removeAttribute('data-mce-style')}BB(f.attributes,function(b,c){var d;b=ot.replaceVars(b,g);if(typeof c==='number'){c=b;j=0}if(!j||BC(k.getAttrib(j,c),b)){if(c==='class'){b=k.getAttrib(h,c);if(b){d='';BB(b.split(/\s+/),function(a){if(/mce\-\w+/.test(a)){d+=(d?' ':'')+a}});if(d){k.setAttrib(h,c,d);return}}}if(c==='class'){h.removeAttribute('className')}if(BA.test(c)){h.removeAttribute('data-mce-'+c)}h.removeAttribute(c)}});BB(f.classes,function(a){a=ot.replaceVars(a,g);if(!j||k.hasClass(j,a)){k.removeClass(h,a)}});attrs=k.getAttribs(h);for(i=0;i<attrs.length;i++){var l=attrs[i].nodeName;if(l.indexOf('_')!==0&&l.indexOf('data-')!==0){return false}}}if(f.remove!=='none'){BL(e,h,f);return true}};var BN=function(c,d,e,f,g){var h;BB(ot.getParents(c.dom,d.parentNode).reverse(),function(a){var b;if(!h&&a.id!=='_start'&&a.id!=='_end'){b=AZ.matchNode(c,a,e,f,g);if(b&&b.split!==false){h=a}}});return h};var BO=function(a,b,c,d,e,f,g,h){var j,clone,lastClone,firstClone,i,formatRootParent;var k=a.dom;if(c){formatRootParent=c.parentNode;for(j=d.parentNode;j&&j!==formatRootParent;j=j.parentNode){clone=k.clone(j,false);for(i=0;i<b.length;i++){if(BM(a,b[i],h,clone,clone)){clone=0;break}}if(clone){if(lastClone){clone.appendChild(lastClone)}if(!firstClone){firstClone=clone}lastClone=clone}}if(f&&(!g.mixed||!k.isBlock(c))){d=k.split(c,d)}if(lastClone){e.parentNode.insertBefore(lastClone,e);firstClone.appendChild(e)}}return d};var BP=function(g,h,j,k,m){var n=g.formatter.get(h),format=n[0];var o,rng,cm=true;var p=g.dom;var q=g.selection;var r=function(a){var b=BN(g,a,h,j,m);return BO(g,n,b,a,a,true,format,j)};var s=function(a){return og.isBookmarkNode(a)&&hq.isElement(a)&&(a.id==='_start'||a.id==='_end')};var t=function(a){var b,i,l,lastContentEditable,hj;if(hq.isElement(a)&&p.getContentEditable(a)){lastContentEditable=cm;cm=p.getContentEditable(a)==='true';hj=true}b=dj.grep(a.childNodes);if(cm&&!hj){for(i=0,l=n.length;i<l;i++){if(BM(g,n[i],j,a,a)){break}}}if(format.deep){if(b.length){for(i=0,l=b.length;i<l;i++){t(b[i])}if(hj){cm=lastContentEditable}}}};var u=function(a){var b=p.get(a?'_start':'_end');var c=b[a?'firstChild':'lastChild'];if(s(c)){c=c[a?'firstChild':'lastChild']}if(hq.isText(c)&&c.data.length===0){c=a?b.previousSibling||b.nextSibling:b.nextSibling||b.previousSibling}p.remove(b,true);return c};var v=function(c){var d,endContainer;var e=c.commonAncestorContainer;c=oG.expandRng(g,c,n,true);if(format.split){c=Bc.split(c);d=BF(g,c,true);endContainer=BF(g,c);if(d!==endContainer){if(/^(TR|TH|TD)$/.test(d.nodeName)&&d.firstChild){if(d.nodeName==='TR'){d=d.firstChild.firstChild||d}else{d=d.firstChild||d}}if(e&&/^T(HEAD|BODY|FOOT|R)$/.test(e.nodeName)&&BD(endContainer)&&endContainer.firstChild){endContainer=endContainer.firstChild||endContainer}if(BE(p,d,endContainer)){var f=bo.from(d.firstChild).getOr(d);r(BH(p,f,true,'span',{'id':'_start','data-mce-type':'bookmark'}));u(true);return}if(BE(p,endContainer,d)){var f=bo.from(endContainer.lastChild).getOr(endContainer);r(BH(p,f,false,'span',{'id':'_end','data-mce-type':'bookmark'}));u(false);return}d=BG(p,d,'span',{'id':'_start','data-mce-type':'bookmark'});endContainer=BG(p,endContainer,'span',{'id':'_end','data-mce-type':'bookmark'});r(d);r(endContainer);d=u(true);endContainer=u()}else{d=endContainer=r(d)}c.startContainer=d.parentNode?d.parentNode:d;c.startOffset=p.nodeIndex(d);c.endContainer=endContainer.parentNode?endContainer.parentNode:endContainer;c.endOffset=p.nodeIndex(endContainer)+1}oK.walk(p,c,function(b){BB(b,function(a){t(a);if(hq.isElement(a)&&g.dom.getStyle(a,'text-decoration')==='underline'&&a.parentNode&&ot.getTextDecoration(p,a.parentNode)==='underline'){BM(g,{deep:false,exact:true,inline:'span',styles:{textDecoration:'underline'}},null,a)}})})};if(k){if(k.nodeType){rng=p.createRng();rng.setStartBefore(k);rng.setEndAfter(k);v(rng)}else{v(k)}return}if(p.getContentEditable(q.getNode())==='false'){k=q.getNode();for(var i=0,l=n.length;i<l;i++){if(n[i].ceFalseOverride){if(BM(g,n[i],j,k,k)){break}}}return}if(!q.isCollapsed()||!format.inline||p.select('td[data-mce-selected],th[data-mce-selected]').length){o=lW.getPersistentBookmark(g.selection,true);v(q.getRng());q.moveToBookmark(o);if(format.inline&&AZ.match(g,h,j,q.getStart())){ot.moveStart(p,q,q.getRng())}g.nodeChanged()}else{Bq(g,h,j,m)}};var BQ={removeFormat:BM,remove:BP};var BR=dj.each;var BS=function(a){return a&&a.nodeType===1&&!og.isBookmarkNode(a)&&!lY(a)&&!hq.isBogus(a)};var BT=function(a,b){var c;for(c=a;c;c=c[b]){if(c.nodeType===3&&c.nodeValue.length!==0){return a}if(c.nodeType===1&&!og.isBookmarkNode(c)){return c}}return a};var BU=function(b,c,d){var e,tmpSibling;var f=new pv(b);if(c&&d){c=BT(c,'previousSibling');d=BT(d,'nextSibling');if(f.compare(c,d)){for(e=c.nextSibling;e&&e!==d;){tmpSibling=e;e=e.nextSibling;c.appendChild(tmpSibling)}b.remove(d);dj.each(dj.grep(d.childNodes),function(a){c.appendChild(a)});return c}}return d};var BV=function(b,c,d){BR(b.childNodes,function(a){if(BS(a)){if(c(a)){d(a)}if(a.hasChildNodes()){BV(a,c,d)}}})};var BW=function(c,d){return curry(function(a,b){return!!(b&&ot.getStyle(c,b,a))},d)};var BX=function(d,e,f){return curry(function(a,b,c){d.setStyle(c,a,b);if(c.getAttribute('style')===''){c.removeAttribute('style')}BY(d,c)},e,f)};var BY=function(a,b){if(b.nodeName==='SPAN'&&a.getAttribs(b).length===0){a.remove(b,true)}};var BZ=function(a,b){var c;if(b.nodeType===1&&b.parentNode&&b.parentNode.nodeType===1){c=ot.getTextDecoration(a,b.parentNode);if(a.getStyle(b,'color')&&c){a.setStyle(b,'text-decoration',c)}else if(a.getStyle(b,'text-decoration')===c){a.setStyle(b,'text-decoration',null)}}};var Ca=function(a,b,c,d){if(b.styles.color||b.styles.textDecoration){dj.walk(d,curry(BZ,a),'childNodes');BZ(a,d)}};var Cb=function(a,b,c,d){if(b.styles&&b.styles.backgroundColor){BV(d,BW(a,'fontSize'),BX(a,'backgroundColor',ot.replaceVars(b.styles.backgroundColor,c)))}};var Cc=function(a,b,c,d){if(b.inline==='sub'||b.inline==='sup'){BV(d,BW(a,'fontSize'),BX(a,'fontSize',''));a.remove(a.select(b.inline==='sup'?'sub':'sup',d),true)}};var Cd=function(a,b,c,d){if(d&&b.merge_siblings!==false){d=BU(a,ot.getNonWhiteSpaceSibling(d),d);d=BU(a,d,ot.getNonWhiteSpaceSibling(d,true))}};var Ce=function(d,e,f){if(e.clear_child_styles){var g=e.links?'*:not(a)':'*';BR(d.select(g,f),function(c){if(BS(c)){BR(e.styles,function(a,b){d.setStyle(c,b,'')})}})}};var Cf=function(c,d,e,f){BR(d,function(b){BR(c.dom.select(b.inline,f),function(a){if(!BS(a)){return}BQ.removeFormat(c,b,e,a,b.exact?a:null)});Ce(c.dom,b,f)})};var Cg=function(b,c,d,e,f){if(AZ.matchNode(b,f.parentNode,d,e)){if(BQ.removeFormat(b,c,e,f)){return}}if(c.merge_with_parents){b.dom.getParent(f.parentNode,function(a){if(AZ.matchNode(b,a,d,e)){BQ.removeFormat(b,c,e,f);return true}})}};var Ch={mergeWithChildren:Cf,mergeUnderlineAndColor:Ca,mergeBackgroundColorAndFontSize:Cb,mergeSubSup:Cc,mergeSiblings:Cd,mergeWithParents:Cg};var Ci=dj.each;var Cj=function(a){return a&&a.nodeType===1&&!og.isBookmarkNode(a)&&!lY(a)&&!hq.isBogus(a)};var Ck=function(o,p,q,r){var s=o.formatter.get(p);var t=s[0];var u,rng;var v=!r&&o.selection.isCollapsed();var w=o.dom,selection=o.selection;var x=function(c,d){d=d||t;if(c){if(d.onformat){d.onformat(c,d,q,r)}Ci(d.styles,function(a,b){w.setStyle(c,b,ot.replaceVars(a,q))});if(d.styles){var e=w.getAttrib(c,'style');if(e){c.setAttribute('data-mce-style',e)}}Ci(d.attributes,function(a,b){w.setAttrib(c,b,ot.replaceVars(a,q))});Ci(d.classes,function(a){a=ot.replaceVars(a,q);if(!w.hasClass(c,a)){w.addClass(c,a)}})}};var y=function(b,c){var d=false;if(!t.selector){return false}Ci(b,function(a){if('collapsed'in a&&a.collapsed!==v){return}if(w.is(c,a.selector)&&!lY(c)){x(c,a);d=true;return false}});return d};var z=function(i,j,k,l){var m=[];var n,wrapElm,cm=true;n=t.inline||t.block;wrapElm=i.create(n);x(wrapElm);oK.walk(i,j,function(d){var e;var f=function(a){var b,parentName,hj,lastContentEditable;lastContentEditable=cm;b=a.nodeName.toLowerCase();parentName=a.parentNode.nodeName.toLowerCase();if(a.nodeType===1&&i.getContentEditable(a)){lastContentEditable=cm;cm=i.getContentEditable(a)==='true';hj=true}if(ot.isEq(b,'br')){e=0;if(t.block){i.remove(a)}return}if(t.wrapper&&AZ.matchNode(o,a,p,q)){e=0;return}if(cm&&!hj&&t.block&&!t.wrapper&&ot.isTextBlock(o,b)&&ot.isValid(o,parentName,n)){a=i.rename(a,n);x(a);m.push(a);e=0;return}if(t.selector){var c=y(s,a);if(!t.inline||c){e=0;return}}if(cm&&!hj&&ot.isValid(o,n,b)&&ot.isValid(o,parentName,n)&&!(!l&&a.nodeType===3&&a.nodeValue.length===1&&a.nodeValue.charCodeAt(0)===65279)&&!lY(a)&&(!t.inline||!i.isBlock(a))){if(!e){e=i.clone(wrapElm,false);a.parentNode.insertBefore(e,a);m.push(e)}e.appendChild(a)}else{e=0;Ci(dj.grep(a.childNodes),f);if(hj){cm=lastContentEditable}e=0}};Ci(d,f)});if(t.links===true){Ci(m,function(b){var c=function(a){if(a.nodeName==='A'){x(a,t)}Ci(dj.grep(a.childNodes),c)};c(b)})}Ci(m,function(d){var e;var f=function(b){var c=0;Ci(b.childNodes,function(a){if(!ot.isWhiteSpaceNode(a)&&!og.isBookmarkNode(a)){c++}});return c};var g=function(b){var c=false;Ci(b.childNodes,function(a){if(Cj(a)){c=a;return false}});return c};var h=function(a){var b,clone;b=g(a);if(b&&!og.isBookmarkNode(b)&&AZ.matchName(i,b,t)){clone=i.clone(b,false);x(clone);i.replace(clone,a,true);i.remove(b,1)}return clone||a};e=f(d);if((m.length>1||!i.isBlock(d))&&e===0){i.remove(d,1);return}if(t.inline||t.wrapper){if(!t.exact&&e===1){d=h(d)}Ch.mergeWithChildren(o,s,q,d);Ch.mergeWithParents(o,t,p,q,d);Ch.mergeBackgroundColorAndFontSize(i,t,q,d);Ch.mergeSubSup(i,t,q,d);Ch.mergeSiblings(i,t,q,d)}})};if(w.getContentEditable(selection.getNode())==='false'){r=selection.getNode();for(var i=0,l=s.length;i<l;i++){if(s[i].ceFalseOverride&&w.is(r,s[i].selector)){x(r,s[i]);return}}return}if(t){if(r){if(r.nodeType){if(!y(s,r)){rng=w.createRng();rng.setStartBefore(r);rng.setEndAfter(r);z(w,oG.expandRng(o,rng,s),null,true)}}else{z(w,r,null,true)}}else{if(!v||!t.inline||w.select('td[data-mce-selected],th[data-mce-selected]').length){var A=o.selection.getNode();if(!o.settings.forced_root_block&&s[0].defaultBlock&&!w.getParent(A,w.isBlock)){Ck(o,s[0].defaultBlock)}o.selection.setRng(pH.normalize(o.selection.getRng()));u=lW.getPersistentBookmark(o.selection,true);z(w,oG.expandRng(o,selection.getRng(),s),u);if(t.styles){Ch.mergeUnderlineAndColor(w,t,q,A)}selection.moveToBookmark(u);ot.moveStart(w,selection,selection.getRng());o.nodeChanged()}else{Bp(o,p,q)}}Bz.postProcess(p,o)}};var Cl={applyFormat:Ck};var Cm=dj.each;var Cn=function(h,i){var j={};h.set({});i.on('NodeChange',function(e){var f=ot.getParents(i.dom,e.element);var g={};f=dj.grep(f,function(a){return a.nodeType===1&&!a.getAttribute('data-mce-bogus')});Cm(h.get(),function(c,d){Cm(f,function(b){if(i.formatter.matchNode(b,d,{},c.similar)){if(!j[d]){Cm(c,function(a){a(true,{node:b,format:d,parents:f})});j[d]=c}g[d]=c;return false}if(AZ.matchesUnInheritedFormatSelector(i,b,d)){return false}})});Cm(j,function(b,c){if(!g[c]){delete j[c];Cm(b,function(a){a(false,{node:e.element,format:c,parents:f})})}})})};var Co=function(b,c,d,e){var f=b.get();Cm(c.split(','),function(a){if(!f[a]){f[a]=[];f[a].similar=e}f[a].push(d)});b.set(f)};var Cp=function(a,b,c,d,e){if(b.get()===null){Cn(b,a)}Co(b,c,d,e)};var Cq={formatChanged:Cp};var Cr=function(f){var g={valigntop:[{selector:'td,th',styles:{verticalAlign:'top'}}],valignmiddle:[{selector:'td,th',styles:{verticalAlign:'middle'}}],valignbottom:[{selector:'td,th',styles:{verticalAlign:'bottom'}}],alignleft:[{selector:'figure.image',collapsed:false,classes:'align-left',ceFalseOverride:true,preview:'font-family font-size'},{selector:'figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li',styles:{textAlign:'left'},inherit:false,preview:false,defaultBlock:'div'},{selector:'img,table',collapsed:false,styles:{float:'left'},preview:'font-family font-size'}],aligncenter:[{selector:'figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li',styles:{textAlign:'center'},inherit:false,preview:'font-family font-size',defaultBlock:'div'},{selector:'figure.image',collapsed:false,classes:'align-center',ceFalseOverride:true,preview:'font-family font-size'},{selector:'img',collapsed:false,styles:{display:'block',marginLeft:'auto',marginRight:'auto'},preview:false},{selector:'table',collapsed:false,styles:{marginLeft:'auto',marginRight:'auto'},preview:'font-family font-size'}],alignright:[{selector:'figure.image',collapsed:false,classes:'align-right',ceFalseOverride:true,preview:'font-family font-size'},{selector:'figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li',styles:{textAlign:'right'},inherit:false,preview:'font-family font-size',defaultBlock:'div'},{selector:'img,table',collapsed:false,styles:{float:'right'},preview:'font-family font-size'}],alignjustify:[{selector:'figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li',styles:{textAlign:'justify'},inherit:false,defaultBlock:'div',preview:'font-family font-size'}],bold:[{inline:'strong',remove:'all'},{inline:'span',styles:{fontWeight:'bold'}},{inline:'b',remove:'all'}],italic:[{inline:'em',remove:'all'},{inline:'span',styles:{fontStyle:'italic'}},{inline:'i',remove:'all'}],underline:[{inline:'span',styles:{textDecoration:'underline'},exact:true},{inline:'u',remove:'all'}],strikethrough:[{inline:'span',styles:{textDecoration:'line-through'},exact:true},{inline:'strike',remove:'all'}],forecolor:{inline:'span',styles:{color:'%value'},links:true,remove_similar:true,clear_child_styles:true},hilitecolor:{inline:'span',styles:{backgroundColor:'%value'},links:true,remove_similar:true,clear_child_styles:true},fontname:{inline:'span',toggle:false,styles:{fontFamily:'%value'},clear_child_styles:true},fontsize:{inline:'span',toggle:false,styles:{fontSize:'%value'},clear_child_styles:true},fontsize_class:{inline:'span',attributes:{class:'%value'}},blockquote:{block:'blockquote',wrapper:1,remove:'all'},subscript:{inline:'sub'},superscript:{inline:'sup'},code:{inline:'code'},link:{inline:'a',selector:'a',remove:'all',split:true,deep:true,onmatch:function(){return true},onformat:function(c,d,e){dj.each(e,function(a,b){f.setAttrib(c,b,a)})}},removeformat:[{selector:'b,strong,em,i,font,u,strike,sub,sup,dfn,code,samp,kbd,var,cite,mark,q,del,ins',remove:'all',split:true,expand:false,block_expand:true,deep:true},{selector:'span',attributes:['style','class'],remove:'empty',split:true,expand:false,deep:true},{selector:'*',attributes:['style','class'],split:false,expand:false,deep:true}]};dj.each('p h1 h2 h3 h4 h5 h6 div address pre div dt dd samp'.split(/\s/),function(a){g[a]={block:a,remove:'all'}});return g};var Cs={get:Cr};function FormatRegistry(e){var f={};var g=function(a){return a?f[a]:f};var h=function(c,d){if(c){if(typeof c!=='string'){dj.each(c,function(a,b){h(b,a)})}else{d=d.length?d:[d];dj.each(d,function(a){if(typeof a.deep==='undefined'){a.deep=!a.selector}if(typeof a.split==='undefined'){a.split=!a.selector||a.inline}if(typeof a.remove==='undefined'&&a.selector&&!a.inline){a.remove='none'}if(a.selector&&a.inline){a.mixed=true;a.block_expand=true}if(typeof a.classes==='string'){a.classes=a.classes.split(/\s+/)}});f[c]=d}}};var i=function(a){if(a&&f[a]){delete f[a]}return f};h(Cs.get(e.dom));h(e.settings.formats);return{get:g,register:h,unregister:i}}var Ct=dj.each;var Cu=iQ.DOM;var Cv=function(i,j){var k,item,fragment;var l=j&&j.schema||Schema({});var m=function(a,b){if(b.classes.length){Cu.addClass(a,b.classes.join(' '))}Cu.setAttribs(a,b.attrs)};var n=function(a){var b;item=typeof a==='string'?{name:a,classes:[],attrs:{}}:a;b=Cu.create(item.name);m(b,item);return b};var o=function(a,b){var c=typeof a!=='string'?a.nodeName.toLowerCase():a;var d=l.getElementRule(c);var e=d&&d.parentsRequired;if(e&&e.length){return b&&dj.inArray(e,b)!==-1?b:e[0]}else{return false}};var p=function(c,d,e){var f,parentCandidate,parentRequired;var g=d.length>0&&d[0];var h=g&&g.name;parentRequired=o(c,h);if(parentRequired){if(h===parentRequired){parentCandidate=d[0];d=d.slice(1)}else{parentCandidate=parentRequired}}else if(g){parentCandidate=d[0];d=d.slice(1)}else if(!e){return c}if(parentCandidate){f=n(parentCandidate);f.appendChild(c)}if(e){if(!f){f=Cu.create('div');f.appendChild(c)}dj.each(e,function(a){var b=n(a);f.insertBefore(b,c)})}return p(f,d,parentCandidate&&parentCandidate.siblings)};if(i&&i.length){item=i[0];k=n(item);fragment=Cu.create('div');fragment.appendChild(p(k,i.slice(1),item.siblings));return fragment}else{return''}};var Cw=function(a,b){return Cv(Cy(a),b)};var Cx=function(f){var g;var h={classes:[],attrs:{}};f=h.selector=dj.trim(f);if(f!=='*'){g=f.replace(/(?:([#\.]|::?)([\w\-]+)|(\[)([^\]]+)\]?)/g,function(a,b,c,d,e){switch(b){case'#':h.attrs.id=c;break;case'.':h.classes.push(c);break;case':':if(dj.inArray('checked disabled enabled read-only required'.split(' '),c)!==-1){h.attrs[c]=c}break}if(d==='['){var m=e.match(/([\w\-]+)(?:\=\"([^\"]+))?/);if(m){h.attrs[m[1]]=m[2]}}return''})}h.name=g||'div';return h};var Cy=function(d){if(!d||typeof d!=='string'){return[]}d=d.split(/\s*,\s*/)[0];d=d.replace(/\s*(~\+|~|\+|>)\s*/g,'$1');return dj.map(d.split(/(?:>|\s+(?![^\[\]]+\]))/),function(a){var b=dj.map(a.split(/(?:~\+|~|\+)/),Cx);var c=b.pop();if(b.length){c.siblings=b}return c}).reverse()};var Cz=function(d,e){var f,previewFrag,previewElm,items;var g='',parentFontSize,previewStyles;previewStyles=d.settings.preview_styles;if(previewStyles===false){return''}if(typeof previewStyles!=='string'){previewStyles='font-family font-size font-weight font-style text-decoration '+'text-transform color background-color border border-radius outline text-shadow'}var h=function(a){return a.replace(/%(\w+)/g,'')};if(typeof e==='string'){e=d.formatter.get(e);if(!e){return}e=e[0]}if('preview'in e){previewStyles=e.preview;if(previewStyles===false){return''}}f=e.block||e.inline||'span';items=Cy(e.selector);if(items.length){if(!items[0].name){items[0].name=f}f=e.selector;previewFrag=Cv(items,d)}else{previewFrag=Cv([f],d)}previewElm=Cu.select(f,previewFrag)[0]||previewFrag.firstChild;Ct(e.styles,function(a,b){a=h(a);if(a){Cu.setStyle(previewElm,b,a)}});Ct(e.attributes,function(a,b){a=h(a);if(a){Cu.setAttrib(previewElm,b,a)}});Ct(e.classes,function(a){a=h(a);if(!Cu.hasClass(previewElm,a)){Cu.addClass(previewElm,a)}});d.fire('PreviewFormats');Cu.setStyles(previewFrag,{position:'absolute',left:-65535});d.getBody().appendChild(previewFrag);parentFontSize=Cu.getStyle(d.getBody(),'fontSize',true);parentFontSize=/px$/.test(parentFontSize)?parseInt(parentFontSize,10):0;Ct(previewStyles.split(' '),function(a){var b=Cu.getStyle(previewElm,a,true);if(a==='background-color'&&/transparent|rgba\s*\([^)]+,\s*0\)/.test(b)){b=Cu.getStyle(d.getBody(),a,true);if(Cu.toHex(b).toLowerCase()==='#ffffff'){return}}if(a==='color'){if(Cu.toHex(b).toLowerCase()==='#000000'){return}}if(a==='font-size'){if(/em|%$/.test(b)){if(parentFontSize===0){return}var c=parseFloat(b)/(/%$/.test(b)?100:1);b=c*parentFontSize+'px'}}if(a==='border'&&b){g+='padding:0 2px;'}g+=a+':'+b+';'});d.fire('AfterPreviewFormats');Cu.remove(previewFrag);return g};var CA={getCssText:Cz,parseSelector:Cy,selectorToHtml:Cw};var CB=function(a,b,c,d,e){var f=b.get(c);if(AZ.match(a,c,d,e)&&(!('toggle'in f[0])||f[0].toggle)){BQ.remove(a,c,d,e)}else{Cl.applyFormat(a,c,d,e)}};var CC={toggle:CB};var CD=function(a){a.addShortcut('meta+b','','Bold');a.addShortcut('meta+i','','Italic');a.addShortcut('meta+u','','Underline');for(var i=1;i<=6;i++){a.addShortcut('access+'+i,'',['FormatBlock',false,'h'+i])}a.addShortcut('access+7','',['FormatBlock',false,'p']);a.addShortcut('access+8','',['FormatBlock',false,'div']);a.addShortcut('access+9','',['FormatBlock',false,'address'])};var CE={setup:CD};function Formatter(a){var b=FormatRegistry(a);var c=ji(null);CE.setup(a);Bs(a);return{get:b.get,register:b.register,unregister:b.unregister,apply:curry(Cl.applyFormat,a),remove:curry(BQ.remove,a),toggle:curry(CC.toggle,a,b),match:curry(AZ.match,a),matchAll:curry(AZ.matchAll,a),matchNode:curry(AZ.matchNode,a),canApply:curry(AZ.canApply,a),formatChanged:curry(Cq.formatChanged,a,c),getCssText:curry(CA.getCssText,a)}}var CF=Object.prototype.hasOwnProperty;var CG=function(a,b){return b};var CH=function(e){return function(){var a=new Array(arguments.length);for(var i=0;i<a.length;i++)a[i]=arguments[i];if(a.length===0)throw new Error('Can\'t merge zero objects');var b={};for(var j=0;j<a.length;j++){var c=a[j];for(var d in c)if(CF.call(c,d)){b[d]=e(b[d],c[d])}}return b}};var CI=CH(CG);var CJ=function(f,g,h){f.addAttributeFilter('data-mce-tabindex',function(a,b){var i=a.length,fH;while(i--){fH=a[i];fH.attr('tabindex',fH.attributes.map['data-mce-tabindex']);fH.attr(b,null)}});f.addAttributeFilter('src,href,style',function(a,b){var i=a.length,fH,value;var c='data-mce-'+b;var d=g.url_converter;var e=g.url_converter_scope;while(i--){fH=a[i];value=fH.attributes.map[c];if(value!==undefined){fH.attr(b,value.length>0?value:null);fH.attr(c,null)}else{value=fH.attributes.map[b];if(b==='style'){value=h.serializeStyle(h.parseStyle(value),fH.name)}else if(d){value=d.call(e,value,b,fH.name)}fH.attr(b,value.length>0?value:null)}}});f.addAttributeFilter('class',function(a){var i=a.length,fH,value;while(i--){fH=a[i];value=fH.attr('class');if(value){value=fH.attr('class').replace(/(?:^|\s)mce-item-\w+(?!\S)/g,'');fH.attr('class',value.length>0?value:null)}}});f.addAttributeFilter('data-mce-type',function(a,b,c){var i=a.length,fH;while(i--){fH=a[i];if(fH.attributes.map['data-mce-type']==='bookmark'&&!c.cleanup){fH.remove()}}});f.addNodeFilter('noscript',function(a){var i=a.length,fH;while(i--){fH=a[i].firstChild;if(fH){fH.value=hK.decode(fH.value)}}});f.addNodeFilter('script,style',function(b,c){var i=b.length,fH,value,fd;var d=function(a){return a.replace(/(<!--\[CDATA\[|\]\]-->)/g,'\n').replace(/^[\r\n]*|[\r\n]*$/g,'').replace(/^\s*((<!--)?(\s*\/\/)?\s*<!\[CDATA\[|(<!--\s*)?\/\*\s*<!\[CDATA\[\s*\*\/|(\/\/)?\s*<!--|\/\*\s*<!--\s*\*\/)\s*[\r\n]*/gi,'').replace(/\s*(\/\*\s*\]\]>\s*\*\/(-->)?|\s*\/\/\s*\]\]>(-->)?|\/\/\s*(-->)?|\]\]>|\/\*\s*-->\s*\*\/|\s*-->\s*)\s*$/g,'')};while(i--){fH=b[i];value=fH.firstChild?fH.firstChild.value:'';if(c==='script'){fd=fH.attr('type');if(fd){fH.attr('type',fd==='mce-no/type'?null:fd.replace(/^mce\-/,''))}if(g.element_format==='xhtml'&&value.length>0){fH.firstChild.value='// <![CDATA[\n'+d(value)+'\n// ]]>'}}else{if(g.element_format==='xhtml'&&value.length>0){fH.firstChild.value='<!--\n'+d(value)+'\n-->'}}}});f.addNodeFilter('#comment',function(a){var i=a.length,fH;while(i--){fH=a[i];if(fH.value.indexOf('[CDATA[')===0){fH.name='#cdata';fH.type=4;fH.value=fH.value.replace(/^\[CDATA\[|\]\]$/g,'')}else if(fH.value.indexOf('mce:protected ')===0){fH.name='#text';fH.type=3;fH.raw=true;fH.value=unescape(fH.value).substr(14)}}});f.addNodeFilter('xml:namespace,input',function(a,b){var i=a.length,fH;while(i--){fH=a[i];if(fH.type===7){fH.remove()}else if(fH.type===1){if(b==='input'&&!('type'in fH.attributes.map)){fH.attr('type','text')}}}});f.addAttributeFilter('data-mce-type',function(b){bD(b,function(a){if(a.attr('data-mce-type')==='format-caret'){if(a.isEmpty(f.schema.getNonEmptyElements())){a.remove()}else{a.unwrap()}}})});f.addAttributeFilter('data-mce-src,data-mce-href,data-mce-style,'+'data-mce-selected,data-mce-expando,'+'data-mce-type,data-mce-resize',function(a,b){var i=a.length;while(i--){a[i].attr(b,null)}})};var CK=function(b){var c,brNode2;var d=function(a){return a&&a.name==='br'};c=b.lastChild;if(d(c)){brNode2=c.prev;if(d(brNode2)){c.remove();brNode2.remove()}}};var CL={register:CJ,trimTrailingBr:CK};var CM=function(b,c,d){var e,dk,oldDoc;var f=b.dom;c=c.cloneNode(true);e=document.implementation;if(e.createHTMLDocument){dk=e.createHTMLDocument('');dj.each(c.nodeName==='BODY'?c.childNodes:[c],function(a){dk.body.appendChild(dk.importNode(a,true))});if(c.nodeName!=='BODY'){c=dk.body.firstChild}else{c=dk.body}oldDoc=f.doc;f.doc=dk}xh.firePreProcess(b,CI(d,{node:c}));if(oldDoc){f.doc=oldDoc}return c};var CN=function(a,b){return a&&a.hasEventListeners('PreProcess')&&!b.no_events};var CO=function(a,b,c){return CN(a,c)?CM(a,b,c):b};var CP={process:CO};var CQ=function(b,c){bD(c,function(a){b.attr(a,null)})};var CR=function(g,h,i){g.addNodeFilter('font',function(f){bD(f,function(a){var b=h.parse(a.attr('style'));var c=a.attr('color');var d=a.attr('face');var e=a.attr('size');if(c){b.color=c}if(d){b['font-family']=d}if(e){b['font-size']=i[parseInt(a.attr('size'),10)-1]}a.name='span';a.attr('style',h.serialize(b));CQ(a,['color','face','size'])})})};var CS=function(d,e){d.addNodeFilter('strike',function(c){bD(c,function(a){var b=e.parse(a.attr('style'));b['text-decoration']='line-through';a.name='span';a.attr('style',e.serialize(b))})})};var CT=function(a,b){var c=Styles();if(b.convert_fonts_to_spans){CR(a,c,dj.explode(b.font_size_legacy_values))}CS(a,c)};var CU=function(a,b){if(b.inline_styles){CT(a,b)}};var CV={register:CU};var CW=/^[ \t\r\n]*$/;var CX={'#text':3,'#comment':8,'#cdata':4,'#pi':7,'#doctype':10,'#document-fragment':11};var CY=function(a,b,c){var d;var e;var f=c?'lastChild':'firstChild';var g=c?'prev':'next';if(a[f]){return a[f]}if(a!==b){d=a[g];if(d){return d}for(e=a.parent;e&&e!==b;e=e.parent){d=e[g];if(d){return d}}}};var CZ=function(){function Node(a,b){this.name=a;this.type=b;if(b===1){this.attributes=[];this.attributes.map={}}}Node.create=function(a,b){var c,attrName;c=new Node(a,CX[a]||1);if(b){for(attrName in b){c.attr(attrName,b[attrName])}}return c};Node.prototype.replace=function(a){var b=this;if(a.parent){a.remove()}b.insert(a,b);b.remove();return b};Node.prototype.attr=function(a,b){var c=this;var d,i;if(typeof a!=='string'){for(i in a){c.attr(i,a[i])}return c}if(d=c.attributes){if(b!==undefined){if(b===null){if(a in d.map){delete d.map[a];i=d.length;while(i--){if(d[i].name===a){d=d.splice(i,1);return c}}}return c}if(a in d.map){i=d.length;while(i--){if(d[i].name===a){d[i].value=b;break}}}else{d.push({name:a,value:b})}d.map[a]=b;return c}return d.map[a]}};Node.prototype.clone=function(){var a=this;var b=new Node(a.name,a.type);var i,l,selfAttrs,selfAttr,cloneAttrs;if(selfAttrs=a.attributes){cloneAttrs=[];cloneAttrs.map={};for(i=0,l=selfAttrs.length;i<l;i++){selfAttr=selfAttrs[i];if(selfAttr.name!=='id'){cloneAttrs[cloneAttrs.length]={name:selfAttr.name,value:selfAttr.value};cloneAttrs.map[selfAttr.name]=selfAttr.value}}b.attributes=cloneAttrs}b.value=a.value;b.shortEnded=a.shortEnded;return b};Node.prototype.wrap=function(a){var b=this;b.parent.insert(a,b);a.append(b);return b};Node.prototype.unwrap=function(){var a=this;var b,next;for(b=a.firstChild;b;){next=b.next;a.insert(b,a,true);b=next}a.remove()};Node.prototype.remove=function(){var a=this,ga=a.parent,next=a.next,prev=a.prev;if(ga){if(ga.firstChild===a){ga.firstChild=next;if(next){next.prev=null}}else{prev.next=next}if(ga.lastChild===a){ga.lastChild=prev;if(prev){prev.next=null}}else{next.prev=prev}a.parent=a.next=a.prev=null}return a};Node.prototype.append=function(a){var b=this;var c;if(a.parent){a.remove()}c=b.lastChild;if(c){c.next=a;a.prev=c;b.lastChild=a}else{b.lastChild=b.firstChild=a}a.parent=b;return a};Node.prototype.insert=function(a,b,c){var d;if(a.parent){a.remove()}d=b.parent||this;if(c){if(b===d.firstChild){d.firstChild=a}else{b.prev.next=a}a.prev=b.prev;a.next=b;b.prev=a}else{if(b===d.lastChild){d.lastChild=a}else{b.next.prev=a}a.next=b.next;a.prev=b;b.next=a}a.parent=d;return a};Node.prototype.getAll=function(a){var b=this;var c;var d=[];for(c=b.firstChild;c;c=CY(c,b)){if(c.name===a){d.push(c)}}return d};Node.prototype.empty=function(){var a=this;var b,i,fH;if(a.firstChild){b=[];for(fH=a.firstChild;fH;fH=CY(fH,a)){b.push(fH)}i=b.length;while(i--){fH=b[i];fH.parent=fH.firstChild=fH.lastChild=fH.next=fH.prev=null}}a.firstChild=a.lastChild=null;return a};Node.prototype.isEmpty=function(a,b,c){var d=this;var e=d.firstChild,i,fc;b=b||{};if(e){do{if(e.type===1){if(e.attributes.map['data-mce-bogus']){continue}if(a[e.name]){return false}i=e.attributes.length;while(i--){fc=e.attributes[i].name;if(fc==='name'||fc.indexOf('data-mce-bookmark')===0){return false}}}if(e.type===8){return false}if(e.type===3&&!CW.test(e.value)){return false}if(e.type===3&&e.parent&&b[e.parent.name]&&CW.test(e.value)){return false}if(c&&c(e)){return false}}while(e=CY(e,d))}return true};Node.prototype.walk=function(a){return CY(this,null,a)};return Node}();var Da=function(a,b,c,d){var e=a.padd_empty_with_br||b.insert;if(e&&c[d.name]){d.empty().append(new CZ('br',1)).shortEnded=true}else{d.empty().append(new CZ('#text',3)).value='\xA0'}};var Db=function(a){return Dc(a,'#text')&&a.firstChild.value==='\xA0'};var Dc=function(a,b){return a&&a.firstChild&&a.firstChild===a.lastChild&&a.firstChild.name===b};var Dd=function(a,b){var c=a.getElementRule(b.name);return c&&c.paddEmpty};var De=function(b,c,d,e){return e.isEmpty(c,d,function(a){return Dd(b,a)})};var Df=function(a,b){return a&&(b[a.name]||a.name==='br')};var Dg=function(j,k){var m=j.schema;if(k.remove_trailing_brs){j.addNodeFilter('br',function(a,_,b){var i;var l=a.length;var c;var d=dj.extend({},m.getBlockElements());var e=m.getNonEmptyElements();var f,lastParent,prev,prevName;var g=m.getNonEmptyElements();var h,textNode;d.body=1;for(i=0;i<l;i++){c=a[i];f=c.parent;if(d[c.parent.name]&&c===f.lastChild){prev=c.prev;while(prev){prevName=prev.name;if(prevName!=='span'||prev.attr('data-mce-type')!=='bookmark'){if(prevName!=='br'){break}if(prevName==='br'){c=null;break}}prev=prev.prev}if(c){c.remove();if(De(m,e,g,f)){h=m.getElementRule(f.name);if(h){if(h.removeEmpty){f.remove()}else if(h.paddEmpty){Da(k,b,d,f)}}}}}else{lastParent=c;while(f&&f.firstChild===lastParent&&f.lastChild===lastParent){lastParent=f;if(d[f.name]){break}f=f.parent}if(lastParent===f&&k.padd_empty_with_br!==true){textNode=new CZ('#text',3);textNode.value='\xA0';c.replace(textNode)}}}})}j.addAttributeFilter('href',function(c){var i=c.length,fH;var d=function(a){var b=a.split(' ').filter(function(p){return p.length>0});return b.concat(['noopener']).sort().join(' ')};var e=function(a){var b=a?dj.trim(a):'';if(!/\b(noopener)\b/g.test(b)){return d(b)}else{return b}};if(!k.allow_unsafe_link_target){while(i--){fH=c[i];if(fH.name==='a'&&fH.attr('target')==='_blank'){fH.attr('rel',e(fH.attr('rel')))}}}});if(!k.allow_html_in_named_anchor){j.addAttributeFilter('id,name',function(a){var i=a.length,dJ,gc,ga,fH;while(i--){fH=a[i];if(fH.name==='a'&&fH.firstChild&&!fH.attr('href')){ga=fH.parent;dJ=fH.lastChild;do{gc=dJ.prev;ga.insert(dJ,fH);dJ=gc}while(dJ)}}})}if(k.fix_list_elements){j.addNodeFilter('ul,ol',function(a){var i=a.length,fH,parentNode;while(i--){fH=a[i];parentNode=fH.parent;if(parentNode.name==='ul'||parentNode.name==='ol'){if(fH.prev&&fH.prev.name==='li'){fH.prev.append(fH)}else{var b=new CZ('li',1);b.attr('style','list-style-type: none');fH.wrap(b)}}}})}if(k.validate&&m.getValidClasses()){j.addAttributeFilter('class',function(a){var i=a.length,fH,classList,ci,className,classValue;var b=m.getValidClasses();var c,valid;while(i--){fH=a[i];classList=fH.attr('class').split(' ');classValue='';for(ci=0;ci<classList.length;ci++){className=classList[ci];valid=false;c=b['*'];if(c&&c[className]){valid=true}c=b[fH.name];if(!valid&&c&&c[className]){valid=true}if(valid){if(classValue){classValue+=' '}classValue+=className}}if(!classValue.length){classValue=null}fH.attr('class',classValue)}})}};var Dh=dj.makeMap,each$i=dj.each,explode$3=dj.explode,extend$3=dj.extend;function DomParser(B,C){if(C===void 0){C=Schema()}var D={};var E=[];var F={};var G={};B=B||{};B.validate='validate'in B?B.validate:true;B.root_name=B.root_name||'body';var H=function(a){var b,fH,ga,gb,newParent,currentNode,tempNode,childNode,i;var c,whitespaceElements,nonSplitableElements,textBlockElements,specialElements,dJ,nextNode;nonSplitableElements=Dh('tr,td,th,tbody,thead,tfoot,table');c=C.getNonEmptyElements();whitespaceElements=C.getWhiteSpaceElements();textBlockElements=C.getTextBlockElements();specialElements=C.getSpecialElements();for(b=0;b<a.length;b++){fH=a[b];if(!fH.parent||fH.fixed){continue}if(textBlockElements[fH.name]&&fH.parent.name==='li'){dJ=fH.next;while(dJ){if(textBlockElements[dJ.name]){dJ.name='li';dJ.fixed=true;fH.parent.insert(dJ,fH.parent)}else{break}dJ=dJ.next}fH.unwrap(fH);continue}gb=[fH];for(ga=fH.parent;ga&&!C.isValidChild(ga.name,fH.name)&&!nonSplitableElements[ga.name];ga=ga.parent){gb.push(ga)}if(ga&&gb.length>1){gb.reverse();newParent=currentNode=I(gb[0].clone());for(i=0;i<gb.length-1;i++){if(C.isValidChild(currentNode.name,gb[i].name)){tempNode=I(gb[i].clone());currentNode.append(tempNode)}else{tempNode=currentNode}for(childNode=gb[i].firstChild;childNode&&childNode!==gb[i+1];){nextNode=childNode.next;tempNode.append(childNode);childNode=nextNode}currentNode=tempNode}if(!De(C,c,whitespaceElements,newParent)){ga.insert(newParent,gb[0],true);ga.insert(fH,newParent)}else{ga.insert(fH,gb[0],true)}ga=gb[0];if(De(C,c,whitespaceElements,ga)||Dc(ga,'br')){ga.empty().remove()}}else if(fH.parent){if(fH.name==='li'){dJ=fH.prev;if(dJ&&(dJ.name==='ul'||dJ.name==='ul')){dJ.append(fH);continue}dJ=fH.next;if(dJ&&(dJ.name==='ul'||dJ.name==='ul')){dJ.insert(fH,dJ.firstChild,true);continue}fH.wrap(I(new CZ('ul',1)));continue}if(C.isValidChild(fH.parent.name,'div')&&C.isValidChild('div',fH.name)){fH.wrap(I(new CZ('div',1)))}else{if(specialElements[fH.name]){fH.empty().remove()}else{fH.unwrap()}}}}};var I=function(a){var i,fc,list;fc=a.name;if(fc in D){list=F[fc];if(list){list.push(a)}else{F[fc]=[a]}}i=E.length;while(i--){fc=E[i].name;if(fc in a.attributes.map){list=G[fc];if(list){list.push(a)}else{G[fc]=[a]}}}return a};var J=function(c,d){each$i(explode$3(c),function(a){var b=D[a];if(!b){D[a]=b=[]}b.push(d)})};var K=function(){var a=[];for(var b in D){if(D.hasOwnProperty(b)){a.push({name:b,callbacks:D[b]})}}return a};var L=function(b,c){each$i(explode$3(b),function(a){var i;for(i=0;i<E.length;i++){if(E[i].name===a){E[i].callbacks.push(c);return}}E.push({name:a,callbacks:[c]})})};var M=function(){return[].concat(E)};var N=function(e,f){var g,nodes,i,l,fi,fl,list,fc;var h;var j=[];var k;var m;f=f||{};F={};G={};h=extend$3(Dh('script,style,head,html,body,title,meta,param'),C.getBlockElements());var n=C.getNonEmptyElements();var o=C.children;var p=B.validate;var q='forced_root_block'in f?f.forced_root_block:B.forced_root_block;var r=C.getWhiteSpaceElements();var s=/^[ \t\r\n]+/;var t=/[ \t\r\n]+$/;var u=/[ \t\r\n]+/g;var v=/^[ \t\r\n]+$/;k=r.hasOwnProperty(f.context)||r.hasOwnProperty(B.root_name);var w=function(){var b=A.firstChild,next,rootBlockNode;var c=function(a){if(a){b=a.firstChild;if(b&&b.type===3){b.value=b.value.replace(s,'')}b=a.lastChild;if(b&&b.type===3){b.value=b.value.replace(t,'')}}};if(!C.isValidChild(A.name,q.toLowerCase())){return}while(b){next=b.next;if(b.type===3||b.type===1&&b.name!=='p'&&!h[b.name]&&!b.attr('data-mce-type')){if(!rootBlockNode){rootBlockNode=x(q,1);rootBlockNode.attr(B.forced_root_block_attrs);A.insert(rootBlockNode,b);rootBlockNode.append(b)}else{rootBlockNode.append(b)}}else{c(rootBlockNode);rootBlockNode=null}b=next}c(rootBlockNode)};var x=function(a,b){var c=new CZ(a,b);var d;if(a in D){d=F[a];if(d){d.push(c)}else{F[a]=[c]}}return c};var y=function(a){var b,textNodeNext,textVal,dJ;var c=C.getBlockElements();for(b=a.prev;b&&b.type===3;){textVal=b.value.replace(t,'');if(textVal.length>0){b.value=textVal;return}textNodeNext=b.next;if(textNodeNext){if(textNodeNext.type===3&&textNodeNext.value.length){b=b.prev;continue}if(!c[textNodeNext.name]&&textNodeNext.name!=='script'&&textNodeNext.name!=='style'){b=b.prev;continue}}dJ=b.prev;b.remove();b=dJ}};var z=function(a){var b;var c={};for(b in a){if(b!=='li'&&b!=='p'){c[b]=a[b]}}return c};g=An({validate:p,allow_script_urls:B.allow_script_urls,allow_conditional_comments:B.allow_conditional_comments,self_closing_elements:z(C.getSelfClosingElements()),cdata:function(a){m.append(x('#cdata',4)).value=a},text:function(a,b){var c;if(!k){a=a.replace(u,' ');if(Df(m.lastChild,h)){a=a.replace(s,'')}}if(a.length!==0){c=x('#text',3);c.raw=!!b;m.append(c).value=a}},comment:function(a){m.append(x('#comment',8)).value=a},pi:function(a,b){m.append(x(a,7)).value=b;y(m)},doctype:function(a){var b;b=m.append(x('#doctype',10));b.value=a;y(m)},start:function(a,b,c){var d,attrFiltersLen,elementRule,attrName,ga;elementRule=p?C.getElementRule(a):{};if(elementRule){d=x(elementRule.outputName||a,1);d.attributes=b;d.shortEnded=c;m.append(d);ga=o[m.name];if(ga&&o[d.name]&&!ga[d.name]){j.push(d)}attrFiltersLen=E.length;while(attrFiltersLen--){attrName=E[attrFiltersLen].name;if(attrName in b.map){list=G[attrName];if(list){list.push(d)}else{G[attrName]=[d]}}}if(h[a]){y(d)}if(!c){m=d}if(!k&&r[a]){k=true}}},end:function(a){var b,elementRule,text,dJ,tempNode;elementRule=p?C.getElementRule(a):{};if(elementRule){if(h[a]){if(!k){b=m.firstChild;if(b&&b.type===3){text=b.value.replace(s,'');if(text.length>0){b.value=text;b=b.next}else{dJ=b.next;b.remove();b=dJ;while(b&&b.type===3){text=b.value;dJ=b.next;if(text.length===0||v.test(text)){b.remove();b=dJ}b=dJ}}}b=m.lastChild;if(b&&b.type===3){text=b.value.replace(t,'');if(text.length>0){b.value=text;b=b.prev}else{dJ=b.prev;b.remove();b=dJ;while(b&&b.type===3){text=b.value;dJ=b.prev;if(text.length===0||v.test(text)){b.remove();b=dJ}b=dJ}}}}}if(k&&r[a]){k=false}if(elementRule.removeEmpty&&De(C,n,r,m)){if(!m.attributes.map.name&&!m.attr('id')){tempNode=m.parent;if(h[m.name]){m.empty().remove()}else{m.unwrap()}m=tempNode;return}}if(elementRule.paddEmpty&&(Db(m)||De(C,n,r,m))){Da(B,f,h,m)}m=m.parent}}},C);var A=m=new CZ(f.context||B.root_name,11);g.parse(e);if(p&&j.length){if(!f.context){H(j)}else{f.invalid=true}}if(q&&(A.name==='body'||f.isRootContent)){w()}if(!f.invalid){for(fc in F){list=D[fc];nodes=F[fc];fi=nodes.length;while(fi--){if(!nodes[fi].parent){nodes.splice(fi,1)}}for(i=0,l=list.length;i<l;i++){list[i](nodes,fc,f)}}for(i=0,l=E.length;i<l;i++){list=E[i];if(list.name in G){nodes=G[list.name];fi=nodes.length;while(fi--){if(!nodes[fi].parent){nodes.splice(fi,1)}}for(fi=0,fl=list.callbacks.length;fi<fl;fi++){list.callbacks[fi](nodes,list.name,f)}}}}return A};var O={schema:C,addAttributeFilter:L,getAttributeFilters:M,addNodeFilter:J,getNodeFilters:K,filterNode:I,parse:N};Dg(O,B);CV.register(O,B);return O}var Di=function(c,d,e){if(dj.inArray(d,e)===-1){c.addAttributeFilter(e,function(a,b){var i=a.length;while(i--){a[i].attr(b,null)}});d.push(e)}};var Dj=function(a,b,c){if(!b.no_events&&a){var d=xh.firePostProcess(a,CI(b,{content:c}));return d.content}else{return c}};var Dk=function(a,b,c){var d=jX.trim(c.getInner?b.innerHTML:a.getOuterHTML(b));return c.selection||gX(eP.fromDom(b))?d:dj.trim(d)};var Dl=function(a,b,c){var d=c.selection?CI({forced_root_block:false},c):c;var e=a.parse(b,d);CL.trimTrailingBr(e);return e};var Dm=function(a,b,c){var d=Serializer(a,b);return d.serialize(c)};var Dn=function(a,b,c,d,e){var f=Dm(b,c,d);return Dj(a,e,f)};function DomSerializer(g,h){var i,schema,htmlParser;var j=['data-mce-selected'];i=h&&h.dom?h.dom:iQ.DOM;schema=h&&h.schema?h.schema:Schema(g);g.entity_encoding=g.entity_encoding||'named';g.remove_trailing_brs='remove_trailing_brs'in g?g.remove_trailing_brs:true;htmlParser=DomParser(g,schema);CL.register(htmlParser,g,i);var k=function(a,b){var c=CI({format:'html'},b?b:{});var d=CP.process(h,a,c);var e=Dk(i,d,c);var f=Dl(htmlParser,e,c);return c.format==='tree'?f:Dn(h,g,schema,f,c)};return{schema:schema,addNodeFilter:htmlParser.addNodeFilter,addAttributeFilter:htmlParser.addAttributeFilter,serialize:k,addRules:function(a){schema.addValidElements(a)},setRules:function(a){schema.setValidElements(a)},addTempAttr:curry(Di,htmlParser,j),getTempAttrs:function(){return j}}}function Serializer$1(a,b){var c=DomSerializer(a,b);return{schema:c.schema,addNodeFilter:c.addNodeFilter,addAttributeFilter:c.addAttributeFilter,serialize:c.serialize,addRules:c.addRules,setRules:c.setRules,addTempAttr:c.addTempAttr,getTempAttrs:c.getTempAttrs}}function BookmarkManager(a){return{getBookmark:curry(og.getBookmark,a),moveToBookmark:curry(og.moveToBookmark,a)}}(function(a){a.isBookmarkNode=og.isBookmarkNode}(BookmarkManager||(BookmarkManager={})));var Do=BookmarkManager;var Dp=hq.isContentEditableFalse;var Dq=hq.isContentEditableTrue;var Dr=function(a,b){while(b&&b!==a){if(Dq(b)||Dp(b)){return b}b=b.parentNode}return null};var Ds=function(h,i){var j=i.dom,bD=dj.each;var k,selectedElmGhost,resizeHelper,resizeHandles,selectedHandle;var l,startY,selectedElmX,selectedElmY,startW,startH,ratio,resizeStarted;var m,height;var n=i.getDoc(),rootDocument=document;var o=Math.abs,kD=Math.round,rootElement=i.getBody();var p,startScrollHeight;resizeHandles={nw:[0,0,-1,-1],ne:[1,0,1,-1],se:[1,1,1,1],sw:[0,1,-1,1]};var q='.mce-content-body';i.contentStyles.push(q+' div.mce-resizehandle {'+'position: absolute;'+'border: 1px solid black;'+'box-sizing: content-box;'+'background: #FFF;'+'width: 7px;'+'height: 7px;'+'z-index: 10000'+'}'+q+' .mce-resizehandle:hover {'+'background: #000'+'}'+q+' img[data-mce-selected],'+q+' hr[data-mce-selected] {'+'outline: 1px solid black;'+'resize: none'+'}'+q+' .mce-clonedresizable {'+'position: absolute;'+(co.gecko?'':'outline: 1px dashed black;')+'opacity: .5;'+'filter: alpha(opacity=50);'+'z-index: 10000'+'}'+q+' .mce-resize-helper {'+'background: #555;'+'background: rgba(0,0,0,0.75);'+'border-radius: 3px;'+'border: 1px;'+'color: white;'+'display: none;'+'font-family: sans-serif;'+'font-size: 12px;'+'white-space: nowrap;'+'line-height: 14px;'+'margin: 5px 10px;'+'padding: 5px;'+'position: absolute;'+'z-index: 10001'+'}');var r=function(a){return a&&(a.nodeName==='IMG'||i.dom.is(a,'figure.image'))};var s=function(a,b){return r(a.target)&&!zT.isXYWithinRange(a.clientX,a.clientY,b)};var t=function(a){var b=a.target;if(s(a,i.selection.getRng())&&!a.isDefaultPrevented()){a.preventDefault();i.selection.select(b)}};var u=function(a){return i.dom.is(a,'figure.image')?a.querySelector('img'):a};var v=function(a){var b=i.settings.object_resizing;if(b===false||co.iOS){return false}if(typeof b!=='string'){b='table,img,figure.image,div'}if(a.getAttribute('data-mce-resize')==='false'){return false}if(a===i.getBody()){return false}return fO(eP.fromDom(a),b)};var w=function(e){var a,deltaY,proportional;var b,resizeHelperY;a=e.screenX-l;deltaY=e.screenY-startY;m=a*selectedHandle[2]+startW;height=deltaY*selectedHandle[3]+startH;m=m<5?5:m;height=height<5?5:height;if(r(k)&&i.settings.resize_img_proportional!==false){proportional=!Ad.modifierPressed(e)}else{proportional=Ad.modifierPressed(e)||r(k)&&selectedHandle[2]*selectedHandle[3]!==0}if(proportional){if(o(a)>o(deltaY)){height=kD(m*ratio);m=kD(height/ratio)}else{m=kD(height/ratio);height=kD(m*ratio)}}j.setStyles(u(selectedElmGhost),{width:m,height:height});b=selectedHandle.startPos.x+a;resizeHelperY=selectedHandle.startPos.y+deltaY;b=b>0?b:0;resizeHelperY=resizeHelperY>0?resizeHelperY:0;j.setStyles(resizeHelper,{left:b,top:resizeHelperY,display:'block'});resizeHelper.innerHTML=m+' &times; '+height;if(selectedHandle[2]<0&&selectedElmGhost.clientWidth<=m){j.setStyle(selectedElmGhost,'left',selectedElmX+(startW-m))}if(selectedHandle[3]<0&&selectedElmGhost.clientHeight<=height){j.setStyle(selectedElmGhost,'top',selectedElmY+(startH-height))}a=rootElement.scrollWidth-p;deltaY=rootElement.scrollHeight-startScrollHeight;if(a+deltaY!==0){j.setStyles(resizeHelper,{left:b-a,top:resizeHelperY-deltaY})}if(!resizeStarted){xh.fireObjectResizeStart(i,k,startW,startH);resizeStarted=true}};var x=function(){resizeStarted=false;var c=function(a,b){if(b){if(k.style[a]||!i.schema.isValid(k.nodeName.toLowerCase(),a)){j.setStyle(u(k),a,b)}else{j.setAttrib(u(k),a,b)}}};c('width',m);c('height',height);j.unbind(n,'mousemove',w);j.unbind(n,'mouseup',x);if(rootDocument!==n){j.unbind(rootDocument,'mousemove',w);j.unbind(rootDocument,'mouseup',x)}j.remove(selectedElmGhost);j.remove(resizeHelper);y(k);xh.fireObjectResized(i,k,m,height);j.setAttrib(k,'style',j.getAttrib(k,'style'));i.nodeChanged()};var y=function(f){var g,targetWidth,targetHeight,e,rect;z();C();g=j.getPos(f,rootElement);selectedElmX=g.x;selectedElmY=g.y;rect=f.getBoundingClientRect();targetWidth=rect.width||rect.right-rect.left;targetHeight=rect.height||rect.bottom-rect.top;if(k!==f){k=f;m=height=0}e=i.fire('ObjectSelected',{target:f});if(v(f)&&!e.isDefaultPrevented()){bD(resizeHandles,function(a,b){var c;var d=function(e){l=e.screenX;startY=e.screenY;startW=u(k).clientWidth;startH=u(k).clientHeight;ratio=startH/startW;selectedHandle=a;a.startPos={x:targetWidth*a[0]+selectedElmX,y:targetHeight*a[1]+selectedElmY};p=rootElement.scrollWidth;startScrollHeight=rootElement.scrollHeight;selectedElmGhost=k.cloneNode(true);j.addClass(selectedElmGhost,'mce-clonedresizable');j.setAttrib(selectedElmGhost,'data-mce-bogus','all');selectedElmGhost.contentEditable=false;selectedElmGhost.unSelectabe=true;j.setStyles(selectedElmGhost,{left:selectedElmX,top:selectedElmY,margin:0});selectedElmGhost.removeAttribute('data-mce-selected');rootElement.appendChild(selectedElmGhost);j.bind(n,'mousemove',w);j.bind(n,'mouseup',x);if(rootDocument!==n){j.bind(rootDocument,'mousemove',w);j.bind(rootDocument,'mouseup',x)}resizeHelper=j.add(rootElement,'div',{'class':'mce-resize-helper','data-mce-bogus':'all'},startW+' &times; '+startH)};c=j.get('mceResizeHandle'+b);if(c){j.remove(c)}c=j.add(rootElement,'div',{'id':'mceResizeHandle'+b,'data-mce-bogus':'all','class':'mce-resizehandle','unselectable':true,'style':'cursor:'+b+'-resize; margin:0; padding:0'});if(co.ie===11){c.contentEditable=false}j.bind(c,'mousedown',function(e){e.stopImmediatePropagation();e.preventDefault();d(e)});a.elm=c;j.setStyles(c,{left:targetWidth*a[0]+selectedElmX-c.offsetWidth/2,top:targetHeight*a[1]+selectedElmY-c.offsetHeight/2})})}else{z()}k.setAttribute('data-mce-selected','1')};var z=function(){var a,handleElm;C();if(k){k.removeAttribute('data-mce-selected')}for(a in resizeHandles){handleElm=j.get('mceResizeHandle'+a);if(handleElm){j.unbind(handleElm);j.remove(handleElm)}}};var A=function(e){var c,controlElm;var d=function(a,b){if(a){do{if(a===b){return true}}while(a=a.parentNode)}};if(resizeStarted||i.removed){return}bD(j.select('img[data-mce-selected],hr[data-mce-selected]'),function(a){a.removeAttribute('data-mce-selected')});controlElm=e.type==='mousedown'?e.target:h.getNode();controlElm=j.$(controlElm).closest('table,img,figure.image,hr')[0];if(d(controlElm,rootElement)){D();c=h.getStart(true);if(d(c,controlElm)&&d(h.getEnd(true),controlElm)){y(controlElm);return}}z()};var B=function(a){return Dp(Dr(i.getBody(),a))};var C=function(){for(var a in resizeHandles){var b=resizeHandles[a];if(b.elm){j.unbind(b.elm);delete b.elm}}};var D=function(){try{i.getDoc().execCommand('enableObjectResizing',false,false)}catch(ex){}};i.on('init',function(){D();if(co.ie&&co.ie>=11){i.on('mousedown click',function(e){var a=e.target,nodeName=a.nodeName;if(!resizeStarted&&/^(TABLE|IMG|HR)$/.test(nodeName)&&!B(a)){if(e.button!==2){i.selection.select(a,nodeName==='TABLE')}if(e.type==='mousedown'){i.nodeChanged()}}});i.dom.bind(rootElement,'mscontrolselect',function(e){var b=function(a){cy.setEditorTimeout(i,function(){i.selection.select(a)})};if(B(e.target)){e.preventDefault();b(e.target);return}if(/^(TABLE|IMG|HR)$/.test(e.target.nodeName)){e.preventDefault();if(e.target.tagName==='IMG'){b(e.target)}}})}var c=cy.throttle(function(e){if(!i.composing){A(e)}});i.on('nodechange ResizeEditor ResizeWindow drop FullscreenStateChanged',c);i.on('keyup compositionend',function(e){if(k&&k.nodeName==='TABLE'){c(e)}});i.on('hide blur',z);i.on('contextmenu',t)});i.on('remove',C);var E=function(){k=selectedElmGhost=null};return{isResizable:v,showResizeRect:y,hideResizeRect:z,updateResizeRect:A,destroy:E}};var Dt=function(a){var x=0,y=0;var b=a;while(b&&b.nodeType){x+=b.offsetLeft||0;y+=b.offsetTop||0;b=b.offsetParent}return{x:x,y:y}};var Du=function(a,b,c){var d={elm:b,alignToTop:c};a.fire('scrollIntoView',d);return d.isDefaultPrevented()};var Dv=function(a,b,c){var y,viewPort;var d=a.dom;var e=d.getRoot();var f,viewPortH,offsetY=0;if(Du(a,b,c)){return}if(!hq.isElement(b)){return}if(c===false){offsetY=b.offsetHeight}if(e.nodeName!=='BODY'){var g=a.selection.getScrollContainer();if(g){y=Dt(b).y-Dt(g).y+offsetY;viewPortH=g.clientHeight;f=g.scrollTop;if(y<f||y+25>f+viewPortH){g.scrollTop=y<f?y:y-viewPortH+25}return}}viewPort=d.getViewPort(a.getWin());y=d.getPos(b).y+offsetY;f=viewPort.y;viewPortH=viewPort.h;if(y<viewPort.y||y+25>f+viewPortH){a.getWin().scrollTo(0,y<f?y:y-viewPortH+25)}};var Dw=function(a){if(a.inline){return a.getBody().getBoundingClientRect()}else{var b=a.getWin();return{left:0,right:b.innerWidth,top:0,bottom:b.innerHeight,width:b.innerWidth,height:b.innerHeight}}};var Dx=function(a,b,c){if(a.inline){a.getBody().scrollLeft+=b;a.getBody().scrollTop+=c}else{a.getWin().scrollBy(b,c)}};var Dy=function(g,h){bV(CaretPosition.fromRangeStart(h).getClientRects()).each(function(a){var b=Dw(g);var c=kN(b,a);var d=4;var e=c.x>0?c.x+d:c.x-d;var f=c.y>0?c.y+d:c.y-d;Dx(g,c.x!==0?e:0,c.y!==0?f:0)})};var Dz={scrollElementIntoView:Dv,scrollRangeIntoView:Dy};var DA=function(a){return hq.isContentEditableTrue(a)||hq.isContentEditableFalse(a)};var DB=function(a,b,c){while(a&&a!==b){if(c(a)){return a}a=a.parentNode}return null};var DC=function(c,d,e){var f,rng,rects;f=e.elementFromPoint(c,d);rng=e.body.createTextRange();if(!f||f.tagName==='HTML'){f=e.body}rng.moveToElementText(f);rects=dj.toArray(rng.getClientRects());rects=rects.sort(function(a,b){a=Math.abs(Math.max(a.top-d,a.bottom-d));b=Math.abs(Math.max(b.top-d,b.bottom-d));return a-b});if(rects.length>0){d=(rects[0].bottom+rects[0].top)/2;try{rng.moveToPoint(c,d);rng.collapse(true);return rng}catch(ex){}}return null};var DD=function(a,b){var c=a&&a.parentElement?a.parentElement():null;return hq.isContentEditableFalse(DB(c,b,DA))?null:a};var DE=function(a,b,c){var d,point;var e=c;if(e.caretPositionFromPoint){point=e.caretPositionFromPoint(a,b);if(point){d=c.createRange();d.setStart(point.offsetNode,point.offset);d.collapse(true)}}else if(c.caretRangeFromPoint){d=c.caretRangeFromPoint(a,b)}else if(e.body.createTextRange){d=e.body.createTextRange();try{d.moveToPoint(a,b);d.collapse(true)}catch(ex){d=DC(a,b,c)}return DD(d,c.body)}return d};var DF={fromPoint:DE};var DG=function(c,d){return bC(d,function(a){var b=c.fire('GetSelectionRange',{range:a});return b.range!==a?b.range:a})};var DH={processRanges:DG};var DI=function(b,c){var d=c||document;var e=d.createDocumentFragment();bD(b,function(a){e.appendChild(a.dom())});return eP.fromDom(e)};var DJ=fE('element','width','rows');var DK=fE('element','cells');var DL=fE('x','y');var DM=function(a,b){var c=parseInt(fu(a,b),10);return isNaN(c)?1:c};var DN=function(a,x,y,b,c){var d=DM(c,'rowspan');var e=DM(c,'colspan');var f=a.rows();for(var g=y;g<y+d;g++){if(!f[g]){f[g]=DK(jQ(b),[])}for(var h=x;h<x+e;h++){var i=f[g].cells();i[h]=g===y&&h===x?c:jP(c)}}};var DO=function(a,x,y){var b=a.rows();var c=b[y]?b[y].cells():[];return!!c[x]};var DP=function(a,x,y){while(DO(a,x,y)){x++}return x};var DQ=function(c){return bI(c,function(a,b){return b.cells().length>a?b.cells().length:a},0)};var DR=function(a,b){var c=a.rows();for(var y=0;y<c.length;y++){var d=c[y].cells();for(var x=0;x<d.length;x++){if(fS(d[x],b)){return bo.some(DL(x,y))}}}return bo.none()};var DS=function(a,b,c,d,e){var f=[];var g=a.rows();for(var y=c;y<=e;y++){var h=g[y].cells();var i=b<d?h.slice(b,d+1):h.slice(d,b+1);f.push(DK(g[y].element(),i))}return f};var DT=function(a,b,c){var d=b.x(),sy=b.y();var e=c.x(),ey=c.y();var f=sy<ey?DS(a,d,sy,e,ey):DS(a,d,ey,e,sy);return DJ(a.element(),DQ(f),f)};var DU=function(a,b){var c=jP(a.element());var d=eP.fromTag('tbody');jc(d,b);iZ(c,d);return c};var DV=function(f){return bC(f.rows(),function(c){var d=bC(c.cells(),function(a){var b=jQ(a);fw(b,'colspan');fw(b,'rowspan');return b});var e=jP(c.element());jc(e,d);return e})};var DW=function(c){var d=DJ(jP(c),0,[]);bD(jv(c,'tr'),function(b,y){bD(jv(b,'td,th'),function(a,x){DN(d,DP(d,x,y),y,b,a)})});return DJ(d.element(),DQ(d.rows()),d.rows())};var DX=function(a){return DU(a,DV(a))};var DY=function(c,d,e){return DR(c,d).bind(function(b){return DR(c,e).map(function(a){return DT(c,b,a)})})};var DZ={fromDom:DW,toDom:DX,subsection:DY};var Ea=function(b){return bJ(b,function(a){return fc(a)==='ul'||fc(a)==='ol'})};var Eb=function(c,d){return bJ(c,function(a){return fc(a)==='li'&&yP(a,d)}).fold(bc([]),function(b){return Ea(c).map(function(a){return[eP.fromTag('li'),eP.fromTag(fc(a))]}).getOr([])})};var Ec=function(c,d){var e=bI(d,function(a,b){iZ(b,a);return b},c);return d.length>0?DI([e]):e};var Ed=function(b){if(gT(b)){return ga(b).filter(gS).fold(bc([]),function(a){return[b,a]})}else{return gS(b)?[b]:[]}};var Ee=function(b,c){var d=eP.fromDom(c.commonAncestorContainer);var e=rn.parentsAndSelf(d,b);var f=bG(e,function(a){return gP(a)||gN(a)});var g=Eb(e,c);var h=f.concat(g.length?g:Ed(d));return bC(h,jP)};var Ef=function(){return DI([])};var Eg=function(a,b){return Ec(eP.fromDom(b.cloneContents()),Ee(a,b))};var Eh=function(a,b){return jy(b,'table',curry(fS,a))};var Ei=function(f,g){return Eh(f,g[0]).bind(function(b){var c=g[0];var d=g[g.length-1];var e=DZ.fromDom(b);return DZ.subsection(e,c,d).map(function(a){return DI([DZ.toDom(a)])})}).getOrThunk(Ef)};var Ej=function(a,b){return b.length>0&&b[0].collapsed?Ef():Eg(a,b[0])};var Ek=function(a,b){var c=uE.getCellsFromElementOrRanges(b,a);return c.length>0?Ei(a,c):Ej(a,b)};var El={read:Ek};var Em=function(a){return bo.from(a.selection.getRng()).map(function(r){return jX.trim(r.toString())}).getOr('')};var En=function(a,b){var c=a.selection.getRng(),tmpElm=a.dom.create('body');var d=a.selection.getSel();var e;var f=DH.processRanges(a,uz.getRanges(d));if(c.cloneContents){e=b.contextual?El.read(eP.fromDom(a.getBody()),f).dom():c.cloneContents();if(e){tmpElm.appendChild(e)}}else{tmpElm.innerHTML=c.toString()}return a.selection.serializer.serialize(tmpElm,b)};var Eo=function(a,b){if(b===void 0){b={}}b.get=true;b.format=b.format||'html';b.selection=true;b=a.fire('BeforeGetContent',b);if(b.isDefaultPrevented()){a.fire('GetContent',b);return b.content}if(b.format==='text'){return Em(a)}else{b.getInner=true;var c=En(a,b);if(b.format==='tree'){return c}else{b.content=a.selection.isCollapsed()?'':c;a.fire('GetContent',b);return b.content}}};var Ep={getContent:Eo};var Eq=function(a,b,c){var d=a.selection.getRng(),caretNode;var e=a.getDoc();var f,temp;c=c||{format:'html'};c.set=true;c.selection=true;c.content=b;if(!c.no_events){c=a.fire('BeforeSetContent',c);if(c.isDefaultPrevented()){a.fire('SetContent',c);return}}b=c.content;if(d.insertNode){b+='<span id="__caret">_</span>';if(d.startContainer===e&&d.endContainer===e){e.body.innerHTML=b}else{d.deleteContents();if(e.body.childNodes.length===0){e.body.innerHTML=b}else{if(d.createContextualFragment){d.insertNode(d.createContextualFragment(b))}else{f=e.createDocumentFragment();temp=e.createElement('div');f.appendChild(temp);temp.outerHTML=b;d.insertNode(f)}}}caretNode=a.dom.get('__caret');d=e.createRange();d.setStartBefore(caretNode);d.setEndBefore(caretNode);a.selection.setRng(d);a.dom.remove('__caret');try{a.selection.setRng(d)}catch(ex){}}else{if(d.item){e.execCommand('Delete',false,null);d=a.getRng()}if(/^\s+/.test(b)){d.pasteHTML('<span id="__mce_tmp">_</span>'+b);a.dom.remove('__mce_tmp')}else{d.pasteHTML(b)}}if(!c.no_events){a.fire('SetContent',c)}};var Er={setContent:Eq};var Es=function(b,c,d,e,f){var g=d?c.startContainer:c.endContainer;var h=d?c.startOffset:c.endOffset;return bo.from(g).map(eP.fromDom).map(function(a){return!e||!c.collapsed?gh(a,f(a,h)).getOr(a):a}).bind(function(a){return ff(a)?bo.some(a):ga(a)}).map(function(a){return a.dom()}).getOr(b)};var Et=function(c,d,e){return Es(c,d,true,e,function(a,b){return Math.min(gk(a),b)})};var Eu=function(c,d,e){return Es(c,d,false,e,function(a,b){return b>0?b-1:b})};var Ev=function(a,b){var c=a;while(a&&hq.isText(a)&&a.length===0){a=b?a.nextSibling:a.previousSibling}return a||c};var Ew=function(a,b){var c,startContainer,endContainer,startOffset,endOffset;if(!b){return a}startContainer=b.startContainer;endContainer=b.endContainer;startOffset=b.startOffset;endOffset=b.endOffset;c=b.commonAncestorContainer;if(!b.collapsed){if(startContainer===endContainer){if(endOffset-startOffset<2){if(startContainer.hasChildNodes()){c=startContainer.childNodes[startOffset]}}}if(startContainer.nodeType===3&&endContainer.nodeType===3){if(startContainer.length===startOffset){startContainer=Ev(startContainer.nextSibling,true)}else{startContainer=startContainer.parentNode}if(endOffset===0){endContainer=Ev(endContainer.previousSibling,false)}else{endContainer=endContainer.parentNode}if(startContainer&&startContainer===endContainer){return startContainer}}}if(c&&c.nodeType===3){return c.parentNode}return c};var Ex=function(a,b,c,d){var e,root;var f=[];root=a.getRoot();c=a.getParent(c||Et(root,b,b.collapsed),a.isBlock);d=a.getParent(d||Eu(root,b,b.collapsed),a.isBlock);if(c&&c!==root){f.push(c)}if(c&&d&&c!==d){e=c;var g=new TreeWalker(c,root);while((e=g.next())&&e!==d){if(a.isBlock(e)){f.push(e)}}}if(d&&c!==d&&d!==root){f.push(d)}return f};var Ey=function(d,e,f){return bo.from(e).map(function(a){var b=d.nodeIndex(a);var c=d.createRng();c.setStart(a.parentNode,b);c.setEnd(a.parentNode,b+1);if(f){yQ(d,c,a,true);yQ(d,c,a,false)}return c})};var Ez=dj.each;var EA=function(a){return!!a.select};var EB=function(a){return!!(a&&a.ownerDocument)&&fW(eP.fromDom(a.ownerDocument),eP.fromDom(a))};var EC=function(a){if(!a){return false}else if(EA(a)){return true}else{return EB(a.startContainer)&&EB(a.endContainer)}};var ED=function(j,k,l,m){var n,controlSelection;var o,explicitRange,selectorChangedData;var p=function(a,b){var c=j.createRng();if(!a){yQ(j,c,m.getBody(),true);C(c)}else{c.setStart(a,b);c.setEnd(a,b);C(c);z(false)}};var q=function(a){return Ep.getContent(m,a)};var s=function(a,b){return Er.setContent(m,a,b)};var t=function(a){return Et(m.getBody(),B(),a)};var u=function(a){return Eu(m.getBody(),B(),a)};var v=function(a,b){return n.getBookmark(a,b)};var w=function(a){return n.moveToBookmark(a)};var x=function(a,b){Ey(j,a,b).each(C);return a};var y=function(){var a=B(),sel=A();if(!a||a.item){return false}if(a.compareEndPoints){return a.compareEndPoints('StartToEnd',a)===0}return!sel||a.collapsed};var z=function(a){var b=B();b.collapse(!!a);C(b)};var A=function(){return k.getSelection?k.getSelection():k.document.selection};var B=function(){var d,rng,elm,dk;var e=function(a,b,c){try{return b.compareBoundaryPoints(a,c)}catch(ex){return-1}};if(!k){return null}dk=k.document;if(typeof dk==='undefined'||dk===null){return null}if(m.bookmark!==undefined&&xO.hasFocus(m)===false){var f=wP.getRng(m);if(f.isSome()){return f.map(function(r){return DH.processRanges(m,[r])[0]}).getOr(dk.createRange())}}try{if(d=A()){if(d.rangeCount>0){rng=d.getRangeAt(0)}else{rng=d.createRange?d.createRange():dk.createRange()}}}catch(ex){}rng=DH.processRanges(m,[rng])[0];if(!rng){rng=dk.createRange?dk.createRange():dk.body.createTextRange()}if(rng.setStart&&rng.startContainer.nodeType===9&&rng.collapsed){elm=j.getRoot();rng.setStart(elm,0);rng.setEnd(elm,0)}if(o&&explicitRange){if(e(rng.START_TO_START,rng,o)===0&&e(rng.END_TO_END,rng,o)===0){rng=explicitRange}else{o=null;explicitRange=null}}return rng};var C=function(a,b){var c,fH,evt;if(!EC(a)){return}var d=EA(a)?a:null;if(d){explicitRange=null;try{d.select()}catch(ex){}return}c=A();evt=m.fire('SetSelectionRange',{range:a,forward:b});a=evt.range;if(c){explicitRange=a;try{c.removeAllRanges();c.addRange(a)}catch(ex){}if(b===false&&c.extend){c.collapse(a.endContainer,a.endOffset);c.extend(a.startContainer,a.startOffset)}o=c.rangeCount>0?c.getRangeAt(0):null}if(!a.collapsed&&a.startContainer===a.endContainer&&c.setBaseAndExtent&&!co.ie){if(a.endOffset-a.startOffset<2){if(a.startContainer.hasChildNodes()){fH=a.startContainer.childNodes[a.startOffset];if(fH&&fH.tagName==='IMG'){c.setBaseAndExtent(a.startContainer,a.startOffset,a.endContainer,a.endOffset);if(c.anchorNode!==a.startContainer||c.focusNode!==a.endContainer){c.setBaseAndExtent(fH,0,fH,1)}}}}}m.fire('AfterSetSelectionRange',{range:a,forward:b})};var D=function(a){s(j.getOuterHTML(a));return a};var E=function(){return Ew(m.getBody(),B())};var F=function(a,b){return Ex(j,B(),a,b)};var G=function(){var a=A();var b,focusRange;if(!a||!a.anchorNode||!a.focusNode){return true}b=j.createRng();b.setStart(a.anchorNode,a.anchorOffset);b.collapse(true);focusRange=j.createRng();focusRange.setStart(a.focusNode,a.focusOffset);focusRange.collapse(true);return b.compareBoundaryPoints(b.START_TO_START,focusRange)<=0};var H=function(){var b=B();var c=A();if(!uz.hasMultipleRanges(c)&&yR(m)){var d=wf.normalize(j,b);d.each(function(a){C(a,G())});return d.getOr(b)}return b};var I=function(g,h){var i;if(!selectorChangedData){selectorChangedData={};i={};m.on('NodeChange',function(e){var f=e.element,gb=j.getParents(f,null,j.getRoot()),matchedSelectors={};Ez(selectorChangedData,function(c,d){Ez(gb,function(b){if(j.is(b,d)){if(!i[d]){Ez(c,function(a){a(true,{node:b,selector:d,parents:gb})});i[d]=c}matchedSelectors[d]=c;return false}})});Ez(i,function(b,c){if(!matchedSelectors[c]){delete i[c];Ez(b,function(a){a(false,{node:f,selector:c,parents:gb})})}})})}if(!selectorChangedData[g]){selectorChangedData[g]=[]}selectorChangedData[g].push(h);return O};var J=function(){var a;var b=j.getRoot();while(b&&b.nodeName!=='BODY'){if(b.scrollHeight>b.clientHeight){a=b;break}b=b.parentNode}return a};var K=function(a,b){return Dz.scrollElementIntoView(m,a,b)};var L=function(a,b){return C(DF.fromPoint(a,b,m.getDoc()))};var M=function(){var a=B();return a.collapsed?lr.fromRangeStart(a).getClientRects()[0]:a.getBoundingClientRect()};var N=function(){k=o=explicitRange=null;controlSelection.destroy()};var O={bookmarkManager:null,controlSelection:null,dom:j,win:k,serializer:l,editor:m,collapse:z,setCursorLocation:p,getContent:q,setContent:s,getBookmark:v,moveToBookmark:w,select:x,isCollapsed:y,isForward:G,setNode:D,getNode:E,getSel:A,setRng:C,getRng:B,getStart:t,getEnd:u,getSelectedBlocks:F,normalize:H,selectorChanged:I,getScrollContainer:J,scrollIntoView:K,placeCaretAt:L,getBoundingClientRect:M,destroy:N};n=Do(O);controlSelection=Ds(O,m);O.bookmarkManager=n;O.controlSelection=controlSelection;return O};var EE=hq.isContentEditableFalse;var EF=kO;var EG=mY;var EH=mX;var EI=function(a,b){while(b=a(b)){if(b.isVisible()){return b}}return b};var EJ=function(a,b){var c=mL(a,b);if(!c&&hq.isBr(a.getNode())){return true}return c};var EK=function(a,b,c,d){var e,caretPosition,peekCaretPosition,rangeIsInContainerBlock;var f=a===nh.Forwards;var g=f?EH:EG;if(!d.collapsed){e=EF(d);if(EE(e)){return zW(a,b,e,a===nh.Backwards,true)}}rangeIsInContainerBlock=kn(d);caretPosition=mW(a,b.getBody(),d);if(g(caretPosition)){return zY(b,caretPosition.getNode(!f))}caretPosition=c(caretPosition);if(!caretPosition){if(rangeIsInContainerBlock){return d}return null}if(g(caretPosition)){return zW(a,b,caretPosition.getNode(!f),f,true)}peekCaretPosition=c(caretPosition);if(g(peekCaretPosition)){if(EJ(caretPosition,peekCaretPosition)){return zW(a,b,peekCaretPosition.getNode(!f),f,true)}}if(rangeIsInContainerBlock){return Aa(b,caretPosition.toRange(),true)}return null};var EL=function(a,b,c,d){var e,linePositions,nextLinePositions;var f,caretClientRect,clientX;var g,dist2,contentEditableFalseNode;contentEditableFalseNode=EF(d);e=mW(a,b.getBody(),d);linePositions=c(b.getBody(),zF(1),e);nextLinePositions=bG(linePositions,zG(1));caretClientRect=cW.last(e.getClientRects());if(EH(e)||mZ(e)){contentEditableFalseNode=e.getNode()}if(EG(e)||na(e)){contentEditableFalseNode=e.getNode(true)}if(!caretClientRect){return null}clientX=caretClientRect.left;f=zM(nextLinePositions,clientX);if(f){if(EE(f.node)){g=Math.abs(clientX-f.left);dist2=Math.abs(clientX-f.right);return zW(a,b,f.node,g<dist2,true)}}if(contentEditableFalseNode){var h=zE(a,b.getBody(),zF(1),contentEditableFalseNode);f=zM(bG(h,zG(1)),clientX);if(f){return Aa(b,f.position.toRange(),true)}f=cW.last(bG(h,zG(0)));if(f){return Aa(b,f.position.toRange(),true)}}};var EM=function(a){var b=a.dom.create(a.settings.forced_root_block);if(!co.ie||co.ie>=11){b.innerHTML='<br data-mce-bogus="1">'}return b};var EN=function(a,b,c){var d,caretPos,newBlock;var e=nv(a.getBody());var f=curry(EI,e.next);var g=curry(EI,e.prev);if(c.collapsed&&a.settings.forced_root_block){d=a.dom.getParent(c.startContainer,'PRE');if(!d){return}if(b===1){caretPos=f(lr.fromRangeStart(c))}else{caretPos=g(lr.fromRangeStart(c))}if(!caretPos){newBlock=EM(a);if(b===1){a.$(d).after(newBlock)}else{a.$(d).before(newBlock)}a.selection.select(newBlock,true);a.selection.collapse()}}};var EO=function(a,b){var c=nv(a.getBody());var d=curry(EI,c.next);var e=curry(EI,c.prev);var f;var g=b?nh.Forwards:nh.Backwards;var h=b?d:e;var i=a.selection.getRng();f=EK(g,a,h,i);if(f){return f}f=EN(a,g,i);if(f){return f}return null};var EP=function(a,b){var c;var d=b?1:-1;var e=b?zD:zC;var f=a.selection.getRng();c=EL(d,a,e,f);if(c){return c}c=EN(a,d,f);if(c){return c}return null};var EQ=function(b,c){return function(){var a=EO(b,c);if(a){b.selection.setRng(a);return true}else{return false}}};var ER=function(b,c){return function(){var a=EP(b,c);if(a){b.selection.setRng(a);return true}else{return false}}};var ES;(function(a){a[a['Br']=0]='Br';a[a['Block']=1]='Block';a[a['Wrap']=2]='Wrap';a[a['Eol']=3]='Eol'}(ES||(ES={})));var ET=function(a,b){return a===nh.Backwards?b.reverse():b};var EU=function(a,b,c){return a===nh.Forwards?b.next(c):b.prev(c)};var EV=function(a,b,c,d){if(hq.isBr(d.getNode(b===nh.Forwards))){return ES.Br}else if(mL(c,d)===false){return ES.Block}else{return ES.Wrap}};var EW=function(a,b,c,d){var e=nv(c);var f=d,nextPos;var g=[];while(f){nextPos=EU(b,e,f);if(!nextPos){break}if(hq.isBr(nextPos.getNode(false))){if(b===nh.Forwards){return{positions:ET(b,g).concat([nextPos]),breakType:ES.Br,breakAt:bo.some(nextPos)}}else{return{positions:ET(b,g),breakType:ES.Br,breakAt:bo.some(nextPos)}}}if(!nextPos.isVisible()){f=nextPos;continue}if(a(f,nextPos)){var h=EV(c,b,f,nextPos);return{positions:ET(b,g),breakType:h,breakAt:bo.some(nextPos)}}g.push(nextPos);f=nextPos}return{positions:ET(b,g),breakType:ES.Eol,breakAt:bo.none()}};var EX=function(c,d,e,f){return d(e,f).breakAt.map(function(a){var b=d(e,a).positions;return c===nh.Backwards?b.concat(a):[a].concat(b)}).getOr([])};var EY=function(h,x){return bI(h,function(f,g){return f.fold(function(){return bo.some(g)},function(e){return kS([bV(e.getClientRects()),bV(g.getClientRects())],function(a,b){var c=Math.abs(x-a.left);var d=Math.abs(x-b.left);return d<=c?g:e}).or(f)})},bo.none())};var EZ=function(b,c){return bV(c.getClientRects()).bind(function(a){return EY(b,a.left)})};var Fa=curry(EW,CaretPosition.isAbove,-1);var Fb=curry(EW,CaretPosition.isBelow,1);var Fc=function(a,b){return Fa(a,b).breakAt.isNone()};var Fd=function(a,b){return Fb(a,b).breakAt.isNone()};var Fe=curry(EX,-1,Fa);var Ff=curry(EX,1,Fb);var Fg=function(b){return nI.firstPositionIn(b).map(function(a){return[a].concat(Fb(b,a).positions)}).getOr([])};var Fh=function(b){return nI.lastPositionIn(b).map(function(a){return Fa(b,a).positions.concat(a)}).getOr([])};var Fi=function(a,b){return{left:a.left-b,top:a.top-b,right:a.right+b*2,bottom:a.bottom+b*2,width:a.width+b,height:a.height+b}};var Fj=function(c,d){return bO(d,function(a){var b=Fi(kE(a.getBoundingClientRect()),-1);return[{x:b.left,y:c(b),cell:a},{x:b.right,y:c(b),cell:a}]})};var Fk=function(f,x,y){return bI(f,function(d,e){return d.fold(function(){return bo.some(e)},function(a){var b=Math.sqrt(Math.abs(a.x-x)+Math.abs(a.y-y));var c=Math.sqrt(Math.abs(e.x-x)+Math.abs(e.y-y));return bo.some(c<b?e:a)})},bo.none())};var Fl=function(b,c,d,x,y){var f=jv(eP.fromDom(d),'td,th,caption').map(function(e){return e.dom()});var g=bG(Fj(b,f),function(a){return c(a,y)});return Fk(g,x,y).map(function(a){return a.cell})};var Fm=function(a){return a.bottom};var Fn=function(a){return a.top};var Fo=function(a,y){return a.y<y};var Fp=function(a,y){return a.y>y};var Fq=curry(Fl,Fm,Fo);var Fr=curry(Fl,Fn,Fp);var Fs=function(b,c){return bV(c.getClientRects()).bind(function(a){return Fq(b,a.left,a.top)}).bind(function(a){return EZ(Fh(a),c)})};var Ft=function(b,c){return bW(c.getClientRects()).bind(function(a){return Fr(b,a.left,a.top)}).bind(function(a){return EZ(Fg(a),c)})};var Fu=function(a,b){a.selection.setRng(b);Dz.scrollRangeIntoView(a,b)};var Fv=function(b,c,d){return d.breakAt.map(function(a){return b(c,a).breakAt.isSome()}).getOr(false)};var Fw=function(a){return a.breakType===ES.Wrap&&a.positions.length===0};var Fx=function(a){return a.breakType===ES.Br&&a.positions.length===1};var Fy=function(a,b,c){var d=a(b,c);if(Fw(d)||!hq.isBr(c.getNode())&&Fx(d)){return!Fv(a,b,d)}else{return d.breakAt.isNone()}};var Fz=curry(Fy,Fa);var FA=curry(Fy,Fb);var FB=function(b,c,d){var e=lr.fromRangeStart(c);return nI.positionIn(!b,d).map(function(a){return a.isEqual(e)}).getOr(false)};var FC=function(a,b,c,d){var e=a.selection.getRng();var f=b?1:-1;if(mu()&&FB(b,e,c)){var g=zW(f,a,c,!b,true);Fu(a,g);return true}return false};var FD=function(b,c,d){return Fs(c,d).orThunk(function(){return bV(d.getClientRects()).bind(function(a){return EY(Fe(b,lr.before(c)),a.left)})}).getOr(lr.before(c))};var FE=function(b,c,d){return Ft(c,d).orThunk(function(){return bV(d.getClientRects()).bind(function(a){return EY(Ff(b,lr.after(c)),a.left)})}).getOr(lr.after(c))};var FF=function(a,b){var c=b.getNode(a);return hq.isElement(c)&&c.nodeName==='TABLE'?bo.some(c):bo.none()};var FG=function(c,d,e,f){var g=vB.getForcedRootBlock(d);if(g){d.undoManager.transact(function(){var a=eP.fromTag(g);ft(a,vB.getForcedRootBlockAttrs(d));iZ(a,eP.fromTag('br'));if(c){iX(eP.fromDom(e),a)}else{iW(eP.fromDom(e),a)}var b=d.dom.createRng();b.setStart(a.dom(),0);b.setEnd(a.dom(),0);Fu(d,b)})}else{Fu(d,f.toRange())}};var FH=function(c,d,e){var f=d?FF(true,e):FF(false,e);var g=d===false;f.fold(function(){return Fu(c,e.toRange())},function(b){return nI.positionIn(g,c.getBody()).filter(function(a){return a.isEqual(e)}).fold(function(){return Fu(c,e.toRange())},function(_){return FG(d,c,b,e)})})};var FI=function(a,b,c,d){var e=a.selection.getRng();var f=lr.fromRangeStart(e);var g=a.getBody();if(!b&&Fz(d,f)){var h=FD(g,c,f);FH(a,b,h);return true}else if(b&&FA(d,f)){var h=FE(g,c,f);FH(a,b,h);return true}else{return false}};var FJ=function(c,d){return function(){return bo.from(c.dom.getParent(c.selection.getNode(),'td,th')).bind(function(b){return bo.from(c.dom.getParent(b,'table')).map(function(a){return FC(c,d,a,b)})}).getOr(false)}};var FK=function(c,d){return function(){return bo.from(c.dom.getParent(c.selection.getNode(),'td,th')).bind(function(b){return bo.from(c.dom.getParent(b,'table')).map(function(a){return FI(c,d,a,b)})}).getOr(false)}};var FL=function(a){return bA(['figcaption'],fc(a))};var FM=function(a){var b=document.createRange();b.setStartBefore(a.dom());b.setEndBefore(a.dom());return b};var FN=function(a,b,c){if(c){iZ(a,b)}else{iY(a,b)}};var FO=function(a,b){var c=eP.fromTag('br');FN(a,c,b);return FM(c)};var FP=function(a,b,c,d){var e=eP.fromTag(c);var f=eP.fromTag('br');ft(e,d);iZ(e,f);FN(a,e,b);return FM(f)};var FQ=function(a,b,c,d){if(b===''){return FO(a,d)}else{return FP(a,d,b,c)}};var FR=function(a,b){var c=curry(fS,b);return jx(eP.fromDom(a.container()),gO,c).filter(FL)};var FS=function(a,b,c){return b?Fd(a.dom(),c):Fc(a.dom(),c)};var FT=function(b,c){var d=eP.fromDom(b.getBody());var e=lr.fromRangeStart(b.selection.getRng());var f=vB.getForcedRootBlock(b);var g=vB.getForcedRootBlockAttrs(b);return FR(e,d).exists(function(){if(FS(d,c,e)){var a=FQ(d,f,g,c);b.selection.setRng(a);return true}else{return false}})};var FU=function(a,b){return function(){if(a.selection.isCollapsed()){return FT(a,b)}else{return false}}};var FV=function(b){return bC(b,function(a){return CI({shiftKey:false,altKey:false,ctrlKey:false,metaKey:false,keyCode:0,action:ba},a)})};var FW=function(a,b){return b.keyCode===a.keyCode&&b.shiftKey===a.shiftKey&&b.altKey===a.altKey&&b.ctrlKey===a.ctrlKey&&b.metaKey===a.metaKey};var FX=function(b,c){return bO(FV(b),function(a){return FW(a,c)?[a]:[]})};var FY=function(f){var x=[];for(var a=1;a<arguments.length;a++){x[a-1]=arguments[a]}var b=Array.prototype.slice.call(arguments,1);return function(){return f.apply(null,b)}};var FZ=function(b,c){return bJ(FX(b,c),function(a){return a.action()})};var Ga={match:FX,action:FY,execute:FZ};var Gb=function(a,b,c){var d=eJ.detect().os;Ga.execute([{keyCode:Ad.RIGHT,action:EQ(a,true)},{keyCode:Ad.LEFT,action:EQ(a,false)},{keyCode:Ad.UP,action:ER(a,false)},{keyCode:Ad.DOWN,action:ER(a,true)},{keyCode:Ad.RIGHT,action:FJ(a,true)},{keyCode:Ad.LEFT,action:FJ(a,false)},{keyCode:Ad.UP,action:FK(a,false)},{keyCode:Ad.DOWN,action:FK(a,true)},{keyCode:Ad.RIGHT,action:tQ.move(a,b,true)},{keyCode:Ad.LEFT,action:tQ.move(a,b,false)},{keyCode:Ad.RIGHT,ctrlKey:!d.isOSX(),altKey:d.isOSX(),action:tQ.moveNextWord(a,b)},{keyCode:Ad.LEFT,ctrlKey:!d.isOSX(),altKey:d.isOSX(),action:tQ.movePrevWord(a,b)},{keyCode:Ad.UP,action:FU(a,false)},{keyCode:Ad.DOWN,action:FU(a,true)}],c).each(function(_){c.preventDefault()})};var Gc=function(b,c){b.on('keydown',function(a){if(a.isDefaultPrevented()===false){Gb(b,c,a)}})};var Gd={setup:Gc};var Ge=function(b,c){var d=rn.parentsAndSelf(c,b);return bK(d,gO).fold(bc(d),function(a){return d.slice(0,a)})};var Gf=function(a){return gg(a).length===1};var Gg=function(b,c,d,e){var f=curry(Bu,c);var g=bC(bG(e,f),function(a){return a.dom()});if(g.length===0){sD.deleteElement(c,b,d)}else{var h=Bt(d.dom(),g);c.selection.setRng(h.toRange())}};var Gh=function(c,d){var e=eP.fromDom(c.getBody());var f=eP.fromDom(c.selection.getStart());var g=bG(Ge(e,f),Gf);return bW(g).map(function(a){var b=lr.fromRangeStart(c.selection.getRng());if(a.dom().getAttribute('data-control')==='input')return false;if(qM.willDeleteLastPositionInElement(d,b,a.dom())&&!Bv(a)){Gg(d,c,a,g);return true}else{return false}}).getOr(false)};var Gi=function(a,b){return a.selection.isCollapsed()?Gh(a,b):false};var Gj={backspaceDelete:Gi};var Gk=function(a,b,c){Ga.execute([{keyCode:Ad.BACKSPACE,action:Ga.action(sN.backspaceDelete,a,false)},{keyCode:Ad.DELETE,action:Ga.action(sN.backspaceDelete,a,true)},{keyCode:Ad.BACKSPACE,action:Ga.action(tZ.backspaceDelete,a,b,false)},{keyCode:Ad.DELETE,action:Ga.action(tZ.backspaceDelete,a,b,true)},{keyCode:Ad.BACKSPACE,action:Ga.action(uX.backspaceDelete,a,false)},{keyCode:Ad.DELETE,action:Ga.action(uX.backspaceDelete,a,true)},{keyCode:Ad.BACKSPACE,action:Ga.action(rJ.backspaceDelete,a,false)},{keyCode:Ad.DELETE,action:Ga.action(rJ.backspaceDelete,a,true)},{keyCode:Ad.BACKSPACE,action:Ga.action(rB.backspaceDelete,a,false)},{keyCode:Ad.DELETE,action:Ga.action(rB.backspaceDelete,a,true)},{keyCode:Ad.BACKSPACE,action:Ga.action(Gj.backspaceDelete,a,false)},{keyCode:Ad.DELETE,action:Ga.action(Gj.backspaceDelete,a,true)}],c).each(function(_){c.preventDefault()})};var Gl=function(a,b){Ga.execute([{keyCode:Ad.BACKSPACE,action:Ga.action(sN.paddEmptyElement,a)},{keyCode:Ad.DELETE,action:Ga.action(sN.paddEmptyElement,a)}],b)};var Gm=function(b,c){b.on('keydown',function(a){if(a.isDefaultPrevented()===false){Gk(b,c,a)}});b.on('keyup',function(a){if(a.isDefaultPrevented()===false){Gl(b,a)}})};var Gn={setup:Gm};var Go=function(a){while(a){if(a.nodeType===1||a.nodeType===3&&a.data&&/[\r\n\s]/.test(a.data)){return a}a=a.nextSibling}};var Gp=function(a,b){var c,fH,rng,lastNode=b,tempElm;var d=a.dom;var e=a.schema.getMoveCaretBeforeOnEnterElements();if(!b){return}if(/^(LI|DT|DD)$/.test(b.nodeName)){var f=Go(b.firstChild);if(f&&/^(UL|OL|DL)$/.test(f.nodeName)){b.insertBefore(d.doc.createTextNode('\xA0'),b.firstChild)}}rng=d.createRng();b.normalize();if(b.hasChildNodes()){c=new TreeWalker(b,b);while(fH=c.current()){if(hq.isText(fH)){rng.setStart(fH,0);rng.setEnd(fH,0);break}if(e[fH.nodeName.toLowerCase()]){rng.setStartBefore(fH);rng.setEndBefore(fH);break}lastNode=fH;fH=c.next()}if(!fH){rng.setStart(lastNode,0);rng.setEnd(lastNode,0)}}else{if(hq.isBr(b)){if(b.nextSibling&&d.isBlock(b.nextSibling)){rng.setStartBefore(b);rng.setEndBefore(b)}else{rng.setStartAfter(b);rng.setEndAfter(b)}}else{rng.setStart(b,0);rng.setEnd(b,0)}}a.selection.setRng(rng);d.remove(tempElm);a.selection.scrollIntoView(b)};var Gq=function(a,b){var c=a.getRoot();var d,editableRoot;d=b;while(d!==c&&a.getContentEditable(d)!=='false'){if(a.getContentEditable(d)==='true'){editableRoot=d}d=d.parentNode}return d!==c?editableRoot:c};var Gr=function(a){return bo.from(a.dom.getParent(a.selection.getStart(true),a.dom.isBlock))};var Gs=function(b){return Gr(b).fold(bc(''),function(a){return a.nodeName.toUpperCase()})};var Gt=function(b){return Gr(b).filter(function(a){return gT(eP.fromDom(a))}).isSome()};var Gu={moveToCaretPosition:Gp,getEditableRoot:Gq,getParentBlock:Gr,getParentBlockName:Gs,isListItemParentBlock:Gt};var Gv=function(a,b){return a.firstChild&&a.firstChild.nodeName===b};var Gw=function(a,b){return a&&a.parentNode&&a.parentNode.nodeName===b};var Gx=function(a){return a&&/^(OL|UL|LI)$/.test(a.nodeName)};var Gy=function(a){return Gx(a)&&Gx(a.parentNode)};var Gz=function(a){var b=a.parentNode;if(/^(LI|DT|DD)$/.test(b.nodeName)){return b}return a};var GA=function(a,b,c){var d=a[c?'firstChild':'lastChild'];while(d){if(hq.isElement(d)){break}d=d[c?'nextSibling':'previousSibling']}return d===b};var GB=function(a,b,c,d,e){var f=a.dom;var g=a.selection.getRng();if(c===a.getBody()){return}if(Gy(c)){e='LI'}var h=e?b(e):f.create('BR');if(GA(c,d,true)&&GA(c,d,false)){if(Gw(c,'LI')){f.insertAfter(h,Gz(c))}else{f.replace(h,c)}}else if(GA(c,d,true)){if(Gw(c,'LI')){f.insertAfter(h,Gz(c));h.appendChild(f.doc.createTextNode(' '));h.appendChild(c)}else{c.parentNode.insertBefore(h,c)}}else if(GA(c,d,false)){f.insertAfter(h,Gz(c))}else{c=Gz(c);var i=g.cloneRange();i.setStartAfter(d);i.setEndAfter(c);var j=i.extractContents();if(e==='LI'&&Gv(j,'LI')){h=j.firstChild;f.insertAfter(j,c)}else{f.insertAfter(j,c);f.insertAfter(h,c)}}f.remove(d);Gu.moveToCaretPosition(a,h)};var GC={insert:GB};var GD=function(c){bD(ju(eP.fromDom(c),fg),function(a){var b=a.dom();b.nodeValue=jX.trim(b.nodeValue)})};var GE=function(a,b){return b&&b.nodeName==='A'&&a.isEmpty(b)};var GF=function(a){return a&&/^(TD|TH|CAPTION)$/.test(a.nodeName)};var GG=function(a){a.innerHTML='<br data-mce-bogus="1">'};var GH=function(a,b){return a.nodeName===b||a.previousSibling&&a.previousSibling.nodeName===b};var GI=function(a,b){return b&&a.isBlock(b)&&!/^(TD|TH|CAPTION|FORM)$/.test(b.nodeName)&&!/^(fixed|absolute)/i.test(b.style.position)&&a.getContentEditable(b)!=='true'};var GJ=function(a,b,c){var d=c;var e=[];var i;if(!d){return}while(d=d.firstChild){if(a.isBlock(d)){return}if(hq.isElement(d)&&!b[d.nodeName.toLowerCase()]){e.push(d)}}i=e.length;while(i--){d=e[i];if(!d.hasChildNodes()||d.firstChild===d.lastChild&&d.firstChild.nodeValue===''){a.remove(d)}else{if(GE(a,d)){a.remove(d)}}}};var GK=function(a,b,c){if(hq.isText(b)===false){return c}else if(a){return c===1&&b.data.charAt(c-1)===jX.ZWSP?0:c}else{return c===b.data.length-1&&b.data.charAt(c)===jX.ZWSP?b.data.length:c}};var GL=function(a){var b=a.cloneRange();b.setStart(a.startContainer,GK(true,a.startContainer,a.startOffset));b.setEnd(a.endContainer,GK(false,a.endContainer,a.endOffset));return b};var GM=function(a){do{if(hq.isText(a)){a.nodeValue=a.nodeValue.replace(/^[\r\n]+/,'')}a=a.firstChild}while(a)};var GN=function(a,b){var c=a.getRoot();var d,editableRoot;d=b;while(d!==c&&a.getContentEditable(d)!=='false'){if(a.getContentEditable(d)==='true'){editableRoot=d}d=d.parentNode}return d!==c?editableRoot:c};var GO=function(a,b){var c=vB.getForcedRootBlock(a);if(c&&c.toLowerCase()===b.tagName.toLowerCase()){a.dom.setAttribs(b,vB.getForcedRootBlockAttrs(a))}};var GP=function(a,b,c,d,e){var f,parentBlock,startNode,fH,next,rootBlockName;var g=b||'P';var h=a.dom,editableRoot=GN(h,d);parentBlock=h.getParent(d,h.isBlock);if(!parentBlock||!GI(h,parentBlock)){parentBlock=parentBlock||editableRoot;if(parentBlock===a.getBody()||GF(parentBlock)){rootBlockName=parentBlock.nodeName.toLowerCase()}else{rootBlockName=parentBlock.parentNode.nodeName.toLowerCase()}if(!parentBlock.hasChildNodes()){f=h.create(g);GO(a,f);parentBlock.appendChild(f);c.setStart(f,0);c.setEnd(f,0);return f}fH=d;while(fH.parentNode!==parentBlock){fH=fH.parentNode}while(fH&&!h.isBlock(fH)){startNode=fH;fH=fH.previousSibling}if(startNode&&a.schema.isValidChild(rootBlockName,g.toLowerCase())){f=h.create(g);GO(a,f);startNode.parentNode.insertBefore(f,startNode);fH=startNode;while(fH&&!h.isBlock(fH)){next=fH.nextSibling;f.appendChild(fH);fH=next}c.setStart(d,e);c.setEnd(d,e)}}return d};var GQ=function(a,b){var c;b.normalize();c=b.lastChild;if(!c||/^(left|right)$/gi.test(a.getStyle(c,'float',true))){a.add(b,'br')}};var GR=function(d,e){var f,editableRoot,container,offset,parentBlock,shiftKey;var g,fragment,containerBlock,parentBlockName,containerBlockName,newBlockName,isAfterLastNodeInContainer;var h=d.dom;var i=d.schema,nonEmptyElementsMap=i.getNonEmptyElements();var j=d.selection.getRng();var k=function(a){var b=container,block,clonedNode,caretNode;var c=i.getTextInlineElements();if(a||parentBlockName==='TABLE'||parentBlockName==='HR'){block=h.create(a||newBlockName);GO(d,block)}else{block=parentBlock.cloneNode(false)}caretNode=block;if(vB.shouldKeepStyles(d)===false){h.setAttrib(block,'style',null);h.setAttrib(block,'class',null)}else{do{if(c[b.nodeName]){if(lY(b)){continue}clonedNode=b.cloneNode(false);h.setAttrib(clonedNode,'id','');if(block.hasChildNodes()){clonedNode.appendChild(block.firstChild);block.appendChild(clonedNode)}else{caretNode=clonedNode;block.appendChild(clonedNode)}}}while((b=b.parentNode)&&b!==editableRoot)}GG(caretNode);return block};var l=function(a){var b,fH,name$1,normalizedOffset;normalizedOffset=GK(a,container,offset);if(hq.isText(container)&&(a?normalizedOffset>0:normalizedOffset<container.nodeValue.length)){return false}if(container.parentNode===parentBlock&&isAfterLastNodeInContainer&&!a){return true}if(a&&hq.isElement(container)&&container===parentBlock.firstChild){return true}if(GH(container,'TABLE')||GH(container,'HR')){return isAfterLastNodeInContainer&&!a||!isAfterLastNodeInContainer&&a}b=new TreeWalker(container,parentBlock);if(hq.isText(container)){if(a&&normalizedOffset===0){b.prev()}else if(!a&&normalizedOffset===container.nodeValue.length){b.next()}}while(fH=b.current()){if(hq.isElement(fH)){if(!fH.getAttribute('data-mce-bogus')){name$1=fH.nodeName.toLowerCase();if(nonEmptyElementsMap[name$1]&&name$1!=='br'){return false}}}else if(hq.isText(fH)&&!/^[ \t\r\n]*$/.test(fH.nodeValue)){return false}if(a){b.prev()}else{b.next()}}return true};var m=function(){if(/^(H[1-6]|PRE|FIGURE)$/.test(parentBlockName)&&containerBlockName!=='HGROUP'){g=k(newBlockName)}else{g=k()}if(vB.shouldEndContainerOnEmptyBlock(d)&&GI(h,containerBlock)&&h.isEmpty(parentBlock)){g=h.split(containerBlock,parentBlock)}else{h.insertAfter(g,parentBlock)}Gu.moveToCaretPosition(d,g)};wf.normalize(h,j).each(function(a){j.setStart(a.startContainer,a.startOffset);j.setEnd(a.endContainer,a.endOffset)});container=j.startContainer;offset=j.startOffset;newBlockName=vB.getForcedRootBlock(d);shiftKey=e.shiftKey;if(hq.isElement(container)&&container.hasChildNodes()){isAfterLastNodeInContainer=offset>container.childNodes.length-1;container=container.childNodes[Math.min(offset,container.childNodes.length-1)]||container;if(isAfterLastNodeInContainer&&hq.isText(container)){offset=container.nodeValue.length}else{offset=0}}editableRoot=GN(h,container);if(!editableRoot){return}if(newBlockName&&!shiftKey||!newBlockName&&shiftKey){container=GP(d,newBlockName,j,container,offset)}parentBlock=h.getParent(container,h.isBlock);containerBlock=parentBlock?h.getParent(parentBlock.parentNode,h.isBlock):null;parentBlockName=parentBlock?parentBlock.nodeName.toUpperCase():'';containerBlockName=containerBlock?containerBlock.nodeName.toUpperCase():'';if(containerBlockName==='LI'&&!e.ctrlKey){parentBlock=containerBlock;containerBlock=containerBlock.parentNode;parentBlockName=containerBlockName}if(/^(LI|DT|DD)$/.test(parentBlockName)){if(h.isEmpty(parentBlock)){GC.insert(d,k,containerBlock,parentBlock,newBlockName);return}}if(newBlockName&&parentBlock===d.getBody()){return}newBlockName=newBlockName||'P';if(ka(parentBlock)){g=km(parentBlock);if(h.isEmpty(parentBlock)){GG(parentBlock)}Gu.moveToCaretPosition(d,g)}else if(l()){m()}else if(l(true)){g=parentBlock.parentNode.insertBefore(k(),parentBlock);Gu.moveToCaretPosition(d,GH(parentBlock,'HR')?g:parentBlock)}else{f=GL(j).cloneRange();f.setEndAfter(parentBlock);fragment=f.extractContents();GD(fragment);GM(fragment);g=fragment.firstChild;h.insertAfter(fragment,parentBlock);GJ(h,nonEmptyElementsMap,g);GQ(h,parentBlock);if(h.isEmpty(parentBlock)){GG(parentBlock)}g.normalize();if(h.isEmpty(g)){h.remove(g);m()}else{Gu.moveToCaretPosition(d,g)}}h.setAttrib(g,'id','');d.fire('NewBlock',{newBlock:g})};var GS={insert:GR};var GT=function(b,c){return Gu.getParentBlock(b).filter(function(a){return c.length>0&&fO(eP.fromDom(a),c)}).isSome()};var GU=function(a){return GT(a,vB.getBrNewLineSelector(a))};var GV=function(a){return GT(a,vB.getNoNewLineSelector(a))};var GW={shouldInsertBr:GU,shouldBlockNewLine:GV};var GX=rL.generate([{br:[]},{block:[]},{none:[]}]);var GY=function(a,b){return GW.shouldBlockNewLine(a)};var GZ=function(d){return function(a,b){var c=vB.getForcedRootBlock(a)==='';return c===d}};var Ha=function(c){return function(a,b){return Gu.isListItemParentBlock(a)===c}};var Hb=function(d,e){return function(a,b){var c=Gu.getParentBlockName(a)===d.toUpperCase();return c===e}};var Hc=function(a){return Hb('pre',a)};var Hd=function(){return Hb('summary',true)};var He=function(c){return function(a,b){return vB.shouldPutBrInPre(a)===c}};var Hf=function(a,b){return GW.shouldInsertBr(a)};var Hg=function(a,b){return b};var Hh=function(a){var b=vB.getForcedRootBlock(a);var c=Gu.getEditableRoot(a.dom,a.selection.getStart());return c&&a.schema.isValidChild(c.nodeName,b?b:'P')};var Hi=function(e,f){return function(b,c){var d=bI(e,function(a,p){return a&&p(b,c)},true);return d?bo.some(f):bo.none()}};var Hj=function(a,b){return tc.evaluateUntil([Hi([GY],GX.none()),Hi([Hd()],GX.br()),Hi([Hc(true),He(false),Hg],GX.br()),Hi([Hc(true),He(false)],GX.block()),Hi([Hc(true),He(true),Hg],GX.block()),Hi([Hc(true),He(true)],GX.br()),Hi([Ha(true),Hg],GX.br()),Hi([Ha(true)],GX.block()),Hi([GZ(true),Hg,Hh],GX.block()),Hi([GZ(true)],GX.br()),Hi([Hf],GX.br()),Hi([GZ(false),Hg],GX.br()),Hi([Hh],GX.block())],[a,b.shiftKey]).getOr(GX.none())};var Hk={getAction:Hj};var Hl=function(a,b){Hk.getAction(a,b).fold(function(){wt.insert(a,b)},function(){GS.insert(a,b)},ba)};var Hm={insert:Hl};var Hn=function(a){if(a.typing){a.typing=false;a.add()}};var Ho=function(a,b){if(b.isDefaultPrevented()){return}b.preventDefault();Hn(a.undoManager);a.undoManager.transact(function(){if(a.selection.isCollapsed()===false){a.execCommand('Delete')}Hm.insert(a,b)})};var Hp=function(b){b.on('keydown',function(a){if(a.keyCode===Ad.ENTER){Ho(b,a)}})};var Hq={setup:Hp};var Hr=function(c,d){var e=d.container();var f=d.offset();if(hq.isText(e)){e.insertData(f,c);return bo.some(CaretPosition(e,f+c.length))}else{return nf(d).map(function(a){var b=eP.fromText(c);if(d.isAtEnd()){iX(a,b)}else{iW(a,b)}return CaretPosition(b.dom(),c.length)})}};var Hs=curry(Hr,'\xA0');var Ht=curry(Hr,' ');var Hu=function(b,c,d){var e=bG(rn.parentsAndSelf(eP.fromDom(d.container()),c),gO);return bV(e).fold(function(){return nI.navigate(b,c.dom(),d).forall(function(a){return mL(a,d,c.dom())===false})},function(a){return nI.navigate(b,a.dom(),d).isNone()})};var Hv=curry(Hu,false);var Hw=curry(Hu,true);var Hx='\xA0';var Hy=function(a){return CaretPosition.isTextPosition(a)&&!a.isAtStart()&&!a.isAtEnd()};var Hz=function(a,b){var c=bG(rn.parentsAndSelf(eP.fromDom(b.container()),a),gO);return bV(c).getOr(a)};var HA=function(a,b){if(Hy(b)){return ne(b)}else{return ne(b)||nI.prevPosition(Hz(a,b).dom(),b).exists(ne)}};var HB=function(a,b){if(Hy(b)){return nd(b)}else{return nd(b)||nI.nextPosition(Hz(a,b).dom(),b).exists(nd)}};var HC=function(a){return bA(['pre','pre-line','pre-wrap'],a)};var HD=function(b){return nf(b).bind(function(a){return jx(a,ff)}).exists(function(a){return HC(fB(a,'white-space'))})};var HE=function(a,b){return nI.prevPosition(a.dom(),b).isNone()};var HF=function(a,b){return nI.nextPosition(a.dom(),b).isNone()};var HG=function(a,b){return HE(a,b)||HF(a,b)||Hv(a,b)||Hw(a,b)||rP(a,b)||rO(a,b)};var HH=function(a,b){if(HD(b)){return false}else{return HG(a,b)||HA(a,b)||HB(a,b)}};var HI=function(a,b){if(HD(b)){return false}else{return Hv(a,b)||rP(a,b)||HA(a,b)}};var HJ=function(a,b){if(HD(b)){return false}else{return Hw(a,b)||rO(a,b)||HB(a,b)}};var HK=function(a,b){return mx(a.charAt(b))};var HL=function(a){var b=a.container();return hq.isText(b)&&ev(b.data,Hx)};var HM=function(a,b,c){var d=CaretPosition(b,0);if(HK(c,0)&&!HI(a,d)){return' '+c.slice(1)}else{return c}};var HN=function(c){return bC(c.split(''),function(a,i,b){if(mx(a)&&i>0&&i<b.length-1&&mz(b[i-1])&&mz(b[i+1])){return' '}else{return a}}).join('')};var HO=function(a,b,c){var d=CaretPosition(b,c.length);if(HK(c,c.length-1)&&!HJ(a,d)){return c.slice(0,-1)+' '}else{return c}};var HP=function(e,f){return bo.some(f).filter(HL).bind(function(a){var b=a.container();var c=b.nodeValue;var d=HM(e,b,HN(HO(e,b,c)));if(c!==d){a.container().nodeValue=d;return bo.some(a)}else{return bo.none()}})};var HQ=function(b){var c=eP.fromDom(b.getBody());if(b.selection.isCollapsed()){HP(c,CaretPosition.fromRangeStart(b.selection.getRng())).each(function(a){b.selection.setRng(a.toRange())})}};var HR=function(c){return function(b){return b.fold(function(a){return nI.prevPosition(c.dom(),lr.before(a))},function(a){return nI.firstPositionIn(a)},function(a){return nI.lastPositionIn(a)},function(a){return nI.nextPosition(c.dom(),lr.after(a))})}};var HS=function(b,c){return function(a){return HH(b,a)?Hs(c):Ht(c)}};var HT=function(b){return function(a){b.selection.setRng(a.toRange());b.nodeChanged();return true}};var HU=function(a){var b=lr.fromRangeStart(a.selection.getRng());var c=eP.fromDom(a.getBody());if(a.selection.isCollapsed()){var d=curry(qG.isInlineTarget,a);var e=lr.fromRangeStart(a.selection.getRng());return ty.readLocation(d,a.getBody(),e).bind(HR(c)).bind(HS(c,b)).exists(HT(a))}else{return false}};var HV=function(a,b){Ga.execute([{keyCode:Ad.SPACEBAR,action:Ga.action(HU,a)}],b).each(function(_){b.preventDefault()})};var HW=function(b){b.on('keydown',function(a){if(a.isDefaultPrevented()===false){HV(b,a)}})};var HX={setup:HW};var HY=function(b){return jz(eP.fromDom(b.getBody()),'*[data-mce-caret]').fold(bc(null),function(a){return a.dom()})};var HZ=function(a){a.selection.setRng(a.selection.getRng())};var Ia=function(a,b){if(b.hasAttribute('data-mce-caret')){km(b);HZ(a);a.selection.scrollIntoView(b)}};var Ib=function(a,e){var b=HY(a);if(!b){return}if(e.type==='compositionstart'){e.preventDefault();e.stopPropagation();Ia(a,b);return}if(kd(b)){Ia(a,b);a.undoManager.add()}};var Ic=function(a){a.on('keyup compositionstart',curry(Ib,a))};var Id={setup:Ic};var Ie=eJ.detect().browser;var If=function(a){var b=jg(function(){if(!a.composing){HQ(a)}},0);if(Ie.isIE()){a.on('keypress',function(e){b.throttle()});a.on('remove',function(e){b.cancel()})}};var Ig=function(a){If(a);a.on('input',function(e){if(e.isComposing===false){HQ(a)}})};var Ih=function(a){var b=tQ.setupSelectedState(a);Id.setup(a);Gd.setup(a,b);Gn.setup(a,b);Hq.setup(a);HX.setup(a);Ig(a)};var Ii={setup:Ih};function Quirks(h){var j=dj.each;var k=Ad.BACKSPACE,DELETE=Ad.DELETE,Cu=h.dom,selection=h.selection,settings=h.settings,parser=h.parser;var l=co.gecko,hT=co.ie,isWebKit=co.webkit;var m='data:text/mce-internal,';var n=hT?'Text':'URL';var o=function(a,b){try{h.getDoc().execCommand(a,false,b)}catch(ex){}};var p=function(e){return e.isDefaultPrevented()};var q=function(e){var a,internalContent;if(e.dataTransfer){if(h.selection.isCollapsed()&&e.target.tagName==='IMG'){selection.select(e.target)}a=h.selection.getContent();if(a.length>0){internalContent=m+escape(h.id)+','+escape(a);e.dataTransfer.setData(n,internalContent)}}};var r=function(e){var a;if(e.dataTransfer){a=e.dataTransfer.getData(n);if(a&&a.indexOf(m)>=0){a=a.substr(m.length).split(',');return{id:unescape(a[0]),html:unescape(a[1])}}}return null};var s=function(a,b){if(h.queryCommandSupported('mceInsertClipboardContent')){h.execCommand('mceInsertClipboardContent',false,{content:a,internal:b})}else{h.execCommand('mceInsertContent',false,a)}};var t=function(){var f=function(a){var b=Cu.create('body');var c=a.cloneContents();b.appendChild(c);return selection.serializer.serialize(b,{format:'html'})};var g=function(a){var b=f(a);var c=Cu.createRng();c.selectNode(h.getBody());var d=f(c);return b===d};h.on('keydown',function(e){var a=e.keyCode;var b,body;if(!p(e)&&(a===DELETE||a===k)){b=h.selection.isCollapsed();body=h.getBody();if(b&&!Cu.isEmpty(body)){return}if(!b&&!g(h.selection.getRng())){return}e.preventDefault();h.setContent('');if(body.firstChild&&Cu.isBlock(body.firstChild)){h.selection.setCursorLocation(body.firstChild,0)}else{h.selection.setCursorLocation(body,0)}h.nodeChanged()}})};var u=function(){h.shortcuts.add('meta+a',null,'SelectAll')};var v=function(){if(!h.settings.content_editable){Cu.bind(h.getDoc(),'mousedown mouseup',function(e){var a;if(e.target===h.getDoc().documentElement){a=selection.getRng();h.getBody().focus();if(e.type==='mousedown'){if(kc(a.startContainer)){return}selection.placeCaretAt(e.clientX,e.clientY)}else{selection.setRng(a)}}})}};var w=function(){h.on('keydown',function(e){if(!p(e)&&e.keyCode===k){if(!h.getBody().getElementsByTagName('hr').length){return}if(selection.isCollapsed()&&selection.getRng().startOffset===0){var a=selection.getNode();var b=a.previousSibling;if(a.nodeName==='HR'){Cu.remove(a);e.preventDefault();return}if(b&&b.nodeName&&b.nodeName.toLowerCase()==='hr'){Cu.remove(b);e.preventDefault()}}}})};var x=function(){if(!Range.prototype.getClientRects){h.on('mousedown',function(e){if(!p(e)&&e.target.nodeName==='HTML'){var a=h.getBody();a.blur();cy.setEditorTimeout(h,function(){a.focus()})}})}};var y=function(){h.on('click',function(e){var a=e.target;if(/^(IMG|HR)$/.test(a.nodeName)&&Cu.getContentEditableParent(a)!=='false'){e.preventDefault();h.selection.select(a);h.nodeChanged()}if(a.nodeName==='A'&&Cu.hasClass(a,'mce-item-anchor')){e.preventDefault();selection.select(a)}})};var z=function(){var d=function(){var c=Cu.getAttribs(selection.getStart().cloneNode(false));return function(){var b=selection.getStart();if(b!==h.getBody()){Cu.setAttrib(b,'style',null);j(c,function(a){b.setAttributeNode(a.cloneNode(true))})}}};var f=function(){return!selection.isCollapsed()&&Cu.getParent(selection.getStart(),Cu.isBlock)!==Cu.getParent(selection.getEnd(),Cu.isBlock)};h.on('keypress',function(e){var a;if(!p(e)&&(e.keyCode===8||e.keyCode===46)&&f()){a=d();h.getDoc().execCommand('delete',false,null);a();e.preventDefault();return false}});Cu.bind(h.getDoc(),'cut',function(e){var a;if(!p(e)&&f()){a=d();cy.setEditorTimeout(h,function(){a()})}})};var A=function(){h.on('keydown',function(e){if(!p(e)&&e.keyCode===k){if(selection.isCollapsed()&&selection.getRng().startOffset===0){var a=selection.getNode().previousSibling;if(a&&a.nodeName&&a.nodeName.toLowerCase()==='table'){e.preventDefault();return false}}}})};var B=function(){h.on('keydown',function(e){var a,container,offset,root,parent$1;if(p(e)||e.keyCode!==Ad.BACKSPACE){return}a=selection.getRng();container=a.startContainer;offset=a.startOffset;root=Cu.getRoot();parent$1=container;if(!a.collapsed||offset!==0){return}while(parent$1&&parent$1.parentNode&&parent$1.parentNode.firstChild===parent$1&&parent$1.parentNode!==root){parent$1=parent$1.parentNode}if(parent$1.tagName==='BLOCKQUOTE'){h.formatter.toggle('blockquote',null,parent$1);a=Cu.createRng();a.setStart(container,0);a.setEnd(container,0);selection.setRng(a)}})};var C=function(){var a=function(){o('StyleWithCSS',false);o('enableInlineTableEditing',false);if(!settings.object_resizing){o('enableObjectResizing',false)}};if(!settings.readonly){h.on('BeforeExecCommand MouseDown',a)}};var D=function(){var d=function(){j(Cu.select('a'),function(a){var b=a.parentNode;var c=Cu.getRoot();if(b.lastChild===a){while(b&&!Cu.isBlock(b)){if(b.parentNode.lastChild!==b||b===c){return}b=b.parentNode}Cu.add(b,'br',{'data-mce-bogus':1})}})};h.on('SetContent ExecCommand',function(e){if(e.type==='setcontent'||e.command==='mceInsertLink'){d()}})};var E=function(){if(settings.forced_root_block){h.on('init',function(){o('DefaultParagraphSeparator',settings.forced_root_block)})}};var F=function(){h.on('keyup focusin mouseup',function(e){if(!Ad.modifierPressed(e)){selection.normalize()}},true)};var G=function(){h.contentStyles.push('img:-moz-broken {'+'-moz-force-broken-image-icon:1;'+'min-width:24px;'+'min-height:24px'+'}')};var H=function(){if(!h.inline){h.on('keydown',function(){if(document.activeElement===document.body){h.getWin().focus()}})}};var I=function(){if(!h.inline){h.contentStyles.push('body {min-height: 150px}');h.on('click',function(e){var a;if(e.target.nodeName==='HTML'){if(co.ie>11){h.getBody().focus();return}a=h.selection.getRng();h.getBody().focus();h.selection.setRng(a);h.selection.normalize();h.nodeChanged()}})}};var J=function(){if(co.mac){h.on('keydown',function(e){if(Ad.metaKeyPressed(e)&&!e.shiftKey&&(e.keyCode===37||e.keyCode===39)){e.preventDefault();h.selection.getSel().modify('move',e.keyCode===37?'backward':'forward','lineboundary')}})}};var K=function(){o('AutoUrlDetect',false)};var L=function(){h.on('click',function(e){var a=e.target;do{if(a.tagName==='A'){e.preventDefault();return}}while(a=a.parentNode)});h.contentStyles.push('.mce-content-body {-webkit-touch-callout: none}')};var M=function(){h.on('init',function(){h.dom.bind(h.getBody(),'submit',function(e){e.preventDefault()})})};var N=function(){parser.addNodeFilter('br',function(a){var i=a.length;while(i--){if(a[i].attr('class')==='Apple-interchange-newline'){a[i].remove()}}})};var O=function(){h.on('dragstart',function(e){q(e)});h.on('drop',function(e){if(!p(e)){var a=r(e);if(a&&a.id!==h.id){e.preventDefault();var b=DF.fromPoint(e.x,e.y,h.getDoc());selection.setRng(b);s(a.html,true)}}})};var P=function(){};var Q=function(){var a;if(!l||h.removed){return 0}a=h.selection.getSel();return!a||!a.rangeCount||a.rangeCount===0};B();t();if(!co.windowsPhone){F()}if(isWebKit){v();y();E();M();A();N();if(co.iOS){H();I();L()}else{u()}}if(co.ie>=11){I();A()}if(co.ie){u();K();O()}if(l){w();x();z();C();D();G();J();A()}return{refreshContentEditable:P,isHidden:Q}}var Ij=function(a){return hq.isElement(a)&&gR(eP.fromDom(a))};var Ik=function(b){var c=b.selection.getRng();var d=CaretPosition.fromRangeStart(c);var e=CaretPosition.fromRangeEnd(c);if(CaretPosition.isElementPosition(d)){var f=d.container();if(Ij(f)){nI.firstPositionIn(f).each(function(a){return c.setStart(a.container(),a.offset())})}}if(CaretPosition.isElementPosition(e)){var f=d.container();if(Ij(f)){nI.lastPositionIn(f).each(function(a){return c.setEnd(a.container(),a.offset())})}}b.selection.setRng(pH.normalize(c))};var Il=function(a){a.on('click',function(e){if(e.detail>=3){Ik(a)}})};var Im=function(a){a.on('click',function(e){if(a.dom.getParent(e.target,'details')){e.preventDefault()}})};var In=function(d){d.parser.addNodeFilter('details',function(b){bD(b,function(a){a.attr('data-mce-open',a.attr('open'));a.attr('open','open')})});d.serializer.addNodeFilter('details',function(c){bD(c,function(a){var b=a.attr('data-mce-open');a.attr('open',br(b)?b:null);a.attr('data-mce-open',null)})})};var Io=function(a){Im(a);In(a)};var Ip=iQ.DOM;var Iq=function(a,b){var c=eP.fromDom(a.getDoc().head);var d=eP.fromTag('style');fs(d,'type','text/css');iZ(d,eP.fromText(b));iZ(c,d)};var Ir=function(e){var f=DomParser(e.settings,e.schema);f.addAttributeFilter('src,href,style,tabindex',function(a,b){var i=a.length,fH;var c=e.dom;var d,internalName;while(i--){fH=a[i];d=fH.attr(b);internalName='data-mce-'+b;if(!fH.attributes.map[internalName]){if(d.indexOf('data:')===0||d.indexOf('blob:')===0){continue}if(b==='style'){d=c.serializeStyle(c.parseStyle(d),fH.name);if(!d.length){d=null}fH.attr(internalName,d);fH.attr(b,d)}else if(b==='tabindex'){fH.attr(internalName,d);fH.attr(b,null)}else{fH.attr(internalName,e.convertURL(d,b,fH.name))}}}});f.addNodeFilter('script',function(a){var i=a.length,fH,fd;while(i--){fH=a[i];fd=fH.attr('type')||'no/type';if(fd.indexOf('mce-')!==0){fH.attr('type','mce-'+fd)}}});f.addNodeFilter('#cdata',function(a){var i=a.length,fH;while(i--){fH=a[i];fH.type=8;fH.name='#comment';fH.value='[CDATA['+fH.value+']]'}});f.addNodeFilter('p,h1,h2,h3,h4,h5,h6,div',function(a){var i=a.length,fH;var b=e.schema.getNonEmptyElements();while(i--){fH=a[i];if(fH.isEmpty(b)&&fH.getAll('br').length===0){fH.append(new CZ('br',1)).shortEnded=true}}});return f};var Is=function(b){if(b.settings.auto_focus){cy.setEditorTimeout(b,function(){var a;if(b.settings.auto_focus===true){a=b}else{a=b.editorManager.get(b.settings.auto_focus)}if(!a.destroyed){a.focus()}},100)}};var It=function(a){a.bindPendingEventDelegates();a.initialized=true;a.fire('init');a.focus(true);a.nodeChanged({initial:true});a.execCallback('init_instance_callback',a);Is(a)};var Iu=function(a){return a.inline?Ip.styleSheetLoader:a.dom.styleSheetLoader};var Iv=function(c,d){var f=c.settings;var g=c.getElement();var h=c.getDoc(),body,contentCssText;if(!f.inline){c.getElement().style.visibility=c.orgVisibility}if(!d&&!f.content_editable){h.open();h.write(c.iframeHTML);h.close()}if(f.content_editable){c.on('remove',function(){var a=this.getBody();Ip.removeClass(a,'mce-content-body');Ip.removeClass(a,'mce-edit-focus');Ip.setAttrib(a,'contentEditable',null)});Ip.addClass(g,'mce-content-body');c.contentDocument=h=f.content_document||document;c.contentWindow=f.content_window||window;c.bodyElement=g;f.content_document=f.content_window=null;f.root_name=g.nodeName.toLowerCase()}body=c.getBody();body.disabled=true;c.readonly=f.readonly;if(!c.readonly){if(c.inline&&Ip.getStyle(body,'position',true)==='static'){body.style.position='relative'}body.contentEditable=c.getParam('content_editable_state',true)}body.disabled=false;c.editorUpload=EditorUpload(c);c.schema=Schema(f);c.dom=iQ(h,{keep_values:true,url_converter:c.convertURL,url_converter_scope:c,hex_colors:f.force_hex_style_colors,class_filter:f.class_filter,update_styles:true,root_element:c.inline?c.getBody():null,collect:f.content_editable,schema:c.schema,contentCssCors:vB.shouldUseContentCssCors(c),onSetAttrib:function(e){c.fire('SetAttrib',e)}});c.parser=Ir(c);c.serializer=Serializer$1(f,c);c.selection=ED(c.dom,c.getWin(),c.serializer,c);c.annotator=Annotator(c);c.formatter=Formatter(c);c.undoManager=UndoManager(c);c._nodeChangeDispatcher=new NodeChange(c);c._selectionOverrides=Aj(c);Io(c);Il(c);Ii.setup(c);yK.setup(c);c.fire('PreInit');if(!f.browser_spellcheck&&!f.gecko_spellcheck){h.body.spellcheck=false;Ip.setAttrib(body,'spellcheck','false')}c.quirks=Quirks(c);c.fire('PostRender');if(f.directionality){body.dir=f.directionality}if(f.nowrap){body.style.whiteSpace='nowrap'}if(f.protect){c.on('BeforeSetContent',function(e){dj.each(f.protect,function(b){e.content=e.content.replace(b,function(a){return'<!--mce:protected '+escape(a)+'-->'})})})}c.on('SetContent',function(){c.addVisual(c.getBody())});c.load({initial:true,format:'html'});c.startContent=c.getContent({format:'raw'});c.on('compositionstart compositionend',function(e){c.composing=e.type==='compositionstart'});if(c.contentStyles.length>0){contentCssText='';dj.each(c.contentStyles,function(a){contentCssText+=a+'\r\n'});c.dom.addStyle(contentCssText)}Iu(c).loadAll(c.contentCSS,function(_){It(c)},function(a){It(c)});if(f.content_style){Iq(c,f.content_style)}};var Iw={initContentBody:Iv};var Ix=iQ.DOM;var Iy=function(a,b){if(document.domain!==window.location.hostname&&co.ie&&co.ie<12){var c=yD.uuid('mce');a[c]=function(){Iw.initContentBody(a)};var d='javascript:(function(){'+'document.open();document.domain="'+document.domain+'";'+'var ed = window.parent.tinymce.get("'+a.id+'");document.write(ed.iframeHTML);'+'document.close();ed.'+c+'(true);})()';Ix.setAttrib(b,'src',d);return true}return false};var Iz=function(a){var b=typeof a==='number'?a+'px':a;return b?b:''};var IA=function(a,b,c,d){var e=eP.fromTag('iframe');ft(e,d);ft(e,{id:a+'_ifr',frameBorder:'0',allowTransparency:'true',title:b});fA(e,{width:'100%',height:Iz(c),display:'block'});return e};var IB=function(a){var b,bodyClass,iframeHTML;iframeHTML=vB.getDocType(a)+'<html><head>';if(vB.getDocumentBaseUrl(a)!==a.documentBaseUrl){iframeHTML+='<base href="'+a.documentBaseURI.getURI()+'" />'}iframeHTML+='<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />';b=vB.getBodyId(a);bodyClass=vB.getBodyClass(a);if(vB.getContentSecurityPolicy(a)){iframeHTML+='<meta http-equiv="Content-Security-Policy" content="'+vB.getContentSecurityPolicy(a)+'" />'}iframeHTML+='</head><body id="'+b+'" class="mce-content-body '+bodyClass+'" data-id="'+a.id+'"><br></body></html>';return iframeHTML};var IC=function(a,o){var b=a.editorManager.translate('Rich Text Area. Press ALT-F9 for menu. '+'Press ALT-F10 for toolbar. Press ALT-0 for help');var c=IA(a.id,b,o.height,vB.getIframeAttrs(a)).dom();c.onload=function(){c.onload=null;a.fire('load')};var d=Iy(a,c);a.contentAreaContainer=o.iframeContainer;a.iframeElement=c;a.iframeHTML=IB(a);Ix.add(o.iframeContainer,c);return d};var ID=function(a,b){var c=IC(a,b);if(b.editorContainer){Ix.get(b.editorContainer).style.display=a.orgDisplay;a.hidden=Ix.isHidden(b.editorContainer)}a.getElement().style.display='none';Ix.setAttrib(a.id,'aria-hidden','true');if(!c){Iw.initContentBody(a)}};var IE={init:ID};var IF=iQ.DOM;var IG=function(b,c,d){var e=yl.get(d);var f,pluginInstance;f=yl.urls[d]||b.documentBaseUrl.replace(/\/$/,'');d=dj.trim(d);if(e&&dj.inArray(c,d)===-1){dj.each(yl.dependencies(d),function(a){IG(b,c,a)});if(b.plugins[d]){return}pluginInstance=new e(b,f,b.$);b.plugins[d]=pluginInstance;if(pluginInstance.init){pluginInstance.init(b,f);c.push(d)}}};var IH=function(a){return a.replace(/^\-/,'')};var II=function(b){var c=[];dj.each(b.settings.plugins.split(/[ ,]/),function(a){IG(b,c,IH(a))})};var IJ=function(a){var b;var c=a.settings.theme;if(br(c)){a.settings.theme=IH(c);b=ym.get(c);a.theme=new b(a,ym.urls[c]);if(a.theme.init){a.theme.init(a,ym.urls[c]||a.documentBaseUrl.replace(/\/$/,''),a.$)}}else{a.theme={}}};var IK=function(a){var w,h,minHeight,re,info;var b=a.settings;var c=a.getElement();w=b.width||IF.getStyle(c,'width')||'100%';h=b.height||IF.getStyle(c,'height')||c.offsetHeight;minHeight=b.min_height||100;re=/^[0-9\.]+(|px)$/i;if(re.test(''+w)){w=Math.max(parseInt(w,10),100)}if(re.test(''+h)){h=Math.max(parseInt(h,10),minHeight)}info=a.theme.renderUI({targetNode:c,width:w,height:h,deltaWidth:b.delta_width,deltaHeight:b.delta_height});if(!b.content_editable){h=(info.iframeHeight||h)+(typeof h==='number'?info.deltaHeight||0:'');if(h<minHeight){h=minHeight}}info.height=h;return info};var IL=function(a){var b;var c=a.getElement();b=a.settings.theme(a,c);if(b.editorContainer.nodeType){b.editorContainer.id=b.editorContainer.id||a.id+'_parent'}if(b.iframeContainer&&b.iframeContainer.nodeType){b.iframeContainer.id=b.iframeContainer.id||a.id+'_iframecontainer'}b.height=b.iframeHeight?b.iframeHeight:c.offsetHeight;return b};var IM=function(a){return{editorContainer:a,iframeContainer:a}};var IN=function(a){var b=IF.create('div');IF.insertAfter(b,a);return IM(b)};var IO=function(a){var b=a.getElement();return a.inline?IM(null):IN(b)};var IP=function(a){var b=a.settings,elm=a.getElement();a.orgDisplay=elm.style.display;if(br(b.theme)){return IK(a)}else if(bw(b.theme)){return IL(a)}else{return IO(a)}};var IQ=function(a){var b=a.settings;var c=a.getElement();var d;a.rtl=b.rtl_ui||a.editorManager.i18n.rtl;a.editorManager.i18n.setCode(b.language);b.aria_label=b.aria_label||IF.getAttrib(c,'aria-label',a.getLang('aria.rich_text_area'));a.fire('ScriptsLoaded');IJ(a);II(a);d=IP(a);a.editorContainer=d.editorContainer?d.editorContainer:null;if(b.content_css){dj.each(dj.explode(b.content_css),function(u){a.contentCSS.push(a.documentBaseURI.toAbsolute(u))})}if(b.content_editable){return Iw.initContentBody(a)}else{return IE.init(a,d)}};var IR={init:IQ};var IS=iQ.DOM;var IT=function(a){return a.charAt(0)==='-'};var IU=function(a,b){var c=b.settings;if(c.language&&c.language!=='en'&&!c.language_url){c.language_url=b.editorManager.baseURL+'/langs/'+c.language+'.js'}if(c.language_url&&!b.editorManager.i18n.data[c.language]){a.add(c.language_url)}};var IV=function(a,b,c,d){var e=b.settings,theme=e.theme;if(br(theme)){if(!IT(theme)&&!ym.urls.hasOwnProperty(theme)){var f=e.theme_url;if(f){ym.load(theme,b.documentBaseURI.toAbsolute(f))}else{ym.load(theme,'themes/'+theme+'/theme'+c+'.js')}}a.loadQueue(function(){ym.waitFor(theme,d)})}else{d()}};var IW=function(e,f){if(dj.isArray(e.plugins)){e.plugins=e.plugins.join(' ')}dj.each(e.external_plugins,function(a,b){yl.load(b,a);e.plugins+=' '+b});dj.each(e.plugins.split(/[ ,]/),function(c){c=dj.trim(c);if(c&&!yl.urls[c]){if(IT(c)){c=c.substr(1,c.length);var d=yl.dependencies(c);dj.each(d,function(a){var b={prefix:'plugins/',resource:a,suffix:'/plugin'+f+'.js'};a=yl.createUrl(b,a);yl.load(a.resource,a)})}else{yl.load(c,{prefix:'plugins/',resource:c,suffix:'/plugin'+f+'.js'})}}})};var IX=function(b,c){var d=iU.ScriptLoader;IV(d,b,c,function(){IU(d,b);IW(b.settings,c);d.loadQueue(function(){if(!b.removed){IR.init(b)}},b,function(a){yk.pluginLoadError(b,a[0]);if(!b.removed){IR.init(b)}})})};var IY=function(a){var b=a.settings,id=a.id;var c=function(){IS.unbind(window,'ready',c);a.render()};if(!cK.Event.domLoaded){IS.bind(window,'ready',c);return}if(!a.getElement()){return}if(!co.contentEditable){return}if(!b.inline){a.orgVisibility=a.getElement().style.visibility;a.getElement().style.visibility='hidden'}else{a.inline=true}var d=a.getElement().form||IS.getParent(id,'form');if(d){a.formElement=d;if(b.hidden_input&&!/TEXTAREA|INPUT/i.test(a.getElement().nodeName)){IS.insertAfter(IS.create('input',{type:'hidden',name:id}),id);a.hasHiddenInput=true}a.formEventDelegate=function(e){a.fire(e.type,e)};IS.bind(d,'submit reset',a.formEventDelegate);a.on('reset',function(){a.setContent(a.startContent,{format:'raw'})});if(b.submit_patch&&!d.submit.nodeType&&!d.submit.length&&!d._mceOldSubmit){d._mceOldSubmit=d.submit;d.submit=function(){a.editorManager.triggerSave();a.setDirty(false);return d._mceOldSubmit(d)}}}a.windowManager=WindowManager(a);a.notificationManager=NotificationManager(a);if(b.encoding==='xml'){a.on('GetContent',function(e){if(e.save){e.content=IS.encode(e.content)}})}if(b.add_form_submit_trigger){a.on('submit',function(){if(a.initialized){a.save()}})}if(b.add_unload_trigger){a._beforeUnload=function(){if(a.initialized&&!a.destroyed&&!a.isHidden()){a.save({format:'raw',no_events:true,set_dirty:false})}};a.editorManager.on('BeforeUnload',a._beforeUnload)}a.editorManager.add(a);IX(a,a.suffix)};var IZ={render:IY};var Ja=function(a,b,c){var d=a.sidebars?a.sidebars:[];d.push({name:b,settings:c});a.sidebars=d};var Jb={add:Ja};var Jc=dj.each,trim$4=dj.trim;var Jd='source protocol authority userInfo user password host port relative path directory file query anchor'.split(' ');var Je={ftp:21,http:80,https:443,mailto:25};var Jf=function(b,c){var d=this;var e,baseUrl;b=trim$4(b);c=d.settings=c||{};e=c.base_uri;if(/^([\w\-]+):([^\/]{2})/i.test(b)||/^\s*#/.test(b)){d.source=b;return}var f=b.indexOf('//')===0;if(b.indexOf('/')===0&&!f){b=(e?e.protocol||'http':'http')+'://mce_host'+b}if(!/^[\w\-]*:?\/\//.test(b)){baseUrl=c.base_uri?c.base_uri.path:new Jf(document.location.href).directory;if(c.base_uri.protocol==''){b='//mce_host'+d.toAbsPath(baseUrl,b)}else{b=/([^#?]*)([#?]?.*)/.exec(b);b=(e&&e.protocol||'http')+'://mce_host'+d.toAbsPath(baseUrl,b[1])+b[2]}}b=b.replace(/@@/g,'(mce_at)');b=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*):?([^:@\/]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(b);Jc(Jd,function(v,i){var a=b[i];if(a){a=a.replace(/\(mce_at\)/g,'@@')}d[v]=a});if(e){if(!d.protocol){d.protocol=e.protocol}if(!d.userInfo){d.userInfo=e.userInfo}if(!d.port&&d.host==='mce_host'){d.port=e.port}if(!d.host||d.host==='mce_host'){d.host=e.host}d.source=''}if(f){d.protocol=''}};Jf.prototype={setPath:function(a){var b=this;a=/^(.*?)\/?(\w+)?$/.exec(a);b.path=a[0];b.directory=a[1];b.file=a[2];b.source='';b.getURI()},toRelative:function(a){var b=this;var c;if(a==='./'){return a}a=new Jf(a,{base_uri:b});if(a.host!=='mce_host'&&b.host!==a.host&&a.host||b.port!==a.port||b.protocol!==a.protocol&&a.protocol!==''){return a.getURI()}var d=b.getURI(),uu=a.getURI();if(d===uu||d.charAt(d.length-1)==='/'&&d.substr(0,d.length-1)===uu){return d}c=b.toRelPath(b.path,a.path);if(a.query){c+='?'+a.query}if(a.anchor){c+='#'+a.anchor}return c},toAbsolute:function(a,b){a=new Jf(a,{base_uri:this});return a.getURI(b&&this.isSameOrigin(a))},isSameOrigin:function(a){if(this.host==a.host&&this.protocol==a.protocol){if(this.port==a.port){return true}var b=Je[this.protocol];if(b&&(this.port||b)==(a.port||b)){return true}}return false},toRelPath:function(a,b){var c,breakPoint=0,out='',i,l;a=a.substring(0,a.lastIndexOf('/'));a=a.split('/');c=b.split('/');if(a.length>=c.length){for(i=0,l=a.length;i<l;i++){if(i>=c.length||a[i]!==c[i]){breakPoint=i+1;break}}}if(a.length<c.length){for(i=0,l=c.length;i<l;i++){if(i>=a.length||a[i]!==c[i]){breakPoint=i+1;break}}}if(breakPoint===1){return b}for(i=0,l=a.length-(breakPoint-1);i<l;i++){out+='../'}for(i=breakPoint-1,l=c.length;i<l;i++){if(i!==breakPoint-1){out+='/'+c[i]}else{out+=c[i]}}return out},toAbsPath:function(a,b){var i,nb=0,o=[],tr,outPath;tr=/\/$/.test(b)?'/':'';a=a.split('/');b=b.split('/');Jc(a,function(k){if(k){o.push(k)}});a=o;for(i=b.length-1,o=[];i>=0;i--){if(b[i].length===0||b[i]==='.'){continue}if(b[i]==='..'){nb++;continue}if(nb>0){nb--;continue}o.push(b[i])}i=a.length-nb;if(i<=0){outPath=o.reverse().join('/')}else{outPath=a.slice(0,i).join('/')+'/'+o.reverse().join('/')}if(outPath.indexOf('/')!==0){outPath='/'+outPath}if(tr&&outPath.lastIndexOf('/')!==outPath.length-1){outPath+=tr}return outPath},getURI:function(a){var s;var b=this;if(!b.source||a){s='';if(!a){if(b.protocol){s+=b.protocol+'://'}else{s+='//'}if(b.userInfo){s+=b.userInfo+'@'}if(b.host){s+=b.host}if(b.port){s+=':'+b.port}}if(b.path){s+=b.path}if(b.query){s+='?'+b.query}if(b.anchor){s+='#'+b.anchor}b.source=s}return b.source}};Jf.parseDataUri=function(a){var b,matches;a=decodeURIComponent(a).split(',');matches=/data:([^;]+)/.exec(a[0]);if(matches){b=matches[1]}return{type:b,data:a[1]}};Jf.getDocumentBaseUrl=function(a){var b;if(a.protocol.indexOf('http')!==0&&a.protocol!=='file:'){b=a.href}else{b=a.protocol+'//'+a.host+a.pathname}if(/^[^:]+:\/\/\/?[^\/]+\//.test(b)){b=b.replace(/[\?#].*$/,'').replace(/[\/\\][^\/]+$/,'');if(!/[\/\\]$/.test(b)){b+='/'}}return b};var Jg='html';var Jh=function(a,b){var c=vB.getForcedRootBlock(a);var d=new RegExp('^(<'+c+'[^>]*>(&nbsp;|&#160;|\\s|\xA0|<br \\/>|)<\\/'+c+'>[\r\n]*|<br \\/>[\r\n]*););return b.replace(d,'')};var Ji=function(a,b,c){var d;b.format=b.format?b.format:Jg;b.get=true;b.getInner=true;if(!b.no_events){a.fire('BeforeGetContent',b)}if(b.format==='raw'){d=dj.trim(Ar.trimExternal(a.serializer,c.innerHTML))}else if(b.format==='text'){d=jX.trim(c.innerText||c.textContent)}else if(b.format==='tree'){return a.serializer.serialize(c,b)}else{d=Jh(a,a.serializer.serialize(c,b))}if(b.format!=='text'&&!gX(eP.fromDom(c))){b.content=dj.trim(d)}else{b.content=d}if(!b.no_events){a.fire('GetContent',b)}return b.content};var Jj=function(b,c){if(c===void 0){c={}}return bo.from(b.getBody()).fold(bc(c.format==='tree'?new CZ('body',11):''),function(a){return Ji(b,c,a)})};var Jk=function(a,b){b(a);if(a.firstChild){Jk(a.firstChild,b)}if(a.next){Jk(a.next,b)}};var Jl=function(c,d,e){var f={};var g={};var h=[];if(e.firstChild){Jk(e.firstChild,function(b){bD(c,function(a){if(a.name===b.name){if(f[a.name]){f[a.name].nodes.push(b)}else{f[a.name]={filter:a,nodes:[b]}}}});bD(d,function(a){if(typeof b.attr(a.name)==='string'){if(g[a.name]){g[a.name].nodes.push(b)}else{g[a.name]={filter:a,nodes:[b]}}}})})}for(var i in f){if(f.hasOwnProperty(i)){h.push(f[i])}}for(var i in g){if(g.hasOwnProperty(i)){h.push(g[i])}}return h};var Jm=function(c,d,e){var f=Jl(c,d,e);bD(f,function(b){bD(b.filter.callbacks,function(a){a(b.nodes,b.filter.name,{})})})};var Jn='html';var Jo=function(a){return a instanceof CZ};var Jp=function(d){if(xO.hasFocus(d)){nI.firstPositionIn(d.getBody()).each(function(a){var b=a.getNode();var c=hq.isTable(b)?nI.firstPositionIn(b).getOr(a):a;d.selection.setRng(c.toRange())})}};var Jq=function(a,b){a.dom.setHTML(a.getBody(),b);Jp(a)};var Jr=function(a,b,c,d){var e,padd;if(c.length===0||/^\s+$/.test(c)){padd='<br data-mce-bogus="1">';if(b.nodeName==='TABLE'){c='<tr><td>'+padd+'</td></tr>'}else if(/^(UL|OL)$/.test(b.nodeName)){c='<li>'+padd+'</li>'}e=vB.getForcedRootBlock(a);if(e&&a.schema.isValidChild(b.nodeName.toLowerCase(),e.toLowerCase())){c=padd;c=a.dom.createHTML(e,a.settings.forced_root_block_attrs,c)}else if(!c){c='<br data-mce-bogus="1">'}Jq(a,c);a.fire('SetContent',d)}else{if(d.format!=='raw'){c=Serializer({validate:a.validate},a.schema).serialize(a.parser.parse(c,{isRootContent:true,insert:true}))}d.content=gX(eP.fromDom(b))?c:dj.trim(c);Jq(a,d.content);if(!d.no_events){a.fire('SetContent',d)}}return d.content};var Js=function(a,b,c,d){Jm(a.parser.getNodeFilters(),a.parser.getAttributeFilters(),c);var e=Serializer({validate:a.validate},a.schema).serialize(c);d.content=gX(eP.fromDom(b))?e:dj.trim(e);Jq(a,d.content);if(!d.no_events){a.fire('SetContent',d)}return c};var Jt=function(b,c,d){if(d===void 0){d={}}d.format=d.format?d.format:Jn;d.set=true;d.content=Jo(c)?'':c;if(!Jo(c)&&!d.no_events){b.fire('BeforeSetContent',d);c=d.content}return bo.from(b.getBody()).fold(bc(c),function(a){return Jo(c)?Js(b,a,c,d):Jr(b,a,c,d)})};var Ju=iQ.DOM;var Jv=function(a){Ju.setStyle(a.id,'display',a.orgDisplay)};var Jw=function(x){return bo.from(x).each(function(x){return x.destroy()})};var Jx=function(a){a.contentAreaContainer=a.formElement=a.container=a.editorContainer=null;a.bodyElement=a.contentDocument=a.contentWindow=null;a.iframeElement=a.targetElm=null;if(a.selection){a.selection=a.selection.win=a.selection.dom=a.selection.dom.doc=null}};var Jy=function(a){var b=a.formElement;if(b){if(b._mceOldSubmit){b.submit=b._mceOldSubmit;b._mceOldSubmit=null}Ju.unbind(b,'submit reset',a.formEventDelegate)}};var Jz=function(a){if(!a.removed){var b=a._selectionOverrides,editorUpload=a.editorUpload;var c=a.getBody();var d=a.getElement();if(c){a.save({is_removing:true})}a.removed=true;a.unbindAllNativeEvents();if(a.hasHiddenInput&&d){Ju.remove(d.nextSibling)}if(!a.inline&&c){Jv(a)}xh.fireRemove(a);a.editorManager.remove(a);Ju.remove(a.getContainer());Jw(b);Jw(editorUpload);a.destroy()}};var JA=function(a,b){var c=a.selection,Cu=a.dom;if(a.destroyed){return}if(!b&&!a.removed){a.remove();return}if(!b){a.editorManager.off('beforeunload',a._beforeUnload);if(a.theme&&a.theme.destroy){a.theme.destroy()}Jw(c);Jw(Cu)}Jy(a);Jx(a);a.destroyed=true};var JB=iQ.DOM;var JC=dj.extend,each$l=dj.each;var JD=dj.resolve;var JE=co.ie;var JF=function(a,b,c){var d=this;var e=d.documentBaseUrl=c.documentBaseURL;var f=c.baseURI;b=qp(d,a,e,c.defaultSettings,b);d.settings=b;AddOnManager.language=b.language||'en';AddOnManager.languageLoad=b.language_load;AddOnManager.baseURL=c.baseURL;d.id=a;d.setDirty(false);d.plugins={};d.documentBaseURI=new Jf(b.document_base_url,{base_uri:f});d.baseURI=f;d.contentCSS=[];d.contentStyles=[];d.shortcuts=new Shortcuts(d);d.loadedCSS={};d.editorCommands=new EditorCommands(d);d.suffix=c.suffix;d.editorManager=c;d.inline=b.inline;d.buttons={};d.menuItems={};if(b.cache_suffix){co.cacheSuffix=b.cache_suffix.replace(/^[\?\&]+/,'')}if(b.override_viewport===false){co.overrideViewPort=false}c.fire('SetupEditor',{editor:d});d.execCallback('setup',d);d.$=dB.overrideDefaults(function(){return{context:d.inline?d.getBody():d.getDoc(),element:d.getBody()}})};JF.prototype={render:function(){IZ.render(this)},focus:function(a){xO.focus(this,a)},hasFocus:function(){return xO.hasFocus(this)},execCallback:function(a){var x=[];for(var b=1;b<arguments.length;b++){x[b-1]=arguments[b]}var c=this;var d=c.settings[a],scope;if(!d){return}if(c.callbackLookup&&(scope=c.callbackLookup[a])){d=scope.func;scope=scope.scope}if(typeof d==='string'){scope=d.replace(/\.\w+$/,'');scope=scope?JD(scope):0;d=JD(d);c.callbackLookup=c.callbackLookup||{};c.callbackLookup[a]={func:d,scope:scope}}return d.apply(scope||c,Array.prototype.slice.call(arguments,1))},translate:function(c){if(c&&dj.is(c,'string')){var d=this.settings.language||'en',i18n_1=this.editorManager.i18n;c=i18n_1.data[d+'.'+c]||c.replace(/\{\#([^\}]+)\}/g,function(a,b){return i18n_1.data[d+'.'+b]||'{#'+b+'}'})}return this.editorManager.translate(c)},getLang:function(a,b){return this.editorManager.i18n.data[(this.settings.language||'en')+'.'+a]||(b!==undefined?b:'{#'+a+'}')},getParam:function(a,b,c){return qu(this,a,b,c)},nodeChanged:function(a){this._nodeChangeDispatcher.nodeChanged(a)},addButton:function(a,b){var c=this;if(b.cmd){b.onclick=function(){c.execCommand(b.cmd)}}if(b.stateSelector&&typeof b.active==='undefined'){b.active=false}if(!b.text&&!b.icon){b.icon=a}b.tooltip=b.tooltip||b.title;c.buttons[a]=b},addSidebar:function(a,b){return Jb.add(this,a,b)},addMenuItem:function(a,b){var c=this;if(b.cmd){b.onclick=function(){c.execCommand(b.cmd)}}c.menuItems[a]=b},addContextToolbar:function(b,c){var d=this;var e;d.contextToolbars=d.contextToolbars||[];if(typeof b==='string'){e=b;b=function(a){return d.dom.is(a,e)}}d.contextToolbars.push({id:yD.uuid('mcet'),predicate:b,items:c})},addCommand:function(a,b,c){this.editorCommands.addCommand(a,b,c)},addQueryStateHandler:function(a,b,c){this.editorCommands.addQueryStateHandler(a,b,c)},addQueryValueHandler:function(a,b,c){this.editorCommands.addQueryValueHandler(a,b,c)},addShortcut:function(a,b,c,d){this.shortcuts.add(a,b,c,d)},execCommand:function(a,b,c,d){return this.editorCommands.execCommand(a,b,c,d)},queryCommandState:function(a){return this.editorCommands.queryCommandState(a)},queryCommandValue:function(a){return this.editorCommands.queryCommandValue(a)},queryCommandSupported:function(a){return this.editorCommands.queryCommandSupported(a)},show:function(){var a=this;if(a.hidden){a.hidden=false;if(a.inline){a.getBody().contentEditable=true}else{JB.show(a.getContainer());JB.hide(a.id)}a.load();a.fire('show')}},hide:function(){var a=this,dk=a.getDoc();if(!a.hidden){if(JE&&dk&&!a.inline){dk.execCommand('SelectAll')}a.save();if(a.inline){a.getBody().contentEditable=false;if(a===a.editorManager.focusedEditor){a.editorManager.focusedEditor=null}}else{JB.hide(a.getContainer());JB.setStyle(a.id,'display',a.orgDisplay)}a.hidden=true;a.fire('hide')}},isHidden:function(){return!!this.hidden},setProgressState:function(a,b){this.fire('ProgressState',{state:a,time:b})},load:function(a){var b=this;var c=b.getElement(),html;if(b.removed){return''}if(c){a=a||{};a.load=true;html=b.setContent(c.value!==undefined?c.value:c.innerHTML,a);a.element=c;if(!a.no_events){b.fire('LoadContent',a)}a.element=c=null;return html}},save:function(b){var c=this;var d=c.getElement(),html,form;if(!d||!c.initialized||c.removed){return}b=b||{};b.save=true;b.element=d;html=b.content=c.getContent(b);if(!b.no_events){c.fire('SaveContent',b)}if(b.format==='raw'){c.fire('RawSaveContent',b)}html=b.content;if(!/TEXTAREA|INPUT/i.test(d.nodeName)){if(b.is_removing||!c.inline){d.innerHTML=html}if(form=JB.getParent(c.id,'form')){each$l(form.elements,function(a){if(a.name===c.id){a.value=html;return false}})}}else{d.value=html}b.element=d=null;if(b.set_dirty!==false){c.setDirty(false)}return html},setContent:function(a,b){return Jt(this,a,b)},getContent:function(a){return Jj(this,a)},insertContent:function(a,b){if(b){a=JC({content:a},b)}this.execCommand('mceInsertContent',false,a)},isDirty:function(){return!this.isNotDirty},setDirty:function(a){var b=!this.isNotDirty;this.isNotDirty=!a;if(a&&a!==b){this.fire('dirty')}},setMode:function(a){xl(this,a)},getContainer:function(){var a=this;if(!a.container){a.container=JB.get(a.editorContainer||a.id+'_parent')}return a.container},getContentAreaContainer:function(){return this.contentAreaContainer},getElement:function(){if(!this.targetElm){this.targetElm=JB.get(this.id)}return this.targetElm},getWin:function(){var a=this;var b;if(!a.contentWindow){b=a.iframeElement;if(b){a.contentWindow=b.contentWindow}}return a.contentWindow},getDoc:function(){var a=this;var b;if(!a.contentDocument){b=a.getWin();if(b){a.contentDocument=b.document}}return a.contentDocument},getBody:function(){var a=this.getDoc();return this.bodyElement||(a?a.body:null)},convertURL:function(a,b,c){var d=this,settings=d.settings;if(settings.urlconverter_callback){return d.execCallback('urlconverter_callback',a,c,true,b)}if(!settings.convert_urls||c&&c.nodeName==='LINK'||a.indexOf('file:')===0||a.length===0){return a}if(settings.relative_urls){return d.documentBaseURI.toRelative(a)}a=d.documentBaseURI.toAbsolute(a,settings.remove_script_host);return a},addVisual:function(c){var d=this;var e=d.settings;var f=d.dom;var g;c=c||d.getBody();if(d.hasVisual===undefined){d.hasVisual=e.visual}each$l(f.select('table,a',c),function(a){var b;switch(a.nodeName){case'TABLE':g=e.visual_table_class||'mce-item-table';b=f.getAttrib(a,'border');if((!b||b==='0')&&d.hasVisual){f.addClass(a,g)}else{f.removeClass(a,g)}return;case'A':if(!f.getAttrib(a,'href')){b=f.getAttrib(a,'name')||a.id;g=e.visual_anchor_class||'mce-item-anchor';if(b&&d.hasVisual){f.addClass(a,g)}else{f.removeClass(a,g)}}return}});d.fire('VisualAid',{element:c,hasVisual:d.hasVisual})},remove:function(){Jz(this)},destroy:function(a){JA(this,a)},uploadImages:function(a){return this.editorUpload.uploadImages(a)},_scanForImages:function(){return this.editorUpload.scanForImages()}};JC(JF.prototype,xv);var JG=function(a){return a.className.toString().indexOf('mce-')!==-1};var JH={isEditorUIElement:JG};var JI=function(e){return e.type==='nodechange'&&e.selectionChange};var JJ=function(a,b){var c=function(){b.throttle()};iQ.DOM.bind(document,'mouseup',c);a.on('remove',function(){iQ.DOM.unbind(document,'mouseup',c)})};var JK=function(a){a.on('focusout',function(){wP.store(a)})};var JL=function(a,b){a.on('mouseup touchend',function(e){b.throttle()})};var JM=function(a,b){var c=eJ.detect().browser;if(c.isIE()){JK(a)}else{JL(a,b)}a.on('keyup nodechange',function(e){if(!JI(e)){wP.store(a)}})};var JN=function(a){var b=jg(function(){wP.store(a)},0);if(a.inline){JJ(a,b)}a.on('init',function(){JM(a,b)});a.on('remove',function(){b.cancel()})};var JO={register:JN};var JP;var JQ=iQ.DOM;var JR=function(a){return JH.isEditorUIElement(a)};var JS=function(b,c){var d=b?b.settings.custom_ui_selector:'';var e=JQ.getParent(c,function(a){return JR(a)||(d?b.dom.is(a,d):false)});return e!==null};var JT=function(){try{return document.activeElement}catch(ex){return document.body}};var JU=function(c,e){var d=e.editor;JO.register(d);d.on('focusin',function(){var a=this;var b=c.focusedEditor;if(b!==a){if(b){b.fire('blur',{focusedEditor:a})}c.setActive(a);c.focusedEditor=a;a.fire('focus',{blurredEditor:b});a.focus(true)}});d.on('focusout',function(){var b=this;cy.setEditorTimeout(b,function(){var a=c.focusedEditor;if(!JS(b,JT())&&a===b){b.fire('blur',{focusedEditor:null});c.focusedEditor=null}})});if(!JP){JP=function(e){var a=c.activeEditor;var b;b=e.target;if(a&&b.ownerDocument===document){if(b!==document.body&&!JS(a,b)&&c.focusedEditor===a){a.fire('blur',{focusedEditor:null});c.focusedEditor=null}}};JQ.bind(document,'focusin',JP)}};var JV=function(a,e){if(a.focusedEditor===e.editor){a.focusedEditor=null}if(!a.activeEditor){JQ.unbind(document,'focusin',JP);JP=null}};var JW=function(a){a.on('AddEditor',curry(JU,a));a.on('RemoveEditor',curry(JV,a))};var JX={setup:JW,isEditorUIElement:JR,isUIElement:JS};var JY={};var JZ='en';var Ka={setCode:function(a){if(a){JZ=a;this.rtl=this.data[a]?this.data[a]._dir==='rtl':false}},getCode:function(){return JZ},rtl:false,add:function(a,b){var c=JY[a];if(!c){JY[a]=c={}}for(var d in b){c[d]=b[d]}this.setCode(a)},translate:function(c){var d=JY[JZ]||{};var toString=function(a){if(dj.is(a,'function')){return Object.prototype.toString.call(a)}return!e(a)?''+a:''};var e=function(a){return a===''||a===null||dj.is(a,'undefined')};var f=function(a){a=toString(a);return dj.hasOwn(d,a)?toString(d[a]):a};if(e(c)){return''}if(dj.is(c,'object')&&dj.hasOwn(c,'raw')){return toString(c.raw)}if(dj.is(c,'array')){var g=c.slice(1);c=f(c[0]).replace(/\{([0-9]+)\}/g,function(a,b){return dj.hasOwn(g,b)?toString(g[b]):a})}return f(c).replace(/{context:\w+}$/,'')},data:JY};var Kb=iQ.DOM;var Kc=dj.explode,each$m=dj.each,extend$5=dj.extend;var Kd=0,beforeUnloadDelegate,EditorManager,boundGlobalEvents=false;var Ke=[];var Kf=[];var Kg=function(a){return a!=='length'};var Kh=function(e){each$m(EditorManager.get(),function(a){if(e.type==='scroll'){a.fire('ScrollWindow',e)}else{a.fire('ResizeWindow',e)}})};var Ki=function(a){if(a!==boundGlobalEvents){if(a){dB(window).on('resize scroll',Kh)}else{dB(window).off('resize scroll',Kh)}boundGlobalEvents=a}};var Kj=function(b){var c=Kf;delete Ke[b.id];for(var i=0;i<Ke.length;i++){if(Ke[i]===b){Ke.splice(i,1);break}}Kf=bG(Kf,function(a){return b!==a});if(EditorManager.activeEditor===b){EditorManager.activeEditor=Kf.length>0?Kf[0]:null}if(EditorManager.focusedEditor===b){EditorManager.focusedEditor=null}return c.length!==Kf.length};var Kk=function(a){if(a&&a.initialized&&!(a.getContainer()||a.getBody()).parentNode){Kj(a);a.unbindAllNativeEvents();a.destroy(true);a.removed=true;a=null}return a};EditorManager={defaultSettings:{},$:dB,majorVersion:'4',minorVersion:'9.2',releaseDate:'2018-12-17',editors:Ke,i18n:Ka,activeEditor:null,settings:{},setup:function(){var a=this;var b,documentBaseURL,suffix='',preInit,src;documentBaseURL=Jf.getDocumentBaseUrl(document.location);if(/^[^:]+:\/\/\/?[^\/]+\//.test(documentBaseURL)){documentBaseURL=documentBaseURL.replace(/[\?#].*$/,'').replace(/[\/\\][^\/]+$/,'');if(!/[\/\\]$/.test(documentBaseURL)){documentBaseURL+='/'}}preInit=window.tinymce||window.tinyMCEPreInit;if(preInit){b=preInit.base||preInit.baseURL;suffix=preInit.suffix}else{var c=document.getElementsByTagName('script');for(var i=0;i<c.length;i++){src=c[i].src;var d=src.substring(src.lastIndexOf('/'));if(/tinymce(\.full|\.jquery|)(\.min|\.dev|)\.js/.test(src)){if(d.indexOf('.min')!==-1){suffix='.min'}b=src.substring(0,src.lastIndexOf('/'));break}}if(!b&&document.currentScript){src=document.currentScript.src;if(src.indexOf('.min')!==-1){suffix='.min'}b=src.substring(0,src.lastIndexOf('/'))}}a.baseURL=new Jf(documentBaseURL).toAbsolute(b);a.documentBaseURL=documentBaseURL;a.baseURI=new Jf(a.baseURL);a.suffix=suffix;JX.setup(a)},overrideDefaults:function(a){var b,suffix;b=a.base_url;if(b){this.baseURL=new Jf(this.documentBaseURL).toAbsolute(b.replace(/\/+$/,''));this.baseURI=new Jf(this.baseURL)}suffix=a.suffix;if(a.suffix){this.suffix=suffix}this.defaultSettings=a;var c=a.plugin_base_urls;for(var d in c){AddOnManager.PluginManager.urls[d]=c[d]}},init:function(i){var j=this;var k,invalidInlineTargets;invalidInlineTargets=dj.makeMap('area base basefont br col frame hr img input isindex link meta param embed source wbr track '+'colgroup option tbody tfoot thead tr script noscript style textarea video audio iframe object menu',' ');var m=function(a,b){return a.inline&&b.tagName.toLowerCase()in invalidInlineTargets};var n=function(a){var b=a.id;if(!b){b=a.name;if(b&&!Kb.get(b)){b=a.name}else{b=Kb.uniqueId()}a.setAttribute('id',b)}return b};var o=function(a){var b=i[a];if(!b){return}return b.apply(j,Array.prototype.slice.call(arguments,2))};var p=function(a,b){return b.constructor===RegExp?b.test(a.className):Kb.hasClass(a,b)};var q=function(c){var l,targets=[];if(co.ie&&co.ie<11){yk.initError('TinyMCE does not support the browser you are using. For a list of supported'+' browsers please see: https://www.tinymce.com/docs/get-started/system-requirements/');return[]}if(c.types){each$m(c.types,function(a){targets=targets.concat(Kb.select(a.selector))});return targets}else if(c.selector){return Kb.select(c.selector)}else if(c.target){return[c.target]}switch(c.mode){case'exact':l=c.elements||'';if(l.length>0){each$m(Kc(l),function(a){var b;if(b=Kb.get(a)){targets.push(b)}else{each$m(document.forms,function(f){each$m(f.elements,function(e){if(e.name===a){a='mce_editor_'+Kd++;Kb.setAttrib(e,'id',a);targets.push(e)}})})}})}break;case'textareas':case'specific_textareas':each$m(Kb.select('textarea'),function(a){if(c.editor_deselector&&p(a,c.editor_deselector)){return}if(!c.editor_selector||p(a,c.editor_selector)){targets.push(a)}});break}return targets};var r=function(a){k=a};var s=function(){var e=0;var f=[];var g;var h=function(a,b,c){var d=new JF(a,b,j);f.push(d);d.on('init',function(){if(++e===g.length){r(f)}});d.targetElm=d.targetElm||c;d.render()};Kb.unbind(window,'ready',s);o('onpageload');g=dB.unique(q(i));if(i.types){each$m(i.types,function(b){dj.each(g,function(a){if(Kb.is(a,b.selector)){h(n(a),extend$5({},i,b),a);return false}return true})});return}dj.each(g,function(a){Kk(j.get(a.id))});g=dj.grep(g,function(a){return!j.get(a.id)});if(g.length===0){r([])}else{each$m(g,function(a){if(m(i,a)){yk.initError('Could not initialize inline editor on invalid inline target element',a)}else{h(n(a),i,a)}})}};j.settings=i;Kb.bind(window,'ready',s);return new cq(function(b){if(k){b(k)}else{r=function(a){b(a)}}})},get:function(b){if(arguments.length===0){return Kf.slice(0)}else if(br(b)){return bJ(Kf,function(a){return a.id===b}).getOr(null)}else if(bx(b)){return Kf[b]?Kf[b]:null}else{return null}},add:function(a){var b=this;var c;c=Ke[a.id];if(c===a){return a}if(b.get(a.id)===null){if(Kg(a.id)){Ke[a.id]=a}Ke.push(a);Kf.push(a)}Ki(true);b.activeEditor=a;b.fire('AddEditor',{editor:a});if(!beforeUnloadDelegate){beforeUnloadDelegate=function(){b.fire('BeforeUnload')};Kb.bind(window,'beforeunload',beforeUnloadDelegate)}return a},createEditor:function(a,b){return this.add(new JF(a,b,this))},remove:function(b){var c=this;var i,editor;if(!b){for(i=Kf.length-1;i>=0;i--){c.remove(Kf[i])}return}if(br(b)){each$m(Kb.select(b),function(a){editor=c.get(a.id);if(editor){c.remove(editor)}});return}editor=b;if(bu(c.get(editor.id))){return null}if(Kj(editor)){c.fire('RemoveEditor',{editor:editor})}if(Kf.length===0){Kb.unbind(window,'beforeunload',beforeUnloadDelegate)}editor.remove();Ki(Kf.length>0);return editor},execCommand:function(a,b,c){var d=this,editor=d.get(c);switch(a){case'mceAddEditor':if(!d.get(c)){new JF(c,d.settings,d).render()}return true;case'mceRemoveEditor':if(editor){editor.remove()}return true;case'mceToggleEditor':if(!editor){d.execCommand('mceAddEditor',0,c);return true}if(editor.isHidden()){editor.show()}else{editor.hide()}return true}if(d.activeEditor){return d.activeEditor.execCommand(a,b,c)}return false},triggerSave:function(){each$m(Kf,function(a){a.save()})},addI18n:function(a,b){Ka.add(a,b)},translate:function(a){return Ka.translate(a)},setActive:function(a){var b=this.activeEditor;if(this.activeEditor!==a){if(b){b.fire('deactivate',{relatedTarget:a})}a.fire('activate',{relatedTarget:b})}this.activeEditor=a}};extend$5(EditorManager,xa);EditorManager.setup();var Kl=EditorManager;function RangeUtils(c){var d=function(a,b){return oK.walk(c,a,b)};var e=Bc.split;var f=function(b){return wf.normalize(c,b).fold(bc(false),function(a){b.setStart(a.startContainer,a.startOffset);b.setEnd(a.endContainer,a.endOffset);return true})};return{walk:d,split:e,normalize:f}}(function(a){a.compareRanges=vS.isEq;a.getCaretRangeFromPoint=DF.fromPoint;a.getSelectedNode=kO;a.getNode=kP}(RangeUtils||(RangeUtils={})));var Km=RangeUtils;var Kn=Math.min,max=Math.max,round$2=Math.round;var Ko=function(a,b,c){var x,y,w,h,targetW,targetH;x=b.x;y=b.y;w=a.w;h=a.h;targetW=b.w;targetH=b.h;c=(c||'').split('');if(c[0]==='b'){y+=targetH}if(c[1]==='r'){x+=targetW}if(c[0]==='c'){y+=round$2(targetH/2)}if(c[1]==='c'){x+=round$2(targetW/2)}if(c[3]==='b'){y-=h}if(c[4]==='r'){x-=w}if(c[3]==='c'){y-=round$2(h/2)}if(c[4]==='c'){x-=round$2(w/2)}return Kt(x,y,w,h)};var Kp=function(a,b,c,d){var e,i;for(i=0;i<d.length;i++){e=Ko(a,b,d[i]);if(e.x>=c.x&&e.x+e.w<=c.w+c.x&&e.y>=c.y&&e.y+e.h<=c.h+c.y){return d[i]}}return null};var Kq=function(a,w,h){return Kt(a.x-w,a.y-h,a.w+w*2,a.h+h*2)};var Kr=function(a,b){var c,y1,x2,y2;c=max(a.x,b.x);y1=max(a.y,b.y);x2=Kn(a.x+a.w,b.x+b.w);y2=Kn(a.y+a.h,b.y+b.h);if(x2-c<0||y2-y1<0){return null}return Kt(c,y1,x2-c,y2-y1)};var Ks=function(a,b,c){var d,underflowY1,overflowX2,overflowY2,x1,y1,x2,y2,cx2,cy2;x1=a.x;y1=a.y;x2=a.x+a.w;y2=a.y+a.h;cx2=b.x+b.w;cy2=b.y+b.h;d=max(0,b.x-x1);underflowY1=max(0,b.y-y1);overflowX2=max(0,x2-cx2);overflowY2=max(0,y2-cy2);x1+=d;y1+=underflowY1;if(c){x2+=d;y2+=underflowY1;x1-=overflowX2;y1-=overflowY2}x2-=overflowX2;y2-=overflowY2;return Kt(x1,y1,x2-x1,y2-y1)};var Kt=function(x,y,w,h){return{x:x,y:y,w:w,h:h}};var Ku=function(a){return Kt(a.left,a.top,a.width,a.height)};var Kv={inflate:Kq,relativePosition:Ko,findBestRelativePosition:Kp,intersect:Kr,clamp:Ks,create:Kt,fromClientRect:Ku};var Kw={};var Kx={add:function(a,b){Kw[a.toLowerCase()]=b},has:function(a){return!!Kw[a.toLowerCase()]},get:function(a){var b=a.toLowerCase();var c=Kw.hasOwnProperty(b)?Kw[b]:null;if(c===null){throw new Error('Could not find module for type: '+a);}return c},create:function(a,b){var c;if(typeof a==='string'){b=b||{};b.type=a}else{b=a;a=b.type}a=a.toLowerCase();c=Kw[a];if(!c){throw new Error('Could not find control by type: '+a);}c=new c(b);c.type=a;return c}};var Ky=dj.each,extend$6=dj.extend;var Kz,initializing;var KA=function(){};KA.extend=Kz=function(f){var g=this;var h=g.prototype;var j,fc,member;var k=function(){var i,mixins,mixin;var a=this;if(!initializing){if(a.init){a.init.apply(a,arguments)}mixins=a.Mixins;if(mixins){i=mixins.length;while(i--){mixin=mixins[i];if(mixin.init){mixin.init.apply(a,arguments)}}}}};var l=function(){return this};var m=function(d,e){return function(){var a=this;var b=a._super;var c;a._super=h[d];c=e.apply(a,arguments);a._super=b;return c}};initializing=true;j=new g();initializing=false;if(f.Mixins){Ky(f.Mixins,function(a){for(var b in a){if(b!=='init'){f[b]=a[b]}}});if(h.Mixins){f.Mixins=h.Mixins.concat(f.Mixins)}}if(f.Methods){Ky(f.Methods.split(','),function(a){f[a]=l})}if(f.Properties){Ky(f.Properties.split(','),function(c){var d='_'+c;f[c]=function(a){var b=this;if(a!==undefined){b[d]=a;return b}return b[d]}})}if(f.Statics){Ky(f.Statics,function(a,b){k[b]=a})}if(f.Defaults&&h.Defaults){f.Defaults=extend$6({},h.Defaults,f.Defaults)}for(fc in f){member=f[fc];if(typeof member==='function'&&h[fc]){j[fc]=m(fc,member)}else{j[fc]=member}}k.prototype=j;k.constructor=k;k.extend=Kz;return k};var KB=Math.min,max$1=Math.max,round$3=Math.round;var KC=function(f){var i={};var r=0,g=0,b=0;var j=function(r,g,b){var h,s,v,d,minRGB,maxRGB;h=0;s=0;v=0;r=r/255;g=g/255;b=b/255;minRGB=KB(r,KB(g,b));maxRGB=max$1(r,max$1(g,b));if(minRGB===maxRGB){v=minRGB;return{h:0,s:0,v:v*100}}d=r===minRGB?g-b:b===minRGB?r-g:b-r;h=r===minRGB?3:b===minRGB?1:5;h=60*(h-d/(maxRGB-minRGB));s=(maxRGB-minRGB)/maxRGB;v=maxRGB;return{h:round$3(h),s:round$3(s*100),v:round$3(v*100)}};var k=function(a,c,d){var e,chroma,x,AW;a=(parseInt(a,10)||0)%360;c=parseInt(c,10)/100;d=parseInt(d,10)/100;c=max$1(0,KB(c,1));d=max$1(0,KB(d,1));if(c===0){r=g=b=round$3(255*d);return}e=a/60;chroma=d*c;x=chroma*(1-Math.abs(e%2-1));AW=d-chroma;switch(Math.floor(e)){case 0:r=chroma;g=x;b=0;break;case 1:r=x;g=chroma;b=0;break;case 2:r=0;g=chroma;b=x;break;case 3:r=0;g=x;b=chroma;break;case 4:r=x;g=0;b=chroma;break;case 5:r=chroma;g=0;b=x;break;default:r=g=b=0}r=round$3(255*(r+AW));g=round$3(255*(g+AW));b=round$3(255*(b+AW))};var l=function(){var c=function(a){a=parseInt(a,10).toString(16);return a.length>1?a:'0'+a};return'#'+c(r)+c(g)+c(b)};var m=function(){return{r:r,g:g,b:b}};var n=function(){return j(r,g,b)};var o=function(a){var c;if(typeof a==='object'){if('r'in a){r=a.r;g=a.g;b=a.b}else if('v'in a){k(a.h,a.s,a.v)}}else{if(c=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)[^\)]*\)/gi.exec(a)){r=parseInt(c[1],10);g=parseInt(c[2],10);b=parseInt(c[3],10)}else if(c=/#([0-F]{2})([0-F]{2})([0-F]{2})/gi.exec(a)){r=parseInt(c[1],16);g=parseInt(c[2],16);b=parseInt(c[3],16)}else if(c=/#([0-F])([0-F])([0-F])/gi.exec(a)){r=parseInt(c[1]+c[1],16);g=parseInt(c[2]+c[2],16);b=parseInt(c[3]+c[3],16)}}r=r<0?0:r>255?255:r;g=g<0?0:g>255?255:g;b=b<0?0:b>255?255:b;return i};if(f){o(f)}i.toRgb=m;i.toHsv=n;i.toHex=l;i.parse=o;return i};var KD=function(o,c){var i,v,t,fc;c=c||'"';if(o===null){return'null'}t=typeof o;if(t==='string'){v='\bb\tt\nn\ff\rr""\'\'\\\\';return c+o.replace(/([\u0080-\uFFFF\x00-\x1f\"\'\\])/g,function(a,b){if(c==='"'&&a==='\''){return a}i=v.indexOf(b);if(i+1){return'\\'+v.charAt(i+1)}a=b.charCodeAt().toString(16);return'\\u'+'0000'.substring(a.length)+a})+c}if(t==='object'){if(o.hasOwnProperty&&Object.prototype.toString.call(o)==='[object Array]'){for(i=0,v='[';i<o.length;i++){v+=(i>0?',':'')+KD(o[i],c)}return v+']'}v='{';for(fc in o){if(o.hasOwnProperty(fc)){v+=typeof o[fc]!=='function'?(v.length>1?','+c:c)+fc+c+':'+KD(o[fc],c):''}}return v+'}'}return''+o};var KE={serialize:KD,parse:function(a){try{return JSON.parse(a)}catch(ex){}}};var KF={callbacks:{},count:0,send:function(b){var c=this,Cu=iQ.DOM,yw=b.count!==undefined?b.count:c.count;var d='tinymce_jsonp_'+yw;c.callbacks[yw]=function(a){Cu.remove(d);delete c.callbacks[yw];b.callback(a)};Cu.add(Cu.doc.body,'script',{id:d,src:b.url,type:'text/javascript'});c.count++}};var KG={send:function(b){var c,yw=0;var d=function(){if(!b.async||c.readyState===4||yw++>10000){if(b.success&&yw<10000&&c.status===200){b.success.call(b.success_scope,''+c.responseText,c,b)}else if(b.error){b.error.call(b.error_scope,yw>10000?'TIMED_OUT':'GENERAL',c,b)}c=null}else{setTimeout(d,10)}};b.scope=b.scope||this;b.success_scope=b.success_scope||b.scope;b.error_scope=b.error_scope||b.scope;b.async=b.async===false?false:true;b.data=b.data||'';KG.fire('beforeInitialize',{settings:b});c=XMLHttpRequest();if(c){if(c.overrideMimeType){c.overrideMimeType(b.content_type)}c.open(b.type||(b.data?'POST':'GET'),b.url,b.async);if(b.crossDomain){c.withCredentials=true}if(b.content_type){c.setRequestHeader('Content-Type',b.content_type)}if(b.requestheaders){dj.each(b.requestheaders,function(a){c.setRequestHeader(a.key,a.value)})}c.setRequestHeader('X-Requested-With','XMLHttpRequest');c=KG.fire('beforeSend',{xhr:c,settings:b}).xhr;c.send(b.data);if(!b.async){return d()}setTimeout(d,10)}}};dj.extend(KG,xa);var KH=dj.extend;var KI=function(a){this.settings=KH({},a);this.count=0};KI.sendRPC=function(o){return new KI().send(o)};KI.prototype={send:function(b){var d=b.error,scb=b.success;b=KH(this.settings,b);b.success=function(c,x){c=KE.parse(c);if(typeof c==='undefined'){c={error:'JSON Parse error.'}}if(c.error){d.call(b.error_scope||b.scope,c.error,x)}else{scb.call(b.success_scope||b.scope,c.result)}};b.error=function(a,x){if(d){d.call(b.error_scope||b.scope,a,x)}};b.data=KE.serialize({id:b.id||'c'+this.count++,method:b.method,params:b.params});b.content_type='application/json';KG.send(b)}};var KJ=function(){return function(){var c={};var d=[];var e={getItem:function(a){var b=c[a];return b?b:null},setItem:function(a,b){d.push(a);c[a]=String(b)},key:function(a){return d[a]},removeItem:function(a){d=d.filter(function(k){return k===a});delete c[a]},clear:function(){d=[];c={}},length:0};Object.defineProperty(e,'length',{get:function(){return d.length},configurable:false,enumerable:false});return e}()};var KK;try{KK=window.localStorage}catch(e){KK=KJ()}var KL=KK;var KM=Kl;var KN={geom:{Rect:Kv},util:{Promise:cq,Delay:cy,Tools:dj,VK:Ad,URI:Jf,Class:KA,EventDispatcher:wY,Observable:xa,I18n:Ka,XHR:KG,JSON:KE,JSONRequest:KI,JSONP:KF,LocalStorage:KL,Color:KC},dom:{EventUtils:cK,Sizzle:cL,DomQuery:dB,TreeWalker:TreeWalker,DOMUtils:iQ,ScriptLoader:iU,RangeUtils:Km,Serializer:Serializer$1,ControlSelection:Ds,BookmarkManager:Do,Selection:ED,Event:cK.Event},html:{Styles:Styles,Entities:hK,Node:CZ,Schema:Schema,SaxParser:An,DomParser:DomParser,Writer:Writer,Serializer:Serializer},ui:{Factory:Kx},Env:co,AddOnManager:AddOnManager,Annotator:Annotator,Formatter:Formatter,UndoManager:UndoManager,EditorCommands:EditorCommands,WindowManager:WindowManager,NotificationManager:NotificationManager,EditorObservable:xv,Shortcuts:Shortcuts,Editor:JF,FocusManager:JH,EditorManager:Kl,DOM:iQ.DOM,ScriptLoader:iU.ScriptLoader,PluginManager:AddOnManager.PluginManager,ThemeManager:AddOnManager.ThemeManager,trim:dj.trim,isArray:dj.isArray,is:dj.is,toArray:dj.toArray,makeMap:dj.makeMap,each:dj.each,map:dj.map,grep:dj.grep,inArray:dj.inArray,extend:dj.extend,create:dj.create,walk:dj.walk,createNS:dj.createNS,resolve:dj.resolve,explode:dj.explode,_addCacheSuffix:dj._addCacheSuffix,isOpera:co.opera,isWebKit:co.webkit,isIE:co.ie,isGecko:co.gecko,isMac:co.mac};KM=dj.extend(KM,KN);var KO=KM;var KP=function(a){if(typeof module==='object'){try{module.exports=a}catch(_){}}};var KQ=function(a){window.tinymce=a;window.tinyMCE=a};KQ(KO);KP(KO)}())})();!function(){"use strict";var t,n,e,r,a,o=function(t){var n=t,e=function(){return n};return{get:e,set:function(t){n=t},clone:function(){return o(e())}}},i=tinymce.util.Tools.resolve("tinymce.PluginManager"),f=function(t){return function(){return t}},u=f(!1),s=f(!0),c=u,l=s,d=function(){return g},g=(r={fold:function(t,n){return t()},is:c,isSome:c,isNone:l,getOr:e=function(t){return t},getOrThunk:n=function(t){return t()},getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:function(){return null},getOrUndefined:function(){return undefined},or:e,orThunk:n,map:d,ap:d,each:function(){},bind:d,flatten:d,exists:c,forall:l,filter:d,equals:t=function(t){return t.isNone()},equals_:t,toArray:function(){return[]},toString:f("none()")},Object.freeze&&Object.freeze(r),r),m=function(e){var t=function(){return e},n=function(){return a},r=function(t){return t(e)},a={fold:function(t,n){return n(e)},is:function(t){return e===t},isSome:l,isNone:c,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:n,orThunk:n,map:function(t){return m(t(e))},ap:function(t){return t.fold(d,function(t){return m(t(e))})},each:function(t){t(e)},bind:r,flatten:t,exists:r,forall:r,filter:function(t){return t(e)?a:g},equals:function(t){return t.is(e)},equals_:function(t,n){return t.fold(c,function(t){return n(e,t)})},toArray:function(){return[e]},toString:function(){return"some("+e+")"}};return a},h={some:m,none:d,from:function(t){return null===t||t===undefined?g:m(t)}},p=(a="function",function(t){return function(t){if(null===t)return"null";var n=typeof t;return"object"===n&&Array.prototype.isPrototypeOf(t)?"array":"object"===n&&String.prototype.isPrototypeOf(t)?"string":n}(t)===a}),v=function(t,n){for(var e=[],r=0,a=t.length;r<a;r++){var o=t[r];n(o,r,t)&&e.push(o)}return e},O=Array.prototype.slice,y=(p(Array.from)&&Array.from,Object.hasOwnProperty),P=function(t,n){return y.call(t,n)},x=function(t){return P(t,"start")&&P(t,"end")},T=function(t){return!P(t,"end")&&!P(t,"replacement")},b=function(t){return P(t,"replacement")},k=function(t){return n=t,e=function(t,n){return t.start.length===n.start.length?0:t.start.length>n.start.length?-1:1},(r=O.call(n,0)).sort(e),r;var n,e,r},C=function(t){return{inlinePatterns:k(v(t,x)),blockPatterns:k(v(t,T)),replacementPatterns:v(t,b)}},D=function(n){return{setPatterns:function(t){n.set(C(t))},getPatterns:function(){return n.get().inlinePatterns.concat(n.get().blockPatterns,n.get().replacementPatterns)}}},S=[{start:"*",end:"*",format:"italic"},{start:"**",end:"**",format:"bold"},{start:"***",end:"***",format:["bold","italic"]},{start:"#",format:"h1"},{start:"##",format:"h2"},{start:"###",format:"h3"},{start:"####",format:"h4"},{start:"#####",format:"h5"},{start:"######",format:"h6"},{start:"1. ",cmd:"InsertOrderedList"},{start:"* ",cmd:"InsertUnorderedList"},{start:"- ",cmd:"InsertUnorderedList"}],A=function(t){var n,e,r=(n=t,e="textpattern_patterns",P(n,e)?h.some(n[e]):h.none()).getOr(S);return C(r)},N=tinymce.util.Tools.resolve("tinymce.util.Delay"),R=tinymce.util.Tools.resolve("tinymce.util.VK"),I=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),j=tinymce.util.Tools.resolve("tinymce.util.Tools"),w=function(t,n){for(var e=0;e<t.length;e++){var r=t[e];if(0===n.indexOf(r.start)&&(!r.end||n.lastIndexOf(r.end)===n.length-r.end.length))return r}},E=function(t,n,e){if(!1!==n.collapsed){var r=n.startContainer,a=r.data,o=!0===e?1:0;if(3===r.nodeType){var i=function(t,n,e,r){var a,o,i,f,u,s;for(o=0;o<t.length;o++)if((a=t[o]).end!==undefined&&(f=a,u=e,s=r,n.substr(u-f.end.length-s,f.end.length)===f.end)&&0<e-r-(i=a).end.length-i.start.length)return a}(t,a,n.startOffset,o);if(i!==undefined){var f=a.lastIndexOf(i.end,n.startOffset-o),u=a.lastIndexOf(i.start,f-i.end.length);if(f=a.indexOf(i.end,u+i.start.length),-1!==u){var s=document.createRange();s.setStart(r,u),s.setEnd(r,f+i.end.length);var c=w(t,s.toString());if(!(i===undefined||c!==i||r.data.length<=i.start.length+i.end.length))return{pattern:i,startOffset:u,endOffset:f}}}}}},q=function(t){return t&&3===t.nodeType},L=function(t,n,e){var r=t.dom.createRng();r.setStart(n,e),r.setEnd(n,e),t.selection.setRng(r)},M=function(n,t,e){var r=n.selection.getRng();return h.from(E(t,r,e)).map(function(t){return function(a,o,i,f){var u=j.isArray(i.pattern.format)?i.pattern.format:[i.pattern.format];if(0!==j.grep(u,function(t){var n=a.formatter.get(t);return n&&n[0].inline}).length)return a.undoManager.transact(function(){var t,n,e,r;t=o,n=i.pattern,e=i.endOffset,r=i.startOffset,(t=0<r?t.splitText(r):t).splitText(e-r+n.end.length),t.deleteData(0,n.start.length),t.deleteData(t.data.length-n.end.length,n.end.length),o=t,f&&a.selection.setCursorLocation(o.nextSibling,1),u.forEach(function(t){a.formatter.apply(t,{},o)})}),o}(n,r.startContainer,t,e)})},U=function(s,t,c){var n=s.selection.getRng(),l=n.startContainer;n.collapsed&&q(l)&&function(t,n,e){for(var r=0;r<t.length;r++){var a=e.lastIndexOf(t[r].start,n);if(-1!==a)return h.some({pattern:t[r],startOffset:a})}return h.none()}(t,n.startOffset,l.data).each(function(t){var n,e,r,a,o,i,f,u=c?h.some((n=l,r=(e=t).startOffset+e.pattern.start.length,a=n.data.slice(r,r+1),n.deleteData(r,1),a)):h.none();o=s,f=t,(i=l).deleteData(f.startOffset,f.pattern.start.length),o.insertContent(f.pattern.replacement),h.from(i.nextSibling).filter(q).each(function(t){t.insertData(0,i.data),o.dom.remove(i)}),u.each(function(t){return function(t,n){var e=t.selection.getRng(),r=e.startContainer;if(q(r)){var a=e.startOffset;r.insertData(a,n),L(t,r,a+n.length)}else{var o=t.dom.doc.createTextNode(n);e.insertNode(o),L(t,o,o.length)}}(s,t)})})},_=function(t,n,e){for(var r=0;r<t.length;r++)if(e(t[r],n))return!0},z=function(t,n){var e,r,a,o;e=t,r=n.replacementPatterns,U(e,r,!1),a=t,o=n.inlinePatterns,M(a,o,!1).each(function(t){L(a,t,t.data.length)}),function(t,n){var e,r,a,o,i,f,u,s,c,l,d;if(e=t.selection,r=t.dom,e.isCollapsed()&&(u=r.getParent(e.getStart(),"p"))){for(c=new I(u,u);i=c.next();)if(q(i)){o=i;break}if(o){if(!(s=w(n,o.data)))return;if(a=(l=e.getRng(!0)).startContainer,d=l.startOffset,o===a&&(d=Math.max(0,d-s.start.length)),j.trim(o.data).length===s.start.length)return;s.format&&(f=t.formatter.get(s.format))&&f[0].block&&(o.deleteData(0,s.start.length),t.formatter.apply(s.format,{},o),l.setStart(a,d),l.collapse(!0),e.setRng(l)),s.cmd&&t.undoManager.transact(function(){o.deleteData(0,s.start.length),t.execCommand(s.cmd)})}}}(t,n.blockPatterns)},K=function(t,n){var e,r,a,o;e=t,r=n.replacementPatterns,U(e,r,!0),a=t,o=n.inlinePatterns,M(a,o,!0).each(function(t){var n=t.data.slice(-1);if(/[\u00a0 ]/.test(n)){t.deleteData(t.data.length-1,1);var e=a.dom.doc.createTextNode(n);a.dom.insertAfter(e,t.parentNode),L(a,e,1)}})},V=function(t,n){return _(t,n,function(t,n){return t.charCodeAt(0)===n.charCode})},W=function(t,n){return _(t,n,function(t,n){return t===n.keyCode&&!1===R.modifierPressed(n)})},B=function(n,e){var r=[",",".",";",":","!","?"],a=[32];n.on("keydown",function(t){13!==t.keyCode||R.modifierPressed(t)||z(n,e.get())},!0),n.on("keyup",function(t){W(a,t)&&K(n,e.get())}),n.on("keypress",function(t){V(r,t)&&N.setEditorTimeout(n,function(){K(n,e.get())})})};i.add("textpattern",function(t){var n=o(A(t.settings));return B(t,n),D(n)})}();!function(){"use strict";var t=tinymce.util.Tools.resolve("tinymce.PluginManager"),n=function(t,o){var r;return t.dom.getParents(t.selection.getStart(),function(t){var e;(e=t.style["forecolor"===o?"color":"background-color"])&&(r=r||e)}),r},g=function(t){var e,o=[];for(e=0;e<t.length;e+=2)o.push({text:t[e+1],color:"#"+t[e]});return o},r=function(t,e,o){t.undoManager.transact(function(){t.focus(),t.formatter.apply(e,{value:o}),t.nodeChanged()})},e=function(t,e){t.undoManager.transact(function(){t.focus(),t.formatter.remove(e,{value:null},null,!0),t.nodeChanged()})},o=function(o){o.addCommand("mceApplyTextcolor",function(t,e){r(o,t,e)}),o.addCommand("mceRemoveTextcolor",function(t){e(o,t)})},F=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),i=tinymce.util.Tools.resolve("tinymce.util.Tools"),a=["000000","Black","993300","Burnt orange","333300","Dark olive","003300","Dark green","003366","Dark azure","000080","Navy Blue","333399","Indigo","333333","Very dark gray","800000","Maroon","FF6600","Orange","808000","Olive","008000","Green","008080","Teal","0000FF","Blue","666699","Grayish blue","808080","Gray","FF0000","Red","FF9900","Amber","99CC00","Yellow green","339966","Sea green","33CCCC","Turquoise","3366FF","Royal blue","800080","Purple","999999","Medium gray","FF00FF","Magenta","FFCC00","Gold","FFFF00","Yellow","00FF00","Lime","00FFFF","Aqua","00CCFF","Sky blue","993366","Red violet","FFFFFF","White","FF99CC","Pink","FFCC99","Peach","FFFF99","Light yellow","CCFFCC","Pale green","CCFFFF","Pale cyan","99CCFF","Light sky blue","CC99FF","Plum"],l=function(t){return t.getParam("textcolor_map",a)},c=function(t){return t.getParam("textcolor_rows",5)},u=function(t){return t.getParam("textcolor_cols",8)},m=function(t){return t.getParam("color_picker_callback",null)},s=function(t){return t.getParam("forecolor_map",l(t))},d=function(t){return t.getParam("backcolor_map",l(t))},f=function(t){return t.getParam("forecolor_rows",c(t))},b=function(t){return t.getParam("backcolor_rows",c(t))},p=function(t){return t.getParam("forecolor_cols",u(t))},C=function(t){return t.getParam("backcolor_cols",u(t))},y=m,v=function(t){return"function"==typeof m(t)},h=tinymce.util.Tools.resolve("tinymce.util.I18n"),P=function(t,e,o,r){var n,a,l,c,i,u,m,s=0,d=F.DOM.uniqueId("mcearia"),f=function(t,e){var o="transparent"===t;return'<td class="mce-grid-cell'+(o?" mce-colorbtn-trans":"")+'"><div id="'+d+"-"+s+++'" data-mce-color="'+(t||"")+'" role="option" tabIndex="-1" style="'+(t?"background-color: "+t:"")+'" title="'+h.translate(e)+'">'+(o?"&#215;":"")+"</div></td>"};for((n=g(o)).push({text:h.translate("No color"),color:"transparent"}),l='<table class="mce-grid mce-grid-border mce-colorbutton-grid" role="list" cellspacing="0"><tbody>',c=n.length-1,u=0;u<e;u++){for(l+="<tr>",i=0;i<t;i++)l+=c<(m=u*t+i)?"<td></td>":f((a=n[m]).color,a.text);l+="</tr>"}if(r){for(l+='<tr><td colspan="'+t+'" class="mce-custom-color-btn"><div id="'+d+'-c" class="mce-widget mce-btn mce-btn-small mce-btn-flat" role="button" tabindex="-1" aria-labelledby="'+d+'-c" style="width: 100%"><button type="button" role="presentation" tabindex="-1">'+h.translate("Custom...")+"</button></div></td></tr>",l+="<tr>",i=0;i<t;i++)l+=f("","Custom color");l+="</tr>"}return l+="</tbody></table>"},k=function(t,e){t.style.background=e,t.setAttribute("data-mce-color",e)},x=function(o){return function(t){var e=t.control;e._color?o.execCommand("mceApplyTextcolor",e.settings.format,e._color):o.execCommand("mceRemoveTextcolor",e.settings.format)}},T=function(r,c){return function(t){var e,a=this.parent(),o=n(r,a.settings.format),l=function(t){r.execCommand("mceApplyTextcolor",a.settings.format,t),a.hidePanel(),a.color(t)};F.DOM.getParent(t.target,".mce-custom-color-btn")&&(a.hidePanel(),y(r).call(r,function(t){var e,o,r,n=a.panel.getEl().getElementsByTagName("table")[0];for(e=i.map(n.rows[n.rows.length-1].childNodes,function(t){return t.firstChild}),r=0;r<e.length&&(o=e[r]).getAttribute("data-mce-color");r++);if(r===c)for(r=0;r<c-1;r++)k(e[r],e[r+1].getAttribute("data-mce-color"));k(o,t),l(t)},o)),(e=t.target.getAttribute("data-mce-color"))?(this.lastId&&F.DOM.get(this.lastId).setAttribute("aria-selected","false"),t.target.setAttribute("aria-selected",!0),this.lastId=t.target.id,"transparent"===e?(r.execCommand("mceRemoveTextcolor",a.settings.format),a.hidePanel(),a.resetColor()):l(e)):null!==e&&a.hidePanel()}},_=function(n,a){return function(){var t=a?p(n):C(n),e=a?f(n):b(n),o=a?s(n):d(n),r=v(n);return P(t,e,o,r)}},A=function(t){t.addButton("forecolor",{type:"colorbutton",tooltip:"Text color",format:"forecolor",panel:{role:"application",ariaRemember:!0,html:_(t,!0),onclick:T(t,p(t))},onclick:x(t)}),t.addButton("backcolor",{type:"colorbutton",tooltip:"Background color",format:"hilitecolor",panel:{role:"application",ariaRemember:!0,html:_(t,!1),onclick:T(t,C(t))},onclick:x(t)})};t.add("textcolor",function(t){o(t),A(t)})}();!function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager"),o=tinymce.util.Tools.resolve("tinymce.util.Tools"),c=tinymce.util.Tools.resolve("tinymce.util.XHR"),t=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),i=function(e){return e.getParam("template_cdate_classes","cdate")},s=function(e){return e.getParam("template_mdate_classes","mdate")},u=function(e){return e.getParam("template_selected_content_classes","selcontent")},p=function(e){return e.getParam("template_preview_replace_values")},m=function(e){return e.getParam("template_replace_values")},a=function(e){return e.templates},d=function(e){return e.getParam("template_cdate_format",e.getLang("template.cdate_format"))},f=function(e){return e.getParam("template_mdate_format",e.getLang("template.mdate_format"))},g=function(e){return e.getParam("template_popup_width",600)},h=function(e){return Math.min(t.DOM.getViewPort().h,e.getParam("template_popup_height",500))},y=function(e,t){if((e=""+e).length<t)for(var n=0;n<t-e.length;n++)e="0"+e;return e},v=function(e,t,n){var a="Sun Mon Tue Wed Thu Fri Sat Sun".split(" "),r="Sunday Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" "),l="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),c="January February March April May June July August September October November December".split(" ");return n=n||new Date,t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace("%D","%m/%d/%Y")).replace("%r","%I:%M:%S %p")).replace("%Y",""+n.getFullYear())).replace("%y",""+n.getYear())).replace("%m",y(n.getMonth()+1,2))).replace("%d",y(n.getDate(),2))).replace("%H",""+y(n.getHours(),2))).replace("%M",""+y(n.getMinutes(),2))).replace("%S",""+y(n.getSeconds(),2))).replace("%I",""+((n.getHours()+11)%12+1))).replace("%p",n.getHours()<12?"AM":"PM")).replace("%B",""+e.translate(c[n.getMonth()]))).replace("%b",""+e.translate(l[n.getMonth()]))).replace("%A",""+e.translate(r[n.getDay()]))).replace("%a",""+e.translate(a[n.getDay()]))).replace("%%","%")},M=function(e,n,t){return o.each(t,function(e,t){"function"==typeof e&&(e=e(t)),n=n.replace(new RegExp("\\{\\$"+t+"\\}","g"),e)}),n},_=function(e,t){var a=e.dom,r=m(e);o.each(a.select("*",t),function(n){o.each(r,function(e,t){a.hasClass(n,t)&&"function"==typeof r[t]&&r[t](n)})})},b=function(e,t){return new RegExp("\\b"+t+"\\b","g").test(e.className)},n=function(t,n){return function(){var e=a(t);"function"!=typeof e?"string"==typeof e?c.send({url:e,success:function(e){n(JSON.parse(e))}}):n(e):e(n)}},T=M,r=_,x=function(t,e,n){var a,r,l=t.dom,c=t.selection.getContent();n=M(0,n,m(t)),a=l.create("div",null,n),(r=l.select(".mceTmpl",a))&&0<r.length&&(a=l.create("div",null)).appendChild(r[0].cloneNode(!0)),o.each(l.select("*",a),function(e){b(e,i(t).replace(/\s+/g,"|"))&&(e.innerHTML=v(t,d(t))),b(e,s(t).replace(/\s+/g,"|"))&&(e.innerHTML=v(t,f(t))),b(e,u(t).replace(/\s+/g,"|"))&&(e.innerHTML=c)}),_(t,a),t.execCommand("mceInsertContent",!1,a.innerHTML),t.addVisual()},l=function(e){e.addCommand("mceInsertTemplate",function(a){for(var r=[],e=1;e<arguments.length;e++)r[e-1]=arguments[e];return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=r.concat(e);return a.apply(null,n)}}(x,e))},P=function(a){a.on("PreProcess",function(e){var t=a.dom,n=f(a);o.each(t.select("div",e.node),function(e){t.hasClass(e,"mceTmpl")&&(o.each(t.select("*",e),function(e){t.hasClass(e,a.getParam("template_mdate_classes","mdate").replace(/\s+/g,"|"))&&(e.innerHTML=v(a,n))}),r(a,e))})})},S=function(t,e,n){if(-1===n.indexOf("<html>")){var a="";o.each(t.contentCSS,function(e){a+='<link type="text/css" rel="stylesheet" href="'+t.documentBaseURI.toAbsolute(e)+'">'});var r=t.settings.body_class||"";-1!==r.indexOf("=")&&(r=(r=t.getParam("body_class","","hash"))[t.id]||""),n="<!DOCTYPE html><html><head>"+a+'</head><body class="'+r+'">'+n+"</body></html>"}n=T(t,n,p(t));var l=e.find("iframe")[0].getEl().contentWindow.document;l.open(),l.write(n),l.close()},D=function(n,e){var a,r,t=[];if(e&&0!==e.length)o.each(e,function(e){t.push({selected:!t.length,text:e.title,value:{url:e.url,content:e.content,description:e.description}})}),(a=n.windowManager.open({title:"Insert template",layout:"flex",direction:"column",align:"stretch",padding:15,spacing:10,items:[{type:"form",flex:0,padding:0,items:[{type:"container",label:"Templates",items:{type:"listbox",label:"Templates",name:"template",values:t,onselect:function(e){var t=e.control.value();t.url?c.send({url:t.url,success:function(e){S(n,a,r=e)}}):(r=t.content,S(n,a,r)),a.find("#description")[0].text(e.control.value().description)}}}]},{type:"label",name:"description",label:"Description",text:"\xa0"},{type:"iframe",flex:1,border:1}],onsubmit:function(){x(n,!1,r)},minWidth:g(n),minHeight:h(n)})).find("listbox")[0].fire("select");else{var l=n.translate("No templates defined.");n.notificationManager.open({text:l,type:"info"})}},H=function(t){return function(e){D(t,e)}},w=function(e){e.addButton("template",{title:"Insert template",onclick:n(e.settings,H(e))}),e.addMenuItem("template",{text:"Template",onclick:n(e.settings,H(e)),icon:"template",context:"insert"})};e.add("template",function(e){w(e),l(e),P(e)})}();!function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager"),y=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},x=function(n,r){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n(r.apply(null,e))}},C=function(e){return function(){return e}},o=function(e){return e};function b(r){for(var o=[],e=1;e<arguments.length;e++)o[e-1]=arguments[e];return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=o.concat(e);return r.apply(null,n)}}var t,n,r,i,u,m=function(n){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return!n.apply(null,e)}},c=function(e){return e()},a=C(!1),l=C(!0),f=a,s=l,d=function(){return g},g=(i={fold:function(e,t){return e()},is:f,isSome:f,isNone:s,getOr:r=function(e){return e},getOrThunk:n=function(e){return e()},getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:function(){return null},getOrUndefined:function(){return undefined},or:r,orThunk:n,map:d,ap:d,each:function(){},bind:d,flatten:d,exists:f,forall:s,filter:d,equals:t=function(e){return e.isNone()},equals_:t,toArray:function(){return[]},toString:C("none()")},Object.freeze&&Object.freeze(i),i),h=function(n){var e=function(){return n},t=function(){return o},r=function(e){return e(n)},o={fold:function(e,t){return t(n)},is:function(e){return n===e},isSome:s,isNone:f,getOr:e,getOrThunk:e,getOrDie:e,getOrNull:e,getOrUndefined:e,or:t,orThunk:t,map:function(e){return h(e(n))},ap:function(e){return e.fold(d,function(e){return h(e(n))})},each:function(e){e(n)},bind:r,flatten:e,exists:r,forall:r,filter:function(e){return e(n)?o:g},equals:function(e){return e.is(n)},equals_:function(e,t){return e.fold(f,function(e){return t(n,e)})},toArray:function(){return[n]},toString:function(){return"some("+n+")"}};return o},R={some:h,none:d,from:function(e){return null===e||e===undefined?g:h(e)}},p=function(t){return function(e){return function(e){if(null===e)return"null";var t=typeof e;return"object"===t&&Array.prototype.isPrototypeOf(e)?"array":"object"===t&&String.prototype.isPrototypeOf(e)?"string":t}(e)===t}},v=p("string"),w=p("array"),S=p("boolean"),T=p("function"),D=p("number"),O=(u=Array.prototype.indexOf)===undefined?function(e,t){return _(e,t)}:function(e,t){return u.call(e,t)},k=function(e,t){return-1<O(e,t)},N=function(e,t){return M(e,t).isSome()},E=function(e,t){for(var n=e.length,r=new Array(n),o=0;o<n;o++){var i=e[o];r[o]=t(i,o,e)}return r},A=function(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n],n,e)},P=function(e,t){for(var n=[],r=0,o=e.length;r<o;r++){var i=e[r];t(i,r,e)&&n.push(i)}return n},I=function(e,t,n){return function(e,t){for(var n=e.length-1;0<=n;n--)t(e[n],n,e)}(e,function(e){n=t(n,e)}),n},B=function(e,t,n){return A(e,function(e){n=t(n,e)}),n},W=function(e,t){for(var n=0,r=e.length;n<r;n++){var o=e[n];if(t(o,n,e))return R.some(o)}return R.none()},M=function(e,t){for(var n=0,r=e.length;n<r;n++)if(t(e[n],n,e))return R.some(n);return R.none()},_=function(e,t){for(var n=0,r=e.length;n<r;++n)if(e[n]===t)return n;return-1},L=Array.prototype.push,j=function(e){for(var t=[],n=0,r=e.length;n<r;++n){if(!Array.prototype.isPrototypeOf(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);L.apply(t,e[n])}return t},F=function(e,t){var n=E(e,t);return j(n)},z=function(e,t){for(var n=0,r=e.length;n<r;++n)if(!0!==t(e[n],n,e))return!1;return!0},H=Array.prototype.slice,U=function(e){var t=H.call(e,0);return t.reverse(),t},q=(T(Array.from)&&Array.from,Object.keys),V=function(e,t){for(var n=q(e),r=0,o=n.length;r<o;r++){var i=n[r];t(e[i],i,e)}},G=function(e,r){return Y(e,function(e,t,n){return{k:t,v:r(e,t,n)}})},Y=function(r,o){var i={};return V(r,function(e,t){var n=o(e,t,r);i[n.k]=n.v}),i},X=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];if(t.length!==n.length)throw new Error('Wrong number of arguments to struct. Expected "['+t.length+']", got '+n.length+" arguments");var r={};return A(t,function(e,t){r[e]=C(n[t])}),r}},K=function(e){return e.slice(0).sort()},J=function(e,t){throw new Error("All required keys ("+K(e).join(", ")+") were not specified. Specified keys were: "+K(t).join(", ")+".")},$=function(e){throw new Error("Unsupported keys for object: "+K(e).join(", "))},Q=function(t,e){if(!w(e))throw new Error("The "+t+" fields must be an array. Was: "+e+".");A(e,function(e){if(!v(e))throw new Error("The value "+e+" in the "+t+" fields was not a string.")})},Z=function(e){var n=K(e);W(n,function(e,t){return t<n.length-1&&e===n[t+1]}).each(function(e){throw new Error("The field: "+e+" occurs more than once in the combined fields: ["+n.join(", ")+"].")})},ee=function(o,i){var u=o.concat(i);if(0===u.length)throw new Error("You must specify at least one required or optional field.");return Q("required",o),Q("optional",i),Z(u),function(t){var n=q(t);z(o,function(e){return k(n,e)})||J(o,n);var e=P(n,function(e){return!k(u,e)});0<e.length&&$(e);var r={};return A(o,function(e){r[e]=C(t[e])}),A(i,function(e){r[e]=C(Object.prototype.hasOwnProperty.call(t,e)?R.some(t[e]):R.none())}),r}},te=X("width","height"),ne=X("rows","columns"),re=X("row","column"),oe=X("x","y"),ie=X("element","rowspan","colspan"),ue=X("element","rowspan","colspan","isNew"),ae={dimensions:te,grid:ne,address:re,coords:oe,extended:X("element","rowspan","colspan","row","column"),detail:ie,detailnew:ue,rowdata:X("element","cells","section"),elementnew:X("element","isNew"),rowdatanew:X("element","cells","section","isNew"),rowcells:X("cells","section"),rowdetails:X("details","section"),bounds:X("startRow","startCol","finishRow","finishCol")},ce=function(e){if(null===e||e===undefined)throw new Error("Node cannot be null or undefined");return{dom:C(e)}},le={fromHtml:function(e,t){var n=(t||document).createElement("div");if(n.innerHTML=e,!n.hasChildNodes()||1<n.childNodes.length)throw console.error("HTML does not have a single root node",e),"HTML must have a single root node";return ce(n.childNodes[0])},fromTag:function(e,t){var n=(t||document).createElement(e);return ce(n)},fromText:function(e,t){var n=(t||document).createTextNode(e);return ce(n)},fromDom:ce,fromPoint:function(e,t,n){var r=e.dom();return R.from(r.elementFromPoint(t,n)).map(ce)}},fe=(Node.ATTRIBUTE_NODE,Node.CDATA_SECTION_NODE,Node.COMMENT_NODE),se=Node.DOCUMENT_NODE,de=(Node.DOCUMENT_TYPE_NODE,Node.DOCUMENT_FRAGMENT_NODE,Node.ELEMENT_NODE),me=Node.TEXT_NODE,ge=(Node.PROCESSING_INSTRUCTION_NODE,Node.ENTITY_REFERENCE_NODE,Node.ENTITY_NODE,Node.NOTATION_NODE,de),he=se,pe=function(e,t){var n=e.dom();if(n.nodeType!==ge)return!1;if(n.matches!==undefined)return n.matches(t);if(n.msMatchesSelector!==undefined)return n.msMatchesSelector(t);if(n.webkitMatchesSelector!==undefined)return n.webkitMatchesSelector(t);if(n.mozMatchesSelector!==undefined)return n.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},ve=function(e){return e.nodeType!==ge&&e.nodeType!==he||0===e.childElementCount},be="undefined"!=typeof window?window:Function("return this;")(),we=function(e,t){return function(e,t){for(var n=t!==undefined&&null!==t?t:be,r=0;r<e.length&&n!==undefined&&null!==n;++r)n=n[e[r]];return n}(e.split("."),t)},ye=function(e,t){var n=we(e,t);if(n===undefined||null===n)throw e+" not available on this browser";return n},xe=function(){return ye("Node")},Ce=function(e,t,n){return 0!=(e.compareDocumentPosition(t)&n)},Re=function(e,t){return Ce(e,t,xe().DOCUMENT_POSITION_CONTAINED_BY)},Se=function(n){var r,o=!1;return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o||(o=!0,r=n.apply(null,e)),r}},Te=function(e,t){var n=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r.test(t))return r}return undefined}(e,t);if(!n)return{major:0,minor:0};var r=function(e){return Number(t.replace(n,"$"+e))};return Oe(r(1),r(2))},De=function(){return Oe(0,0)},Oe=function(e,t){return{major:e,minor:t}},ke={nu:Oe,detect:function(e,t){var n=String(t).toLowerCase();return 0===e.length?De():Te(e,n)},unknown:De},Ne="Firefox",Ee=function(e,t){return function(){return t===e}},Ae=function(e){var t=e.current;return{current:t,version:e.version,isEdge:Ee("Edge",t),isChrome:Ee("Chrome",t),isIE:Ee("IE",t),isOpera:Ee("Opera",t),isFirefox:Ee(Ne,t),isSafari:Ee("Safari",t)}},Pe={unknown:function(){return Ae({current:undefined,version:ke.unknown()})},nu:Ae,edge:C("Edge"),chrome:C("Chrome"),ie:C("IE"),opera:C("Opera"),firefox:C(Ne),safari:C("Safari")},Ie="Windows",Be="Android",We="Solaris",Me="FreeBSD",_e=function(e,t){return function(){return t===e}},Le=function(e){var t=e.current;return{current:t,version:e.version,isWindows:_e(Ie,t),isiOS:_e("iOS",t),isAndroid:_e(Be,t),isOSX:_e("OSX",t),isLinux:_e("Linux",t),isSolaris:_e(We,t),isFreeBSD:_e(Me,t)}},je={unknown:function(){return Le({current:undefined,version:ke.unknown()})},nu:Le,windows:C(Ie),ios:C("iOS"),android:C(Be),linux:C("Linux"),osx:C("OSX"),solaris:C(We),freebsd:C(Me)},Fe=function(e,t){var n=String(t).toLowerCase();return W(e,function(e){return e.search(n)})},ze=function(e,n){return Fe(e,n).map(function(e){var t=ke.detect(e.versionRegexes,n);return{current:e.name,version:t}})},He=function(e,n){return Fe(e,n).map(function(e){var t=ke.detect(e.versionRegexes,n);return{current:e.name,version:t}})},Ue=function(e,t){return-1!==e.indexOf(t)},qe=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Ve=function(t){return function(e){return Ue(e,t)}},Ge=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return Ue(e,"edge/")&&Ue(e,"chrome")&&Ue(e,"safari")&&Ue(e,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,qe],search:function(e){return Ue(e,"chrome")&&!Ue(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return Ue(e,"msie")||Ue(e,"trident")}},{name:"Opera",versionRegexes:[qe,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Ve("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Ve("firefox")},{name:"Safari",versionRegexes:[qe,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(Ue(e,"safari")||Ue(e,"mobile/"))&&Ue(e,"applewebkit")}}],Ye=[{name:"Windows",search:Ve("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return Ue(e,"iphone")||Ue(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Ve("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:Ve("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Ve("linux"),versionRegexes:[]},{name:"Solaris",search:Ve("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Ve("freebsd"),versionRegexes:[]}],Xe={browsers:C(Ge),oses:C(Ye)},Ke=function(e){var t,n,r,o,i,u,a,c,l,f,s,d=Xe.browsers(),m=Xe.oses(),g=ze(d,e).fold(Pe.unknown,Pe.nu),h=He(m,e).fold(je.unknown,je.nu);return{browser:g,os:h,deviceType:(n=g,r=e,o=(t=h).isiOS()&&!0===/ipad/i.test(r),i=t.isiOS()&&!o,u=t.isAndroid()&&3===t.version.major,a=t.isAndroid()&&4===t.version.major,c=o||u||a&&!0===/mobile/i.test(r),l=t.isiOS()||t.isAndroid(),f=l&&!c,s=n.isSafari()&&t.isiOS()&&!1===/safari/i.test(r),{isiPad:C(o),isiPhone:C(i),isTablet:C(c),isPhone:C(f),isTouch:C(l),isAndroid:t.isAndroid,isiOS:t.isiOS,isWebView:C(s)})}},Je={detect:Se(function(){var e=navigator.userAgent;return Ke(e)})},$e=function(e,t){return e.dom()===t.dom()},Qe=Je.detect().browser.isIE()?function(e,t){return Re(e.dom(),t.dom())}:function(e,t){var n=e.dom(),r=t.dom();return n!==r&&n.contains(r)},Ze=pe,et=function(e){return le.fromDom(e.dom().ownerDocument)},tt=function(e){var t=e.dom();return R.from(t.parentNode).map(le.fromDom)},nt=function(e,t){for(var n=T(t)?t:C(!1),r=e.dom(),o=[];null!==r.parentNode&&r.parentNode!==undefined;){var i=r.parentNode,u=le.fromDom(i);if(o.push(u),!0===n(u))break;r=i}return o},rt=function(e){var t=e.dom();return R.from(t.previousSibling).map(le.fromDom)},ot=function(e){var t=e.dom();return R.from(t.nextSibling).map(le.fromDom)},it=function(e){var t=e.dom();return E(t.childNodes,le.fromDom)},ut=function(e,t){var n=e.dom().childNodes;return R.from(n[t]).map(le.fromDom)},at=(X("element","offset"),function(e,t,n){return F(it(e),function(e){return pe(e,t)?n(e)?[e]:[]:at(e,t,n)})}),ct={firstLayer:function(e,t){return at(e,t,C(!0))},filterFirstLayer:at},lt=function(e){return e.dom().nodeName.toLowerCase()},ft=function(e){return e.dom().nodeType},st=function(t){return function(e){return ft(e)===t}},dt=function(e){return ft(e)===fe||"#comment"===lt(e)},mt=st(de),gt=st(me),ht=st(se),pt=function(e,t,n){if(!(v(n)||S(n)||D(n)))throw console.error("Invalid call to Attr.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,n+"")},vt=function(e,t,n){pt(e.dom(),t,n)},bt=function(e,t){var n=e.dom();V(t,function(e,t){pt(n,t,e)})},wt=function(e,t){var n=e.dom().getAttribute(t);return null===n?undefined:n},yt=function(e,t){var n=e.dom();return!(!n||!n.hasAttribute)&&n.hasAttribute(t)},xt=function(e,t){e.dom().removeAttribute(t)},Ct=function(e){return B(e.dom().attributes,function(e,t){return e[t.name]=t.value,e},{})},Rt=function(e){var t=gt(e)?e.dom().parentNode:e.dom();return t!==undefined&&null!==t&&t.ownerDocument.body.contains(t)},St=Se(function(){return Tt(le.fromDom(document))}),Tt=function(e){var t=e.dom().body;if(null===t||t===undefined)throw"Body is not available yet";return le.fromDom(t)},Dt=function(e,t){var n=[];return A(it(e),function(e){t(e)&&(n=n.concat([e])),n=n.concat(Dt(e,t))}),n},Ot=function(e,t,n){return r=function(e){return pe(e,t)},P(nt(e,n),r);var r},kt=function(e,t){return n=function(e){return pe(e,t)},P(it(e),n);var n},Nt=function(e,t){return n=t,o=(r=e)===undefined?document:r.dom(),ve(o)?[]:E(o.querySelectorAll(n),le.fromDom);var n,r,o};function Et(e,t,n,r,o){return e(n,r)?R.some(n):T(o)&&o(n)?R.none():t(n,r,o)}var At,Pt,It,Bt,Wt,Mt=function(e,t,n){for(var r=e.dom(),o=T(n)?n:C(!1);r.parentNode;){r=r.parentNode;var i=le.fromDom(r);if(t(i))return R.some(i);if(o(i))break}return R.none()},_t=function(e,t,n){return Mt(e,function(e){return pe(e,t)},n)},Lt=function(e,t){return n=function(e){return pe(e,t)},W(e.dom().childNodes,x(n,le.fromDom)).map(le.fromDom);var n},jt=function(e,t){return n=t,o=(r=e)===undefined?document:r.dom(),ve(o)?R.none():R.from(o.querySelector(n)).map(le.fromDom);var n,r,o},Ft=function(e,t,n){return Et(pe,_t,e,t,n)},zt=function(e,t,n){var r=n!==undefined?n:C(!1);return r(t)?R.none():k(e,lt(t))?R.some(t):_t(t,e.join(","),function(e){return pe(e,"table")||r(e)})},Ht=function(t,e){return tt(e).map(function(e){return kt(e,t)})},Ut=b(Ht,"th,td"),qt=b(Ht,"tr"),Vt=function(e,t){return parseInt(wt(e,t),10)},Gt={cell:function(e,t){return zt(["td","th"],e,t)},firstCell:function(e){return jt(e,"th,td")},cells:function(e){return ct.firstLayer(e,"th,td")},neighbourCells:Ut,table:function(e,t){return Ft(e,"table",t)},row:function(e,t){return zt(["tr"],e,t)},rows:function(e){return ct.firstLayer(e,"tr")},notCell:function(e,t){return zt(["caption","tr","tbody","tfoot","thead"],e,t)},neighbourRows:qt,attr:Vt,grid:function(e,t,n){var r=Vt(e,t),o=Vt(e,n);return ae.grid(r,o)}},Yt=function(e){var t=Gt.rows(e);return E(t,function(e){var t=e,n=tt(t).map(function(e){var t=lt(e);return"tfoot"===t||"thead"===t||"tbody"===t?t:"tbody"}).getOr("tbody"),r=E(Gt.cells(e),function(e){var t=yt(e,"rowspan")?parseInt(wt(e,"rowspan"),10):1,n=yt(e,"colspan")?parseInt(wt(e,"colspan"),10):1;return ae.detail(e,t,n)});return ae.rowdata(t,r,n)})},Xt=function(e,n){return E(e,function(e){var t=E(Gt.cells(e),function(e){var t=yt(e,"rowspan")?parseInt(wt(e,"rowspan"),10):1,n=yt(e,"colspan")?parseInt(wt(e,"colspan"),10):1;return ae.detail(e,t,n)});return ae.rowdata(e,t,n.section())})},Kt=function(e,t){return e+","+t},Jt=function(e,t){var n=F(e.all(),function(e){return e.cells()});return P(n,t)},$t={generate:function(e){var f={},t=[],n=e.length,s=0;A(e,function(e,c){var l=[];A(e.cells(),function(e,t){for(var n=0;f[Kt(c,n)]!==undefined;)n++;for(var r=ae.extended(e.element(),e.rowspan(),e.colspan(),c,n),o=0;o<e.colspan();o++)for(var i=0;i<e.rowspan();i++){var u=n+o,a=Kt(c+i,u);f[a]=r,s=Math.max(s,u+1)}l.push(r)}),t.push(ae.rowdata(e.element(),l,e.section()))});var r=ae.grid(n,s);return{grid:C(r),access:C(f),all:C(t)}},getAt:function(e,t,n){var r=e.access()[Kt(t,n)];return r!==undefined?R.some(r):R.none()},findItem:function(e,t,n){var r=Jt(e,function(e){return n(t,e.element())});return 0<r.length?R.some(r[0]):R.none()},filterItems:Jt,justCells:function(e){var t=E(e.all(),function(e){return e.cells()});return j(t)}},Qt=function(e){return e.style!==undefined},Zt=function(e,t,n){if(!v(n))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",n,":: Element ",e),new Error("CSS value must be a string: "+n);Qt(e)&&e.style.setProperty(t,n)},en=function(e,t,n){var r=e.dom();Zt(r,t,n)},tn=function(e,t){var n=e.dom();V(t,function(e,t){Zt(n,t,e)})},nn=function(e,t){var n=e.dom(),r=window.getComputedStyle(n).getPropertyValue(t),o=""!==r||Rt(e)?r:rn(n,t);return null===o?undefined:o},rn=function(e,t){return Qt(e)?e.style.getPropertyValue(t):""},on=function(e,t){var n=e.dom(),r=rn(n,t);return R.from(r).filter(function(e){return 0<e.length})},un=function(e,t){var n,r,o=e.dom();r=t,Qt(n=o)&&n.style.removeProperty(r),yt(e,"style")&&""===wt(e,"style").replace(/^\s+|\s+$/g,"")&&xt(e,"style")},an=function(t,n){tt(t).each(function(e){e.dom().insertBefore(n.dom(),t.dom())})},cn=function(e,t){ot(e).fold(function(){tt(e).each(function(e){fn(e,t)})},function(e){an(e,t)})},ln=function(t,n){ut(t,0).fold(function(){fn(t,n)},function(e){t.dom().insertBefore(n.dom(),e.dom())})},fn=function(e,t){e.dom().appendChild(t.dom())},sn=function(e,t){an(e,t),fn(t,e)},dn=function(r,o){A(o,function(e,t){var n=0===t?r:o[t-1];cn(n,e)})},mn=function(t,e){A(e,function(e){fn(t,e)})},gn=function(e){e.dom().textContent="",A(it(e),function(e){hn(e)})},hn=function(e){var t=e.dom();null!==t.parentNode&&t.parentNode.removeChild(t)},pn=function(e){var t,n=it(e);0<n.length&&(t=e,A(n,function(e){an(t,e)})),hn(e)},vn=X("minRow","minCol","maxRow","maxCol"),bn=function(e,t){var n,i,r,u,a,c,l,o,f,s,d=function(e){return pe(e.element(),t)},m=Yt(e),g=$t.generate(m),h=(i=d,r=(n=g).grid().columns(),u=n.grid().rows(),a=r,l=c=0,V(n.access(),function(e){if(i(e)){var t=e.row(),n=t+e.rowspan()-1,r=e.column(),o=r+e.colspan()-1;t<u?u=t:c<n&&(c=n),r<a?a=r:l<o&&(l=o)}}),vn(u,a,c,l)),p="th:not("+t+"),td:not("+t+")",v=ct.filterFirstLayer(e,"th,td",function(e){return pe(e,p)});return A(v,hn),function(e,t,n,r){for(var o,i,u,a=t.grid().columns(),c=t.grid().rows(),l=0;l<c;l++)for(var f=!1,s=0;s<a;s++)l<n.minRow()||l>n.maxRow()||s<n.minCol()||s>n.maxCol()||($t.getAt(t,l,s).filter(r).isNone()?(o=f,i=e[l].element(),u=le.fromTag("td"),fn(u,le.fromTag("br")),(o?fn:ln)(i,u)):f=!0)}(m,g,h,d),o=e,f=h,s=P(ct.firstLayer(o,"tr"),function(e){return 0===e.dom().childElementCount}),A(s,hn),f.minCol()!==f.maxCol()&&f.minRow()!==f.maxRow()||A(ct.firstLayer(o,"th,td"),function(e){xt(e,"rowspan"),xt(e,"colspan")}),xt(o,"width"),xt(o,"height"),un(o,"width"),un(o,"height"),e},wn=function(e,t){return le.fromDom(e.dom().cloneNode(t))},yn=function(e){return wn(e,!1)},xn=function(e){return wn(e,!0)},Cn=function(e,t){var n,r,o,i,u=(n=e,r=t,o=le.fromTag(r),i=Ct(n),bt(o,i),o),a=it(xn(e));return mn(u,a),u},Rn=(At=gt,Pt="text",It=function(e){return At(e)?R.from(e.dom().nodeValue):R.none()},Bt=Je.detect().browser,{get:function(e){if(!At(e))throw new Error("Can only get "+Pt+" value of a "+Pt+" node");return Wt(e).getOr("")},getOption:Wt=Bt.isIE()&&10===Bt.version.major?function(e){try{return It(e)}catch(t){return R.none()}}:It,set:function(e,t){if(!At(e))throw new Error("Can only set raw "+Pt+" value of a "+Pt+" node");e.dom().nodeValue=t}}),Sn=function(e){return Rn.get(e)},Tn=function(e){return Rn.getOption(e)},Dn=function(e,t){Rn.set(e,t)},On=function(e){return"img"===lt(e)?1:Tn(e).fold(function(){return it(e).length},function(e){return e.length})},kn=["img","br"],Nn=function(e){return Tn(e).filter(function(e){return 0!==e.trim().length||-1<e.indexOf("\xa0")}).isSome()||k(kn,lt(e))},En=function(e){return r=Nn,(o=function(e){for(var t=0;t<e.childNodes.length;t++){if(r(le.fromDom(e.childNodes[t])))return R.some(le.fromDom(e.childNodes[t]));var n=o(e.childNodes[t]);if(n.isSome())return n}return R.none()})(e.dom());var r,o},An=function(e){return Pn(e,Nn)},Pn=function(e,i){var u=function(e){for(var t=it(e),n=t.length-1;0<=n;n--){var r=t[n];if(i(r))return R.some(r);var o=u(r);if(o.isSome())return o}return R.none()};return u(e)},In=function(){var e=le.fromTag("td");return fn(e,le.fromTag("br")),e},Bn=function(e,t,n){var r=Cn(e,t);return V(n,function(e,t){null===e?xt(r,t):vt(r,t,e)}),r},Wn=function(e){return e},Mn=function(e){return function(){return le.fromTag("tr",e.dom())}},_n=function(d,e,m){return{row:Mn(e),cell:function(e){var r,o,i,t,n,u,a,c=et(e.element()),l=le.fromTag(lt(e.element()),c.dom()),f=m.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),s=0<f.length?(r=e.element(),o=l,i=f,En(r).map(function(e){var t=i.join(","),n=Ot(e,t,function(e){return $e(e,r)});return I(n,function(e,t){var n=yn(t);return xt(n,"contenteditable"),fn(e,n),n},o)}).getOr(o)):l;return fn(s,le.fromTag("br")),t=e.element(),n=l,u=t.dom(),a=n.dom(),Qt(u)&&Qt(a)&&(a.style.cssText=u.style.cssText),un(l,"height"),1!==e.colspan()&&un(e.element(),"width"),d(e.element(),l),l},replace:Bn,gap:In}},Ln=function(e){return{row:Mn(e),cell:In,replace:Wn,gap:In}},jn=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];function Fn(){return{up:C({selector:_t,closest:Ft,predicate:Mt,all:nt}),down:C({selector:Nt,predicate:Dt}),styles:C({get:nn,getRaw:on,set:en,remove:un}),attrs:C({get:wt,set:vt,remove:xt,copyTo:function(e,t){var n=Ct(e);bt(t,n)}}),insert:C({before:an,after:cn,afterAll:dn,append:fn,appendAll:mn,prepend:ln,wrap:sn}),remove:C({unwrap:pn,remove:hn}),create:C({nu:le.fromTag,clone:function(e){return le.fromDom(e.dom().cloneNode(!1))},text:le.fromText}),query:C({comparePosition:function(e,t){return e.dom().compareDocumentPosition(t.dom())},prevSibling:rt,nextSibling:ot}),property:C({children:it,name:lt,parent:tt,isText:gt,isComment:dt,isElement:mt,getText:Sn,setText:Dn,isBoundary:function(e){return!!mt(e)&&("body"===lt(e)||k(jn,lt(e)))},isEmptyTag:function(e){return!!mt(e)&&k(["br","img","hr","input"],lt(e))}}),eq:$e,is:Ze}}var zn=X("left","right"),Hn=function(e,t,n){var r=e.property().children(t);return M(r,b(e.eq,n)).map(function(e){return{before:C(r.slice(0,e)),after:C(r.slice(e+1))}})},Un=function(n,r,o){return Hn(n,r,o).map(function(e){var t=n.create().clone(r);return n.insert().appendAll(t,e.before().concat([o])),n.insert().appendAll(r,e.after()),n.insert().before(r,t),zn(t,r)})},qn=function(n,r,e){return Hn(n,r,e).map(function(e){var t=n.create().clone(r);return n.insert().appendAll(t,e.after()),n.insert().after(r,t),zn(r,t)})},Vn=function(i,e,u,a){var r=X("first","second","splits"),c=function(e,t,o){var n=r(e,R.none(),o);return u(e)?r(e,t,o):i.property().parent(e).bind(function(r){return a(i,r,e).map(function(e){var t=[{first:e.left,second:e.right}],n=u(r)?r:e.left();return c(n,R.some(e.right()),o.concat(t))}).getOr(n)})};return c(e,R.none(),[])},Gn=function(r,o,e,t){var n=o(r,e);return I(t,function(e,t){var n=o(r,t);return Yn(r,e,n)},n)},Yn=function(t,e,n){return e.bind(function(e){return n.filter(b(t.eq,e))})},Xn=function(e,t,n){return 0<n.length?Gn(e,t,(r=n)[0],r.slice(1)):R.none();var r},Kn=function(e,t){return b(e.eq,t)},Jn=function(t,e,n,r){var o=r!==undefined?r:C(!1),i=[e].concat(t.up().all(e)),u=[n].concat(t.up().all(n)),a=function(t){return M(t,o).fold(function(){return t},function(e){return t.slice(0,e+1)})},c=a(i),l=a(u),f=W(c,function(e){return N(l,Kn(t,e))});return{firstpath:C(c),secondpath:C(l),shared:C(f)}},$n=function(t,e,n){var r=Jn(t,e,n);return r.shared().bind(function(e){return function(o,i,e,t){var u=o.property().children(i);if(o.eq(i,e[0]))return R.some([e[0]]);if(o.eq(i,t[0]))return R.some([t[0]]);var n=function(e){var t=U(e),n=M(t,Kn(o,i)).getOr(-1),r=n<t.length-1?t[n+1]:t[n];return M(u,Kn(o,r))},r=n(e),a=n(t);return r.bind(function(r){return a.map(function(e){var t=Math.min(r,e),n=Math.max(r,e);return u.slice(t,n+1)})})}(t,e,r.firstpath(),r.secondpath())})},Qn=Jn,Zn=function(e,t,n){return Xn(e,t,n)},er=function(e,t,n){return $n(e,t,n)},tr=function(e,t,n,r){return Qn(e,t,n,r)},nr=function(e,t,n){return Un(e,t,n)},rr=function(e,t,n){return qn(e,t,n)},or=function(e,t,n,r){return Vn(e,t,n,r)},ir=Fn(),ur={sharedOne:function(n,e){return Zn(ir,function(e,t){return n(t)},e)},subset:function(e,t){return er(ir,e,t)},ancestors:function(e,t,n){return tr(ir,e,t,n)},breakToLeft:function(e,t){return nr(ir,e,t)},breakToRight:function(e,t){return rr(ir,e,t)},breakPath:function(e,t,r){return or(ir,e,t,function(e,t,n){return r(t,n)})}},ar=function(e,t){return t.column()>=e.startCol()&&t.column()+t.colspan()-1<=e.finishCol()&&t.row()>=e.startRow()&&t.row()+t.rowspan()-1<=e.finishRow()},cr=function(e,t){var n=t.column(),r=t.column()+t.colspan()-1,o=t.row(),i=t.row()+t.rowspan()-1;return n<=e.finishCol()&&r>=e.startCol()&&o<=e.finishRow()&&i>=e.startRow()},lr=function(e,t){for(var n=!0,r=b(ar,t),o=t.startRow();o<=t.finishRow();o++)for(var i=t.startCol();i<=t.finishCol();i++)n=n&&$t.getAt(e,o,i).exists(r);return n?R.some(t):R.none()},fr=function(e,t,n){var r=$t.findItem(e,t,$e),o=$t.findItem(e,n,$e);return r.bind(function(r){return o.map(function(e){return t=r,n=e,ae.bounds(Math.min(t.row(),n.row()),Math.min(t.column(),n.column()),Math.max(t.row()+t.rowspan()-1,n.row()+n.rowspan()-1),Math.max(t.column()+t.colspan()-1,n.column()+n.colspan()-1));var t,n})})},sr=fr,dr=function(t,e,n){return fr(t,e,n).bind(function(e){return lr(t,e)})},mr=function(r,e,o,i){return $t.findItem(r,e,$e).bind(function(e){var t=0<o?e.row()+e.rowspan()-1:e.row(),n=0<i?e.column()+e.colspan()-1:e.column();return $t.getAt(r,t+o,n+i).map(function(e){return e.element()})})},gr=function(n,e,t){return sr(n,e,t).map(function(e){var t=$t.filterItems(n,b(cr,e));return E(t,function(e){return e.element()})})},hr=function(e,t){return $t.findItem(e,t,function(e,t){return Qe(t,e)}).bind(function(e){return e.element()})},pr=function(e){var t=Yt(e);return $t.generate(t)},vr=function(n,r,o){return Gt.table(n).bind(function(e){var t=pr(e);return mr(t,n,r,o)})},br=function(e,t,n){var r=pr(e);return gr(r,t,n)},wr=function(e,t,n,r,o){var i=pr(e),u=$e(e,n)?t:hr(i,t),a=$e(e,o)?r:hr(i,r);return gr(i,u,a)},yr=function(e,t,n){var r=pr(e);return dr(r,t,n)},xr=function(e,t){return _t(e,"table")},Cr=ee(["boxes","start","finish"],[]),Rr=function(a,c,r){var l=function(t){return function(e){return r(e)||$e(e,t)}};return $e(a,c)?R.some(Cr({boxes:R.some([a]),start:a,finish:c})):xr(a).bind(function(u){return xr(c).bind(function(i){if($e(u,i))return R.some(Cr({boxes:br(u,a,c),start:a,finish:c}));if(Qe(u,i)){var e=0<(t=Ot(c,"td,th",l(u))).length?t[t.length-1]:c;return R.some(Cr({boxes:wr(u,a,u,c,i),start:a,finish:e}))}if(Qe(i,u)){var t,n=0<(t=Ot(a,"td,th",l(i))).length?t[t.length-1]:a;return R.some(Cr({boxes:wr(i,a,u,c,i),start:a,finish:n}))}return ur.ancestors(a,c).shared().bind(function(e){return Ft(e,"table",r).bind(function(e){var t=Ot(c,"td,th",l(e)),n=0<t.length?t[t.length-1]:c,r=Ot(a,"td,th",l(e)),o=0<r.length?r[r.length-1]:a;return R.some(Cr({boxes:wr(e,a,u,c,i),start:o,finish:n}))})})})})},Sr=Rr,Tr=function(e,t){var n=Nt(e,t);return 0<n.length?R.some(n):R.none()},Dr=function(e,t,n,r,o){return(i=e,u=o,W(i,function(e){return pe(e,u)})).bind(function(e){return vr(e,t,n).bind(function(e){return n=r,_t(t=e,"table").bind(function(e){return jt(e,n).bind(function(e){return Rr(e,t).bind(function(t){return t.boxes().map(function(e){return{boxes:C(e),start:C(t.start()),finish:C(t.finish())}})})})});var t,n})});var i,u},Or=function(e,t,r){return jt(e,t).bind(function(n){return jt(e,r).bind(function(t){return ur.sharedOne(xr,[n,t]).map(function(e){return{first:C(n),last:C(t),table:C(e)}})})})},kr=function(e,t){return Tr(e,t)},Nr=function(o,e,t){return Or(o,e,t).bind(function(n){var e=function(e){return $e(o,e)},t=_t(n.first(),"thead,tfoot,tbody,table",e),r=_t(n.last(),"thead,tfoot,tbody,table",e);return t.bind(function(t){return r.bind(function(e){return $e(t,e)?yr(n.table(),n.first(),n.last()):R.none()})})})},Er="data-mce-selected",Ar="data-mce-first-selected",Pr="data-mce-last-selected",Ir={selected:C(Er),selectedSelector:C("td[data-mce-selected],th[data-mce-selected]"),attributeSelector:C("[data-mce-selected]"),firstSelected:C(Ar),firstSelectedSelector:C("td[data-mce-first-selected],th[data-mce-first-selected]"),lastSelected:C(Pr),lastSelectedSelector:C("td[data-mce-last-selected],th[data-mce-last-selected]")},Br=function(u){if(!w(u))throw new Error("cases must be an array");if(0===u.length)throw new Error("there must be at least one case");var a=[],n={};return A(u,function(e,r){var t=q(e);if(1!==t.length)throw new Error("one and only one name per case");var o=t[0],i=e[o];if(n[o]!==undefined)throw new Error("duplicate key detected:"+o);if("cata"===o)throw new Error("cannot have a case named cata (sorry)");if(!w(i))throw new Error("case arguments must be an array");a.push(o),n[o]=function(){var e=arguments.length;if(e!==i.length)throw new Error("Wrong number of arguments to case "+o+". Expected "+i.length+" ("+i+"), got "+e);for(var n=new Array(e),t=0;t<n.length;t++)n[t]=arguments[t];return{fold:function(){if(arguments.length!==u.length)throw new Error("Wrong number of arguments to fold. Expected "+u.length+", got "+arguments.length);return arguments[r].apply(null,n)},match:function(e){var t=q(e);if(a.length!==t.length)throw new Error("Wrong number of arguments to match. Expected: "+a.join(",")+"\nActual: "+t.join(","));if(!z(a,function(e){return k(t,e)}))throw new Error("Not all branches were specified when using match. Specified: "+t.join(", ")+"\nRequired: "+a.join(", "));return e[o].apply(null,n)},log:function(e){console.log(e,{constructors:a,constructor:o,params:n})}}}}),n},Wr=Br([{none:[]},{multiple:["elements"]},{single:["selection"]}]),Mr={cata:function(e,t,n,r){return e.fold(t,n,r)},none:Wr.none,multiple:Wr.multiple,single:Wr.single},_r=function(e,t){return Mr.cata(t.get(),C([]),o,C([e]))},Lr=function(n,e){return Mr.cata(e.get(),R.none,function(t,e){return 0===t.length?R.none():Nr(n,Ir.firstSelectedSelector(),Ir.lastSelectedSelector()).bind(function(e){return 1<t.length?R.some({bounds:C(e),cells:C(t)}):R.none()})},R.none)},jr=function(e,t){var n=_r(e,t);return 0<n.length&&z(n,function(e){return yt(e,"rowspan")&&1<parseInt(wt(e,"rowspan"),10)||yt(e,"colspan")&&1<parseInt(wt(e,"colspan"),10)})?R.some(n):R.none()},Fr=_r,zr=function(e){return{element:C(e),mergable:R.none,unmergable:R.none,selection:C([e])}},Hr=X("element","clipboard","generators"),Ur={noMenu:zr,forMenu:function(e,t,n){return{element:C(n),mergable:C(Lr(t,e)),unmergable:C(jr(n,e)),selection:C(Fr(n,e))}},notCell:function(e){return zr(e)},paste:Hr,pasteRows:function(e,t,n,r,o){return{element:C(n),mergable:R.none,unmergable:R.none,selection:C(Fr(n,e)),clipboard:C(r),generators:C(o)}}},qr=function(f,e,s,d){f.on("BeforeGetContent",function(n){!0===n.selection&&Mr.cata(e.get(),y,function(e){var t;n.preventDefault(),(t=e,Gt.table(t[0]).map(xn).map(function(e){return[bn(e,Ir.attributeSelector())]})).each(function(e){var t;n.content="text"===n.format?E(e,function(e){return e.dom().innerText}).join(""):(t=f,E(e,function(e){return t.selection.serializer.serialize(e.dom(),{})}).join(""))})},y)}),f.on("BeforeSetContent",function(l){!0===l.selection&&!0===l.paste&&R.from(f.dom.getParent(f.selection.getStart(),"th,td")).each(function(e){var c=le.fromDom(e);Gt.table(c).bind(function(t){var e,n,r,o=P((e=l.content,(r=(n||document).createElement("div")).innerHTML=e,it(le.fromDom(r))),function(e){return"meta"!==lt(e)});if(1===o.length&&"table"===lt(o[0])){l.preventDefault();var i=le.fromDom(f.getDoc()),u=Ln(i),a=Ur.paste(c,o[0],u);s.pasteCells(t,a).each(function(e){f.selection.setRng(e),f.focus(),d.clear(t)})}})})})};function Vr(r,o){var e=function(e){var t=o(e);if(t<=0||null===t){var n=nn(e,r);return parseFloat(n)||0}return t},i=function(o,e){return B(e,function(e,t){var n=nn(o,t),r=n===undefined?0:parseInt(n,10);return isNaN(r)?e:e+r},0)};return{set:function(e,t){if(!D(t)&&!t.match(/^[0-9]+$/))throw r+".set accepts only positive integer values. Value was "+t;var n=e.dom();Qt(n)&&(n.style[r]=t+"px")},get:e,getOuter:e,aggregate:i,max:function(e,t,n){var r=i(e,n);return r<t?t-r:0}}}var Gr=Vr("height",function(e){var t=e.dom();return Rt(e)?t.getBoundingClientRect().height:t.offsetHeight}),Yr=function(e){return Gr.get(e)},Xr=function(e){return Gr.getOuter(e)},Kr=Vr("width",function(e){return e.dom().offsetWidth}),Jr=function(e){return Kr.get(e)},$r=function(e){return Kr.getOuter(e)},Qr=Je.detect(),Zr=function(e,t,n){return r=nn(e,t),o=n,i=parseFloat(r),isNaN(i)?o:i;var r,o,i},eo=function(e){return Qr.browser.isIE()||Qr.browser.isEdge()?(n=Zr(t=e,"padding-top",0),r=Zr(t,"padding-bottom",0),o=Zr(t,"border-top-width",0),i=Zr(t,"border-bottom-width",0),u=t.dom().getBoundingClientRect().height,"border-box"===nn(t,"box-sizing")?u:u-n-r-(o+i)):Zr(e,"height",Yr(e));var t,n,r,o,i,u},to=/(\d+(\.\d+)?)(\w|%)*/,no=/(\d+(\.\d+)?)%/,ro=/(\d+(\.\d+)?)px|em/,oo=function(e,t){en(e,"height",t+"px")},io=function(e,t,n,r){var o,i,u,a,c,l,f,s,d,m=parseInt(e,10);return s=l="%",d=(f=e).length-l.length,""!==s&&(f.length<s.length||f.substr(d,d+s.length)!==s)||"table"===lt(t)?m:(o=t,i=m,u=n,a=r,c=Gt.table(o).map(function(e){var t=u(e);return Math.floor(i/100*t)}).getOr(i),a(o,c),c)},uo=function(e){var t,n=on(t=e,"height").getOrThunk(function(){return eo(t)+"px"});return n?io(n,e,Yr,oo):Yr(e)},ao=function(e,t){return yt(e,t)?parseInt(wt(e,t),10):1},co=function(e){return on(e,"width").fold(function(){return R.from(wt(e,"width"))},function(e){return R.some(e)})},lo=function(e,t){return e/t.pixelWidth()*100},fo={percentageBasedSizeRegex:C(no),pixelBasedSizeRegex:C(ro),setPixelWidth:function(e,t){en(e,"width",t+"px")},setPercentageWidth:function(e,t){en(e,"width",t+"%")},setHeight:oo,getPixelWidth:function(t,n){return co(t).fold(function(){return Jr(t)},function(e){return function(e,t,n){if(ro.test(t)){var r=ro.exec(t);return parseInt(r[1],10)}if(no.test(t)){var o=no.exec(t),i=parseFloat(o[1]);return i/100*n.pixelWidth()}return Jr(e)}(t,e,n)})},getPercentageWidth:function(t,n){return co(t).fold(function(){var e=Jr(t);return lo(e,n)},function(e){return function(e,t,n){if(no.test(t)){var r=no.exec(t);return parseFloat(r[1])}var o=Jr(e);return lo(o,n)}(t,e,n)})},getGenericWidth:function(e){return co(e).bind(function(e){if(to.test(e)){var t=to.exec(e);return R.some({width:C(t[1]),unit:C(t[3])})}return R.none()})},setGenericWidth:function(e,t,n){en(e,"width",t+n)},getHeight:function(e){return n="rowspan",uo(t=e)/ao(t,n);var t,n},getRawWidth:co},so=function(n,r){fo.getGenericWidth(n).each(function(e){var t=e.width()/2;fo.setGenericWidth(n,t,e.unit()),fo.setGenericWidth(r,t,e.unit())})},mo=function(n,r){return{left:C(n),top:C(r),translate:function(e,t){return mo(n+e,r+t)}}},go=mo,ho=function(e,t){return e!==undefined?e:t!==undefined?t:0},po=function(e){var t,n,r=e.dom().ownerDocument,o=r.body,i=(t=le.fromDom(r),(n=t.dom())===n.window&&t instanceof Window?t:ht(t)?n.defaultView||n.parentWindow:null),u=r.documentElement,a=ho(i.pageYOffset,u.scrollTop),c=ho(i.pageXOffset,u.scrollLeft),l=ho(u.clientTop,o.clientTop),f=ho(u.clientLeft,o.clientLeft);return vo(e).translate(c-f,a-l)},vo=function(e){var t,n,r,o=e.dom(),i=o.ownerDocument,u=i.body,a=le.fromDom(i.documentElement);return u===o?go(u.offsetLeft,u.offsetTop):(t=e,n=a||le.fromDom(document.documentElement),Mt(t,b($e,n)).isSome()?(r=o.getBoundingClientRect(),go(r.left,r.top)):go(0,0))},bo=X("row","y"),wo=X("col","x"),yo=function(e){return po(e).left()+$r(e)},xo=function(e){return po(e).left()},Co=function(e,t){return wo(e,xo(t))},Ro=function(e,t){return wo(e,yo(t))},So=function(e){return po(e).top()},To=function(n,t,r){if(0===r.length)return[];var e=E(r.slice(1),function(e,t){return e.map(function(e){return n(t,e)})}),o=r[r.length-1].map(function(e){return t(r.length-1,e)});return e.concat([o])},Do={delta:o,positions:b(To,function(e,t){return bo(e,So(t))},function(e,t){return bo(e,So(t)+Xr(t))}),edge:So},Oo={delta:o,edge:xo,positions:b(To,Co,Ro)},ko={height:Do,rtl:{delta:function(e,t){return-e},edge:yo,positions:b(To,Ro,Co)},ltr:Oo},No={ltr:ko.ltr,rtl:ko.rtl};function Eo(t){var n=function(e){return t(e).isRtl()?No.rtl:No.ltr};return{delta:function(e,t){return n(t).delta(e,t)},edge:function(e){return n(e).edge(e)},positions:function(e,t){return n(t).positions(e,t)}}}var Ao,Po=function(e){var t=Yt(e);return $t.generate(t).grid()},Io=function(e){var t=e,n=function(){return t};return{get:n,set:function(e){t=e},clone:function(){return Io(n())}}},Bo=function(r,o,i){if(0===o.length)throw new Error("You must specify at least one required field.");return Q("required",o),Z(o),function(t){var n=q(t);z(o,function(e){return k(n,e)})||J(o,n),r(o,n);var e=P(o,function(e){return!i.validate(t[e],e)});return 0<e.length&&function(e,t){throw new Error("All values need to be of type: "+t+". Keys ("+K(e).join(", ")+") were not.")}(e,i.label),t}},Wo=function(t,e){var n=P(e,function(e){return!k(t,e)});0<n.length&&$(n)},Mo=function(e){return Bo(Wo,e,{validate:T,label:"function"})},_o=function(e){var t=yt(e,"colspan")?parseInt(wt(e,"colspan"),10):1,n=yt(e,"rowspan")?parseInt(wt(e,"rowspan"),10):1;return{element:C(e),colspan:C(t),rowspan:C(n)}},Lo=Mo(["cell","row","replace","gap"]),jo=function(r,e){Lo(r);var n=Io(R.none()),o=e!==undefined?e:_o,i=function(e){var t,n=o(e);return t=n,r.cell(t)},u=function(e){var t=i(e);return n.get().isNone()&&n.set(R.some(t)),a=R.some({item:e,replacement:t}),t},a=R.none();return{getOrInit:function(t,n){return a.fold(function(){return u(t)},function(e){return n(t,e.item)?e.replacement:u(t)})},cursor:n.get}},Fo=function(o,a){return function(n){var r=Io(R.none());Lo(n);var i=[],u=function(e){var t=n.replace(e,a,{scope:o});return i.push({item:e,sub:t}),r.get().isNone()&&r.set(R.some(t)),t};return{replaceOrInit:function(t,n){return(r=t,o=n,W(i,function(e){return o(e.item,r)})).fold(function(){return u(t)},function(e){return n(t,e.item)?e.sub:u(t)});var r,o},cursor:r.get}}},zo=function(n){Lo(n);var e=Io(R.none());return{combine:function(t){return e.get().isNone()&&e.set(R.some(t)),function(){var e=n.cell({element:C(t),colspan:C(1),rowspan:C(1)});return un(e,"width"),un(t,"width"),e}},cursor:e.get}},Ho=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],Uo=function(e,t){var n=e.property().name(t);return k(Ho,n)},qo=function(e,t){return k(["br","img","hr","input"],e.property().name(t))},Vo=Uo,Go=function(e,t){var n=e.property().name(t);return k(["ol","ul"],n)},Yo=qo,Xo=Fn(),Ko=function(e){return Vo(Xo,e)},Jo=function(e){return Go(Xo,e)},$o=function(e){return Yo(Xo,e)},Qo=function(e){var t,i=function(e){return"br"===lt(e)},n=function(o){return An(o).bind(function(n){var r=ot(n).map(function(e){return!!Ko(e)||($o(e)?"img"!==lt(e):void 0)}).getOr(!1);return tt(n).map(function(e){return!0===r||"li"===lt(t=e)||Mt(t,Jo).isSome()||i(n)||Ko(e)&&!$e(o,e)?[]:[le.fromTag("br")];var t})}).getOr([])},r=0===(t=F(e,function(e){var t=it(e);return z(t,function(e){return i(e)||gt(e)&&0===Sn(e).trim().length})?[]:t.concat(n(e))})).length?[le.fromTag("br")]:t;gn(e[0]),mn(e[0],r)},Zo=Object.prototype.hasOwnProperty,ei=(Ao=function(e,t){return t},function(){for(var e=new Array(arguments.length),t=0;t<e.length;t++)e[t]=arguments[t];if(0===e.length)throw new Error("Can't merge zero objects");for(var n={},r=0;r<e.length;r++){var o=e[r];for(var i in o)Zo.call(o,i)&&(n[i]=Ao(n[i],o[i]))}return n}),ti=function(e){for(var t=[],n=function(e){t.push(e)},r=0;r<e.length;r++)e[r].each(n);return t},ni=function(e,t){for(var n=0;n<e.length;n++){var r=t(e[n],n);if(r.isSome())return r}return R.none()},ri=function(e,t){return ae.rowcells(t,e.section())},oi=function(e,t){return e.cells()[t]},ii={addCell:function(e,t,n){var r=e.cells(),o=r.slice(0,t),i=r.slice(t),u=o.concat([n]).concat(i);return ri(e,u)},setCells:ri,mutateCell:function(e,t,n){e.cells()[t]=n},getCell:oi,getCellElement:function(e,t){return oi(e,t).element()},mapCells:function(e,t){var n=e.cells(),r=E(n,t);return ae.rowcells(r,e.section())},cellLength:function(e){return e.cells().length}},ui=function(e,t){if(0===e.length)return 0;var n=e[0];return M(e,function(e){return!t(n.element(),e.element())}).fold(function(){return e.length},function(e){return e})},ai=function(e,t,n,r){var o,i,u,a,c=(o=e,i=t,o[i]).cells().slice(n),l=ui(c,r),f=(u=e,a=n,E(u,function(e){return ii.getCell(e,a)})).slice(t),s=ui(f,r);return{colspan:C(l),rowspan:C(s)}},ci=function(o,i){var u=E(o,function(e,t){return E(e.cells(),function(e,t){return!1})});return E(o,function(e,r){var t=F(e.cells(),function(e,t){if(!1===u[r][t]){var n=ai(o,r,t,i);return function(e,t,n,r){for(var o=e;o<e+n;o++)for(var i=t;i<t+r;i++)u[o][i]=!0}(r,t,n.rowspan(),n.colspan()),[ae.detailnew(e.element(),n.rowspan(),n.colspan(),e.isNew())]}return[]});return ae.rowdetails(t,e.section())})},li=function(e,t,n){for(var r=[],o=0;o<e.grid().rows();o++){for(var i=[],u=0;u<e.grid().columns();u++){var a=$t.getAt(e,o,u).map(function(e){return ae.elementnew(e.element(),n)}).getOrThunk(function(){return ae.elementnew(t.gap(),!0)});i.push(a)}var c=ae.rowcells(i,e.all()[o].section());r.push(c)}return r},fi=function(e,t,n,r){n===r?xt(e,t):vt(e,t,n)},si=function(o,e){var i=[],u=[],t=function(e,t){0<e.length?function(e,t){var n=Lt(o,t).getOrThunk(function(){var e=le.fromTag(t,et(o).dom());return fn(o,e),e});gn(n);var r=E(e,function(e){e.isNew()&&i.push(e.element());var t=e.element();return gn(t),A(e.cells(),function(e){e.isNew()&&u.push(e.element()),fi(e.element(),"colspan",e.colspan(),1),fi(e.element(),"rowspan",e.rowspan(),1),fn(t,e.element())}),t});mn(n,r)}(e,t):Lt(o,t).each(hn)},n=[],r=[],a=[];return A(e,function(e){switch(e.section()){case"thead":n.push(e);break;case"tbody":r.push(e);break;case"tfoot":a.push(e)}}),t(n,"thead"),t(r,"tbody"),t(a,"tfoot"),{newRows:C(i),newCells:C(u)}},di=function(e){return E(e,function(e){var n=yn(e.element());return A(e.cells(),function(e){var t=xn(e.element());fi(t,"colspan",e.colspan(),1),fi(t,"rowspan",e.rowspan(),1),fn(n,t)}),n})},mi=function(e,t){for(var n=[],r=0;r<e;r++)n.push(t(r));return n},gi=function(e,t){for(var n=[],r=e;r<t;r++)n.push(r);return n},hi=function(t,n){if(n<0||n>=t.length-1)return R.none();var e=t[n].fold(function(){var e=U(t.slice(0,n));return ni(e,function(e,t){return e.map(function(e){return{value:e,delta:t+1}})})},function(e){return R.some({value:e,delta:0})}),r=t[n+1].fold(function(){var e=t.slice(n+1);return ni(e,function(e,t){return e.map(function(e){return{value:e,delta:t+1}})})},function(e){return R.some({value:e,delta:1})});return e.bind(function(n){return r.map(function(e){var t=e.delta+n.delta;return Math.abs(e.value-n.value)/t})})},pi=function(e,t,n){var r=e();return W(r,t).orThunk(function(){return R.from(r[0]).orThunk(n)}).map(function(e){return e.element()})},vi=function(n){var e=n.grid(),t=gi(0,e.columns()),r=gi(0,e.rows());return E(t,function(t){return pi(function(){return F(r,function(e){return $t.getAt(n,e,t).filter(function(e){return e.column()===t}).fold(C([]),function(e){return[e]})})},function(e){return 1===e.colspan()},function(){return $t.getAt(n,0,t)})})},bi=function(n){var e=n.grid(),t=gi(0,e.rows()),r=gi(0,e.columns());return E(t,function(t){return pi(function(){return F(r,function(e){return $t.getAt(n,t,e).filter(function(e){return e.row()===t}).fold(C([]),function(e){return[e]})})},function(e){return 1===e.rowspan()},function(){return $t.getAt(n,t,0)})})},wi=function(e,t,n,r,o){var i=le.fromTag("div");return tn(i,{position:"absolute",left:t-r/2+"px",top:n+"px",height:o+"px",width:r+"px"}),bt(i,{"data-column":e,role:"presentation"}),i},yi=function(e,t,n,r,o){var i=le.fromTag("div");return tn(i,{position:"absolute",left:t+"px",top:n-o/2+"px",height:o+"px",width:r+"px"}),bt(i,{"data-row":e,role:"presentation"}),i},xi=function(e){var t=e.replace(/\./g,"-");return{resolve:function(e){return t+"-"+e}}},Ci={resolve:xi("ephox-snooker").resolve},Ri=function(e,t){var n=wt(e,t);return n===undefined||""===n?[]:n.split(" ")},Si=function(e){return e.dom().classList!==undefined},Ti=function(e,t){return o=t,i=Ri(n=e,r="class").concat([o]),vt(n,r,i.join(" ")),!0;var n,r,o,i},Di=function(e,t){return o=t,0<(i=P(Ri(n=e,r="class"),function(e){return e!==o})).length?vt(n,r,i.join(" ")):xt(n,r),!1;var n,r,o,i},Oi=function(e,t){Si(e)?e.dom().classList.add(t):Ti(e,t)},ki=function(e){0===(Si(e)?e.dom().classList:Ri(e,"class")).length&&xt(e,"class")},Ni=function(e,t){return Si(e)&&e.dom().classList.contains(t)},Ei=Ci.resolve("resizer-bar"),Ai=Ci.resolve("resizer-rows"),Pi=Ci.resolve("resizer-cols"),Ii=function(e){var t=Nt(e.parent(),"."+Ei);A(t,hn)},Bi=function(n,e,r){var o=n.origin();A(e,function(e,t){e.each(function(e){var t=r(o,e);Oi(t,Ei),fn(n.parent(),t)})})},Wi=function(e,t,n,r,o,i){var u,a,c,l,f=po(t),s=0<n.length?o.positions(n,t):[];u=e,a=s,c=f,l=$r(t),Bi(u,a,function(e,t){var n=yi(t.row(),c.left()-e.left(),t.y()-e.top(),l,7);return Oi(n,Ai),n});var d,m,g,h,p=0<r.length?i.positions(r,t):[];d=e,m=p,g=f,h=Xr(t),Bi(d,m,function(e,t){var n=wi(t.col(),t.x()-e.left(),g.top()-e.top(),7,h);return Oi(n,Pi),n})},Mi=function(e,t){var n=Nt(e.parent(),"."+Ei);A(n,t)},_i={refresh:function(e,t,n,r){Ii(e);var o=Yt(t),i=$t.generate(o),u=bi(i),a=vi(i);Wi(e,t,u,a,n,r)},hide:function(e){Mi(e,function(e){en(e,"display","none")})},show:function(e){Mi(e,function(e){en(e,"display","block")})},destroy:Ii,isRowBar:function(e){return Ni(e,Ai)},isColBar:function(e){return Ni(e,Pi)}},Li=function(e,r){return E(e,function(e){var t,n=(t=e.details(),ni(t,function(e){return tt(e.element()).map(function(e){var t=tt(e).isNone();return ae.elementnew(e,t)})}).getOrThunk(function(){return ae.elementnew(r.row(),!0)}));return ae.rowdatanew(n.element(),e.details(),e.section(),n.isNew())})},ji=function(e,t){var n=ci(e,$e);return Li(n,t)},Fi=function(e,t){var n=j(E(e.all(),function(e){return e.cells()}));return W(n,function(e){return $e(t,e.element())})},zi=function(a,c,l,f,s){return function(n,r,e,o,i){var t=Yt(r),u=$t.generate(t);return c(u,e).map(function(e){var t=li(u,o,!1),n=a(t,e,$e,s(o)),r=ji(n.grid(),o);return{grid:C(r),cursor:n.cursor}}).fold(function(){return R.none()},function(e){var t=si(r,e.grid());return l(r,e.grid(),i),f(r),_i.refresh(n,r,ko.height,i),R.some({cursor:e.cursor,newRows:t.newRows,newCells:t.newCells})})}},Hi=ji,Ui=function(t,e){return Gt.cell(e.element()).bind(function(e){return Fi(t,e)})},qi=function(t,e){var n=E(e.selection(),function(e){return Gt.cell(e).bind(function(e){return Fi(t,e)})}),r=ti(n);return 0<r.length?R.some(r):R.none()},Vi=function(t,n){return Gt.cell(n.element()).bind(function(e){return Fi(t,e).map(function(e){return ei(e,{generators:n.generators,clipboard:n.clipboard})})})},Gi=function(t,e){var n=E(e.selection(),function(e){return Gt.cell(e).bind(function(e){return Fi(t,e)})}),r=ti(n);return 0<r.length?R.some(ei({cells:r},{generators:e.generators,clipboard:e.clipboard})):R.none()},Yi=function(e,t){return t.mergable()},Xi=function(e,t){return t.unmergable()},Ki=function(n){return{is:function(e){return n===e},isValue:l,isError:a,getOr:C(n),getOrThunk:C(n),getOrDie:C(n),or:function(e){return Ki(n)},orThunk:function(e){return Ki(n)},fold:function(e,t){return t(n)},map:function(e){return Ki(e(n))},mapError:function(e){return Ki(n)},each:function(e){e(n)},bind:function(e){return e(n)},exists:function(e){return e(n)},forall:function(e){return e(n)},toOption:function(){return R.some(n)}}},Ji=function(n){return{is:a,isValue:a,isError:l,getOr:o,getOrThunk:function(e){return e()},getOrDie:function(){return e=String(n),function(){throw new Error(e)}();var e},or:function(e){return e},orThunk:function(e){return e()},fold:function(e,t){return e(n)},map:function(e){return Ji(n)},mapError:function(e){return Ji(e(n))},each:y,bind:function(e){return Ji(n)},exists:a,forall:l,toOption:R.none}},$i={value:Ki,error:Ji},Qi=function(e,t){return E(e,function(){return ae.elementnew(t.cell(),!0)})},Zi=function(t,e,n){return t.concat(mi(e,function(e){return ii.setCells(t[t.length-1],Qi(t[t.length-1].cells(),n))}))},eu=function(e,t,n){return E(e,function(e){return ii.setCells(e,e.cells().concat(Qi(gi(0,t),n)))})},tu=function(e,t,n){if(e.row()>=t.length||e.column()>ii.cellLength(t[0]))return $i.error("invalid start address out of table bounds, row: "+e.row()+", column: "+e.column());var r=t.slice(e.row()),o=r[0].cells().slice(e.column()),i=ii.cellLength(n[0]),u=n.length;return $i.value({rowDelta:C(r.length-u),colDelta:C(o.length-i)})},nu=function(e,t){var n=ii.cellLength(e[0]),r=ii.cellLength(t[0]);return{rowDelta:C(0),colDelta:C(n-r)}},ru=function(e,t,n){var r=t.colDelta()<0?eu:o;return(t.rowDelta()<0?Zi:o)(r(e,Math.abs(t.colDelta()),n),Math.abs(t.rowDelta()),n)},ou=function(e,t,n,r){if(0===e.length)return e;for(var o=t.startRow();o<=t.finishRow();o++)for(var i=t.startCol();i<=t.finishCol();i++)ii.mutateCell(e[o],i,ae.elementnew(r(),!1));return e},iu=function(e,t,n,r){for(var o=!0,i=0;i<e.length;i++)for(var u=0;u<ii.cellLength(e[0]);u++){var a=n(ii.getCellElement(e[i],u),t);!0===a&&!1===o?ii.mutateCell(e[i],u,ae.elementnew(r(),!0)):!0===a&&(o=!1)}return e},uu=function(i,u,a,c){if(0<u&&u<i.length){var e=i[u-1].cells(),t=(n=a,B(e,function(e,t){return N(e,function(e){return n(e.element(),t.element())})?e:e.concat([t])},[]));A(t,function(e){for(var t=R.none(),n=u;n<i.length;n++)for(var r=0;r<ii.cellLength(i[0]);r++){var o=i[n].cells()[r];a(o.element(),e.element())&&(t.isNone()&&(t=R.some(c())),t.each(function(e){ii.mutateCell(i[n],r,ae.elementnew(e,!0))}))}})}var n;return i},au=function(n,r,o,i,u){return tu(n,r,o).map(function(e){var t=ru(r,e,i);return function(e,t,n,r,o){for(var i,u,a,c,l,f=e.row(),s=e.column(),d=f+n.length,m=s+ii.cellLength(n[0]),g=f;g<d;g++)for(var h=s;h<m;h++){i=t,u=g,a=h,c=void 0,c=b(o,ii.getCell(i[u],a).element()),l=i[u],1<i.length&&1<ii.cellLength(l)&&(0<a&&c(ii.getCellElement(l,a-1))||a<l.length-1&&c(ii.getCellElement(l,a+1))||0<u&&c(ii.getCellElement(i[u-1],a))||u<i.length-1&&c(ii.getCellElement(i[u+1],a)))&&iu(t,ii.getCellElement(t[g],h),o,r.cell);var p=ii.getCellElement(n[g-f],h-s),v=r.replace(p);ii.mutateCell(t[g],h,ae.elementnew(v,!0))}return t}(n,t,o,i,u)})},cu=function(e,t,n,r,o){uu(t,e,o,r.cell);var i=nu(n,t),u=ru(n,i,r),a=nu(t,u),c=ru(t,a,r);return c.slice(0,e).concat(u).concat(c.slice(e,c.length))},lu=function(n,r,e,o,i){var t=n.slice(0,r),u=n.slice(r),a=ii.mapCells(n[e],function(e,t){return 0<r&&r<n.length&&o(ii.getCellElement(n[r-1],t),ii.getCellElement(n[r],t))?ii.getCell(n[r],t):ae.elementnew(i(e.element(),o),!0)});return t.concat([a]).concat(u)},fu=function(e,n,r,o,i){return E(e,function(e){var t=0<n&&n<ii.cellLength(e)&&o(ii.getCellElement(e,n-1),ii.getCellElement(e,n))?ii.getCell(e,n):ae.elementnew(i(ii.getCellElement(e,r),o),!0);return ii.addCell(e,n,t)})},su=function(e,r,o,i,u){var a=o+1;return E(e,function(e,t){var n=t===r?ae.elementnew(u(ii.getCellElement(e,o),i),!0):ii.getCell(e,o);return ii.addCell(e,a,n)})},du=function(e,t,n,r,o){var i=t+1,u=e.slice(0,i),a=e.slice(i),c=ii.mapCells(e[t],function(e,t){return t===n?ae.elementnew(o(e.element(),r),!0):e});return u.concat([c]).concat(a)},mu=function(e,t,n){return e.slice(0,t).concat(e.slice(n+1))},gu=function(e,n,r){var t=E(e,function(e){var t=e.cells().slice(0,n).concat(e.cells().slice(r+1));return ae.rowcells(t,e.section())});return P(t,function(e){return 0<e.cells().length})},hu=function(e,n,r,o){return E(e,function(e){return ii.mapCells(e,function(e){return t=e,N(n,function(e){return r(t.element(),e.element())})?ae.elementnew(o(e.element(),r),!0):e;var t})})},pu=function(e,t,n,r){return ii.getCellElement(e[t],n)!==undefined&&0<t&&r(ii.getCellElement(e[t-1],n),ii.getCellElement(e[t],n))},vu=function(e,t,n){return 0<t&&n(ii.getCellElement(e,t-1),ii.getCellElement(e,t))},bu=function(n,r,o,e){var t=F(n,function(e,t){return pu(n,t,r,o)||vu(e,r,o)?[]:[ii.getCell(e,r)]});return hu(n,t,o,e)},wu=function(n,r,o,e){var i=n[r],t=F(i.cells(),function(e,t){return pu(n,r,t,o)||vu(i,t,o)?[]:[e]});return hu(n,t,o,e)},yu=function(e){return{fold:e}},xu=function(){return yu(function(e,t,n,r,o){return e()})},Cu=function(i){return yu(function(e,t,n,r,o){return t(i)})},Ru=function(i,u){return yu(function(e,t,n,r,o){return n(i,u)})},Su=function(i,u,a){return yu(function(e,t,n,r,o){return r(i,u,a)})},Tu=function(i,u){return yu(function(e,t,n,r,o){return o(i,u)})},Du=function(e,t,i,u){var n,r,a=e.slice(0),o=(r=t,0===(n=e).length?xu():1===n.length?Cu(0):0===r?Ru(0,1):r===n.length-1?Tu(r-1,r):0<r&&r<n.length-1?Su(r-1,r,r+1):xu()),c=function(e){return E(e,C(0))},l=C(c(a)),f=function(e,t){if(0<=i){var n=Math.max(u.minCellWidth(),a[t]-i);return c(a.slice(0,e)).concat([i,n-a[t]]).concat(c(a.slice(t+1)))}var r=Math.max(u.minCellWidth(),a[e]+i),o=a[e]-r;return c(a.slice(0,e)).concat([r-a[e],o]).concat(c(a.slice(t+1)))},s=f;return o.fold(l,function(e){return u.singleColumnWidth(a[e],i)},s,function(e,t,n){return f(t,n)},function(e,t){if(0<=i)return c(a.slice(0,t)).concat([i]);var n=Math.max(u.minCellWidth(),a[t]+i);return c(a.slice(0,t)).concat([n-a[t]])})},Ou=function(e,t){return yt(e,t)&&1<parseInt(wt(e,t),10)},ku={hasColspan:function(e){return Ou(e,"colspan")},hasRowspan:function(e){return Ou(e,"rowspan")},minWidth:C(10),minHeight:C(10),getInt:function(e,t){return parseInt(nn(e,t),10)}},Nu=function(e,t,n){return on(e,t).fold(function(){return n(e)+"px"},function(e){return e})},Eu=function(e){return Nu(e,"width",fo.getPixelWidth)},Au=function(e){return Nu(e,"height",fo.getHeight)},Pu=function(e,t,n,r,o){var i=vi(e),u=E(i,function(e){return e.map(t.edge)});return E(i,function(e,t){return e.filter(m(ku.hasColspan)).fold(function(){var e=hi(u,t);return r(e)},function(e){return n(e,o)})})},Iu=function(e){return e.map(function(e){return e+"px"}).getOr("")},Bu=function(e,t,n,r){var o=bi(e),i=E(o,function(e){return e.map(t.edge)});return E(o,function(e,t){return e.filter(m(ku.hasRowspan)).fold(function(){var e=hi(i,t);return r(e)},function(e){return n(e)})})},Wu={getRawWidths:function(e,t){return Pu(e,t,Eu,Iu)},getPixelWidths:function(e,t,n){return Pu(e,t,fo.getPixelWidth,function(e){return e.getOrThunk(n.minCellWidth)},n)},getPercentageWidths:function(e,t,n){return Pu(e,t,fo.getPercentageWidth,function(e){return e.fold(function(){return n.minCellWidth()},function(e){return e/n.pixelWidth()*100})},n)},getPixelHeights:function(e,t){return Bu(e,t,fo.getHeight,function(e){return e.getOrThunk(ku.minHeight)})},getRawHeights:function(e,t){return Bu(e,t,Au,Iu)}},Mu=function(e,t,n){for(var r=0,o=e;o<t;o++)r+=n[o]!==undefined?n[o]:0;return r},_u=function(e,n){var t=$t.justCells(e);return E(t,function(e){var t=Mu(e.column(),e.column()+e.colspan(),n);return{element:e.element,width:C(t),colspan:e.colspan}})},Lu=function(e,n){var t=$t.justCells(e);return E(t,function(e){var t=Mu(e.row(),e.row()+e.rowspan(),n);return{element:e.element,height:C(t),rowspan:e.rowspan}})},ju=function(e,n){return E(e.all(),function(e,t){return{element:e.element,height:C(n[t])}})},Fu=function(e){var t=parseInt(e,10),n=o;return{width:C(t),pixelWidth:C(t),getWidths:Wu.getPixelWidths,getCellDelta:n,singleColumnWidth:function(e,t){return[Math.max(ku.minWidth(),e+t)-e]},minCellWidth:ku.minWidth,setElementWidth:fo.setPixelWidth,setTableWidth:function(e,t,n){var r=I(t,function(e,t){return e+t},0);fo.setPixelWidth(e,r)}}},zu=function(e,t){if(fo.percentageBasedSizeRegex().test(t)){var n=fo.percentageBasedSizeRegex().exec(t);return o=n[1],i=e,u=parseFloat(o),a=Jr(i),{width:C(u),pixelWidth:C(a),getWidths:Wu.getPercentageWidths,getCellDelta:function(e){return e/a*100},singleColumnWidth:function(e,t){return[100-e]},minCellWidth:function(){return ku.minWidth()/a*100},setElementWidth:fo.setPercentageWidth,setTableWidth:function(e,t,n){var r=u+n;fo.setPercentageWidth(e,r)}}}if(fo.pixelBasedSizeRegex().test(t)){var r=fo.pixelBasedSizeRegex().exec(t);return Fu(r[1])}var o,i,u,a,c=Jr(e);return Fu(c)},Hu=function(t){return fo.getRawWidth(t).fold(function(){var e=Jr(t);return Fu(e)},function(e){return zu(t,e)})},Uu=function(e){return $t.generate(e)},qu=function(e){var t=Yt(e);return Uu(t)},Vu=function(e,t,n,r){var o=Hu(e),i=o.getCellDelta(t),u=qu(e),a=o.getWidths(u,r,o),c=Du(a,n,i,o),l=E(c,function(e,t){return e+a[t]}),f=_u(u,l);A(f,function(e){o.setElementWidth(e.element(),e.width())}),n===u.grid().columns()-1&&o.setTableWidth(e,l,i)},Gu=function(e,n,r,t){var o=qu(e),i=Wu.getPixelHeights(o,t),u=E(i,function(e,t){return r===t?Math.max(n+e,ku.minHeight()):e}),a=Lu(o,u),c=ju(o,u);A(c,function(e){fo.setHeight(e.element(),e.height())}),A(a,function(e){fo.setHeight(e.element(),e.height())});var l=I(u,function(e,t){return e+t},0);fo.setHeight(e,l)},Yu=function(e,t,n){var r=Hu(e),o=Uu(t),i=r.getWidths(o,n,r),u=_u(o,i);A(u,function(e){r.setElementWidth(e.element(),e.width())});var a=I(i,function(e,t){return t+e},0);0<u.length&&r.setElementWidth(e,a)},Xu=function(e){0===Gt.cells(e).length&&hn(e)},Ku=X("grid","cursor"),Ju=function(e,t,n){return $u(e,t,n).orThunk(function(){return $u(e,0,0)})},$u=function(e,t,n){return R.from(e[t]).bind(function(e){return R.from(e.cells()[n]).bind(function(e){return R.from(e.element())})})},Qu=function(e,t,n){return Ku(e,$u(e,t,n))},Zu=function(e){return B(e,function(e,t){return N(e,function(e){return e.row()===t.row()})?e:e.concat([t])},[]).sort(function(e,t){return e.row()-t.row()})},ea=function(e){return B(e,function(e,t){return N(e,function(e){return e.column()===t.column()})?e:e.concat([t])},[]).sort(function(e,t){return e.column()-t.column()})},ta=function(e,t,n){var r=Xt(e,n),o=$t.generate(r);return li(o,t,!0)},na=Yu,ra={insertRowBefore:zi(function(e,t,n,r){var o=t.row(),i=t.row(),u=lu(e,i,o,n,r.getOrInit);return Qu(u,i,t.column())},Ui,y,y,jo),insertRowsBefore:zi(function(e,t,n,r){var o=t[0].row(),i=t[0].row(),u=Zu(t),a=B(u,function(e,t){return lu(e,i,o,n,r.getOrInit)},e);return Qu(a,i,t[0].column())},qi,y,y,jo),insertRowAfter:zi(function(e,t,n,r){var o=t.row(),i=t.row()+t.rowspan(),u=lu(e,i,o,n,r.getOrInit);return Qu(u,i,t.column())},Ui,y,y,jo),insertRowsAfter:zi(function(e,t,n,r){var o=Zu(t),i=o[o.length-1].row(),u=o[o.length-1].row()+o[o.length-1].rowspan(),a=B(o,function(e,t){return lu(e,u,i,n,r.getOrInit)},e);return Qu(a,u,t[0].column())},qi,y,y,jo),insertColumnBefore:zi(function(e,t,n,r){var o=t.column(),i=t.column(),u=fu(e,i,o,n,r.getOrInit);return Qu(u,t.row(),i)},Ui,na,y,jo),insertColumnsBefore:zi(function(e,t,n,r){var o=ea(t),i=o[0].column(),u=o[0].column(),a=B(o,function(e,t){return fu(e,u,i,n,r.getOrInit)},e);return Qu(a,t[0].row(),u)},qi,na,y,jo),insertColumnAfter:zi(function(e,t,n,r){var o=t.column(),i=t.column()+t.colspan(),u=fu(e,i,o,n,r.getOrInit);return Qu(u,t.row(),i)},Ui,na,y,jo),insertColumnsAfter:zi(function(e,t,n,r){var o=t[t.length-1].column(),i=t[t.length-1].column()+t[t.length-1].colspan(),u=ea(t),a=B(u,function(e,t){return fu(e,i,o,n,r.getOrInit)},e);return Qu(a,t[0].row(),i)},qi,na,y,jo),splitCellIntoColumns:zi(function(e,t,n,r){var o=su(e,t.row(),t.column(),n,r.getOrInit);return Qu(o,t.row(),t.column())},Ui,y,y,jo),splitCellIntoRows:zi(function(e,t,n,r){var o=du(e,t.row(),t.column(),n,r.getOrInit);return Qu(o,t.row(),t.column())},Ui,y,y,jo),eraseColumns:zi(function(e,t,n,r){var o=ea(t),i=gu(e,o[0].column(),o[o.length-1].column()),u=Ju(i,t[0].row(),t[0].column());return Ku(i,u)},qi,na,Xu,jo),eraseRows:zi(function(e,t,n,r){var o=Zu(t),i=mu(e,o[0].row(),o[o.length-1].row()),u=Ju(i,t[0].row(),t[0].column());return Ku(i,u)},qi,y,Xu,jo),makeColumnHeader:zi(function(e,t,n,r){var o=bu(e,t.column(),n,r.replaceOrInit);return Qu(o,t.row(),t.column())},Ui,y,y,Fo("row","th")),unmakeColumnHeader:zi(function(e,t,n,r){var o=bu(e,t.column(),n,r.replaceOrInit);return Qu(o,t.row(),t.column())},Ui,y,y,Fo(null,"td")),makeRowHeader:zi(function(e,t,n,r){var o=wu(e,t.row(),n,r.replaceOrInit);return Qu(o,t.row(),t.column())},Ui,y,y,Fo("col","th")),unmakeRowHeader:zi(function(e,t,n,r){var o=wu(e,t.row(),n,r.replaceOrInit);return Qu(o,t.row(),t.column())},Ui,y,y,Fo(null,"td")),mergeCells:zi(function(e,t,n,r){var o=t.cells();Qo(o);var i=ou(e,t.bounds(),n,C(o[0]));return Ku(i,R.from(o[0]))},Yi,y,y,zo),unmergeCells:zi(function(e,t,n,r){var o=I(t,function(e,t){return iu(e,t,n,r.combine(t))},e);return Ku(o,R.from(t[0]))},Xi,y,y,zo),pasteCells:zi(function(e,n,t,r){var o,i,u,a,c=(o=n.clipboard(),i=n.generators(),u=Yt(o),a=$t.generate(u),li(a,i,!0)),l=ae.address(n.row(),n.column());return au(l,e,c,n.generators(),t).fold(function(){return Ku(e,R.some(n.element()))},function(e){var t=Ju(e,n.row(),n.column());return Ku(e,t)})},Vi,na,y,jo),pasteRowsBefore:zi(function(e,t,n,r){var o=e[t.cells[0].row()],i=t.cells[0].row(),u=ta(t.clipboard(),t.generators(),o),a=cu(i,e,u,t.generators(),n),c=Ju(a,t.cells[0].row(),t.cells[0].column());return Ku(a,c)},Gi,y,y,jo),pasteRowsAfter:zi(function(e,t,n,r){var o=e[t.cells[0].row()],i=t.cells[t.cells.length-1].row()+t.cells[t.cells.length-1].rowspan(),u=ta(t.clipboard(),t.generators(),o),a=cu(i,e,u,t.generators(),n),c=Ju(a,t.cells[0].row(),t.cells[0].column());return Ku(a,c)},Gi,y,y,jo)},oa=function(e){return le.fromDom(e.getBody())},ia=function(e){return e.getBoundingClientRect().width},ua=function(e){return e.getBoundingClientRect().height},aa=function(t){return function(e){return $e(e,oa(t))}},ca=function(e){return/^[0-9]+$/.test(e)&&(e+="px"),e},la=function(e){var t=Nt(e,"td[data-mce-style],th[data-mce-style]");xt(e,"data-mce-style"),A(t,function(e){xt(e,"data-mce-style")})},fa={isRtl:C(!1)},sa={isRtl:C(!0)},da={directionAt:function(e){return"rtl"==("rtl"===nn(e,"direction")?"rtl":"ltr")?sa:fa}},ma=["tableprops","tabledelete","|","tableinsertrowbefore","tableinsertrowafter","tabledeleterow","|","tableinsertcolbefore","tableinsertcolafter","tabledeletecol"],ga={"border-collapse":"collapse",width:"100%"},ha={border:"1"},pa=function(e){return e.getParam("table_cell_advtab",!0,"boolean")},va=function(e){return e.getParam("table_row_advtab",!0,"boolean")},ba=function(e){return e.getParam("table_advtab",!0,"boolean")},wa=function(e){return e.getParam("table_style_by_css",!1,"boolean")},ya=function(e){return e.getParam("table_cell_class_list",[],"array")},xa=function(e){return e.getParam("table_row_class_list",[],"array")},Ca=function(e){return e.getParam("table_class_list",[],"array")},Ra=function(e){return!1===e.getParam("table_responsive_width")},Sa=function(e,t){return e.fire("newrow",{node:t})},Ta=function(e,t){return e.fire("newcell",{node:t})},Da=function(e,t,n,r){e.fire("ObjectResizeStart",{target:t,width:n,height:r})},Oa=function(e,t,n,r){e.fire("ObjectResized",{target:t,width:n,height:r})},ka=function(f,e){var t,n=function(e){return"table"===lt(oa(e))},s=(t=f.getParam("table_clone_elements"),v(t)?R.some(t.split(/[ ,]/)):Array.isArray(t)?R.some(t):R.none()),r=function(u,a,c,l){return function(e,t){la(e);var n=l(),r=le.fromDom(f.getDoc()),o=Eo(da.directionAt),i=_n(c,r,s);return a(e)?u(n,e,t,i,o).bind(function(e){return A(e.newRows(),function(e){Sa(f,e.dom())}),A(e.newCells(),function(e){Ta(f,e.dom())}),e.cursor().map(function(e){var t=f.dom.createRng();return t.setStart(e.dom(),0),t.setEnd(e.dom(),0),t})}):R.none()}};return{deleteRow:r(ra.eraseRows,function(e){var t=Po(e);return!1===n(f)||1<t.rows()},y,e),deleteColumn:r(ra.eraseColumns,function(e){var t=Po(e);return!1===n(f)||1<t.columns()},y,e),insertRowsBefore:r(ra.insertRowsBefore,l,y,e),insertRowsAfter:r(ra.insertRowsAfter,l,y,e),insertColumnsBefore:r(ra.insertColumnsBefore,l,so,e),insertColumnsAfter:r(ra.insertColumnsAfter,l,so,e),mergeCells:r(ra.mergeCells,l,y,e),unmergeCells:r(ra.unmergeCells,l,y,e),pasteRowsBefore:r(ra.pasteRowsBefore,l,y,e),pasteRowsAfter:r(ra.pasteRowsAfter,l,y,e),pasteCells:r(ra.pasteCells,l,y,e)}},Na=function(e,t,r){var n=Yt(e),o=$t.generate(n);return qi(o,t).map(function(e){var t=li(o,r,!1).slice(e[0].row(),e[e.length-1].row()+e[e.length-1].rowspan()),n=Hi(t,r);return di(n)})},Ea=tinymce.util.Tools.resolve("tinymce.util.Tools"),Aa=function(e,t,n){n&&e.formatter.apply("align"+n,{},t)},Pa=function(e,t,n){n&&e.formatter.apply("valign"+n,{},t)},Ia=function(t,n){Ea.each("left center right".split(" "),function(e){t.formatter.remove("align"+e,{},n)})},Ba=function(t,n){Ea.each("top middle bottom".split(" "),function(e){t.formatter.remove("valign"+e,{},n)})},Wa=function(o,e,i){var t;return t=function(e,t){for(var n=0;n<t.length;n++){var r=o.getStyle(t[n],i);if(void 0===e&&(e=r),e!==r)return""}return e}(t,o.select("td,th",e))},Ma=function(e,t){var n=e.dom,r=t.control.rootControl,o=r.toJSON(),i=n.parseStyle(o.style);i["border-style"]=o.borderStyle,i["border-color"]=o.borderColor,i["background-color"]=o.backgroundColor,i.width=o.width?ca(o.width):"",i.height=o.height?ca(o.height):"",r.find("#style").value(n.serializeStyle(n.parseStyle(n.serializeStyle(i))))},_a=function(e,t){var n=e.dom,r=t.control.rootControl,o=r.toJSON(),i=n.parseStyle(o.style);r.find("#borderStyle").value(i["border-style"]||""),r.find("#borderColor").value(i["border-color"]||""),r.find("#backgroundColor").value(i["background-color"]||""),r.find("#width").value(i.width||""),r.find("#height").value(i.height||"")},La={createStyleForm:function(n){var e=function(){var e=n.getParam("color_picker_callback");if(e)return function(t){return e.call(n,function(e){t.control.value(e).fire("change")},t.control.value())}};return{title:"Advanced",type:"form",defaults:{onchange:b(Ma,n)},items:[{label:"Style",name:"style",type:"textbox",onchange:b(_a,n)},{type:"form",padding:0,formItemDefaults:{layout:"grid",alignH:["start","right"]},defaults:{size:7},items:[{label:"Border style",type:"listbox",name:"borderStyle",width:90,onselect:b(Ma,n),values:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]},{label:"Border color",type:"colorbox",name:"borderColor",onaction:e()},{label:"Background color",type:"colorbox",name:"backgroundColor",onaction:e()}]}]}},buildListItems:function(e,r,t){var o=function(e,n){return n=n||[],Ea.each(e,function(e){var t={text:e.text||e.title};e.menu?t.menu=o(e.menu):(t.value=e.value,r&&r(t)),n.push(t)}),n};return o(e,t||[])},updateStyleField:Ma,extractAdvancedStyles:function(e,t){var n=e.parseStyle(e.getAttrib(t,"style")),r={};return n["border-style"]&&(r.borderStyle=n["border-style"]),n["border-color"]&&(r.borderColor=n["border-color"]),n["background-color"]&&(r.backgroundColor=n["background-color"]),r.style=e.serializeStyle(n),r},updateAdvancedFields:_a,syncAdvancedStyleFields:function(e,t){t.control.rootControl.find("#style")[0].getEl().isEqualNode(document.activeElement)?_a(e,t):Ma(e,t)}},ja=function(r,o,e){var i,u=r.dom;function a(e,t,n){(1===o.length||n)&&u.setAttrib(e,t,n)}function c(e,t,n){(1===o.length||n)&&u.setStyle(e,t,n)}pa(r)&&La.syncAdvancedStyleFields(r,e),i=e.control.rootControl.toJSON(),r.undoManager.transact(function(){Ea.each(o,function(e){var t,n;a(e,"scope",i.scope),1===o.length?a(e,"style",i.style):(t=e,n=i.style,delete t.dataset.mceStyle,t.style.cssText+=";"+n),a(e,"class",i["class"]),c(e,"width",ca(i.width)),c(e,"height",ca(i.height)),i.type&&e.nodeName.toLowerCase()!==i.type&&(e=u.rename(e,i.type)),1===o.length&&(Ia(r,e),Ba(r,e)),i.align&&Aa(r,e,i.align),i.valign&&Pa(r,e,i.valign)}),r.focus()})},Fa=function(t){var e,n,r,o=[];if(o=t.dom.select("td[data-mce-selected],th[data-mce-selected]"),e=t.dom.getParent(t.selection.getStart(),"td,th"),!o.length&&e&&o.push(e),e=e||o[0]){var i,u,a,c;1<o.length?n={width:"",height:"",scope:"","class":"",align:"",valign:"",style:"",type:e.nodeName.toLowerCase()}:(u=e,a=(i=t).dom,c={width:a.getStyle(u,"width")||a.getAttrib(u,"width"),height:a.getStyle(u,"height")||a.getAttrib(u,"height"),scope:a.getAttrib(u,"scope"),"class":a.getAttrib(u,"class"),type:u.nodeName.toLowerCase(),style:"",align:"",valign:""},Ea.each("left center right".split(" "),function(e){i.formatter.matchNode(u,"align"+e)&&(c.align=e)}),Ea.each("top middle bottom".split(" "),function(e){i.formatter.matchNode(u,"valign"+e)&&(c.valign=e)}),pa(i)&&Ea.extend(c,La.extractAdvancedStyles(a,u)),n=c),0<ya(t).length&&(r={name:"class",type:"listbox",label:"Class",values:La.buildListItems(ya(t),function(e){e.value&&(e.textStyle=function(){return t.formatter.getCssText({block:"td",classes:[e.value]})})})});var l={type:"form",layout:"flex",direction:"column",labelGapCalc:"children",padding:0,items:[{type:"form",layout:"grid",columns:2,labelGapCalc:!1,padding:0,defaults:{type:"textbox",maxWidth:50},items:[{label:"Width",name:"width",onchange:b(La.updateStyleField,t)},{label:"Height",name:"height",onchange:b(La.updateStyleField,t)},{label:"Cell type",name:"type",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{label:"Scope",name:"scope",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{label:"H Align",name:"align",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"V Align",name:"valign",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}]}]},r]};pa(t)?t.windowManager.open({title:"Cell properties",bodyType:"tabpanel",data:n,body:[{title:"General",type:"form",items:l},La.createStyleForm(t)],onsubmit:b(ja,t,o)}):t.windowManager.open({title:"Cell properties",data:n,body:l,onsubmit:b(ja,t,o)})}};function za(f,s,d,e){var m=f.dom;function g(e,t,n){(1===s.length||n)&&m.setAttrib(e,t,n)}va(f)&&La.syncAdvancedStyleFields(f,e);var h=e.control.rootControl.toJSON();f.undoManager.transact(function(){Ea.each(s,function(e){var t,n,r,o,i,u,a,c,l;g(e,"scope",h.scope),g(e,"style",h.style),g(e,"class",h["class"]),t=e,n="height",r=ca(h.height),(1===s.length||r)&&m.setStyle(t,n,r),h.type!==e.parentNode.nodeName.toLowerCase()&&(o=f.dom,i=e,u=h.type,a=o.getParent(i,"table"),c=i.parentNode,(l=o.select(u,a)[0])||(l=o.create(u),a.firstChild?"CAPTION"===a.firstChild.nodeName?o.insertAfter(l,a.firstChild):a.insertBefore(l,a.firstChild):a.appendChild(l)),l.appendChild(i),c.hasChildNodes()||o.remove(c)),h.align!==d.align&&(Ia(f,e),Aa(f,e,h.align))}),f.focus()})}var Ha=function(t){var e,n,r,o,i,u,a,c,l,f,s=t.dom,d=[];e=s.getParent(t.selection.getStart(),"table"),n=s.getParent(t.selection.getStart(),"td,th"),Ea.each(e.rows,function(t){Ea.each(t.cells,function(e){if(s.getAttrib(e,"data-mce-selected")||e===n)return d.push(t),!1})}),(r=d[0])&&(1<d.length?i={height:"",scope:"",style:"","class":"",align:"",type:r.parentNode.nodeName.toLowerCase()}:(c=r,l=(a=t).dom,f={height:l.getStyle(c,"height")||l.getAttrib(c,"height"),scope:l.getAttrib(c,"scope"),"class":l.getAttrib(c,"class"),align:"",style:"",type:c.parentNode.nodeName.toLowerCase()},Ea.each("left center right".split(" "),function(e){a.formatter.matchNode(c,"align"+e)&&(f.align=e)}),va(a)&&Ea.extend(f,La.extractAdvancedStyles(l,c)),i=f),0<xa(t).length&&(o={name:"class",type:"listbox",label:"Class",values:La.buildListItems(xa(t),function(e){e.value&&(e.textStyle=function(){return t.formatter.getCssText({block:"tr",classes:[e.value]})})})}),u={type:"form",columns:2,padding:0,defaults:{type:"textbox"},items:[{type:"listbox",name:"type",label:"Row type",text:"Header",maxWidth:null,values:[{text:"Header",value:"thead"},{text:"Body",value:"tbody"},{text:"Footer",value:"tfoot"}]},{type:"listbox",name:"align",label:"Alignment",text:"None",maxWidth:null,values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height"},o]},va(t)?t.windowManager.open({title:"Row properties",data:i,bodyType:"tabpanel",body:[{title:"General",type:"form",items:u},La.createStyleForm(t)],onsubmit:b(za,t,d,i)}):t.windowManager.open({title:"Row properties",data:i,body:u,onsubmit:b(za,t,d,i)}))},Ua=tinymce.util.Tools.resolve("tinymce.Env"),qa={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},percentages:!0},Va=function(e,t,n,r,o){void 0===o&&(o=qa);var i=le.fromTag("table");tn(i,o.styles),bt(i,o.attributes);var u=le.fromTag("tbody");fn(i,u);for(var a=[],c=0;c<e;c++){for(var l=le.fromTag("tr"),f=0;f<t;f++){var s=c<n||f<r?le.fromTag("th"):le.fromTag("td");f<r&&vt(s,"scope","row"),c<n&&vt(s,"scope","col"),fn(s,le.fromTag("br")),o.percentages&&en(s,"width",100/t+"%"),fn(l,s)}a.push(l)}return mn(u,a),i},Ga=function(e,t){e.selection.select(t.dom(),!0),e.selection.collapse(!0)},Ya=function(r,e,t){var n,o,i=r.getParam("table_default_styles",ga,"object"),u={styles:i,attributes:(o=r,o.getParam("table_default_attributes",ha,"object")),percentages:(n=i.width,v(n)&&-1!==n.indexOf("%")&&!Ra(r))},a=Va(t,e,0,0,u);vt(a,"data-mce-id","__mce");var c,l,f,s=(c=a,l=le.fromTag("div"),f=le.fromDom(c.dom().cloneNode(!0)),fn(l,f),l.dom().innerHTML);return r.insertContent(s),jt(oa(r),'table[data-mce-id="__mce"]').map(function(e){var t,n;return Ra(r)&&en(e,"width",nn(e,"width")),xt(e,"data-mce-id"),t=r,A(Nt(e,"tr"),function(e){Sa(t,e.dom()),A(Nt(e,"th,td"),function(e){Ta(t,e.dom())})}),n=r,jt(e,"td,th").each(b(Ga,n)),e.dom()}).getOr(null)};function Xa(e,t,n,r){if("TD"===t.tagName||"TH"===t.tagName)e.setStyle(t,n,r);else if(t.children)for(var o=0;o<t.children.length;o++)Xa(e,t.children[o],n,r)}var Ka=function(e,t,n){var r,o,i=e.dom;ba(e)&&La.syncAdvancedStyleFields(e,n),!1===(o=n.control.rootControl.toJSON())["class"]&&delete o["class"],e.undoManager.transact(function(){t||(t=Ya(e,o.cols||1,o.rows||1)),function(e,t,n){var r,o=e.dom,i={},u={};if(i["class"]=n["class"],u.height=ca(n.height),o.getAttrib(t,"width")&&!wa(e)?i.width=(r=n.width)?r.replace(/px$/,""):"":u.width=ca(n.width),wa(e)?(u["border-width"]=ca(n.border),u["border-spacing"]=ca(n.cellspacing),Ea.extend(i,{"data-mce-border-color":n.borderColor,"data-mce-cell-padding":n.cellpadding,"data-mce-border":n.border})):Ea.extend(i,{border:n.border,cellpadding:n.cellpadding,cellspacing:n.cellspacing}),wa(e)&&t.children)for(var a=0;a<t.children.length;a++)Xa(o,t.children[a],{"border-width":ca(n.border),"border-color":n.borderColor,padding:ca(n.cellpadding)});n.style?Ea.extend(u,o.parseStyle(n.style)):u=Ea.extend({},o.parseStyle(o.getAttrib(t,"style")),u),i.style=o.serializeStyle(u),o.setAttribs(t,i)}(e,t,o),(r=i.select("caption",t)[0])&&!o.caption&&i.remove(r),!r&&o.caption&&((r=i.create("caption")).innerHTML=Ua.ie?"\xa0":'<br data-mce-bogus="1"/>',t.insertBefore(r,t.firstChild)),Ia(e,t),o.align&&Aa(e,t,o.align),e.focus(),e.addVisual()})},Ja=function(t,e){var n,r,o,i,u,a,c,l,f,s,d=t.dom,m={};!0===e?(n=d.getParent(t.selection.getStart(),"table"))&&(c=n,l=(a=t).dom,f={width:l.getStyle(c,"width")||l.getAttrib(c,"width"),height:l.getStyle(c,"height")||l.getAttrib(c,"height"),cellspacing:l.getStyle(c,"border-spacing")||l.getAttrib(c,"cellspacing"),cellpadding:l.getAttrib(c,"data-mce-cell-padding")||l.getAttrib(c,"cellpadding")||Wa(a.dom,c,"padding"),border:l.getAttrib(c,"data-mce-border")||l.getAttrib(c,"border")||Wa(a.dom,c,"border"),borderColor:l.getAttrib(c,"data-mce-border-color"),caption:!!l.select("caption",c)[0],"class":l.getAttrib(c,"class")},Ea.each("left center right".split(" "),function(e){a.formatter.matchNode(c,"align"+e)&&(f.align=e)}),ba(a)&&Ea.extend(f,La.extractAdvancedStyles(l,c)),m=f):(r={label:"Cols",name:"cols"},o={label:"Rows",name:"rows"}),0<Ca(t).length&&(m["class"]&&(m["class"]=m["class"].replace(/\s*mce\-item\-table\s*/g,"")),i={name:"class",type:"listbox",label:"Class",values:La.buildListItems(Ca(t),function(e){e.value&&(e.textStyle=function(){return t.formatter.getCssText({block:"table",classes:[e.value]})})})}),u={type:"form",layout:"flex",direction:"column",labelGapCalc:"children",padding:0,items:[{type:"form",labelGapCalc:!1,padding:0,layout:"grid",columns:2,defaults:{type:"textbox",maxWidth:50},items:(s=t,s.getParam("table_appearance_options",!0,"boolean")?[r,o,{label:"Width",name:"width",onchange:b(La.updateStyleField,t)},{label:"Height",name:"height",onchange:b(La.updateStyleField,t)},{label:"Cell spacing",name:"cellspacing"},{label:"Cell padding",name:"cellpadding"},{label:"Border",name:"border"},{label:"Caption",name:"caption",type:"checkbox"}]:[r,o,{label:"Width",name:"width",onchange:b(La.updateStyleField,t)},{label:"Height",name:"height",onchange:b(La.updateStyleField,t)}])},{label:"Alignment",name:"align",type:"listbox",text:"None",values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},i]},ba(t)?t.windowManager.open({title:"Table properties",data:m,bodyType:"tabpanel",body:[{title:"General",type:"form",items:u},La.createStyleForm(t)],onsubmit:b(Ka,t,n)}):t.windowManager.open({title:"Table properties",data:m,body:u,onsubmit:b(Ka,t,n)})},$a=Ea.each,Qa=function(a,t,c,l,n){var r=aa(a),f=function(){return le.fromDom(a.dom.getParent(a.selection.getStart(),"th,td"))},s=function(e){return Gt.table(e,r)},d=function(e){return{width:ia(e.dom()),height:ia(e.dom())}},o=function(t){var n=f();s(n).each(function(i){var e=Ur.forMenu(l,i,n),u=d(i);t(i,e).each(function(e){var t,n,r,o;t=a,n=u,o=d(r=i),n.width===o.width&&n.height===o.height||(Da(t,r.dom(),n.width,n.height),Oa(t,r.dom(),o.width,o.height)),a.selection.setRng(e),a.focus(),c.clear(i),la(i)})})},i=function(e){var o=f();return s(o).bind(function(e){var t=le.fromDom(a.getDoc()),n=Ur.forMenu(l,e,o),r=_n(y,t,R.none());return Na(e,n,r)})},u=function(u){n.get().each(function(e){var o=E(e,function(e){return xn(e)}),i=f();s(i).bind(function(t){var e=le.fromDom(a.getDoc()),n=Ln(e),r=Ur.pasteRows(l,t,i,o,n);u(t,r).each(function(e){a.selection.setRng(e),a.focus(),c.clear(t)})})})};$a({mceTableSplitCells:function(){o(t.unmergeCells)},mceTableMergeCells:function(){o(t.mergeCells)},mceTableInsertRowBefore:function(){o(t.insertRowsBefore)},mceTableInsertRowAfter:function(){o(t.insertRowsAfter)},mceTableInsertColBefore:function(){o(t.insertColumnsBefore)},mceTableInsertColAfter:function(){o(t.insertColumnsAfter)},mceTableDeleteCol:function(){o(t.deleteColumn)},mceTableDeleteRow:function(){o(t.deleteRow)},mceTableCutRow:function(e){n.set(i()),o(t.deleteRow)},mceTableCopyRow:function(e){n.set(i())},mceTablePasteRowBefore:function(e){u(t.pasteRowsBefore)},mceTablePasteRowAfter:function(e){u(t.pasteRowsAfter)},mceTableDelete:function(){var e=le.fromDom(a.dom.getParent(a.selection.getStart(),"th,td"));Gt.table(e,r).filter(m(r)).each(function(e){var t=le.fromText("");cn(e,t),hn(e);var n=a.dom.createRng();n.setStart(t.dom(),0),n.setEnd(t.dom(),0),a.selection.setRng(n)})}},function(e,t){a.addCommand(t,e)}),$a({mceInsertTable:b(Ja,a),mceTableProps:b(Ja,a,!0),mceTableRowProps:b(Ha,a),mceTableCellProps:b(Fa,a)},function(n,e){a.addCommand(e,function(e,t){n(t)})})},Za=function(e){var t=R.from(e.dom().documentElement).map(le.fromDom).getOr(e);return{parent:C(t),view:C(e),origin:C(go(0,0))}},ec=function(e,t){return{parent:C(t),view:C(e),origin:C(go(0,0))}};function tc(e){var n=X.apply(null,e),r=[];return{bind:function(e){if(e===undefined)throw"Event bind error: undefined handler";r.push(e)},unbind:function(t){r=P(r,function(e){return e!==t})},trigger:function(){var t=n.apply(null,arguments);A(r,function(e){e(t)})}}}var nc={create:function(e){return{registry:G(e,function(e){return{bind:e.bind,unbind:e.unbind}}),trigger:G(e,function(e){return e.trigger})}}},rc={mode:Mo(["compare","extract","mutate","sink"]),sink:Mo(["element","start","stop","destroy"]),api:Mo(["forceDrop","drop","move","delayDrop"])},oc={resolve:xi("ephox-dragster").resolve},ic=function(m,g){return function(e){if(m(e)){var t,n,r,o,i,u,a,c=le.fromDom(e.target),l=function(){e.stopPropagation()},f=function(){e.preventDefault()},s=x(f,l),d=(t=c,n=e.clientX,r=e.clientY,o=l,i=f,u=s,a=e,{target:C(t),x:C(n),y:C(r),stop:o,prevent:i,kill:u,raw:C(a)});g(d)}}},uc=function(e,t,n,r){return o=e,i=t,u=!1,a=ic(n,r),o.dom().addEventListener(i,a,u),{unbind:b(ac,o,i,a,u)};var o,i,u,a},ac=function(e,t,n,r){e.dom().removeEventListener(t,n,r)},cc=C(!0),lc=function(e,t,n){return uc(e,t,cc,n)},fc=rc.mode({compare:function(e,t){return go(t.left()-e.left(),t.top()-e.top())},extract:function(e){return R.some(go(e.x(),e.y()))},sink:function(e,t){var n,r,o,i=(n=t,r=ei({layerClass:oc.resolve("blocker")},n),o=le.fromTag("div"),vt(o,"role","presentation"),tn(o,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),Oi(o,oc.resolve("blocker")),Oi(o,r.layerClass),{element:function(){return o},destroy:function(){hn(o)}}),u=lc(i.element(),"mousedown",e.forceDrop),a=lc(i.element(),"mouseup",e.drop),c=lc(i.element(),"mousemove",e.move),l=lc(i.element(),"mouseout",e.delayDrop);return rc.sink({element:i.element,start:function(e){fn(e,i.element())},stop:function(){hn(i.element())},destroy:function(){i.destroy(),a.unbind(),c.unbind(),l.unbind(),u.unbind()}})},mutate:function(e,t){e.mutate(t.left(),t.top())}});function sc(){var i=R.none(),u=nc.create({move:tc(["info"])});return{onEvent:function(e,o){o.extract(e).each(function(e){var t,n,r;(t=o,n=e,r=i.map(function(e){return t.compare(e,n)}),i=R.some(n),r).each(function(e){u.trigger.move(e)})})},reset:function(){i=R.none()},events:u.registry}}function dc(){var e={onEvent:function(e,t){},reset:y},t=sc(),n=e;return{on:function(){n.reset(),n=t},off:function(){n.reset(),n=e},isOn:function(){return n===t},onEvent:function(e,t){n.onEvent(e,t)},events:t.events}}var mc=function(t,n,e){var r,o,i,u=!1,a=nc.create({start:tc([]),stop:tc([])}),c=dc(),l=function(){d.stop(),c.isOn()&&(c.off(),a.trigger.stop())},f=(r=l,o=200,i=null,{cancel:function(){null!==i&&(clearTimeout(i),i=null)},throttle:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];null!==i&&clearTimeout(i),i=setTimeout(function(){r.apply(null,e),i=null},o)}});c.events.move.bind(function(e){n.mutate(t,e.info())});var s=function(t){return function(){var e=Array.prototype.slice.call(arguments,0);if(u)return t.apply(null,e)}},d=n.sink(rc.api({forceDrop:l,drop:s(l),move:s(function(e,t){f.cancel(),c.onEvent(e,n)}),delayDrop:s(f.throttle)}),e);return{element:d.element,go:function(e){d.start(e),c.on(),a.trigger.start()},on:function(){u=!0},off:function(){u=!1},destroy:function(){d.destroy()},events:a.registry}},gc={transform:function(e,t){var n=t!==undefined?t:{},r=n.mode!==undefined?n.mode:fc;return mc(e,r,t)}};function hc(){var n,r=nc.create({drag:tc(["xDelta","yDelta","target"])}),o=R.none(),e={mutate:function(e,t){n.trigger.drag(e,t)},events:(n=nc.create({drag:tc(["xDelta","yDelta"])})).registry};return e.events.drag.bind(function(t){o.each(function(e){r.trigger.drag(t.xDelta(),t.yDelta(),e)})}),{assign:function(e){o=R.some(e)},get:function(){return o},mutate:e.mutate,events:r.registry}}var pc=function(e,t,n){return Ft(e,t,n).isSome()},vc=Ci.resolve("resizer-bar-dragging");function bc(e,n){var r=ko.height,t=function(o,t,i){var n=hc(),r=gc.transform(n,{}),u=R.none(),e=function(e,t){return R.from(wt(e,t))};n.events.drag.bind(function(n){e(n.target(),"data-row").each(function(e){var t=ku.getInt(n.target(),"top");en(n.target(),"top",t+n.yDelta()+"px")}),e(n.target(),"data-column").each(function(e){var t=ku.getInt(n.target(),"left");en(n.target(),"left",t+n.xDelta()+"px")})});var a=function(e,t){return ku.getInt(e,t)-parseInt(wt(e,"data-initial-"+t),10)};r.events.stop.bind(function(){n.get().each(function(r){u.each(function(n){e(r,"data-row").each(function(e){var t=a(r,"top");xt(r,"data-initial-top"),d.trigger.adjustHeight(n,t,parseInt(e,10))}),e(r,"data-column").each(function(e){var t=a(r,"left");xt(r,"data-initial-left"),d.trigger.adjustWidth(n,t,parseInt(e,10))}),_i.refresh(o,n,i,t)})})});var c=function(e,t){d.trigger.startAdjust(),n.assign(e),vt(e,"data-initial-"+t,parseInt(nn(e,t),10)),Oi(e,vc),en(e,"opacity","0.2"),r.go(o.parent())},l=lc(o.parent(),"mousedown",function(e){_i.isRowBar(e.target())&&c(e.target(),"top"),_i.isColBar(e.target())&&c(e.target(),"left")}),f=function(e){return $e(e,o.view())},s=lc(o.view(),"mouseover",function(e){"table"===lt(e.target())||pc(e.target(),"table",f)?(u="table"===lt(e.target())?R.some(e.target()):_t(e.target(),"table",f)).each(function(e){_i.refresh(o,e,i,t)}):Rt(e.target())&&_i.destroy(o)}),d=nc.create({adjustHeight:tc(["table","delta","row"]),adjustWidth:tc(["table","delta","column"]),startAdjust:tc([])});return{destroy:function(){l.unbind(),s.unbind(),r.destroy(),_i.destroy(o)},refresh:function(e){_i.refresh(o,e,i,t)},on:r.on,off:r.off,hideBars:b(_i.hide,o),showBars:b(_i.show,o),events:d.registry}}(e,n,r),o=nc.create({beforeResize:tc(["table"]),afterResize:tc(["table"]),startDrag:tc([])});return t.events.adjustHeight.bind(function(e){o.trigger.beforeResize(e.table());var t=r.delta(e.delta(),e.table());Gu(e.table(),t,e.row(),r),o.trigger.afterResize(e.table())}),t.events.startAdjust.bind(function(e){o.trigger.startDrag()}),t.events.adjustWidth.bind(function(e){o.trigger.beforeResize(e.table());var t=n.delta(e.delta(),e.table());Vu(e.table(),t,e.column(),n),o.trigger.afterResize(e.table())}),{on:t.on,off:t.off,hideBars:t.hideBars,showBars:t.showBars,destroy:t.destroy,events:o.registry}}var wc=function(e,t){return e.inline?ec(oa(e),(n=le.fromTag("div"),tn(n,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),fn(St(),n),n)):Za(le.fromDom(e.getDoc()));var n},yc=function(e,t){e.inline&&hn(t.parent())},xc=function(u){var a,c,o=R.none(),i=R.none(),l=R.none(),f=/(\d+(\.\d+)?)%/,s=function(e){return"TABLE"===e.nodeName};return u.on("init",function(){var e,t=Eo(da.directionAt),n=wc(u);if(l=R.some(n),("table"===(e=u.getParam("object_resizing",!0))||e)&&u.getParam("table_resize_bars",!0,"boolean")){var r=bc(n,t);r.on(),r.events.startDrag.bind(function(e){o=R.some(u.selection.getRng())}),r.events.beforeResize.bind(function(e){var t=e.table().dom();Da(u,t,ia(t),ua(t))}),r.events.afterResize.bind(function(e){var t=e.table(),n=t.dom();la(t),o.each(function(e){u.selection.setRng(e),u.focus()}),Oa(u,n,ia(n),ua(n)),u.undoManager.add()}),i=R.some(r)}}),u.on("ObjectResizeStart",function(e){var t,n=e.target;s(n)&&(a=e.width,t=n,c=u.dom.getStyle(t,"width")||u.dom.getAttrib(t,"width"))}),u.on("ObjectResized",function(e){var t=e.target;if(s(t)){var n=t;if(f.test(c)){var r=parseFloat(f.exec(c)[1]),o=e.width*r/a;u.dom.setStyle(n,"width",o+"%")}else{var i=[];Ea.each(n.rows,function(e){Ea.each(e.cells,function(e){var t=u.dom.getStyle(e,"width",!0);i.push({cell:e,width:t})})}),Ea.each(i,function(e){u.dom.setStyle(e.cell,"width",e.width),u.dom.setAttrib(e.cell,"width",null)})}}}),{lazyResize:function(){return i},lazyWire:function(){return l.getOr(Za(le.fromDom(u.getBody())))},destroy:function(){i.each(function(e){e.destroy()}),l.each(function(e){yc(u,e)})}}},Cc=function(e){return{fold:e}},Rc=function(o){return Cc(function(e,t,n,r){return e(o)})},Sc=function(o){return Cc(function(e,t,n,r){return t(o)})},Tc=function(o,i){return Cc(function(e,t,n,r){return n(o,i)})},Dc=function(o){return Cc(function(e,t,n,r){return r(o)})},Oc=function(n,e){return Gt.table(n,e).bind(function(e){var t=Gt.cells(e);return M(t,function(e){return $e(n,e)}).map(function(e){return{index:C(e),all:C(t)}})})},kc=function(t,e){return Oc(t,e).fold(function(){return Rc(t)},function(e){return e.index()+1<e.all().length?Tc(t,e.all()[e.index()+1]):Dc(t)})},Nc=function(t,e){return Oc(t,e).fold(function(){return Rc()},function(e){return 0<=e.index()-1?Tc(t,e.all()[e.index()-1]):Sc(t)})},Ec=Br([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Ac={before:Ec.before,on:Ec.on,after:Ec.after,cata:function(e,t,n,r){return e.fold(t,n,r)},getStart:function(e){return e.fold(o,o,o)}},Pc=Br([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Ic=X("start","soffset","finish","foffset"),Bc=function(e){var t,n=e.match({domRange:function(e){return le.fromDom(e.startContainer)},relative:function(e,t){return Ac.getStart(e)},exact:function(e,t,n,r){return e}});return t=n.dom().ownerDocument.defaultView,le.fromDom(t)},Wc=(Pc.domRange,Pc.relative),Mc=Pc.exact,_c=function(e,t,n,r){var o,i,u,a,c,l=(i=t,u=n,a=r,(c=et(o=e).dom().createRange()).setStart(o.dom(),i),c.setEnd(u.dom(),a),c),f=$e(e,n)&&t===r;return l.collapsed&&!f},Lc=function(e,t){e.selectNodeContents(t.dom())},jc=function(e,t,n){var r,o,i=e.document.createRange();return r=i,t.fold(function(e){r.setStartBefore(e.dom())},function(e,t){r.setStart(e.dom(),t)},function(e){r.setStartAfter(e.dom())}),o=i,n.fold(function(e){o.setEndBefore(e.dom())},function(e,t){o.setEnd(e.dom(),t)},function(e){o.setEndAfter(e.dom())}),i},Fc=function(e,t,n,r,o){var i=e.document.createRange();return i.setStart(t.dom(),n),i.setEnd(r.dom(),o),i},zc=function(e){return{left:C(e.left),top:C(e.top),right:C(e.right),bottom:C(e.bottom),width:C(e.width),height:C(e.height)}},Hc=Br([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Uc=function(e,t,n){return t(le.fromDom(n.startContainer),n.startOffset,le.fromDom(n.endContainer),n.endOffset)},qc=function(e,t){var o,n,r,i=(o=e,t.match({domRange:function(e){return{ltr:C(e),rtl:R.none}},relative:function(e,t){return{ltr:Se(function(){return jc(o,e,t)}),rtl:Se(function(){return R.some(jc(o,t,e))})}},exact:function(e,t,n,r){return{ltr:Se(function(){return Fc(o,e,t,n,r)}),rtl:Se(function(){return R.some(Fc(o,n,r,e,t))})}}}));return(r=(n=i).ltr()).collapsed?n.rtl().filter(function(e){return!1===e.collapsed}).map(function(e){return Hc.rtl(le.fromDom(e.endContainer),e.endOffset,le.fromDom(e.startContainer),e.startOffset)}).getOrThunk(function(){return Uc(0,Hc.ltr,r)}):Uc(0,Hc.ltr,r)},Vc=function(i,e){return qc(i,e).match({ltr:function(e,t,n,r){var o=i.document.createRange();return o.setStart(e.dom(),t),o.setEnd(n.dom(),r),o},rtl:function(e,t,n,r){var o=i.document.createRange();return o.setStart(n.dom(),r),o.setEnd(e.dom(),t),o}})},Gc=(Hc.ltr,Hc.rtl,function(e,t,n){return t>=e.left&&t<=e.right&&n>=e.top&&n<=e.bottom}),Yc=function(n,r,e,t,o){var i=function(e){var t=n.dom().createRange();return t.setStart(r.dom(),e),t.collapse(!0),t},u=Sn(r).length,a=function(e,t,n,r,o){if(0===o)return 0;if(t===r)return o-1;for(var i=r,u=1;u<o;u++){var a=e(u),c=Math.abs(t-a.left);if(n<=a.bottom){if(n<a.top||i<c)return u-1;i=c}}return 0}(function(e){return i(e).getBoundingClientRect()},e,t,o.right,u);return i(a)},Xc=function(t,n,r,o){var e=t.dom().createRange();e.selectNode(n.dom());var i=e.getClientRects();return ni(i,function(e){return Gc(e,r,o)?R.some(e):R.none()}).map(function(e){return Yc(t,n,r,o,e)})},Kc=function(t,e,n,r){var o=t.dom().createRange(),i=it(e);return ni(i,function(e){return o.selectNode(e.dom()),Gc(o.getBoundingClientRect(),n,r)?Jc(t,e,n,r):R.none()})},Jc=function(e,t,n,r){return(gt(t)?Xc:Kc)(e,t,n,r)},$c=function(e,t){return t-e.left<e.right-t},Qc=function(e,t,n){var r=e.dom().createRange();return r.selectNode(t.dom()),r.collapse(n),r},Zc=function(t,e,n){var r=t.dom().createRange();r.selectNode(e.dom());var o=r.getBoundingClientRect(),i=$c(o,n);return(!0===i?En:An)(e).map(function(e){return Qc(t,e,i)})},el=function(e,t,n){var r=t.dom().getBoundingClientRect(),o=$c(r,n);return R.some(Qc(e,t,o))},tl=function(e,t,n,r){var o=e.dom().createRange();o.selectNode(t.dom());var i=o.getBoundingClientRect();return function(e,t,n,r){var o=e.dom().createRange();o.selectNode(t.dom());var i=o.getBoundingClientRect(),u=Math.max(i.left,Math.min(i.right,n)),a=Math.max(i.top,Math.min(i.bottom,r));return Jc(e,t,u,a)}(e,t,Math.max(i.left,Math.min(i.right,n)),Math.max(i.top,Math.min(i.bottom,r)))},nl=document.caretPositionFromPoint?function(n,e,t){return R.from(n.dom().caretPositionFromPoint(e,t)).bind(function(e){if(null===e.offsetNode)return R.none();var t=n.dom().createRange();return t.setStart(e.offsetNode,e.offset),t.collapse(),R.some(t)})}:document.caretRangeFromPoint?function(e,t,n){return R.from(e.dom().caretRangeFromPoint(t,n))}:function(o,i,t){return le.fromPoint(o,i,t).bind(function(r){var e=function(){return e=o,n=i,(0===it(t=r).length?el:Zc)(e,t,n);var e,t,n};return 0===it(r).length?e():tl(o,r,i,t).orThunk(e)})},rl=function(e,t){var n=lt(e);return"input"===n?Ac.after(e):k(["br","img"],n)?0===t?Ac.before(e):Ac.after(e):Ac.on(e,t)},ol=function(e,t){var n=e.fold(Ac.before,rl,Ac.after),r=t.fold(Ac.before,rl,Ac.after);return Wc(n,r)},il=function(e,t,n,r){var o=rl(e,t),i=rl(n,r);return Wc(o,i)},ul=function(e,t){R.from(e.getSelection()).each(function(e){e.removeAllRanges(),e.addRange(t)})},al=function(e,t,n,r,o){var i=Fc(e,t,n,r,o);ul(e,i)},cl=function(s,e){return qc(s,e).match({ltr:function(e,t,n,r){al(s,e,t,n,r)},rtl:function(e,t,n,r){var o,i,u,a,c,l=s.getSelection();if(l.setBaseAndExtent)l.setBaseAndExtent(e.dom(),t,n.dom(),r);else if(l.extend)try{i=e,u=t,a=n,c=r,(o=l).collapse(i.dom(),u),o.extend(a.dom(),c)}catch(f){al(s,n,r,e,t)}else al(s,n,r,e,t)}})},ll=function(e){var o=Bc(e).dom(),t=function(e,t,n,r){return Fc(o,e,t,n,r)},n=e.match({domRange:function(e){var t=le.fromDom(e.startContainer),n=le.fromDom(e.endContainer);return il(t,e.startOffset,n,e.endOffset)},relative:ol,exact:il});return qc(o,n).match({ltr:t,rtl:t})},fl=function(e){var t=le.fromDom(e.anchorNode),n=le.fromDom(e.focusNode);return _c(t,e.anchorOffset,n,e.focusOffset)?R.some(Ic(le.fromDom(e.anchorNode),e.anchorOffset,le.fromDom(e.focusNode),e.focusOffset)):function(e){if(0<e.rangeCount){var t=e.getRangeAt(0),n=e.getRangeAt(e.rangeCount-1);return R.some(Ic(le.fromDom(t.startContainer),t.startOffset,le.fromDom(n.endContainer),n.endOffset))}return R.none()}(e)},sl=function(e,t){var n,r,o=(n=t,r=e.document.createRange(),Lc(r,n),r);ul(e,o)},dl=function(e){return(t=e,R.from(t.getSelection()).filter(function(e){return 0<e.rangeCount}).bind(fl)).map(function(e){return Mc(e.start(),e.soffset(),e.finish(),e.foffset())});var t},ml=function(e,t){var n,r,o,i=Vc(e,t);return r=(n=i).getClientRects(),0<(o=0<r.length?r[0]:n.getBoundingClientRect()).width||0<o.height?R.some(o).map(zc):R.none()},gl=function(e,t,n){return r=e,o=t,i=n,u=le.fromDom(r.document),nl(u,o,i).map(function(e){return Ic(le.fromDom(e.startContainer),e.startOffset,le.fromDom(e.endContainer),e.endOffset)});var r,o,i,u},hl=tinymce.util.Tools.resolve("tinymce.util.VK"),pl=function(e,t,n,r){return yl(e,t,kc(n),r)},vl=function(e,t,n,r){return yl(e,t,Nc(n),r)},bl=function(e,t){var n=Mc(t,0,t,0);return ll(n)},wl=function(e,t){var n,r=Nt(t,"tr");return(n=r,0===n.length?R.none():R.some(n[n.length-1])).bind(function(e){return jt(e,"td,th").map(function(e){return bl(0,e)})})},yl=function(r,e,t,o,n){return t.fold(R.none,R.none,function(e,t){return En(t).map(function(e){return bl(0,e)})},function(n){return Gt.table(n,e).bind(function(e){var t=Ur.noMenu(n);return r.undoManager.transact(function(){o.insertRowsAfter(e,t)}),wl(0,e)})})},xl=["table","li","dl"],Cl=function(t,n,r,o){if(t.keyCode===hl.TAB){var i=oa(n),u=function(e){var t=lt(e);return $e(e,i)||k(xl,t)},e=n.selection.getRng();if(e.collapsed){var a=le.fromDom(e.startContainer);Gt.cell(a,u).each(function(e){t.preventDefault(),(t.shiftKey?vl:pl)(n,u,e,r,o).each(function(e){n.selection.setRng(e)})})}}},Rl={response:X("selection","kill")},Sl=function(t){return function(e){return e===t}},Tl=Sl(38),Dl=Sl(40),Ol={ltr:{isBackward:Sl(37),isForward:Sl(39)},rtl:{isBackward:Sl(39),isForward:Sl(37)},isUp:Tl,isDown:Dl,isNavigation:function(e){return 37<=e&&e<=40}},kl=function(e,t){var n=Vc(e,t);return{start:C(le.fromDom(n.startContainer)),soffset:C(n.startOffset),finish:C(le.fromDom(n.endContainer)),foffset:C(n.endOffset)}},Nl=function(e,t,n,r){return{start:C(Ac.on(e,t)),finish:C(Ac.on(n,r))}};function El(a){return{elementFromPoint:function(e,t){return le.fromPoint(le.fromDom(a.document),e,t)},getRect:function(e){return e.dom().getBoundingClientRect()},getRangedRect:function(e,t,n,r){var o=Mc(e,t,n,r);return ml(a,o).map(function(e){return G(e,c)})},getSelection:function(){return dl(a).map(function(e){return kl(a,e)})},fromSitus:function(e){var t=Wc(e.start(),e.finish());return kl(a,t)},situsFromPoint:function(e,t){return gl(a,e,t).map(function(e){return{start:C(Ac.on(e.start(),e.soffset())),finish:C(Ac.on(e.finish(),e.foffset()))}})},clearSelection:function(){a.getSelection().removeAllRanges()},setSelection:function(e){var t,n,r,o,i,u;t=a,n=e.start(),r=e.soffset(),o=e.finish(),i=e.foffset(),u=il(n,r,o,i),cl(t,u)},setRelativeSelection:function(e,t){var n,r;n=a,r=ol(e,t),cl(n,r)},selectContents:function(e){sl(a,e)},getInnerHeight:function(){return a.innerHeight},getScrollY:function(){var e,t,n,r;return(e=le.fromDom(a.document),t=e!==undefined?e.dom():document,n=t.body.scrollLeft||t.documentElement.scrollLeft,r=t.body.scrollTop||t.documentElement.scrollTop,go(n,r)).top()},scrollBy:function(e,t){var n,r,o;n=e,r=t,((o=le.fromDom(a.document))!==undefined?o.dom():document).defaultView.scrollBy(n,r)}}}Je.detect().browser.isSafari();var Al=function(n,e,r,t,o){return $e(r,t)?R.none():Sr(r,t,e).bind(function(e){var t=e.boxes().getOr([]);return 0<t.length?(o(n,t,e.start(),e.finish()),R.some(Rl.response(R.some(Nl(r,0,r,On(r))),!0))):R.none()})},Pl={sync:function(n,r,e,t,o,i,u){return $e(e,o)&&t===i?R.none():Ft(e,"td,th",r).bind(function(t){return Ft(o,"td,th",r).bind(function(e){return Al(n,r,t,e,u)})})},detect:Al,update:function(e,t,n,r,o){return Dr(r,e,t,o.firstSelectedSelector(),o.lastSelectedSelector()).map(function(e){return o.clear(n),o.selectRange(n,e.boxes(),e.start(),e.finish()),e.boxes()})}},Il=ee(["left","top","right","bottom"],[]),Bl={nu:Il,moveUp:function(e,t){return Il({left:e.left(),top:e.top()-t,right:e.right(),bottom:e.bottom()-t})},moveDown:function(e,t){return Il({left:e.left(),top:e.top()+t,right:e.right(),bottom:e.bottom()+t})},moveBottomTo:function(e,t){var n=e.bottom()-e.top();return Il({left:e.left(),top:t-n,right:e.right(),bottom:t})},moveTopTo:function(e,t){var n=e.bottom()-e.top();return Il({left:e.left(),top:t,right:e.right(),bottom:t+n})},getTop:function(e){return e.top()},getBottom:function(e){return e.bottom()},translate:function(e,t,n){return Il({left:e.left()+t,top:e.top()+n,right:e.right()+t,bottom:e.bottom()+n})},toString:function(e){return"("+e.left()+", "+e.top()+") -> ("+e.right()+", "+e.bottom()+")"}},Wl=function(e){return Bl.nu({left:e.left,top:e.top,right:e.right,bottom:e.bottom})},Ml=function(e,t){return R.some(e.getRect(t))},_l=function(e,t,n){return mt(t)?Ml(e,t).map(Wl):gt(t)?(r=e,o=t,i=n,0<=i&&i<On(o)?r.getRangedRect(o,i,o,i+1):0<i?r.getRangedRect(o,i-1,o,i):R.none()).map(Wl):R.none();var r,o,i},Ll=function(e,t){return mt(t)?Ml(e,t).map(Wl):gt(t)?e.getRangedRect(t,0,t,On(t)).map(Wl):R.none()},jl=X("item","mode"),Fl=function(e,t,n,r){var o=r!==undefined?r:zl;return e.property().parent(t).map(function(e){return jl(e,o)})},zl=function(e,t,n,r){var o=r!==undefined?r:Hl;return n.sibling(e,t).map(function(e){return jl(e,o)})},Hl=function(e,t,n,r){var o=r!==undefined?r:Hl,i=e.property().children(t);return n.first(i).map(function(e){return jl(e,o)})},Ul=[{current:Fl,next:zl,fallback:R.none()},{current:zl,next:Hl,fallback:R.some(Fl)},{current:Hl,next:Hl,fallback:R.some(zl)}],ql=function(t,n,r,o,e){return e=e!==undefined?e:Ul,W(e,function(e){return e.current===r}).bind(function(e){return e.current(t,n,o,e.next).orThunk(function(){return e.fallback.bind(function(e){return ql(t,n,e,o)})})})},Vl={backtrack:Fl,sidestep:zl,advance:Hl,go:ql},Gl={left:function(){return{sibling:function(e,t){return e.query().prevSibling(t)},first:function(e){return 0<e.length?R.some(e[e.length-1]):R.none()}}},right:function(){return{sibling:function(e,t){return e.query().nextSibling(t)},first:function(e){return 0<e.length?R.some(e[0]):R.none()}}}},Yl=function(t,e,n,r,o,i){return Vl.go(t,e,r,o).bind(function(e){return i(e.item())?R.none():n(e.item())?R.some(e.item()):Yl(t,e.item(),n,e.mode(),o,i)})},Xl=function(e,t,n,r){return Yl(e,t,n,Vl.sidestep,Gl.left(),r)},Kl=function(e,t,n,r){return Yl(e,t,n,Vl.sidestep,Gl.right(),r)},Jl=function(e,t){return 0===e.property().children(t).length},$l=function(e,t,n,r){return Xl(e,t,n,r)},Ql=function(e,t,n,r){return Kl(e,t,n,r)},Zl={before:function(e,t,n){return $l(e,t,b(Jl,e),n)},after:function(e,t,n){return Ql(e,t,b(Jl,e),n)},seekLeft:$l,seekRight:Ql,walkers:function(){return{left:Gl.left,right:Gl.right}},walk:function(e,t,n,r,o){return Vl.go(e,t,n,r,o)},backtrack:Vl.backtrack,sidestep:Vl.sidestep,advance:Vl.advance},ef=Fn(),tf={gather:function(e,t,n){return Zl.gather(ef,e,t,n)},before:function(e,t){return Zl.before(ef,e,t)},after:function(e,t){return Zl.after(ef,e,t)},seekLeft:function(e,t,n){return Zl.seekLeft(ef,e,t,n)},seekRight:function(e,t,n){return Zl.seekRight(ef,e,t,n)},walkers:function(){return Zl.walkers()},walk:function(e,t,n,r){return Zl.walk(ef,e,t,n,r)}},nf=Br([{none:[]},{retry:["caret"]}]),rf=function(t,e,r){return(n=e,o=Ko,Et(function(e){return o(e)},Mt,n,o,i)).fold(C(!1),function(e){return Ll(t,e).exists(function(e){return n=e,(t=r).left()<n.left()||Math.abs(n.right()-t.left())<1||t.left()>n.right();var t,n})});var n,o,i},of={point:Bl.getTop,adjuster:function(e,t,n,r,o){var i=Bl.moveUp(o,5);return Math.abs(n.top()-r.top())<1?nf.retry(i):n.bottom()<o.top()?nf.retry(i):n.bottom()===o.top()?nf.retry(Bl.moveUp(o,1)):rf(e,t,o)?nf.retry(Bl.translate(i,5,0)):nf.none()},move:Bl.moveUp,gather:tf.before},uf={point:Bl.getBottom,adjuster:function(e,t,n,r,o){var i=Bl.moveDown(o,5);return Math.abs(n.bottom()-r.bottom())<1?nf.retry(i):n.top()>o.bottom()?nf.retry(i):n.top()===o.bottom()?nf.retry(Bl.moveDown(o,1)):rf(e,t,o)?nf.retry(Bl.translate(i,5,0)):nf.none()},move:Bl.moveDown,gather:tf.after},af=function(n,r,o,i,u){return 0===u?R.some(i):(c=n,l=i.left(),f=r.point(i),c.elementFromPoint(l,f).filter(function(e){return"table"===lt(e)}).isSome()?(t=i,a=u-1,af(n,e=r,o,e.move(t,5),a)):n.situsFromPoint(i.left(),r.point(i)).bind(function(e){return e.start().fold(R.none,function(t,e){return Ll(n,t,e).bind(function(e){return r.adjuster(n,t,e,o,i).fold(R.none,function(e){return af(n,r,o,e,u-1)})}).orThunk(function(){return R.some(i)})},R.none)}));var e,t,a,c,l,f},cf=function(t,n,e){var r,o,i,u=t.move(e,5),a=af(n,t,e,u,100).getOr(u);return(r=t,o=a,i=n,r.point(o)>i.getInnerHeight()?R.some(r.point(o)-i.getInnerHeight()):r.point(o)<0?R.some(-r.point(o)):R.none()).fold(function(){return n.situsFromPoint(a.left(),t.point(a))},function(e){return n.scrollBy(0,e),n.situsFromPoint(a.left(),t.point(a)-e)})},lf={tryUp:b(cf,of),tryDown:b(cf,uf),ieTryUp:function(e,t){return e.situsFromPoint(t.left(),t.top()-5)},ieTryDown:function(e,t){return e.situsFromPoint(t.left(),t.bottom()+5)},getJumpSize:C(5)},ff=Br([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),sf=function(e){return Ft(e,"tr")},df={verify:function(a,e,t,n,r,c,o){return Ft(n,"td,th",o).bind(function(u){return Ft(e,"td,th",o).map(function(i){return $e(u,i)?$e(n,u)&&On(u)===r?c(i):ff.none("in same cell"):ur.sharedOne(sf,[u,i]).fold(function(){return t=i,n=u,r=(e=a).getRect(t),(o=e.getRect(n)).right>r.left&&o.left<r.right?ff.success():c(i);var e,t,n,r,o},function(e){return c(i)})})}).getOr(ff.none("default"))},cata:function(e,t,n,r,o){return e.fold(t,n,r,o)},adt:ff},mf={point:X("element","offset"),delta:X("element","deltaOffset"),range:X("element","start","finish"),points:X("begin","end"),text:X("element","text")},gf=(X("ancestor","descendants","element","index"),X("parent","children","element","index")),hf=function(e,t){return M(e,b($e,t))},pf=function(e){return"br"===lt(e)},vf=function(e,t,n){return t(e,n).bind(function(e){return gt(e)&&0===Sn(e).trim().length?vf(e,t,n):R.some(e)})},bf=function(t,e,n,r){return(o=e,i=n,ut(o,i).filter(pf).orThunk(function(){return ut(o,i-1).filter(pf)})).bind(function(e){return r.traverse(e).fold(function(){return vf(e,r.gather,t).map(r.relative)},function(e){return(r=e,tt(r).bind(function(t){var n=it(t);return hf(n,r).map(function(e){return gf(t,n,r,e)})})).map(function(e){return Ac.on(e.parent(),e.index())});var r})});var o,i},wf=function(e,t,n,r){var o,i,u;return(pf(t)?(o=e,i=t,(u=r).traverse(i).orThunk(function(){return vf(i,u.gather,o)}).map(u.relative)):bf(e,t,n,r)).map(function(e){return{start:C(e),finish:C(e)}})},yf=function(e){return df.cata(e,function(e){return R.none()},function(){return R.none()},function(e){return R.some(mf.point(e,0))},function(e){return R.some(mf.point(e,On(e)))})},xf=Je.detect(),Cf=function(r,o,i,u,a,c){return 0===c?R.none():Tf(r,o,i,u,a).bind(function(e){var t=r.fromSitus(e),n=df.verify(r,i,u,t.finish(),t.foffset(),a.failure,o);return df.cata(n,function(){return R.none()},function(){return R.some(e)},function(e){return $e(i,e)&&0===u?Rf(r,i,u,Bl.moveUp,a):Cf(r,o,e,0,a,c-1)},function(e){return $e(i,e)&&u===On(e)?Rf(r,i,u,Bl.moveDown,a):Cf(r,o,e,On(e),a,c-1)})})},Rf=function(t,e,n,r,o){return _l(t,e,n).bind(function(e){return Sf(t,o,r(e,lf.getJumpSize()))})},Sf=function(e,t,n){return xf.browser.isChrome()||xf.browser.isSafari()||xf.browser.isFirefox()||xf.browser.isEdge()?t.otherRetry(e,n):xf.browser.isIE()?t.ieRetry(e,n):R.none()},Tf=function(t,e,n,r,o){return _l(t,n,r).bind(function(e){return Sf(t,o,e)})},Df=function(t,n,r){return(o=t,i=n,u=r,o.getSelection().bind(function(r){return wf(i,r.finish(),r.foffset(),u).fold(function(){return R.some(mf.point(r.finish(),r.foffset()))},function(e){var t=o.fromSitus(e),n=df.verify(o,r.finish(),r.foffset(),t.finish(),t.foffset(),u.failure,i);return yf(n)})})).bind(function(e){return Cf(t,n,e.element(),e.offset(),r,20).map(t.fromSitus)});var o,i,u},Of=Je.detect(),kf=function(e,t){return Mt(e,function(e){return tt(e).exists(function(e){return $e(e,t)})},n).isSome();var n},Nf=function(t,r,o,e,i){return Ft(e,"td,th",r).bind(function(n){return Ft(n,"table",r).bind(function(e){return kf(i,e)?Df(t,r,o).bind(function(t){return Ft(t.finish(),"td,th",r).map(function(e){return{start:C(n),finish:C(e),range:C(t)}})}):R.none()})})},Ef=function(e,t,n,r,o,i){return Of.browser.isIE()?R.none():i(r,t).orThunk(function(){return Nf(e,t,n,r,o).map(function(e){var t=e.range();return Rl.response(R.some(Nl(t.start(),t.soffset(),t.finish(),t.foffset())),!0)})})},Af=function(e,t,n,r,o,i,u){return Nf(e,n,r,o,i).bind(function(e){return Pl.detect(t,n,e.start(),e.finish(),u)})},Pf=function(e,r){return Ft(e,"tr",r).bind(function(n){return Ft(n,"table",r).bind(function(e){var t=Nt(e,"tr");return $e(n,t[0])?tf.seekLeft(e,function(e){return An(e).isSome()},r).map(function(e){var t=On(e);return Rl.response(R.some(Nl(e,t,e,t)),!0)}):R.none()})})},If=function(e,r){return Ft(e,"tr",r).bind(function(n){return Ft(n,"table",r).bind(function(e){var t=Nt(e,"tr");return $e(n,t[t.length-1])?tf.seekRight(e,function(e){return En(e).isSome()},r).map(function(e){return Rl.response(R.some(Nl(e,0,e,0)),!0)}):R.none()})})},Bf=function(e,t){return Ft(e,"td,th",t)},Wf={down:{traverse:ot,gather:tf.after,relative:Ac.before,otherRetry:lf.tryDown,ieRetry:lf.ieTryDown,failure:df.adt.failedDown},up:{traverse:rt,gather:tf.before,relative:Ac.before,otherRetry:lf.tryUp,ieRetry:lf.ieTryUp,failure:df.adt.failedUp}},Mf=X("rows","cols"),_f={mouse:function(e,t,n,r){var o,i,u,a,c,l,f=El(e),s=(o=f,i=t,u=n,a=r,c=R.none(),l=function(){c=R.none()},{mousedown:function(e){a.clear(i),c=Bf(e.target(),u)},mouseover:function(e){c.each(function(r){a.clear(i),Bf(e.target(),u).each(function(n){Sr(r,n,u).each(function(e){var t=e.boxes().getOr([]);(1<t.length||1===t.length&&!$e(r,n))&&(a.selectRange(i,t,e.start(),e.finish()),o.selectContents(n))})})})},mouseup:function(){c.each(l)}});return{mousedown:s.mousedown,mouseover:s.mouseover,mouseup:s.mouseup}},keyboard:function(e,c,l,f){var s=El(e),d=function(){return f.clear(c),R.none()};return{keydown:function(e,t,n,r,o,i){var u=e.raw().which,a=!0===e.raw().shiftKey;return Tr(c,f.selectedSelector()).fold(function(){return Ol.isDown(u)&&a?b(Af,s,c,l,Wf.down,r,t,f.selectRange):Ol.isUp(u)&&a?b(Af,s,c,l,Wf.up,r,t,f.selectRange):Ol.isDown(u)?b(Ef,s,l,Wf.down,r,t,If):Ol.isUp(u)?b(Ef,s,l,Wf.up,r,t,Pf):R.none},function(t){var e=function(e){return function(){return ni(e,function(e){return Pl.update(e.rows(),e.cols(),c,t,f)}).fold(function(){return Or(c,f.firstSelectedSelector(),f.lastSelectedSelector()).map(function(e){var t=Ol.isDown(u)||i.isForward(u)?Ac.after:Ac.before;return s.setRelativeSelection(Ac.on(e.first(),0),t(e.table())),f.clear(c),Rl.response(R.none(),!0)})},function(e){return R.some(Rl.response(R.none(),!0))})}};return Ol.isDown(u)&&a?e([Mf(1,0)]):Ol.isUp(u)&&a?e([Mf(-1,0)]):i.isBackward(u)&&a?e([Mf(0,-1),Mf(-1,0)]):i.isForward(u)&&a?e([Mf(0,1),Mf(1,0)]):Ol.isNavigation(u)&&!1===a?d:R.none})()},keyup:function(t,n,r,o,i){return Tr(c,f.selectedSelector()).fold(function(){var e=t.raw().which;return 0==(!0===t.raw().shiftKey)?R.none():Ol.isNavigation(e)?Pl.sync(c,l,n,r,o,i,f.selectRange):R.none()},R.none)}}}},Lf=function(r,e){A(e,function(e){var t,n;n=e,Si(t=r)?t.dom().classList.remove(n):Di(t,n),ki(t)})},jf={byClass:function(o){var t,n,i=(t=o.selected(),function(e){Oi(e,t)}),r=(n=[o.selected(),o.lastSelected(),o.firstSelected()],function(e){Lf(e,n)}),u=function(e){var t=Nt(e,o.selectedSelector());A(t,r)};return{clear:u,selectRange:function(e,t,n,r){u(e),A(t,i),Oi(n,o.firstSelected()),Oi(r,o.lastSelected())},selectedSelector:o.selectedSelector,firstSelectedSelector:o.firstSelectedSelector,lastSelectedSelector:o.lastSelectedSelector}},byAttr:function(o){var n=function(e){xt(e,o.selected()),xt(e,o.firstSelected()),xt(e,o.lastSelected())},i=function(e){vt(e,o.selected(),"1")},u=function(e){var t=Nt(e,o.selectedSelector());A(t,n)};return{clear:u,selectRange:function(e,t,n,r){u(e),A(t,i),vt(n,o.firstSelected(),"1"),vt(r,o.lastSelected(),"1")},selectedSelector:o.selectedSelector,firstSelectedSelector:o.firstSelectedSelector,lastSelectedSelector:o.lastSelectedSelector}}},Ff=function(e){return!1===Ni(le.fromDom(e.target),"ephox-snooker-resizer-bar")};function zf(h,p){var v=ee(["mousedown","mouseover","mouseup","keyup","keydown"],[]),b=R.none(),w=jf.byAttr(Ir);return h.on("init",function(e){var r=h.getWin(),o=oa(h),t=aa(h),n=_f.mouse(r,o,t,w),a=_f.keyboard(r,o,t,w),c=function(e,t){!0===e.raw().shiftKey&&(t.kill()&&e.kill(),t.selection().each(function(e){var t=Wc(e.start(),e.finish()),n=Vc(r,t);h.selection.setRng(n)}))},i=function(e){var t=f(e);if(t.raw().shiftKey&&Ol.isNavigation(t.raw().which)){var n=h.selection.getRng(),r=le.fromDom(n.startContainer),o=le.fromDom(n.endContainer);a.keyup(t,r,n.startOffset,o,n.endOffset).each(function(e){c(t,e)})}},u=function(e){var t=f(e);p().each(function(e){e.hideBars()});var n=h.selection.getRng(),r=le.fromDom(h.selection.getStart()),o=le.fromDom(n.startContainer),i=le.fromDom(n.endContainer),u=da.directionAt(r).isRtl()?Ol.rtl:Ol.ltr;a.keydown(t,o,n.startOffset,i,n.endOffset,u).each(function(e){c(t,e)}),p().each(function(e){e.showBars()})},l=function(e){return e.hasOwnProperty("x")&&e.hasOwnProperty("y")},f=function(e){var t=le.fromDom(e.target),n=function(){e.stopPropagation()},r=function(){e.preventDefault()},o=x(r,n);return{target:C(t),x:C(l(e)?e.x:null),y:C(l(e)?e.y:null),stop:n,prevent:r,kill:o,raw:C(e)}},s=function(e){return 0===e.button},d=function(e){s(e)&&Ff(e)&&n.mousedown(f(e))},m=function(e){var t;(t=e).buttons!==undefined&&0==(1&t.buttons)||!Ff(e)||n.mouseover(f(e))},g=function(e){s(e)&&Ff(e)&&n.mouseup(f(e))};h.on("mousedown",d),h.on("mouseover",m),h.on("mouseup",g),h.on("keyup",i),h.on("keydown",u),h.on("nodechange",function(){var e=h.selection,t=le.fromDom(e.getStart()),n=le.fromDom(e.getEnd());ur.sharedOne(Gt.table,[t,n]).fold(function(){w.clear(o)},y)}),b=R.some(v({mousedown:d,mouseover:m,mouseup:g,keyup:i,keydown:u}))}),{clear:w.clear,destroy:function(){b.each(function(e){})}}}var Hf=Ea.each,Uf=function(t){var n=[];function e(e){return function(){t.execCommand(e)}}Hf("inserttable tableprops deletetable | cell row column".split(" "),function(e){"|"===e?n.push({text:"-"}):n.push(t.menuItems[e])}),t.addButton("table",{type:"menubutton",title:"Table",menu:n}),t.addButton("tableprops",{title:"Table properties",onclick:e("mceTableProps"),icon:"table"}),t.addButton("tabledelete",{title:"Delete table",onclick:e("mceTableDelete")}),t.addButton("tablecellprops",{title:"Cell properties",onclick:e("mceTableCellProps")}),t.addButton("tablemergecells",{title:"Merge cells",onclick:e("mceTableMergeCells")}),t.addButton("tablesplitcells",{title:"Split cell",onclick:e("mceTableSplitCells")}),t.addButton("tableinsertrowbefore",{title:"Insert row before",onclick:e("mceTableInsertRowBefore")}),t.addButton("tableinsertrowafter",{title:"Insert row after",onclick:e("mceTableInsertRowAfter")}),t.addButton("tabledeleterow",{title:"Delete row",onclick:e("mceTableDeleteRow")}),t.addButton("tablerowprops",{title:"Row properties",onclick:e("mceTableRowProps")}),t.addButton("tablecutrow",{title:"Cut row",onclick:e("mceTableCutRow")}),t.addButton("tablecopyrow",{title:"Copy row",onclick:e("mceTableCopyRow")}),t.addButton("tablepasterowbefore",{title:"Paste row before",onclick:e("mceTablePasteRowBefore")}),t.addButton("tablepasterowafter",{title:"Paste row after",onclick:e("mceTablePasteRowAfter")}),t.addButton("tableinsertcolbefore",{title:"Insert column before",onclick:e("mceTableInsertColBefore")}),t.addButton("tableinsertcolafter",{title:"Insert column after",onclick:e("mceTableInsertColAfter")}),t.addButton("tabledeletecol",{title:"Delete column",onclick:e("mceTableDeleteCol")})},qf=function(t){var e,n=""===(e=t.getParam("table_toolbar",ma))||!1===e?[]:v(e)?e.split(/[ ,]/):w(e)?e:[];0<n.length&&t.addContextToolbar(function(e){return t.dom.is(e,"table")&&t.getBody().contains(e)},n.join(" "))},Vf=function(o,n){var r=R.none(),i=[],u=[],a=[],c=[],l=function(e){e.disabled(!0)},f=function(e){e.disabled(!1)},e=function(){var t=this;i.push(t),r.fold(function(){l(t)},function(e){f(t)})},t=function(){var t=this;u.push(t),r.fold(function(){l(t)},function(e){f(t)})};o.on("init",function(){o.on("nodechange",function(e){var t=R.from(o.dom.getParent(o.selection.getStart(),"th,td"));(r=t.bind(function(e){var t=le.fromDom(e);return Gt.table(t).map(function(e){return Ur.forMenu(n,e,t)})})).fold(function(){A(i,l),A(u,l),A(a,l),A(c,l)},function(t){A(i,f),A(u,f),A(a,function(e){e.disabled(t.mergable().isNone())}),A(c,function(e){e.disabled(t.unmergable().isNone())})})})});var s=function(e,t,n,r){var o,i,u,a,c,l=r.getEl().getElementsByTagName("table")[0],f=r.isRtl()||"tl-tr"===r.parent().rel;for(l.nextSibling.innerHTML=t+1+" x "+(n+1),f&&(t=9-t),i=0;i<10;i++)for(o=0;o<10;o++)a=l.rows[i].childNodes[o].firstChild,c=(f?t<=o:o<=t)&&i<=n,e.dom.toggleClass(a,"mce-active",c),c&&(u=a);return u.parentNode},d=!1===o.getParam("table_grid",!0,"boolean")?{text:"Table",icon:"table",context:"table",onclick:m("mceInsertTable")}:{text:"Table",icon:"table",context:"table",ariaHideMenu:!0,onclick:function(e){e.aria&&(this.parent().hideAll(),e.stopImmediatePropagation(),o.execCommand("mceInsertTable"))},onshow:function(){s(o,0,0,this.menu.items()[0])},onhide:function(){var e=this.menu.items()[0].getEl().getElementsByTagName("a");o.dom.removeClass(e,"mce-active"),o.dom.addClass(e[0],"mce-active")},menu:[{type:"container",html:function(){var e="";e='<table role="grid" class="mce-grid mce-grid-border" aria-readonly="true">';for(var t=0;t<10;t++){e+="<tr>";for(var n=0;n<10;n++)e+='<td role="gridcell" tabindex="-1"><a id="mcegrid'+(10*t+n)+'" href="#" data-mce-x="'+n+'" data-mce-y="'+t+'"></a></td>';e+="</tr>"}return e+="</table>",e+='<div class="mce-text-center" role="presentation">1 x 1</div>'}(),onPostRender:function(){this.lastX=this.lastY=0},onmousemove:function(e){var t,n,r=e.target;"A"===r.tagName.toUpperCase()&&(t=parseInt(r.getAttribute("data-mce-x"),10),n=parseInt(r.getAttribute("data-mce-y"),10),(this.isRtl()||"tl-tr"===this.parent().rel)&&(t=9-t),t===this.lastX&&n===this.lastY||(s(o,t,n,e.control),this.lastX=t,this.lastY=n))},onclick:function(e){var t=this;"A"===e.target.tagName.toUpperCase()&&(e.preventDefault(),e.stopPropagation(),t.parent().cancel(),o.undoManager.transact(function(){Ya(o,t.lastX+1,t.lastY+1)}),o.addVisual())}}]};function m(e){return function(){o.execCommand(e)}}var g={text:"Table properties",context:"table",onPostRender:e,onclick:m("mceTableProps")},h={text:"Delete table",context:"table",onPostRender:e,cmd:"mceTableDelete"},p={text:"Row",context:"table",menu:[{text:"Insert row before",onclick:m("mceTableInsertRowBefore"),onPostRender:t},{text:"Insert row after",onclick:m("mceTableInsertRowAfter"),onPostRender:t},{text:"Delete row",onclick:m("mceTableDeleteRow"),onPostRender:t},{text:"Row properties",onclick:m("mceTableRowProps"),onPostRender:t},{text:"-"},{text:"Cut row",onclick:m("mceTableCutRow"),onPostRender:t},{text:"Copy row",onclick:m("mceTableCopyRow"),onPostRender:t},{text:"Paste row before",onclick:m("mceTablePasteRowBefore"),onPostRender:t},{text:"Paste row after",onclick:m("mceTablePasteRowAfter"),onPostRender:t}]},v={text:"Column",context:"table",menu:[{text:"Insert column before",onclick:m("mceTableInsertColBefore"),onPostRender:t},{text:"Insert column after",onclick:m("mceTableInsertColAfter"),onPostRender:t},{text:"Delete column",onclick:m("mceTableDeleteCol"),onPostRender:t}]},b={separator:"before",text:"Cell",context:"table",menu:[{text:"Cell properties",onclick:m("mceTableCellProps"),onPostRender:t},{text:"Merge cells",onclick:m("mceTableMergeCells"),onPostRender:function(){var t=this;a.push(t),r.fold(function(){l(t)},function(e){t.disabled(e.mergable().isNone())})}},{text:"Split cell",onclick:m("mceTableSplitCells"),onPostRender:function(){var t=this;c.push(t),r.fold(function(){l(t)},function(e){t.disabled(e.unmergable().isNone())})}}]};o.addMenuItem("inserttable",d),o.addMenuItem("tableprops",g),o.addMenuItem("deletetable",h),o.addMenuItem("row",p),o.addMenuItem("column",v),o.addMenuItem("cell",b)},Gf=function(n,r){return{insertTable:function(e,t){return Ya(n,e,t)},setClipboardRows:function(e){return t=r,n=E(e,le.fromDom),void t.set(R.from(n));var t,n},getClipboardRows:function(){return r.get().fold(function(){},function(e){return E(e,function(e){return e.dom()})})}}};e.add("table",function(t){var n,r=xc(t),e=zf(t,r.lazyResize),o=ka(t,r.lazyWire),i=(n=t,{get:function(){var e=oa(n);return kr(e,Ir.selectedSelector()).fold(function(){return n.selection.getStart()===undefined?Mr.none():Mr.single(n.selection)},function(e){return Mr.multiple(e)})}}),u=Io(R.none());return Qa(t,o,e,i,u),qr(t,i,o,e),Vf(t,i),Uf(t),qf(t),t.on("PreInit",function(){t.serializer.addTempAttr(Ir.firstSelected()),t.serializer.addTempAttr(Ir.lastSelected())}),t.getParam("table_tab_navigation",!0,"boolean")&&t.on("keydown",function(e){Cl(e,t,o,r.lazyWire)}),t.on("remove",function(){r.destroy(),e.destroy()}),Gf(t,u)})}();!function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager"),t=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),c=tinymce.util.Tools.resolve("tinymce.EditorManager"),s=tinymce.util.Tools.resolve("tinymce.Env"),a=tinymce.util.Tools.resolve("tinymce.util.Delay"),y=tinymce.util.Tools.resolve("tinymce.util.Tools"),f=tinymce.util.Tools.resolve("tinymce.util.VK"),d=function(e){return e.getParam("tab_focus",e.getParam("tabfocus_elements",":prev,:next"))},m=t.DOM,n=function(e){e.keyCode!==f.TAB||e.ctrlKey||e.altKey||e.metaKey||e.preventDefault()},i=function(r){function e(n){var i,o,e,l;if(!(n.keyCode!==f.TAB||n.ctrlKey||n.altKey||n.metaKey||n.isDefaultPrevented())&&(1===(e=y.explode(d(r))).length&&(e[1]=e[0],e[0]=":prev"),o=n.shiftKey?":prev"===e[0]?u(-1):m.get(e[0]):":next"===e[1]?u(1):m.get(e[1]))){var t=c.get(o.id||o.name);o.id&&t?t.focus():a.setTimeout(function(){s.webkit||window.focus(),o.focus()},10),n.preventDefault()}function u(e){function t(t){return/INPUT|TEXTAREA|BUTTON/.test(t.tagName)&&c.get(n.id)&&-1!==t.tabIndex&&function e(t){return"BODY"===t.nodeName||"hidden"!==t.type&&"none"!==t.style.display&&"hidden"!==t.style.visibility&&e(t.parentNode)}(t)}if(o=m.select(":input:enabled,*[tabindex]:not(iframe)"),y.each(o,function(e,t){if(e.id===r.id)return i=t,!1}),0<e){for(l=i+1;l<o.length;l++)if(t(o[l]))return o[l]}else for(l=i-1;0<=l;l--)if(t(o[l]))return o[l];return null}}r.on("init",function(){r.inline&&m.setAttrib(r.getBody(),"tabIndex",null),r.on("keyup",n),s.gecko?r.on("keypress keydown",e):r.on("keydown",e)})};e.add("tabfocus",function(e){i(e)})}();!function(){"use strict";var r=function(e){var t=e,n=function(){return t};return{get:n,set:function(e){t=e},clone:function(){return r(n())}}},e=tinymce.util.Tools.resolve("tinymce.PluginManager"),p=tinymce.util.Tools.resolve("tinymce.util.Tools");function h(e){return e&&1===e.nodeType&&"false"===e.contentEditable}var u={findAndReplaceDOMText:function(t,n,r,a,i){var o,d,m,f,p,g,c=[],l=0;function s(e,t){if(t=t||0,!e[0])throw new Error("findAndReplaceDOMText cannot handle zero-length matches");var n=e.index;if(0<t){var r=e[t];if(!r)throw new Error("Invalid capture group");n+=e[0].indexOf(r),e[0]=r}return[n,n+e[0].length,[e[0]]]}if(m=n.ownerDocument,f=i.getBlockElements(),p=i.getWhiteSpaceElements(),g=i.getShortEndedElements(),d=function e(t){var n;if(3===t.nodeType)return t.data;if(p[t.nodeName]&&!f[t.nodeName])return"";if(n="",h(t))return"\n";if((f[t.nodeName]||g[t.nodeName])&&(n+="\n"),t=t.firstChild)for(;n+=e(t),t=t.nextSibling;);return n}(n)){if(t.global)for(;o=t.exec(d);)c.push(s(o,a));else o=d.match(t),c.push(s(o,a));return c.length&&(l=c.length,function(e,t,n){var r,a,i,o,d=[],c=0,l=e,s=t.shift(),u=0;e:for(;;){if((f[l.nodeName]||g[l.nodeName]||h(l))&&c++,3===l.nodeType&&(!a&&l.length+c>=s[1]?(a=l,o=s[1]-c):r&&d.push(l),!r&&l.length+c>s[0]&&(r=l,i=s[0]-c),c+=l.length),r&&a){if(l=n({startNode:r,startNodeIndex:i,endNode:a,endNodeIndex:o,innerNodes:d,match:s[2],matchIndex:u}),c-=a.length-o,a=r=null,d=[],u++,!(s=t.shift()))break}else if(p[l.nodeName]&&!f[l.nodeName]||!l.firstChild){if(l.nextSibling){l=l.nextSibling;continue}}else if(!h(l)){l=l.firstChild;continue}for(;;){if(l.nextSibling){l=l.nextSibling;break}if(l.parentNode===e)break e;l=l.parentNode}}}(n,c,function(e){var h;if("function"!=typeof e){var r=e.nodeType?e:m.createElement(e);h=function(e,t){var n=r.cloneNode(!1);return n.setAttribute("data-mce-index",t),e&&n.appendChild(m.createTextNode(e)),n}}else h=e;return function(e){var t,n,r,a=e.startNode,i=e.endNode,o=e.matchIndex;if(a===i){var d=a;r=d.parentNode,0<e.startNodeIndex&&(t=m.createTextNode(d.data.substring(0,e.startNodeIndex)),r.insertBefore(t,d));var c=h(e.match[0],o);return r.insertBefore(c,d),e.endNodeIndex<d.length&&(n=m.createTextNode(d.data.substring(e.endNodeIndex)),r.insertBefore(n,d)),d.parentNode.removeChild(d),c}t=m.createTextNode(a.data.substring(0,e.startNodeIndex)),n=m.createTextNode(i.data.substring(e.endNodeIndex));for(var l=h(a.data.substring(e.startNodeIndex),o),s=0,u=e.innerNodes.length;s<u;++s){var f=e.innerNodes[s],p=h(f.data,o);f.parentNode.replaceChild(p,f)}var g=h(i.data.substring(0,e.endNodeIndex),o);return(r=a.parentNode).insertBefore(t,a),r.insertBefore(l,a),r.removeChild(a),(r=i.parentNode).insertBefore(g,i),r.insertBefore(n,i),r.removeChild(i),g}}(r))),l}}},g=function(e){var t=e.getAttribute("data-mce-index");return"number"==typeof t?""+t:t},m=function(e){var t=e.parentNode;e.firstChild&&t.insertBefore(e.firstChild,e),e.parentNode.removeChild(e)},o=function(e,t){var n,r=[];if((n=p.toArray(e.getBody().getElementsByTagName("span"))).length)for(var a=0;a<n.length;a++){var i=g(n[a]);null!==i&&i.length&&i===t.toString()&&r.push(n[a])}return r},f=function(e,t,n){var r=t.get(),a=e.dom;(n=!1!==n)?r++:r--,a.removeClass(o(e,t.get()),"mce-match-marker-selected");var i=o(e,r);return i.length?(a.addClass(o(e,r),"mce-match-marker-selected"),e.selection.scrollIntoView(i[0]),r):-1},v=function(e,t){var n=t.parentNode;e.remove(t),e.isEmpty(n)&&e.remove(n)},x=function(e,t){var n=f(e,t,!0);-1!==n&&t.set(n)},b=function(e,t){var n=f(e,t,!1);-1!==n&&t.set(n)},N=function(e){var t=g(e);return null!==t&&0<t.length},y=function(e,t,n){var r,a,i,o;for(a=p.toArray(e.getBody().getElementsByTagName("span")),r=0;r<a.length;r++){var d=g(a[r]);null!==d&&d.length&&(d===t.get().toString()&&(i||(i=a[r].firstChild),o=a[r].firstChild),m(a[r]))}if(i&&o){var c=e.dom.createRng();return c.setStart(i,0),c.setEnd(o,o.data.length),!1!==n&&e.selection.setRng(c),c}},k=function(e,t){return 0<o(e,t.get()+1).length},C=function(e,t){return 0<o(e,t.get()-1).length},T={done:y,find:function(e,t,n,r,a){n=(n=n.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")).replace(/\s/g,"[^\\S\\r\\n]"),n=a?"\\b"+n+"\\b":n;var i,o,d,c,l,s=(i=e,o=t,d=new RegExp(n,r?"g":"gi"),(l=i.dom.create("span",{"data-mce-bogus":1})).className="mce-match-marker",c=i.getBody(),y(i,o,!1),u.findAndReplaceDOMText(d,c,l,!1,i.schema));return s&&(t.set(-1),t.set(f(e,t,!0))),s},next:x,prev:b,replace:function(e,t,n,r,a){var i,o,d,c,l,s,u=t.get();for(r=!1!==r,d=e.getBody(),o=p.grep(p.toArray(d.getElementsByTagName("span")),N),i=0;i<o.length;i++){var f=g(o[i]);if(c=l=parseInt(f,10),a||c===t.get()){for(n.length?(o[i].firstChild.nodeValue=n,m(o[i])):v(e.dom,o[i]);o[++i];){if((c=parseInt(g(o[i]),10))!==l){i--;break}v(e.dom,o[i])}r&&u--}else l>t.get()&&o[i].setAttribute("data-mce-index",l-1)}return t.set(u),r?(s=k(e,t),x(e,t)):(s=C(e,t),b(e,t)),!a&&s},hasNext:k,hasPrev:C},n=function(r,a){return{done:function(e){return T.done(r,a,e)},find:function(e,t,n){return T.find(r,a,e,t,n)},next:function(){return T.next(r,a)},prev:function(){return T.prev(r,a)},replace:function(e,t,n){return T.replace(r,a,e,t,n)}}},a=function(i,o){var e,d={};function c(){s.statusbar.find("#next").disabled(!1===T.hasNext(i,o)),s.statusbar.find("#prev").disabled(!1===T.hasPrev(i,o))}function l(){i.windowManager.alert("Could not find the specified string.",function(){s.find("#find")[0].focus()})}i.undoManager.add(),e=p.trim(i.selection.getContent({format:"text"}));var s=i.windowManager.open({layout:"flex",pack:"center",align:"center",onClose:function(){i.focus(),T.done(i,o),i.undoManager.add()},onSubmit:function(e){var t,n,r,a;return e.preventDefault(),n=s.find("#case").checked(),a=s.find("#words").checked(),(r=s.find("#find").value()).length?d.text===r&&d.caseState===n&&d.wholeWord===a?T.hasNext(i,o)?(T.next(i,o),void c()):void l():((t=T.find(i,o,r,n,a))||l(),s.statusbar.items().slice(1).disabled(0===t),c(),void(d={text:r,caseState:n,wholeWord:a})):(T.done(i,o,!1),void s.statusbar.items().slice(1).disabled(!0))},buttons:[{text:"Find",subtype:"primary",onclick:function(){s.submit()}},{text:"Replace",disabled:!0,onclick:function(){T.replace(i,o,s.find("#replace").value())||(s.statusbar.items().slice(1).disabled(!0),o.set(-1),d={})}},{text:"Replace all",disabled:!0,onclick:function(){T.replace(i,o,s.find("#replace").value(),!0,!0),s.statusbar.items().slice(1).disabled(!0),d={}}},{type:"spacer",flex:1},{text:"Prev",name:"prev",disabled:!0,onclick:function(){T.prev(i,o),c()}},{text:"Next",name:"next",disabled:!0,onclick:function(){T.next(i,o),c()}}],title:"Find and replace",items:{type:"form",padding:20,labelGap:30,spacing:10,items:[{type:"textbox",name:"find",size:40,label:"Find",value:e},{type:"textbox",name:"replace",size:40,label:"Replace with"},{type:"checkbox",name:"case",text:"Match case",label:" "},{type:"checkbox",name:"words",text:"Whole words",label:" "}]}})},i=function(e,t){e.addCommand("SearchReplace",function(){a(e,t)})},d=function(e,t){return function(){a(e,t)}},c=function(e,t){e.addMenuItem("searchreplace",{text:"Find and replace",shortcut:"Meta+F",onclick:d(e,t),separator:"before",context:"edit"}),e.addButton("searchreplace",{tooltip:"Find and replace",onclick:d(e,t)}),e.shortcuts.add("Meta+F","",d(e,t))};e.add("searchreplace",function(e){var t=r(-1);return i(e,t),c(e,t),n(e,t)})}();!function(){"use strict";var n=tinymce.util.Tools.resolve("tinymce.PluginManager"),t=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),a=tinymce.util.Tools.resolve("tinymce.util.Tools"),o=function(n){return n.getParam("save_enablewhendirty",!0)},c=function(n){return!!n.getParam("save_onsavecallback")},i=function(n){return!!n.getParam("save_oncancelcallback")},r=function(n,e){n.notificationManager.open({text:n.translate(e),type:"error"})},e=function(n){var e;if(e=t.DOM.getParent(n.id,"form"),!o(n)||n.isDirty()){if(n.save(),c(n))return n.execCallback("save_onsavecallback",n),void n.nodeChanged();e?(n.setDirty(!1),e.onsubmit&&!e.onsubmit()||("function"==typeof e.submit?e.submit():r(n,"Error: Form submit field collision.")),n.nodeChanged()):r(n,"Error: No form element found.")}},l=function(n){var e=a.trim(n.startContent);i(n)?n.execCallback("save_oncancelcallback",n):(n.setContent(e),n.undoManager.clear(),n.nodeChanged())},d=function(n){n.addCommand("mceSave",function(){e(n)}),n.addCommand("mceCancel",function(){l(n)})},s=function(t){return function(n){var e=n.control;t.on("nodeChange dirty",function(){e.disabled(o(t)&&!t.isDirty())})}},u=function(n){n.addButton("save",{icon:"save",text:"Save",cmd:"mceSave",disabled:!0,onPostRender:s(n)}),n.addButton("cancel",{text:"Cancel",icon:!1,cmd:"mceCancel",disabled:!0,onPostRender:s(n)}),n.addShortcut("Meta+S","","mceSave")};n.add("save",function(n){u(n),d(n)})}();!function(){"use strict";var t=tinymce.util.Tools.resolve("tinymce.PluginManager"),n=function(t){t.addCommand("mcePrint",function(){t.getWin().print()})},i=function(t){t.addButton("print",{title:"Print",cmd:"mcePrint"}),t.addMenuItem("print",{text:"Print",cmd:"mcePrint",icon:"print"})};t.add("print",function(t){n(t),i(t),t.addShortcut("Meta+P","","mcePrint")})}();!function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager"),r=tinymce.util.Tools.resolve("tinymce.Env"),c=function(e){return parseInt(e.getParam("plugin_preview_width","650"),10)},a=function(e){return parseInt(e.getParam("plugin_preview_height","500"),10)},s=function(e){return e.getParam("content_style","")},d=tinymce.util.Tools.resolve("tinymce.util.Tools"),l=function(t){var n="",i=t.dom.encode,e=s(t);n+='<base href="'+i(t.documentBaseURI.getURI())+'">',e&&(n+='<style type="text/css">'+e+"</style>"),d.each(t.contentCSS,function(e){n+='<link type="text/css" rel="stylesheet" href="'+i(t.documentBaseURI.toAbsolute(e))+'">'});var o=t.settings.body_id||"tinymce";-1!==o.indexOf("=")&&(o=(o=t.getParam("body_id","","hash"))[t.id]||o);var r=t.settings.body_class||"";-1!==r.indexOf("=")&&(r=(r=t.getParam("body_class","","hash"))[t.id]||"");var c=t.settings.directionality?' dir="'+t.settings.directionality+'"':"";return"<!DOCTYPE html><html><head>"+n+'</head><body id="'+i(o)+'" class="mce-content-body '+i(r)+'"'+i(c)+">"+t.getContent()+'<script>document.addEventListener && document.addEventListener("click", function(e) {for (var elm = e.target; elm; elm = elm.parentNode) {if (elm.nodeName === "A") {e.preventDefault();}}}, false);<\/script> </body></html>'},m=function(e,t,n){var i=l(e);if(n)t.src="data:text/html;charset=utf-8,"+encodeURIComponent(i);else{var o=t.contentWindow.document;o.open(),o.write(i),o.close()}},t=function(n){var i=!r.ie,e='<iframe src="" frameborder="0"'+(i?' sandbox="allow-scripts"':"")+"></iframe>",t=c(n),o=a(n);n.windowManager.open({title:"Preview",width:t,height:o,html:e,buttons:{text:"Close",onclick:function(e){e.control.parent().parent().close()}},onPostRender:function(e){var t=e.control.getEl("body").firstChild;m(n,t,i)}})},n=function(e){e.addCommand("mcePreview",function(){t(e)})},i=function(e){e.addButton("preview",{title:"Preview",cmd:"mcePreview"}),e.addMenuItem("preview",{text:"Preview",cmd:"mcePreview",context:"view"})};e.add("preview",function(e){n(e),i(e)})}();!function(){"use strict";var l=function(t){var e=t,n=function(){return e};return{get:n,set:function(t){e=t},clone:function(){return l(n())}}},e=tinymce.util.Tools.resolve("tinymce.PluginManager"),a=function(t){return!(!/(^|[ ,])powerpaste([, ]|$)/.test(t.settings.plugins)||!e.get("powerpaste")||("undefined"!=typeof window.console&&window.console.log&&window.console.log("PowerPaste is incompatible with Paste plugin! Remove 'paste' from the 'plugins' option."),0))},s=function(t,e){return{clipboard:t,quirks:e}},f=function(t,e,n,r){return t.fire("PastePreProcess",{content:e,internal:n,wordContent:r})},d=function(t,e,n,r){return t.fire("PastePostProcess",{node:e,internal:n,wordContent:r})},u=function(t,e){return t.fire("PastePlainTextToggle",{state:e})},n=function(t,e){return t.fire("paste",{ieFake:e})},m={shouldPlainTextInform:function(t){return t.getParam("paste_plaintext_inform",!0)},shouldBlockDrop:function(t){return t.getParam("paste_block_drop",!1)},shouldPasteDataImages:function(t){return t.getParam("paste_data_images",!1)},shouldFilterDrop:function(t){return t.getParam("paste_filter_drop",!0)},getPreProcess:function(t){return t.getParam("paste_preprocess")},getPostProcess:function(t){return t.getParam("paste_postprocess")},getWebkitStyles:function(t){return t.getParam("paste_webkit_styles")},shouldRemoveWebKitStyles:function(t){return t.getParam("paste_remove_styles_if_webkit",!0)},shouldMergeFormats:function(t){return t.getParam("paste_merge_formats",!0)},isSmartPasteEnabled:function(t){return t.getParam("smart_paste",!0)},isPasteAsTextEnabled:function(t){return t.getParam("paste_as_text",!1)},getRetainStyleProps:function(t){return t.getParam("paste_retain_style_properties")},getWordValidElements:function(t){return t.getParam("paste_word_valid_elements","-strong/b,-em/i,-u,-span,-p,-ol,-ul,-li,-h1,-h2,-h3,-h4,-h5,-h6,-p/div,-a[href|name],sub,sup,strike,br,del,table[width],tr,td[colspan|rowspan|width],th[colspan|rowspan|width],thead,tfoot,tbody")},shouldConvertWordFakeLists:function(t){return t.getParam("paste_convert_word_fake_lists",!0)},shouldUseDefaultFilters:function(t){return t.getParam("paste_enable_default_filters",!0)}},r=function(t,e,n){var r,o,i;"text"===e.pasteFormat.get()?(e.pasteFormat.set("html"),u(t,!1)):(e.pasteFormat.set("text"),u(t,!0),i=t,!1===n.get()&&m.shouldPlainTextInform(i)&&(o="Paste is now in plain text mode. Contents will now be pasted as plain text until you toggle this option off.",(r=t).notificationManager.open({text:r.translate(o),type:"info"}),n.set(!0))),t.focus()},c=function(t,n,e){t.addCommand("mceTogglePlainTextPaste",function(){r(t,n,e)}),t.addCommand("mceInsertClipboardContent",function(t,e){e.content&&n.pasteHtml(e.content,e.internal),e.text&&n.pasteText(e.text)})},v=tinymce.util.Tools.resolve("tinymce.Env"),h=tinymce.util.Tools.resolve("tinymce.util.Delay"),y=tinymce.util.Tools.resolve("tinymce.util.Tools"),o=tinymce.util.Tools.resolve("tinymce.util.VK"),t="x-tinymce/html",i="\x3c!-- "+t+" --\x3e",g=function(t){return i+t},p=function(t){return t.replace(i,"")},b=function(t){return-1!==t.indexOf(i)},x=function(){return t},P=tinymce.util.Tools.resolve("tinymce.html.Entities"),w=function(t){return t.replace(/\r?\n/g,"<br>")},_=function(t,e,n){var r=t.split(/\n\n/),o=function(t,e){var n,r=[],o="<"+t;if("object"==typeof e){for(n in e)e.hasOwnProperty(n)&&r.push(n+'="'+P.encodeAllRaw(e[n])+'"');r.length&&(o+=" "+r.join(" "))}return o+">"}(e,n),i="</"+e+">",a=y.map(r,function(t){return t.split(/\n/).join("<br />")});return 1===a.length?a[0]:y.map(a,function(t){return o+t+i}).join("")},D=function(t){return!/<(?:\/?(?!(?:div|p|br|span)>)\w+|(?:(?!(?:span style="white-space:\s?pre;?">)|br\s?\/>))\w+\s[^>]+)>/i.test(t)},T=function(t,e,n){return e?_(t,e,n):w(t)},C=tinymce.util.Tools.resolve("tinymce.html.DomParser"),k=tinymce.util.Tools.resolve("tinymce.html.Node"),S=tinymce.util.Tools.resolve("tinymce.html.Schema"),O=tinymce.util.Tools.resolve("tinymce.html.Serializer");function R(e,t){return y.each(t,function(t){e=t.constructor===RegExp?e.replace(t,""):e.replace(t[0],t[1])}),e}var F={filter:R,innerText:function(e){var n=S(),r=C({},n),o="",i=n.getShortEndedElements(),a=y.makeMap("script noscript style textarea video audio iframe object"," "),s=n.getBlockElements();return e=R(e,[/<!\[[^\]]+\]>/g]),function t(e){var n=e.name,r=e;if("br"!==n){if("wbr"!==n)if(i[n]&&(o+=" "),a[n])o+=" ";else{if(3===e.type&&(o+=e.value),!e.shortEnded&&(e=e.firstChild))for(;t(e),e=e.next;);s[n]&&r.next&&(o+="\n","p"===n&&(o+="\n"))}}else o+="\n"}(r.parse(e)),o},trimHtml:function(t){return t=R(t,[/^[\s\S]*<body[^>]*>\s*|\s*<\/body[^>]*>[\s\S]*$/gi,/<!--StartFragment-->|<!--EndFragment-->/g,[/( ?)<span class="Apple-converted-space">\u00a0<\/span>( ?)/g,function(t,e,n){return e||n?"\xa0":" "}],/<br class="Apple-interchange-newline">/g,/<br>$/i])},createIdGenerator:function(t){var e=0;return function(){return t+e++}},isMsEdge:function(){return-1!==navigator.userAgent.indexOf(" Edge/")}};function E(e){var n,t;return t=[/^[IVXLMCD]{1,2}\.[ \u00a0]/,/^[ivxlmcd]{1,2}\.[ \u00a0]/,/^[a-z]{1,2}[\.\)][ \u00a0]/,/^[A-Z]{1,2}[\.\)][ \u00a0]/,/^[0-9]+\.[ \u00a0]/,/^[\u3007\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]+\.[ \u00a0]/,/^[\u58f1\u5f10\u53c2\u56db\u4f0d\u516d\u4e03\u516b\u4e5d\u62fe]+\.[ \u00a0]/],e=e.replace(/^[\u00a0 ]+/,""),y.each(t,function(t){if(t.test(e))return!(n=!0)}),n}function A(t){var i,a,s=1;function n(t){var e="";if(3===t.type)return t.value;if(t=t.firstChild)for(;e+=n(t),t=t.next;);return e}function u(t,e){if(3===t.type&&e.test(t.value))return t.value=t.value.replace(e,""),!1;if(t=t.firstChild)do{if(!u(t,e))return!1}while(t=t.next);return!0}function e(e,n,r){var o=e._listLevel||s;o!==s&&(o<s?i&&(i=i.parent.parent):(a=i,i=null)),i&&i.name===n?i.append(e):(a=a||i,i=new k(n,1),1<r&&i.attr("start",""+r),e.wrap(i)),e.name="li",s<o&&a&&a.lastChild.append(i),s=o,function t(e){if(e._listIgnore)e.remove();else if(e=e.firstChild)for(;t(e),e=e.next;);}(e),u(e,/^\u00a0+/),u(e,/^\s*([\u2022\u00b7\u00a7\u25CF]|\w+\.)/),u(e,/^\u00a0+/)}for(var r=[],o=t.firstChild;null!=o;)if(r.push(o),null!==(o=o.walk()))for(;void 0!==o&&o.parent!==t;)o=o.walk();for(var l=0;l<r.length;l++)if("p"===(t=r[l]).name&&t.firstChild){var c=n(t);if(/^[\s\u00a0]*[\u2022\u00b7\u00a7\u25CF]\s*/.test(c)){e(t,"ul");continue}if(E(c)){var f=/([0-9]+)\./.exec(c),d=1;f&&(d=parseInt(f[1],10)),e(t,"ol",d);continue}if(t._listLevel){e(t,"ul",1);continue}i=null}else a=i,i=null}function I(n,r,o,i){var a,s={},t=n.dom.parseStyle(i);return y.each(t,function(t,e){switch(e){case"mso-list":(a=/\w+ \w+([0-9]+)/i.exec(i))&&(o._listLevel=parseInt(a[1],10)),/Ignore/i.test(t)&&o.firstChild&&(o._listIgnore=!0,o.firstChild._listIgnore=!0);break;case"horiz-align":e="text-align";break;case"vert-align":e="vertical-align";break;case"font-color":case"mso-foreground":e="color";break;case"mso-background":case"mso-highlight":e="background";break;case"font-weight":case"font-style":return void("normal"!==t&&(s[e]=t));case"mso-element":if(/^(comment|comment-list)$/i.test(t))return void o.remove()}0!==e.indexOf("mso-comment")?0!==e.indexOf("mso-")&&("all"===m.getRetainStyleProps(n)||r&&r[e])&&(s[e]=t):o.remove()}),/(bold)/i.test(s["font-weight"])&&(delete s["font-weight"],o.wrap(new k("b",1))),/(italic)/i.test(s["font-style"])&&(delete s["font-style"],o.wrap(new k("i",1))),(s=n.dom.serializeStyle(s,o.name))||null}var M,B,H,j,L,N={preProcess:function(t,e){return m.shouldUseDefaultFilters(t)?function(r,t){var e,o;(e=m.getRetainStyleProps(r))&&(o=y.makeMap(e.split(/[, ]/))),t=F.filter(t,[/<br class="?Apple-interchange-newline"?>/gi,/<b[^>]+id="?docs-internal-[^>]*>/gi,/<!--[\s\S]+?-->/gi,/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,[/<(\/?)s>/gi,"<$1strike>"],[/&nbsp;/gi,"\xa0"],[/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(t,e){return 0<e.length?e.replace(/./," ").slice(Math.floor(e.length/2)).split("").join("\xa0"):""}]]);var n=m.getWordValidElements(r),i=S({valid_elements:n,valid_children:"-li[p]"});y.each(i.elements,function(t){t.attributes["class"]||(t.attributes["class"]={},t.attributesOrder.push("class")),t.attributes.style||(t.attributes.style={},t.attributesOrder.push("style"))});var a=C({},i);a.addAttributeFilter("style",function(t){for(var e,n=t.length;n--;)(e=t[n]).attr("style",I(r,o,e,e.attr("style"))),"span"===e.name&&e.parent&&!e.attributes.length&&e.unwrap()}),a.addAttributeFilter("class",function(t){for(var e,n,r=t.length;r--;)n=(e=t[r]).attr("class"),/^(MsoCommentReference|MsoCommentText|msoDel)$/i.test(n)&&e.remove(),e.attr("class",null)}),a.addNodeFilter("del",function(t){for(var e=t.length;e--;)t[e].remove()}),a.addNodeFilter("a",function(t){for(var e,n,r,o=t.length;o--;)if(n=(e=t[o]).attr("href"),r=e.attr("name"),n&&-1!==n.indexOf("#_msocom_"))e.remove();else if(n&&0===n.indexOf("file://")&&(n=n.split("#")[1])&&(n="#"+n),n||r){if(r&&!/^_?(?:toc|edn|ftn)/i.test(r)){e.unwrap();continue}e.attr({href:n,name:r})}else e.unwrap()});var s=a.parse(t);return m.shouldConvertWordFakeLists(r)&&A(s),t=O({validate:r.settings.validate},i).serialize(s)}(t,e):e},isWordContent:function(t){return/<font face="Times New Roman"|class="?Mso|style="[^"]*\bmso-|style='[^'']*\bmso-|w:WordDocument/i.test(t)||/class="OutlineElement/.test(t)||/id="?docs\-internal\-guid\-/.test(t)}},$=function(t,e){return{content:t,cancelled:e}},W=function(t,e,n,r){var o,i,a,s,u,l,c=f(t,e,n,r);return t.hasEventListeners("PastePostProcess")&&!c.isDefaultPrevented()?(o=t,i=c.content,a=n,s=r,u=o.dom.create("div",{style:"display:none"},i),l=d(o,u,a,s),$(l.node.innerHTML,l.isDefaultPrevented())):$(c.content,c.isDefaultPrevented())},z=function(t,e,n){var r=N.isWordContent(e),o=r?N.preProcess(t,e):e;return W(t,o,n,r)},U=function(t,e){var n,r;return t.insertContent((n=e,r=t.dom.create("body",{},n),y.each(r.querySelectorAll("meta"),function(t){return t.parentNode.removeChild(t)}),r.innerHTML),{merge:m.shouldMergeFormats(t),paste:!0}),!0},V=function(t){return/^https?:\/\/[\w\?\-\/+=.&%@~#]+$/i.test(t)},q=function(t){return V(t)&&/.(gif|jpe?g|png)$/.test(t)},K=function(t,e,n){return!(!1!==t.selection.isCollapsed()||!V(e)||(o=e,i=n,(r=t).undoManager.extra(function(){i(r,o)},function(){r.execCommand("mceInsertLink",!1,o)}),0));var r,o,i},G=function(t,e,n){return!!q(e)&&(o=e,i=n,(r=t).undoManager.extra(function(){i(r,o)},function(){r.insertContent('<img src="'+o+'">')}),!0);var r,o,i},X=function(t,e){var n,r;!1===m.isSmartPasteEnabled(t)?U(t,e):(n=t,r=e,y.each([K,G,U],function(t){return!0!==t(n,r,U)}))},Y=function(t){return function(){return t}},Z=Y(!1),J=Y(!0),Q=Z,tt=J,et=function(){return nt},nt=(j={fold:function(t,e){return t()},is:Q,isSome:Q,isNone:tt,getOr:H=function(t){return t},getOrThunk:B=function(t){return t()},getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:function(){return null},getOrUndefined:function(){return undefined},or:H,orThunk:B,map:et,ap:et,each:function(){},bind:et,flatten:et,exists:Q,forall:tt,filter:et,equals:M=function(t){return t.isNone()},equals_:M,toArray:function(){return[]},toString:Y("none()")},Object.freeze&&Object.freeze(j),j),rt=function(n){var t=function(){return n},e=function(){return o},r=function(t){return t(n)},o={fold:function(t,e){return e(n)},is:function(t){return n===t},isSome:tt,isNone:Q,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:e,orThunk:e,map:function(t){return rt(t(n))},ap:function(t){return t.fold(et,function(t){return rt(t(n))})},each:function(t){t(n)},bind:r,flatten:t,exists:r,forall:r,filter:function(t){return t(n)?o:nt},equals:function(t){return t.is(n)},equals_:function(t,e){return t.fold(Q,function(t){return e(n,t)})},toArray:function(){return[n]},toString:function(){return"some("+n+")"}};return o},ot={some:rt,none:et,from:function(t){return null===t||t===undefined?nt:rt(t)}},it=(L="function",function(t){return function(t){if(null===t)return"null";var e=typeof t;return"object"===e&&Array.prototype.isPrototypeOf(t)?"array":"object"===e&&String.prototype.isPrototypeOf(t)?"string":e}(t)===L}),at=function(t,e){for(var n=t.length,r=new Array(n),o=0;o<n;o++){var i=t[o];r[o]=e(i,o,t)}return r},st=function(t,e){for(var n=0,r=t.length;n<r;n++)e(t[n],n,t)},ut=Array.prototype.slice,lt=it(Array.from)?Array.from:function(t){return ut.call(t)},ct=function(t){var n=ot.none(),e=[],r=function(t){o()?a(t):e.push(t)},o=function(){return n.isSome()},i=function(t){st(t,a)},a=function(e){n.each(function(t){setTimeout(function(){e(t)},0)})};return t(function(t){n=ot.some(t),i(e),e=[]}),{get:r,map:function(n){return ct(function(e){r(function(t){e(n(t))})})},isReady:o}},ft={nu:ct,pure:function(e){return ct(function(t){t(e)})}},dt=function(e){var t=function(t){var r;e((r=t,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this;setTimeout(function(){r.apply(n,t)},0)}))},n=function(){return ft.nu(t)};return{map:function(r){return dt(function(n){t(function(t){var e=r(t);n(e)})})},bind:function(n){return dt(function(e){t(function(t){n(t).get(e)})})},anonBind:function(n){return dt(function(e){t(function(t){n.get(e)})})},toLazy:n,toCached:function(){var e=null;return dt(function(t){null===e&&(e=n()),e.get(t)})},get:t}},mt={nu:dt,pure:function(e){return dt(function(t){t(e)})}},gt=function(a,t){return t(function(r){var o=[],i=0;0===a.length?r([]):st(a,function(t,e){var n;t.get((n=e,function(t){o[n]=t,++i>=a.length&&r(o)}))})})},pt=function(t,e){var n=at(t,e);return gt(n,mt.nu)},vt=function(t,e,n){var r=n||b(e),o=z(t,p(e),r);!1===o.cancelled&&X(t,o.content)},ht=function(t,e){e=t.dom.encode(e).replace(/\r\n/g,"\n"),e=T(e,t.settings.forced_root_block,t.settings.forced_root_block_attrs),vt(t,e,!1)},yt=function(t){var e={};if(t){if(t.getData){var n=t.getData("Text");n&&0<n.length&&-1===n.indexOf("data:text/mce-internal,")&&(e["text/plain"]=n)}if(t.types)for(var r=0;r<t.types.length;r++){var o=t.types[r];try{e[o]=t.getData(o)}catch(i){e[o]=""}}}return e},bt=function(t,e){return e in t&&0<t[e].length},xt=function(t){return bt(t,"text/html")||bt(t,"text/plain")},Pt=F.createIdGenerator("mceclip"),wt=function(e,t,n){var r,o,i,a,s="paste"===t.type?t.clipboardData:t.dataTransfer;if(e.settings.paste_data_images&&s){var u=(i=(o=s).items?at(lt(o.items),function(t){return t.getAsFile()}):[],a=o.files?lt(o.files):[],function(t,e){for(var n=[],r=0,o=t.length;r<o;r++){var i=t[r];e(i,r,t)&&n.push(i)}return n}(0<i.length?i:a,function(t){return/^image\/(jpeg|png|gif|bmp)$/.test(t.type)}));if(0<u.length)return t.preventDefault(),(r=u,pt(r,function(r){return mt.nu(function(t){var e=r.getAsFile?r.getAsFile():r,n=new window.FileReader;n.onload=function(){t({blob:e,uri:n.result})},n.readAsDataURL(e)})})).get(function(t){n&&e.selection.setRng(n),st(t,function(t){!function(t,e){var n,r,o,i,a,s,u,l=(n=e.uri,-1!==(r=n.indexOf(","))?n.substr(r+1):null),c=Pt(),f=t.settings.images_reuse_filename&&e.blob.name?(o=t,i=e.blob.name,(a=i.match(/([\s\S]+?)\.(?:jpeg|jpg|png|gif)$/i))?o.dom.encode(a[1]):null):c,d=new Image;if(d.src=e.uri,s=t.settings,u=d,!s.images_dataimg_filter||s.images_dataimg_filter(u)){var m,g=t.editorUpload.blobCache,p=void 0;(m=g.findFirst(function(t){return t.base64()===l}))?p=m:(p=g.create(c,e.blob,l,f),g.add(p)),vt(t,'<img src="'+p.blobUri()+'">',!1)}else vt(t,'<img src="'+e.uri+'">',!1)}(e,t)})}),!0}return!1},_t=function(t){return o.metaKeyPressed(t)&&86===t.keyCode||t.shiftKey&&45===t.keyCode},Dt=function(c,f,d){var m,g=0;function p(t,e,n,r){var o,i;bt(t,"text/html")?o=t["text/html"]:(o=f.getHtml(),r=r||b(o),f.isDefaultContent(o)&&(n=!0)),o=F.trimHtml(o),f.remove(),i=!1===r&&D(o),o.length&&!i||(n=!0),n&&(o=bt(t,"text/plain")&&i?t["text/plain"]:F.innerText(o)),f.isDefaultContent(o)?e||c.windowManager.alert("Please use Ctrl+V/Cmd+V keyboard shortcuts to paste contents."):n?ht(c,o):vt(c,o,r)}c.on("keydown",function(t){function e(t){_t(t)&&!t.isDefaultPrevented()&&f.remove()}if(_t(t)&&!t.isDefaultPrevented()){if((m=t.shiftKey&&86===t.keyCode)&&v.webkit&&-1!==navigator.userAgent.indexOf("Version/"))return;if(t.stopImmediatePropagation(),g=(new Date).getTime(),v.ie&&m)return t.preventDefault(),void n(c,!0);f.remove(),f.create(),c.once("keyup",e),c.once("paste",function(){c.off("keyup",e)})}}),c.on("paste",function(t){var e,n,r,o=(new Date).getTime(),i=(e=c,n=yt(t.clipboardData||e.getDoc().dataTransfer),F.isMsEdge()?y.extend(n,{"text/html":""}):n),a=(new Date).getTime()-o,s=(new Date).getTime()-g-a<1e3,u="text"===d.get()||m,l=bt(i,x());m=!1,t.isDefaultPrevented()||(r=t.clipboardData,-1!==navigator.userAgent.indexOf("Android")&&r&&r.items&&0===r.items.length)?f.remove():xt(i)||!wt(c,t,f.getLastRng()||c.selection.getRng())?(s||t.preventDefault(),!v.ie||s&&!t.ieFake||bt(i,"text/html")||(f.create(),c.dom.bind(f.getEl(),"paste",function(t){t.stopPropagation()}),c.getDoc().execCommand("Paste",!1,null),i["text/html"]=f.getHtml()),bt(i,"text/html")?(t.preventDefault(),l||(l=b(i["text/html"])),p(i,s,u,l)):h.setEditorTimeout(c,function(){p(i,s,u,l)},0)):f.remove()})},Tt=function(t){return v.ie&&t.inline?document.body:t.getBody()},Ct=function(e,t,n){var r;Tt(r=e)!==r.getBody()&&e.dom.bind(t,"paste keyup",function(t){Ot(e,n)||e.fire("paste")})},kt=function(t){return t.dom.get("mcepastebin")},St=function(t,e){return e===t},Ot=function(t,e){var n,r=kt(t);return(n=r)&&"mcepastebin"===n.id&&St(e,r.innerHTML)},Rt=function(a){var s=l(null),u="%MCEPASTEBIN%";return{create:function(){return e=s,n=u,o=(t=a).dom,i=t.getBody(),e.set(t.selection.getRng()),r=t.dom.add(Tt(t),"div",{id:"mcepastebin","class":"mce-pastebin",contentEditable:!0,"data-mce-bogus":"all",style:"position: fixed; top: 50%; width: 10px; height: 10px; overflow: hidden; opacity: 0"},n),(v.ie||v.gecko)&&o.setStyle(r,"left","rtl"===o.getStyle(i,"direction",!0)?65535:-65535),o.bind(r,"beforedeactivate focusin focusout",function(t){t.stopPropagation()}),Ct(t,r,n),r.focus(),void t.selection.select(r,!0);var t,e,n,r,o,i},remove:function(){return function(t,e){if(kt(t)){for(var n=void 0,r=e.get();n=t.dom.get("mcepastebin");)t.dom.remove(n),t.dom.unbind(n);r&&t.selection.setRng(r)}e.set(null)}(a,s)},getEl:function(){return kt(a)},getHtml:function(){return function(n){var e,t,r,o,i,a=function(t,e){t.appendChild(e),n.dom.remove(e,!0)};for(t=y.grep(Tt(n).childNodes,function(t){return"mcepastebin"===t.id}),e=t.shift(),y.each(t,function(t){a(e,t)}),r=(o=n.dom.select("div[id=mcepastebin]",e)).length-1;0<=r;r--)i=n.dom.create("div"),e.insertBefore(i,o[r]),a(i,o[r]);return e?e.innerHTML:""}(a)},getLastRng:function(){return s.get()},isDefault:function(){return Ot(a,u)},isDefaultContent:function(t){return St(u,t)}}},Ft=function(n,t){var e=Rt(n);return n.on("preInit",function(){return Dt(a=n,e,t),void a.parser.addNodeFilter("img",function(t,e,n){var r,o=function(t){t.attr("data-mce-object")||s===v.transparentSrc||t.remove()};if(!a.settings.paste_data_images&&(r=n).data&&!0===r.data.paste)for(var i=t.length;i--;)(s=t[i].attributes.map.src)&&(0===s.indexOf("webkit-fake-url")?o(t[i]):a.settings.allow_html_data_urls||0!==s.indexOf("data:")||o(t[i]))});var a,s}),{pasteFormat:t,pasteHtml:function(t,e){return vt(n,t,e)},pasteText:function(t){return ht(n,t)},pasteImageData:function(t,e){return wt(n,t,e)},getDataTransferItems:yt,hasHtmlOrText:xt,hasContentType:bt}},Et=function(){},At=function(t,e,n){if(r=t,!1!==v.iOS||r===undefined||"function"!=typeof r.setData||!0===F.isMsEdge())return!1;try{return t.clearData(),t.setData("text/html",e),t.setData("text/plain",n),t.setData(x(),e),!0}catch(o){return!1}var r},It=function(t,e,n,r){At(t.clipboardData,e.html,e.text)?(t.preventDefault(),r()):n(e.html,r)},Mt=function(s){return function(t,e){var n=g(t),r=s.dom.create("div",{contenteditable:"false","data-mce-bogus":"all"}),o=s.dom.create("div",{contenteditable:"true"},n);s.dom.setStyles(r,{position:"fixed",top:"0",left:"-3000px",width:"1000px",overflow:"hidden"}),r.appendChild(o),s.dom.add(s.getBody(),r);var i=s.selection.getRng();o.focus();var a=s.dom.createRng();a.selectNodeContents(o),s.selection.setRng(a),setTimeout(function(){s.selection.setRng(i),r.parentNode.removeChild(r),e()},0)}},Bt=function(t){return{html:t.selection.getContent({contextual:!0}),text:t.selection.getContent({format:"text"})}},Ht=function(t){return!t.selection.isCollapsed()||!!(e=t).dom.getParent(e.selection.getStart(),"td[data-mce-selected],th[data-mce-selected]",e.getBody());var e},jt=function(t){var e,n;t.on("cut",(e=t,function(t){Ht(e)&&It(t,Bt(e),Mt(e),function(){setTimeout(function(){e.execCommand("Delete")},0)})})),t.on("copy",(n=t,function(t){Ht(n)&&It(t,Bt(n),Mt(n),Et)}))},Lt=tinymce.util.Tools.resolve("tinymce.dom.RangeUtils"),Nt=function(t,e){return Lt.getCaretRangeFromPoint(e.clientX,e.clientY,t.getDoc())},$t=function(t,e){t.focus(),t.selection.setRng(e)},Wt=function(a,s,u){m.shouldBlockDrop(a)&&a.on("dragend dragover draggesture dragdrop drop drag",function(t){t.preventDefault(),t.stopPropagation()}),m.shouldPasteDataImages(a)||a.on("drop",function(t){var e=t.dataTransfer;e&&e.files&&0<e.files.length&&t.preventDefault()}),a.on("drop",function(t){var e,n;if(n=Nt(a,t),!t.isDefaultPrevented()&&!u.get()){e=s.getDataTransferItems(t.dataTransfer);var r,o=s.hasContentType(e,x());if((s.hasHtmlOrText(e)&&(!(r=e["text/plain"])||0!==r.indexOf("file://"))||!s.pasteImageData(t,n))&&n&&m.shouldFilterDrop(a)){var i=e["mce-internal"]||e["text/html"]||e["text/plain"];i&&(t.preventDefault(),h.setEditorTimeout(a,function(){a.undoManager.transact(function(){e["mce-internal"]&&a.execCommand("Delete"),$t(a,n),i=F.trimHtml(i),e["text/html"]?s.pasteHtml(i,o):s.pasteText(i)})}))}}}),a.on("dragstart",function(t){u.set(!0)}),a.on("dragover dragend",function(t){m.shouldPasteDataImages(a)&&!1===u.get()&&(t.preventDefault(),$t(a,Nt(a,t))),"dragend"===t.type&&u.set(!1)})},zt=function(t){var e=t.plugins.paste,n=m.getPreProcess(t);n&&t.on("PastePreProcess",function(t){n.call(e,e,t)});var r=m.getPostProcess(t);r&&t.on("PastePostProcess",function(t){r.call(e,e,t)})};function Ut(e,n){e.on("PastePreProcess",function(t){t.content=n(e,t.content,t.internal,t.wordContent)})}function Vt(t,e){if(!N.isWordContent(e))return e;var n=[];y.each(t.schema.getBlockElements(),function(t,e){n.push(e)});var r=new RegExp("(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*(<\\/?("+n.join("|")+")[^>]*>)(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*","g");return e=F.filter(e,[[r,"$1"]]),e=F.filter(e,[[/<br><br>/g,"<BR><BR>"],[/<br>/g," "],[/<BR><BR>/g,"<br>"]])}function qt(t,e,n,r){if(r||n)return e;var l,o=m.getWebkitStyles(t);if(!1===m.shouldRemoveWebKitStyles(t)||"all"===o)return e;if(o&&(l=o.split(/[, ]/)),l){var c=t.dom,f=t.selection.getNode();e=e.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,function(t,e,n,r){var o=c.parseStyle(c.decode(n)),i={};if("none"===l)return e+r;for(var a=0;a<l.length;a++){var s=o[l[a]],u=c.getStyle(f,l[a],!0);/color/.test(l[a])&&(s=c.toHex(s),u=c.toHex(u)),u!==s&&(i[l[a]]=s)}return(i=c.serializeStyle(i,"span"))?e+' style="'+i+'"'+r:e+r})}else e=e.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,"$1$3");return e=e.replace(/(<[^>]+) data-mce-style="([^"]+)"([^>]*>)/gi,function(t,e,n,r){return e+' style="'+n+'"'+r})}function Kt(n,t){n.$("a",t).find("font,u").each(function(t,e){n.dom.remove(e,!0)})}var Gt=function(t){var e,n;v.webkit&&Ut(t,qt),v.ie&&(Ut(t,Vt),n=Kt,(e=t).on("PastePostProcess",function(t){n(e,t.node)}))},Xt=function(t,e,n){var r=n.control;r.active("text"===e.pasteFormat.get()),t.on("PastePlainTextToggle",function(t){r.active(t.state)})},Yt=function(t,e){var n=function(r){for(var o=[],t=1;t<arguments.length;t++)o[t-1]=arguments[t];return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=o.concat(t);return r.apply(null,n)}}(Xt,t,e);t.addButton("pastetext",{active:!1,icon:"pastetext",tooltip:"Paste as text",cmd:"mceTogglePlainTextPaste",onPostRender:n}),t.addMenuItem("pastetext",{text:"Paste as text",selectable:!0,active:e.pasteFormat,cmd:"mceTogglePlainTextPaste",onPostRender:n})};e.add("paste",function(t){if(!1===a(t)){var e=l(!1),n=l(!1),r=l(m.isPasteAsTextEnabled(t)?"text":"html"),o=Ft(t,r),i=Gt(t);return Yt(t,o),c(t,o,e),zt(t),jt(t),Wt(t,o,n),s(o,i)}})}();!function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager"),a=tinymce.util.Tools.resolve("tinymce.Env"),n=function(e){return e.getParam("pagebreak_separator","\x3c!-- pagebreak --\x3e")},i=function(e){return e.getParam("pagebreak_split_block",!1)},t=function(){return"mce-pagebreak"},r=function(){return'<img src="'+a.transparentSrc+'" class="mce-pagebreak" data-mce-resize="false" data-mce-placeholder />'},c=function(c){var o=n(c),a=new RegExp(o.replace(/[\?\.\*\[\]\(\)\{\}\+\^\$\:]/g,function(e){return"\\"+e}),"gi");c.on("BeforeSetContent",function(e){e.content=e.content.replace(a,r())}),c.on("PreInit",function(){c.serializer.addNodeFilter("img",function(e){for(var a,n,t=e.length;t--;)if((n=(a=e[t]).attr("class"))&&-1!==n.indexOf("mce-pagebreak")){var r=a.parent;if(c.schema.getBlockElements()[r.name]&&i(c)){r.type=3,r.value=o,r.raw=!0,a.remove();continue}a.type=3,a.value=o,a.raw=!0}})})},o=r,g=t,u=function(e){e.addCommand("mcePageBreak",function(){e.settings.pagebreak_split_block?e.insertContent("<p>"+o()+"</p>"):e.insertContent(o())})},m=function(a){a.on("ResolveName",function(e){"IMG"===e.target.nodeName&&a.dom.hasClass(e.target,g())&&(e.name="pagebreak")})},s=function(e){e.addButton("pagebreak",{title:"Page break",cmd:"mcePageBreak"}),e.addMenuItem("pagebreak",{text:"Page break",icon:"pagebreak",cmd:"mcePageBreak",context:"insert"})};e.add("pagebreak",function(e){u(e),s(e),c(e),m(e)})}();!function(){"use strict";var t=tinymce.util.Tools.resolve("tinymce.PluginManager"),c=tinymce.util.Tools.resolve("tinymce.util.Tools"),l=function(t){return t.getParam("noneditable_noneditable_class","mceNonEditable")},u=function(t){return t.getParam("noneditable_editable_class","mceEditable")},f=function(t){var n=t.getParam("noneditable_regexp",[]);return n&&n.constructor===RegExp?[n]:n},s=function(n){return function(t){return-1!==(" "+t.attr("class")+" ").indexOf(n)}},d=function(i,o,c){return function(t){var n=arguments,e=n[n.length-2],r=0<e?o.charAt(e-1):"";if('"'===r)return t;if(">"===r){var a=o.lastIndexOf("<",e);if(-1!==a&&-1!==o.substring(a,e).indexOf('contenteditable="false"'))return t}return'<span class="'+c+'" data-mce-content="'+i.dom.encode(n[0])+'">'+i.dom.encode("string"==typeof n[1]?n[1]:n[0])+"</span>"}},n=function(n){var t,e,r="contenteditable";t=" "+c.trim(u(n))+" ",e=" "+c.trim(l(n))+" ";var a=s(t),i=s(e),o=f(n);n.on("PreInit",function(){0<o.length&&n.on("BeforeSetContent",function(t){!function(t,n,e){var r=n.length,a=e.content;if("raw"!==e.format){for(;r--;)a=a.replace(n[r],d(t,a,l(t)));e.content=a}}(n,o,t)}),n.parser.addAttributeFilter("class",function(t){for(var n,e=t.length;e--;)n=t[e],a(n)?n.attr(r,"true"):i(n)&&n.attr(r,"false")}),n.serializer.addAttributeFilter(r,function(t){for(var n,e=t.length;e--;)n=t[e],(a(n)||i(n))&&(0<o.length&&n.attr("data-mce-content")?(n.name="#text",n.type=3,n.raw=!0,n.value=n.attr("data-mce-content")):n.attr(r,null))})})};t.add("noneditable",function(t){n(t)})}();!function(){"use strict";var n=tinymce.util.Tools.resolve("tinymce.PluginManager"),i=function(n,e){var t,i=(t=n).plugins.visualchars&&t.plugins.visualchars.isEnabled()?'<span class="mce-nbsp">&nbsp;</span>':"&nbsp;";n.insertContent(function(n,e){for(var t="",i=0;i<e;i++)t+=n;return t}(i,e)),n.dom.setAttrib(n.dom.select("span.mce-nbsp"),"data-mce-bogus","1")},e=function(n){n.addCommand("mceNonBreaking",function(){i(n,1)})},o=tinymce.util.Tools.resolve("tinymce.util.VK"),a=function(n){var e=n.getParam("nonbreaking_force_tab",0);return"boolean"==typeof e?!0===e?3:0:e},t=function(e){var t=a(e);0<t&&e.on("keydown",function(n){if(n.keyCode===o.TAB&&!n.isDefaultPrevented()){if(n.shiftKey)return;n.preventDefault(),n.stopImmediatePropagation(),i(e,t)}})},r=function(n){n.addButton("nonbreaking",{title:"Nonbreaking space",cmd:"mceNonBreaking"}),n.addMenuItem("nonbreaking",{icon:"nonbreaking",text:"Nonbreaking space",cmd:"mceNonBreaking",context:"insert"})};n.add("nonbreaking",function(n){e(n),r(n),t(n)})}();!function(){"use strict";var e,n,t,r,o,i,u,a,l,s,c=tinymce.util.Tools.resolve("tinymce.PluginManager"),f=tinymce.util.Tools.resolve("tinymce.dom.RangeUtils"),d=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),m=tinymce.util.Tools.resolve("tinymce.util.VK"),p=tinymce.util.Tools.resolve("tinymce.dom.BookmarkManager"),v=tinymce.util.Tools.resolve("tinymce.util.Tools"),g=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),h=function(e){return e&&"BR"===e.nodeName},y=function(e){return e&&3===e.nodeType},N=function(e){return e&&/^(OL|UL|DL)$/.test(e.nodeName)},S=function(e){return e&&/^(OL|UL)$/.test(e.nodeName)},O=function(e){return e&&/^(DT|DD)$/.test(e.nodeName)},C=function(e){return e&&/^(LI|DT|DD)$/.test(e.nodeName)},b=function(e){return e&&/^(TH|TD)$/.test(e.nodeName)},L=h,T=function(e,n){return n&&!!e.schema.getTextBlockElements()[n.nodeName]},D=function(e,n){return e&&e.nodeName in n},E=function(e,n){return!!h(n)&&!(!e.isBlock(n.nextSibling)||h(n.previousSibling))},w=function(e,n,t){var r=e.isEmpty(n);return!(t&&0<e.select("span[data-mce-type=bookmark]",n).length)&&r},k=function(e,n){return e.isChildOf(n,e.getRoot())},A=function(e,n){if(y(e))return{container:e,offset:n};var t=f.getNode(e,n);return y(t)?{container:t,offset:n>=e.childNodes.length?t.data.length:0}:t.previousSibling&&y(t.previousSibling)?{container:t.previousSibling,offset:t.previousSibling.data.length}:t.nextSibling&&y(t.nextSibling)?{container:t.nextSibling,offset:0}:{container:e,offset:n}},x=function(e){var n=e.cloneRange(),t=A(e.startContainer,e.startOffset);n.setStart(t.container,t.offset);var r=A(e.endContainer,e.endOffset);return n.setEnd(r.container,r.offset),n},R=g.DOM,I=function(o){var i={},e=function(e){var n,t,r;t=o[e?"startContainer":"endContainer"],r=o[e?"startOffset":"endOffset"],1===t.nodeType&&(n=R.create("span",{"data-mce-type":"bookmark"}),t.hasChildNodes()?(r=Math.min(r,t.childNodes.length-1),e?t.insertBefore(n,t.childNodes[r]):R.insertAfter(n,t.childNodes[r])):t.appendChild(n),t=n,r=0),i[e?"startContainer":"endContainer"]=t,i[e?"startOffset":"endOffset"]=r};return e(!0),o.collapsed||e(),i},B=function(o){function e(e){var n,t,r;n=r=o[e?"startContainer":"endContainer"],t=o[e?"startOffset":"endOffset"],n&&(1===n.nodeType&&(t=function(e){for(var n=e.parentNode.firstChild,t=0;n;){if(n===e)return t;1===n.nodeType&&"bookmark"===n.getAttribute("data-mce-type")||t++,n=n.nextSibling}return-1}(n),n=n.parentNode,R.remove(r),!n.hasChildNodes()&&R.isBlock(n)&&n.appendChild(R.create("br"))),o[e?"startContainer":"endContainer"]=n,o[e?"startOffset":"endOffset"]=t)}e(!0),e();var n=R.createRng();return n.setStart(o.startContainer,o.startOffset),o.endContainer&&n.setEnd(o.endContainer,o.endOffset),x(n)},_=function(e){return function(){return e}},P=function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return!t.apply(null,e)}},M=_(!1),U=_(!0),F=M,j=U,H=function(){return $},$=(r={fold:function(e,n){return e()},is:F,isSome:F,isNone:j,getOr:t=function(e){return e},getOrThunk:n=function(e){return e()},getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:function(){return null},getOrUndefined:function(){return undefined},or:t,orThunk:n,map:H,ap:H,each:function(){},bind:H,flatten:H,exists:F,forall:j,filter:H,equals:e=function(e){return e.isNone()},equals_:e,toArray:function(){return[]},toString:_("none()")},Object.freeze&&Object.freeze(r),r),q=function(t){var e=function(){return t},n=function(){return o},r=function(e){return e(t)},o={fold:function(e,n){return n(t)},is:function(e){return t===e},isSome:j,isNone:F,getOr:e,getOrThunk:e,getOrDie:e,getOrNull:e,getOrUndefined:e,or:n,orThunk:n,map:function(e){return q(e(t))},ap:function(e){return e.fold(H,function(e){return q(e(t))})},each:function(e){e(t)},bind:r,flatten:e,exists:r,forall:r,filter:function(e){return e(t)?o:$},equals:function(e){return e.is(t)},equals_:function(e,n){return e.fold(F,function(e){return n(t,e)})},toArray:function(){return[t]},toString:function(){return"some("+t+")"}};return o},W={some:q,none:H,from:function(e){return null===e||e===undefined?$:q(e)}},z=function(n){return function(e){return function(e){if(null===e)return"null";var n=typeof e;return"object"===n&&Array.prototype.isPrototypeOf(e)?"array":"object"===n&&String.prototype.isPrototypeOf(e)?"string":n}(e)===n}},K=z("string"),V=z("boolean"),X=z("function"),Q=z("number"),Y=function(e,n){for(var t=e.length,r=new Array(t),o=0;o<t;o++){var i=e[o];r[o]=n(i,o,e)}return r},G=function(e,n){for(var t=0,r=e.length;t<r;t++)n(e[t],t,e)},J=function(e,n){for(var t=[],r=0,o=e.length;r<o;r++){var i=e[r];n(i,r,e)&&t.push(i)}return t},Z=function(e,n,t){return G(e,function(e){t=n(t,e)}),t},ee=function(e,n){for(var t=0,r=e.length;t<r;t++){var o=e[t];if(n(o,t,e))return W.some(o)}return W.none()},ne=Array.prototype.push,te=function(e,n){return function(e){for(var n=[],t=0,r=e.length;t<r;++t){if(!Array.prototype.isPrototypeOf(e[t]))throw new Error("Arr.flatten item "+t+" was not an array, input: "+e);ne.apply(n,e[t])}return n}(Y(e,n))},re=Array.prototype.slice,oe=function(e){return 0===e.length?W.none():W.some(e[0])},ie=function(e){return 0===e.length?W.none():W.some(e[e.length-1])},ue=(X(Array.from)&&Array.from,"undefined"!=typeof window?window:Function("return this;")()),ae=function(e,n){return function(e,n){for(var t=n!==undefined&&null!==n?n:ue,r=0;r<e.length&&t!==undefined&&null!==t;++r)t=t[e[r]];return t}(e.split("."),n)},se=function(e,n){var t=ae(e,n);if(t===undefined||null===t)throw e+" not available on this browser";return t},ce=function(e){var n,t=ae("ownerDocument.defaultView",e);return(n=t,se("HTMLElement",n)).prototype.isPrototypeOf(e)},fe=tinymce.util.Tools.resolve("tinymce.dom.DomQuery"),le=function(e){var n=e.selection.getStart(!0);return e.dom.getParent(n,"OL,UL,DL",me(e,n))},de=function(e){var t,n,r,o=e.selection.getSelectedBlocks();return v.grep((t=e,n=o,r=v.map(n,function(e){var n=t.dom.getParent(e,"li,dd,dt",me(t,e));return n||e}),fe.unique(r)),function(e){return C(e)})},me=function(e,n){var t=e.dom.getParents(n,"TD,TH");return 0<t.length?t[0]:e.getBody()},ge=function(e,n){var t=e.dom.getParents(n,"ol,ul",me(e,n));return ie(t)},pe=function(n,e){var t=Y(e,function(e){return ge(n,e).getOr(e)});return fe.unique(t)},ve={isList:function(e){var n=le(e);return ce(n)},getParentList:le,getSelectedSubLists:function(e){var n,t,r,o=le(e),i=e.selection.getSelectedBlocks();return r=i,(t=o)&&1===r.length&&r[0]===t?(n=o,v.grep(n.querySelectorAll("ol,ul,dl"),function(e){return N(e)})):v.grep(i,function(e){return N(e)&&o!==e})},getSelectedListItems:de,getClosestListRootElm:me,getSelectedDlItems:function(e){return J(de(e),O)},getSelectedListRoots:function(e){var n,t,r,o=(t=ge(n=e,n.selection.getStart()),r=J(n.selection.getSelectedBlocks(),S),t.toArray().concat(r));return pe(e,o)}},he=function(e,n){var t=function(e,n){for(var t=0;t<e.length;t++){var r=e[t];if(r.test(n))return r}return undefined}(e,n);if(!t)return{major:0,minor:0};var r=function(e){return Number(n.replace(t,"$"+e))};return Ne(r(1),r(2))},ye=function(){return Ne(0,0)},Ne=function(e,n){return{major:e,minor:n}},Se={nu:Ne,detect:function(e,n){var t=String(n).toLowerCase();return 0===e.length?ye():he(e,t)},unknown:ye},Oe="Firefox",Ce=function(e,n){return function(){return n===e}},be=function(e){var n=e.current;return{current:n,version:e.version,isEdge:Ce("Edge",n),isChrome:Ce("Chrome",n),isIE:Ce("IE",n),isOpera:Ce("Opera",n),isFirefox:Ce(Oe,n),isSafari:Ce("Safari",n)}},Le={unknown:function(){return be({current:undefined,version:Se.unknown()})},nu:be,edge:_("Edge"),chrome:_("Chrome"),ie:_("IE"),opera:_("Opera"),firefox:_(Oe),safari:_("Safari")},Te="Windows",De="Android",Ee="Solaris",we="FreeBSD",ke=function(e,n){return function(){return n===e}},Ae=function(e){var n=e.current;return{current:n,version:e.version,isWindows:ke(Te,n),isiOS:ke("iOS",n),isAndroid:ke(De,n),isOSX:ke("OSX",n),isLinux:ke("Linux",n),isSolaris:ke(Ee,n),isFreeBSD:ke(we,n)}},xe={unknown:function(){return Ae({current:undefined,version:Se.unknown()})},nu:Ae,windows:_(Te),ios:_("iOS"),android:_(De),linux:_("Linux"),osx:_("OSX"),solaris:_(Ee),freebsd:_(we)},Re=function(e,n){var t=String(n).toLowerCase();return ee(e,function(e){return e.search(t)})},Ie=function(e,t){return Re(e,t).map(function(e){var n=Se.detect(e.versionRegexes,t);return{current:e.name,version:n}})},Be=function(e,t){return Re(e,t).map(function(e){var n=Se.detect(e.versionRegexes,t);return{current:e.name,version:n}})},_e=function(e,n){return-1!==e.indexOf(n)},Pe=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Me=function(n){return function(e){return _e(e,n)}},Ue=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return _e(e,"edge/")&&_e(e,"chrome")&&_e(e,"safari")&&_e(e,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Pe],search:function(e){return _e(e,"chrome")&&!_e(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return _e(e,"msie")||_e(e,"trident")}},{name:"Opera",versionRegexes:[Pe,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Me("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Me("firefox")},{name:"Safari",versionRegexes:[Pe,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(_e(e,"safari")||_e(e,"mobile/"))&&_e(e,"applewebkit")}}],Fe=[{name:"Windows",search:Me("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return _e(e,"iphone")||_e(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Me("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:Me("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Me("linux"),versionRegexes:[]},{name:"Solaris",search:Me("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Me("freebsd"),versionRegexes:[]}],je={browsers:_(Ue),oses:_(Fe)},He=function(e){var n,t,r,o,i,u,a,s,c,f,l,d=je.browsers(),m=je.oses(),g=Ie(d,e).fold(Le.unknown,Le.nu),p=Be(m,e).fold(xe.unknown,xe.nu);return{browser:g,os:p,deviceType:(t=g,r=e,o=(n=p).isiOS()&&!0===/ipad/i.test(r),i=n.isiOS()&&!o,u=n.isAndroid()&&3===n.version.major,a=n.isAndroid()&&4===n.version.major,s=o||u||a&&!0===/mobile/i.test(r),c=n.isiOS()||n.isAndroid(),f=c&&!s,l=t.isSafari()&&n.isiOS()&&!1===/safari/i.test(r),{isiPad:_(o),isiPhone:_(i),isTablet:_(s),isPhone:_(f),isTouch:_(c),isAndroid:n.isAndroid,isiOS:n.isiOS,isWebView:_(l)})}},$e={detect:(o=function(){var e=navigator.userAgent;return He(e)},u=!1,function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return u||(u=!0,i=o.apply(null,e)),i})},qe=function(e){if(null===e||e===undefined)throw new Error("Node cannot be null or undefined");return{dom:_(e)}},We={fromHtml:function(e,n){var t=(n||document).createElement("div");if(t.innerHTML=e,!t.hasChildNodes()||1<t.childNodes.length)throw console.error("HTML does not have a single root node",e),"HTML must have a single root node";return qe(t.childNodes[0])},fromTag:function(e,n){var t=(n||document).createElement(e);return qe(t)},fromText:function(e,n){var t=(n||document).createTextNode(e);return qe(t)},fromDom:qe,fromPoint:function(e,n,t){var r=e.dom();return W.from(r.elementFromPoint(n,t)).map(qe)}},ze=(Node.ATTRIBUTE_NODE,Node.CDATA_SECTION_NODE,Node.COMMENT_NODE,Node.DOCUMENT_NODE,Node.DOCUMENT_TYPE_NODE,Node.DOCUMENT_FRAGMENT_NODE,Node.ELEMENT_NODE),Ke=(Node.TEXT_NODE,Node.PROCESSING_INSTRUCTION_NODE,Node.ENTITY_REFERENCE_NODE,Node.ENTITY_NODE,Node.NOTATION_NODE,ze),Ve=($e.detect().browser.isIE(),function(e,n){var t=e.dom();if(t.nodeType!==Ke)return!1;if(t.matches!==undefined)return t.matches(n);if(t.msMatchesSelector!==undefined)return t.msMatchesSelector(n);if(t.webkitMatchesSelector!==undefined)return t.webkitMatchesSelector(n);if(t.mozMatchesSelector!==undefined)return t.mozMatchesSelector(n);throw new Error("Browser lacks native selectors")}),Xe=Object.keys,Qe=function(e){return e.dom().nodeName.toLowerCase()},Ye=function(e,n){var t=e.dom();!function(e,n){for(var t=Xe(e),r=0,o=t.length;r<o;r++){var i=t[r];n(e[i],i,e)}}(n,function(e,n){!function(e,n,t){if(!(K(t)||V(t)||Q(t)))throw console.error("Invalid call to Attr.set. Key ",n,":: Value ",t,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(n,t+"")}(t,n,e)})},Ge=function(e){return Z(e.dom().attributes,function(e,n){return e[n.name]=n.value,e},{})},Je=function(e){var n=e.dom();return W.from(n.parentNode).map(We.fromDom)},Ze=function(e){var n=e.dom();return Y(n.childNodes,We.fromDom)},en=function(e,n){var t=e.dom().childNodes;return W.from(t[n]).map(We.fromDom)},nn=function(e){return en(e,0)},tn=function(e){return en(e,e.dom().childNodes.length-1)},rn=(function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n]}("element","offset"),function(n,t){Je(n).each(function(e){e.dom().insertBefore(t.dom(),n.dom())})}),on=function(e,n){e.dom().appendChild(n.dom())},un=function(n,e){G(e,function(e){on(n,e)})},an=function(e){var n=e.dom();null!==n.parentNode&&n.parentNode.removeChild(n)},sn=function(e){return n=e,t=!0,We.fromDom(n.dom().cloneNode(t));var n,t},cn=function(e,n){var t,r,o,i,u=(t=e,r=n,o=We.fromTag(r),i=Ge(t),Ye(o,i),o);rn(e,u);var a=Ze(e);return un(u,a),an(e),u},fn=tinymce.util.Tools.resolve("tinymce.Env"),ln=g.DOM,dn=function(e,n,t){var r,o,i,u=ln.createFragment(),a=e.schema.getBlockElements();if(e.settings.forced_root_block&&(t=t||e.settings.forced_root_block),t&&((o=ln.create(t)).tagName===e.settings.forced_root_block&&ln.setAttribs(o,e.settings.forced_root_block_attrs),D(n.firstChild,a)||u.appendChild(o)),n)for(;r=n.firstChild;){var s=r.nodeName;i||"SPAN"===s&&"bookmark"===r.getAttribute("data-mce-type")||(i=!0),D(r,a)?(u.appendChild(r),o=null):t?(o||(o=ln.create(t),u.appendChild(o)),o.appendChild(r)):u.appendChild(r)}return e.settings.forced_root_block?i||fn.ie&&!(10<fn.ie)||o.appendChild(ln.create("br",{"data-mce-bogus":"1"})):u.appendChild(ln.create("br")),u},mn=g.DOM,gn=function(e,n,t,r){var o,i,u,a,s;for(u=mn.select('span[data-mce-type="bookmark"]',n),r=r||dn(e,t),(o=mn.createRng()).setStartAfter(t),o.setEndAfter(n),a=(i=o.extractContents()).firstChild;a;a=a.firstChild)if("LI"===a.nodeName&&e.dom.isEmpty(a)){mn.remove(a);break}e.dom.isEmpty(i)||mn.insertAfter(i,n),mn.insertAfter(r,n),w(e.dom,t.parentNode)&&(s=t.parentNode,v.each(u,function(e){s.parentNode.insertBefore(e,t.parentNode)}),mn.remove(s)),mn.remove(t),w(e.dom,n)&&mn.remove(n)},pn=function(e,n){for(var t=[],r=0;r<e.length;r++){var o=e[r];if(!o.isSome())return W.none();t.push(o.getOrDie())}return W.some(n.apply(null,t))},vn=function(e,n,t){if(!K(t))throw console.error("Invalid call to CSS.set. Property ",n,":: Value ",t,":: Element ",e),new Error("CSS value must be a string: "+t);e.style!==undefined&&e.style.setProperty(n,t)},hn=function(e,n){on(e.item,n.list)},yn=function(i,e,u){for(var a=[],n=function(e){var n,t,r,o=(n=i,t=u,r={list:We.fromTag(t,n),item:We.fromTag("li",n)},on(r.list,r.item),r);ie(a).each(function(e){return hn(e,o)}),a.push(o)},t=0;t<e;t++)n();return a},Nn=function(c,e,f){var n=e.slice(0,f.depth);return ie(n).each(function(e){var n,t,r,o,i,u,a,s;n=e,r=c,o=f.itemAttributes,i=f.content,u=We.fromTag("li",r),Ye(u,o),un(u,i),t=u,on(n.list,t),n.item=t,s=f,Qe((a=e).list).toUpperCase()!==s.listType&&(a.list=cn(a.list,s.listType)),Ye(a.list,s.listAttributes)}),n},Sn=function(e,n,t){var r=yn(e,t.depth-n.length,t.listType);return function(e,n){ie(e).each(function(e){Ye(e.list,n.listAttributes),Ye(e.item,n.itemAttributes),un(e.item,n.content)});for(var t=0;t<e.length-1;t++)r=e[t].item,o="list-style-type",i="none",u=r.dom(),vn(u,o,i);var r,o,i,u}(r,t),pn([ie(n),oe(r)],hn),n.concat(r)},On=function(e){return 0<e.depth},Cn=function(e){return e.isSelected},bn=Object.prototype.hasOwnProperty,Ln=(a=function(e,n){return n},function(){for(var e=new Array(arguments.length),n=0;n<e.length;n++)e[n]=arguments[n];if(0===e.length)throw new Error("Can't merge zero objects");for(var t={},r=0;r<e.length;r++){var o=e[r];for(var i in o)bn.call(o,i)&&(t[i]=a(t[i],o[i]))}return t}),Tn=function(e,r){var n=r.depth-1;e[n].each(function(e){return t=e,(n=r).listType=t.listType,void(n.listAttributes=Ln({},t.listAttributes));var n,t});var t=e.slice(0,n);return t.push(W.some(r)),t},Dn=function(e){Z(e,function(e,n){return n.depth>e.length?function(e,n){for(var t=e.slice(0),r=n.depth-e.length,o=1;o<r;o++)t.push(W.none());return t.push(W.some(n)),t}(e,n):Tn(e,n)},[])},En=function(e){var n=e,t=function(){return n};return{get:t,set:function(e){n=e},clone:function(){return En(t())}}};(s=l||(l={})).OL="OL",s.UL="UL",s.DL="DL";var wn=function(e){switch(Qe(e)){case"ol":return W.some(l.OL);case"ul":return W.some(l.UL);case"dl":return W.some(l.DL);default:return W.none()}},kn=function(e){return Ve(e,"OL,UL,DL")},An=function(e){return nn(e).map(kn).getOr(!1)},xn=function(e){var n=Ze(e),t=n.length+(tn(e).map(kn).getOr(!1)?-1:0);return Y(n.slice(0,t),sn)},Rn=function(u,e,a,s){var c=function(r){for(var o=[],e=1;e<arguments.length;e++)o[e-1]=arguments[e];return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var t=o.concat(e);return r.apply(null,t)}}(In,u,e,a),f=function(r){return e.each(function(e){var n,t;n="Start"===r?e.start:e.end,t=s,n.dom()===t.dom()&&a.set("Start"===r)})};return nn(s).filter(kn).fold(function(){f("Start");var e,n,t,r,o=(e=s,n=u,t=a.get(),r=Je(e),{depth:n,isSelected:t,content:xn(e),listType:r.bind(wn).getOr(l.OL),listAttributes:r.map(Ge).getOr({}),itemAttributes:Ge(e)});f("End");var i=tn(s).filter(kn).map(c).getOr([]);return[o].concat(i)},c)},In=function(e,n,t,r){var o=e+1;return te(Ze(r),function(e){return kn(e)?In(o,n,t,e):Rn(o,n,t,e)})},Bn=function(i,e){return Y(e,function(e){var n,t,r,o=(n=e.content,r=(t||document).createDocumentFragment(),G(n,function(e){r.appendChild(e.dom())}),We.fromDom(r));return We.fromDom(dn(i,o.dom()))})},_n=function(e,n){return Dn(n),(t=e.contentDocument,r=n,o=Z(r,function(e,n){return n.depth>e.length?Sn(t,e,n):Nn(t,e,n)},[]),oe(o).map(function(e){return e.list})).toArray();var t,r,o},Pn=function(e){var n,t,r=Y(ve.getSelectedListItems(e),We.fromDom);return pn([ee(r,P(An)),ee((n=r,t=re.call(n,0),t.reverse(),t),P(An))],function(e,n){return{start:e,end:n}})},Mn=function(a,e,s){var n,t,r,o=(n=e,t=Pn(a),r=En(!1),Y(n,function(e){return{entries:In(0,t,r,e),sourceList:e}}));G(o,function(e){var n,t,r,o,i,u;n=e.entries,t=s,G(J(n,Cn),function(e){return function(e,n){switch(e){case"Indent":n.depth++;break;case"Outdent":n.depth--;break;case"Flatten":n.depth=0}}(t,e)}),r=e.sourceList,i=a,u=e.entries,o=te(function(e,n){if(0===e.length)return[];for(var t=n(e[0]),r=[],o=[],i=0,u=e.length;i<u;i++){var a=e[i],s=n(a);s!==t&&(r.push(o),o=[]),t=s,o.push(a)}return 0!==o.length&&r.push(o),r}(u,On),function(e){return oe(e).map(On).getOr(!1)?_n(i,e):Bn(i,e)}),G(o,function(e){rn(r,e)}),an(e.sourceList)})},Un=function(e){Ve(e,"DT")&&cn(e,"DD")},Fn=function(r,e,n){G(n,"Indent"===e?Un:function(e){return n=r,void(Ve(t=e,"DD")?cn(t,"DT"):Ve(t,"DT")&&Je(t).each(function(e){return gn(n,e.dom(),t.dom())}));var n,t})},jn=function(e,n){var t=Y(ve.getSelectedDlItems(e),We.fromDom),r=Y(ve.getSelectedListRoots(e),We.fromDom);if(t.length||r.length){var o=e.selection.getBookmark();Fn(e,n,t),Mn(e,r,n),e.selection.moveToBookmark(o),e.selection.setRng(x(e.selection.getRng())),e.nodeChanged()}},Hn=function(e){jn(e,"Indent")},$n=function(e){jn(e,"Outdent")},qn=function(e){jn(e,"Flatten")},Wn=function(t,e){v.each(e,function(e,n){t.setAttribute(n,e)})},zn=function(e,n,t){var r,o,i,u,a,s,c;r=e,o=n,u=(i=t)["list-style-type"]?i["list-style-type"]:null,r.setStyle(o,"list-style-type",u),a=e,Wn(s=n,(c=t)["list-attributes"]),v.each(a.select("li",s),function(e){Wn(e,c["list-item-attributes"])})},Kn=function(e,n,t,r){var o,i;for(o=n[t?"startContainer":"endContainer"],i=n[t?"startOffset":"endOffset"],1===o.nodeType&&(o=o.childNodes[Math.min(i,o.childNodes.length-1)]||o),!t&&L(o.nextSibling)&&(o=o.nextSibling);o.parentNode!==r;){if(T(e,o))return o;if(/^(TD|TH)$/.test(o.parentNode.nodeName))return o;o=o.parentNode}return o},Vn=function(f,l,d){void 0===d&&(d={});var e,n=f.selection.getRng(!0),m="LI",t=ve.getClosestListRootElm(f,f.selection.getStart(!0)),g=f.dom;"false"!==g.getContentEditable(f.selection.getNode())&&("DL"===(l=l.toUpperCase())&&(m="DT"),e=I(n),v.each(function(t,e,r){for(var o,i=[],u=t.dom,n=Kn(t,e,!0,r),a=Kn(t,e,!1,r),s=[],c=n;c&&(s.push(c),c!==a);c=c.nextSibling);return v.each(s,function(e){if(T(t,e))return i.push(e),void(o=null);if(u.isBlock(e)||L(e))return L(e)&&u.remove(e),void(o=null);var n=e.nextSibling;p.isBookmarkNode(e)&&(T(t,n)||!n&&e.parentNode===r)?o=null:(o||(o=u.create("p"),e.parentNode.insertBefore(o,e),i.push(o)),o.appendChild(e))}),i}(f,n,t),function(e){var n,t,r,o,i,u,a,s,c;(t=e.previousSibling)&&N(t)&&t.nodeName===l&&(r=t,o=d,i=g.getStyle(r,"list-style-type"),u=o?o["list-style-type"]:"",i===(u=null===u?"":u))?(n=t,e=g.rename(e,m),t.appendChild(e)):(n=g.create(l),e.parentNode.insertBefore(n,e),n.appendChild(e),e=g.rename(e,m)),a=g,s=e,c=["margin","margin-right","margin-bottom","margin-left","margin-top","padding","padding-right","padding-bottom","padding-left","padding-top"],v.each(c,function(e){var n;return a.setStyle(s,((n={})[e]="",n))}),zn(g,n,d),Qn(f.dom,n)}),f.selection.setRng(B(e)))},Xn=function(e,n,t){return s=t,(a=n)&&s&&N(a)&&a.nodeName===s.nodeName&&(i=n,u=t,(o=e).getStyle(i,"list-style-type",!0)===o.getStyle(u,"list-style-type",!0))&&(r=t,n.className===r.className);var r,o,i,u,a,s},Qn=function(e,n){var t,r;if(t=n.nextSibling,Xn(e,n,t)){for(;r=t.firstChild;)n.appendChild(r);e.remove(t)}if(t=n.previousSibling,Xn(e,n,t)){for(;r=t.lastChild;)n.insertBefore(r,n.firstChild);e.remove(t)}},Yn=function(n,e,t,r,o){if(e.nodeName!==r||Gn(o)){var i=I(n.selection.getRng(!0));v.each([e].concat(t),function(e){!function(e,n,t,r){if(n.nodeName!==t){var o=e.rename(n,t);zn(e,o,r)}else zn(e,n,r)}(n.dom,e,r,o)}),n.selection.setRng(B(i))}else qn(n)},Gn=function(e){return"list-style-type"in e},Jn={toggleList:function(e,n,t){var r=ve.getParentList(e),o=ve.getSelectedSubLists(e);t=t||{},r&&0<o.length?Yn(e,r,o,n,t):function(e,n,t,r){if(n!==e.getBody())if(n)if(n.nodeName!==t||Gn(r)){var o=I(e.selection.getRng(!0));zn(e.dom,n,r),Qn(e.dom,e.dom.rename(n,t)),e.selection.setRng(B(o))}else qn(e);else Vn(e,t,r)}(e,r,n,t)},mergeWithAdjacentLists:Qn},Zn=g.DOM,et=function(e,n){var t,r=n.parentNode;"LI"===r.nodeName&&r.firstChild===n&&((t=r.previousSibling)&&"LI"===t.nodeName?(t.appendChild(n),w(e,r)&&Zn.remove(r)):Zn.setStyle(r,"listStyleType","none")),N(r)&&(t=r.previousSibling)&&"LI"===t.nodeName&&t.appendChild(n)},nt=function(n,e){v.each(v.grep(n.select("ol,ul",e)),function(e){et(n,e)})},tt=function(e,n,t,r){var o,i,u=n.startContainer,a=n.startOffset;if(3===u.nodeType&&(t?a<u.data.length:0<a))return u;for(o=e.schema.getNonEmptyElements(),1===u.nodeType&&(u=f.getNode(u,a)),i=new d(u,r),t&&E(e.dom,u)&&i.next();u=i[t?"next":"prev2"]();){if("LI"===u.nodeName&&!u.hasChildNodes())return u;if(o[u.nodeName])return u;if(3===u.nodeType&&0<u.data.length)return u}},rt=function(e,n){var t=n.childNodes;return 1===t.length&&!N(t[0])&&e.isBlock(t[0])},ot=function(e,n,t){var r,o,i,u;if(o=rt(e,t)?t.firstChild:t,rt(i=e,u=n)&&i.remove(u.firstChild,!0),!w(e,n,!0))for(;r=n.firstChild;)o.appendChild(r)},it=function(e,n,t){var r,o,i=n.parentNode;k(e,n)&&k(e,t)&&(N(t.lastChild)&&(o=t.lastChild),i===t.lastChild&&L(i.previousSibling)&&e.remove(i.previousSibling),(r=t.lastChild)&&L(r)&&n.hasChildNodes()&&e.remove(r),w(e,t,!0)&&e.$(t).empty(),ot(e,n,t),o&&t.appendChild(o),e.remove(n),w(e,i)&&i!==e.getRoot()&&e.remove(i))},ut=function(e,n,t,r){var o,i,u,a=e.dom;if(a.isEmpty(r))i=t,u=r,(o=e).dom.$(u).empty(),it(o.dom,i,u),o.selection.setCursorLocation(u);else{var s=I(n);it(a,t,r),e.selection.setRng(B(s))}},at=function(e,n){var t,r,o,i=e.dom,u=e.selection,a=u.getStart(),s=ve.getClosestListRootElm(e,a),c=i.getParent(u.getStart(),"LI",s);if(c){if((t=c.parentNode)===e.getBody()&&w(i,t))return!0;if(r=x(u.getRng(!0)),(o=i.getParent(tt(e,r,n,s),"LI",s))&&o!==c)return n?ut(e,r,o,c):function(e,n,t,r){var o=I(n);it(e.dom,t,r);var i=B(o);e.selection.setRng(i)}(e,r,c,o),!0;if(!o&&!n)return qn(e),!0}return!1},st=function(e,n){return at(e,n)||function(o,i){var u=o.dom,e=o.selection.getStart(),a=ve.getClosestListRootElm(o,e),s=u.getParent(e,u.isBlock,a);if(s&&u.isEmpty(s)){var n=x(o.selection.getRng(!0)),c=u.getParent(tt(o,n,i,a),"LI",a);if(c)return o.undoManager.transact(function(){var e,n,t,r;n=s,t=a,r=(e=u).getParent(n.parentNode,e.isBlock,t),e.remove(n),r&&e.isEmpty(r)&&e.remove(r),Jn.mergeWithAdjacentLists(u,c.parentNode),o.selection.select(c,!0),o.selection.collapse(i)}),!0}return!1}(e,n)},ct=function(e,n){return e.selection.isCollapsed()?st(e,n):(r=(t=e).selection.getStart(),o=ve.getClosestListRootElm(t,r),!!(t.dom.getParent(r,"LI,DT,DD",o)||0<ve.getSelectedListItems(t).length)&&(t.undoManager.transact(function(){t.execCommand("Delete"),nt(t.dom,t.getBody())}),!0));var t,r,o},ft=function(n){n.on("keydown",function(e){e.keyCode===m.BACKSPACE?ct(n,!1)&&e.preventDefault():e.keyCode===m.DELETE&&ct(n,!0)&&e.preventDefault()})},lt=ct,dt=function(n){return{backspaceDelete:function(e){lt(n,e)}}},mt=function(n,t){return function(){var e=n.dom.getParent(n.selection.getStart(),"UL,OL,DL");return e&&e.nodeName===t}},gt=function(t){t.on("BeforeExecCommand",function(e){var n=e.command.toLowerCase();"indent"===n?Hn(t):"outdent"===n&&$n(t)}),t.addCommand("InsertUnorderedList",function(e,n){Jn.toggleList(t,"UL",n)}),t.addCommand("InsertOrderedList",function(e,n){Jn.toggleList(t,"OL",n)}),t.addCommand("InsertDefinitionList",function(e,n){Jn.toggleList(t,"DL",n)}),t.addCommand("RemoveList",function(){qn(t)}),t.addQueryStateHandler("InsertUnorderedList",mt(t,"UL")),t.addQueryStateHandler("InsertOrderedList",mt(t,"OL")),t.addQueryStateHandler("InsertDefinitionList",mt(t,"DL"))},pt=function(e){return e.getParam("lists_indent_on_tab",!0)},vt=function(e){var n;pt(e)&&(n=e).on("keydown",function(e){e.keyCode!==m.TAB||m.metaKeyPressed(e)||ve.isList(n)&&(e.preventDefault(),n.undoManager.transact(function(){e.shiftKey?$n(n):Hn(n)}))}),ft(e)},ht=function(n,i){return function(e){var o=e.control;n.on("NodeChange",function(e){var n=function(e,n){for(var t=0;t<e.length;t++)if(n(e[t]))return t;return-1}(e.parents,b),t=-1!==n?e.parents.slice(0,n):e.parents,r=v.grep(t,N);o.active(0<r.length&&r[0].nodeName===i)})}},yt=function(e){var n,t,r;t="advlist",r=(n=e).settings.plugins?n.settings.plugins:"",-1===v.inArray(r.split(/[ ,]/),t)&&(e.addButton("numlist",{active:!1,title:"Numbered list",cmd:"InsertOrderedList",onPostRender:ht(e,"OL")}),e.addButton("bullist",{active:!1,title:"Bullet list",cmd:"InsertUnorderedList",onPostRender:ht(e,"UL")})),e.addButton("indent",{icon:"indent",title:"Increase indent",cmd:"Indent"})};c.add("lists",function(e){return vt(e),yt(e),gt(e),dt(e)})}();!function(){"use strict";var t=tinymce.util.Tools.resolve("tinymce.PluginManager"),n=tinymce.util.Tools.resolve("tinymce.util.VK"),e=function(t){return t.target_list},o=function(t){return t.rel_list},i=function(t){return t.link_class_list},p=function(t){return"boolean"==typeof t.link_assume_external_targets&&t.link_assume_external_targets},a=function(t){return"boolean"==typeof t.link_context_toolbar&&t.link_context_toolbar},r=function(t){return t.link_list},k=function(t){return"string"==typeof t.default_link_target},y=function(t){return t.default_link_target},b=e,_=function(t,e){t.settings.target_list=e},w=function(t){return!1!==e(t)},T=o,C=function(t){return o(t)!==undefined},M=i,O=function(t){return i(t)!==undefined},R=function(t){return!1!==t.link_title},N=function(t){return"boolean"==typeof t.allow_unsafe_link_target&&t.allow_unsafe_link_target},l=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),u=tinymce.util.Tools.resolve("tinymce.Env"),c=function(t){if(!u.ie||10<u.ie){var e=document.createElement("a");e.target="_blank",e.href=t,e.rel="noreferrer noopener";var n=document.createEvent("MouseEvents");n.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),r=e,a=n,document.body.appendChild(r),r.dispatchEvent(a),document.body.removeChild(r)}else{var o=window.open("","_blank");if(o){o.opener=null;var i=o.document;i.open(),i.write('<meta http-equiv="refresh" content="0; url='+l.DOM.encode(t)+'">'),i.close()}}var r,a},A=tinymce.util.Tools.resolve("tinymce.util.Tools"),s=function(t,e){var n,o,i=["noopener"],r=t?t.split(/\s+/):[],a=function(t){return t.filter(function(t){return-1===A.inArray(i,t)})};return(r=e?(n=a(n=r)).length?n.concat(i):i:a(r)).length?(o=r,A.trim(o.sort().join(" "))):null},f=function(t,e){return e=e||t.selection.getNode(),m(e)?t.dom.select("a[href]",e)[0]:t.dom.getParent(e,"a[href]")},d=function(t){return t&&"A"===t.nodeName&&t.href},m=function(t){return t&&"FIGURE"===t.nodeName&&/\bimage\b/i.test(t.className)},v=function(t,e){var n,o;(o=t.dom.select("img",e)[0])&&(n=t.dom.getParents(o,"a[href]",e)[0])&&(n.parentNode.insertBefore(o,n),t.dom.remove(n))},g=function(t,e,n){var o,i;(i=t.dom.select("img",e)[0])&&(o=t.dom.create("a",n),i.parentNode.insertBefore(o,i),o.appendChild(i))},L=function(i,r){return function(o){i.undoManager.transact(function(){var t=i.selection.getNode(),e=f(i,t),n={href:o.href,target:o.target?o.target:null,rel:o.rel?o.rel:null,"class":o["class"]?o["class"]:null,title:o.title?o.title:null};C(i.settings)||!1!==N(i.settings)||(n.rel=s(n.rel,"_blank"===n.target)),o.href===r.href&&(r.attach(),r={}),e?(i.focus(),o.hasOwnProperty("text")&&("innerText"in e?e.innerText=o.text:e.textContent=o.text),i.dom.setAttribs(e,n),i.selection.select(e),i.undoManager.add()):m(t)?g(i,t,n):o.hasOwnProperty("text")?i.insertContent(i.dom.createHTML("a",n,i.dom.encode(o.text))):i.execCommand("mceInsertLink",!1,n)})}},P=function(e){return function(){e.undoManager.transact(function(){var t=e.selection.getNode();m(t)?v(e,t):e.execCommand("unlink")})}},h=d,x=function(t){return 0<A.grep(t,d).length},E=function(t){return!(/</.test(t)&&(!/^<a [^>]+>[^<]+<\/a>$/.test(t)||-1===t.indexOf("href=")))},S=f,I=function(t,e){var n=e?e.innerText||e.textContent:t.getContent({format:"text"});return n.replace(/\uFEFF/g,"")},K=s,U=tinymce.util.Tools.resolve("tinymce.util.Delay"),D=tinymce.util.Tools.resolve("tinymce.util.XHR"),B={},F=function(t,o,e){var i=function(t,n){return n=n||[],A.each(t,function(t){var e={text:t.text||t.title};t.menu?e.menu=i(t.menu):(e.value=t.value,o&&o(e)),n.push(e)}),n};return i(t,e||[])},q=function(e,t,n){var o=e.selection.getRng();U.setEditorTimeout(e,function(){e.windowManager.confirm(t,function(t){e.selection.setRng(o),n(t)})})},V=function(a,t){var e,l,o,u,n,i,r,c,s,f,d,m={},v=a.selection,g=a.dom,h=function(t){var e=o.find("#text");(!e.value()||t.lastControl&&e.value()===t.lastControl.text())&&e.value(t.control.text()),o.find("#href").value(t.control.value())},x=function(){l||!u||m.text||this.parent().parent().find("#text")[0].value(this.value())};u=E(v.getContent()),e=S(a),m.text=l=I(a.selection,e),m.href=e?g.getAttrib(e,"href"):"",e?m.target=g.getAttrib(e,"target"):k(a.settings)&&(m.target=y(a.settings)),(d=g.getAttrib(e,"rel"))&&(m.rel=d),(d=g.getAttrib(e,"class"))&&(m["class"]=d),(d=g.getAttrib(e,"title"))&&(m.title=d),u&&(n={name:"text",type:"textbox",size:40,label:"Text to display",onchange:function(){m.text=this.value()}}),t&&(i={type:"listbox",label:"Link list",values:F(t,function(t){t.value=a.convertURL(t.value||t.url,"href")},[{text:"None",value:""}]),onselect:h,value:a.convertURL(m.href,"href"),onPostRender:function(){i=this}}),w(a.settings)&&(b(a.settings)===undefined&&_(a,[{text:"None",value:""},{text:"New window",value:"_blank"}]),c={name:"target",type:"listbox",label:"Target",values:F(b(a.settings))}),C(a.settings)&&(r={name:"rel",type:"listbox",label:"Rel",values:F(T(a.settings),function(t){!1===N(a.settings)&&(t.value=K(t.value,"_blank"===m.target))})}),O(a.settings)&&(s={name:"class",type:"listbox",label:"Class",values:F(M(a.settings),function(t){t.value&&(t.textStyle=function(){return a.formatter.getCssText({inline:"a",classes:[t.value]})})})}),R(a.settings)&&(f={name:"title",type:"textbox",label:"Title",value:m.title}),o=a.windowManager.open({title:"Insert link",data:m,body:[{name:"href",type:"filepicker",filetype:"file",size:40,autofocus:!0,label:"Url",onchange:function(t){var e=t.meta||{};i&&i.value(a.convertURL(this.value(),"href")),A.each(t.meta,function(t,e){var n=o.find("#"+e);"text"===e?0===l.length&&(n.value(t),m.text=t):n.value(t)}),e.attach&&(B={href:this.value(),attach:e.attach}),e.text||x.call(this)},onkeyup:x,onpaste:x,onbeforecall:function(t){t.meta=o.toJSON()}},n,f,function(n){var o=[];if(A.each(a.dom.select("a:not([href])"),function(t){var e=t.name||t.id;e&&o.push({text:e,value:"#"+e,selected:-1!==n.indexOf("#"+e)})}),o.length)return o.unshift({text:"None",value:""}),{name:"anchor",type:"listbox",label:"Anchors",values:o,onselect:h}}(m.href),i,r,c,s],onSubmit:function(t){var e=p(a.settings),n=L(a,B),o=P(a),i=A.extend({},m,t.data),r=i.href;r?(u&&i.text!==l||delete i.text,0<r.indexOf("@")&&-1===r.indexOf("//")&&-1===r.indexOf("mailto:")?q(a,"The URL you entered seems to be an email address. Do you want to add the required mailto: prefix?",function(t){t&&(i.href="mailto:"+r),n(i)}):!0===e&&!/^\w+:/i.test(r)||!1===e&&/^\s*www[\.|\d\.]/i.test(r)?q(a,"The URL you entered seems to be an external link. Do you want to add the required http:// prefix?",function(t){t&&(i.href="http://"+r),n(i)}):n(i)):o()}})},z=function(t){var e,n,o;n=V,"string"==typeof(o=r((e=t).settings))?D.send({url:o,success:function(t){n(e,JSON.parse(t))}}):"function"==typeof o?o(function(t){n(e,t)}):n(e,o)},H=function(t,e){return t.dom.getParent(e,"a[href]")},J=function(t){return H(t,t.selection.getStart())},$=function(t,e){if(e){var n=(i=e).getAttribute("data-mce-href")||i.getAttribute("href");if(/^#/.test(n)){var o=t.$(n);o.length&&t.selection.scrollIntoView(o[0],!0)}else c(e.href)}var i},j=function(t){return function(){z(t)}},G=function(t){return function(){$(t,J(t))}},X=function(r){return function(t){var e,n,o,i;return!!(a(r.settings)&&(!(i=r.plugins.contextmenu)||!i.isContextMenuVisible())&&h(t)&&3===(o=(n=(e=r.selection).getRng()).startContainer).nodeType&&e.isCollapsed()&&0<n.startOffset&&n.startOffset<o.data.length)}},Q=function(o){o.on("click",function(t){var e=H(o,t.target);e&&n.metaKeyPressed(t)&&(t.preventDefault(),$(o,e))}),o.on("keydown",function(t){var e,n=J(o);n&&13===t.keyCode&&!0===(e=t).altKey&&!1===e.shiftKey&&!1===e.ctrlKey&&!1===e.metaKey&&(t.preventDefault(),$(o,n))})},W=function(n){return function(){var e=this;n.on("nodechange",function(t){e.active(!n.readonly&&!!S(n,t.element))})}},Y=function(n){return function(){var e=this,t=function(t){x(t.parents)?e.show():e.hide()};x(n.dom.getParents(n.selection.getStart()))||e.hide(),n.on("nodechange",t),e.on("remove",function(){n.off("nodechange",t)})}},Z=function(t){t.addCommand("mceLink",j(t))},tt=function(t){t.addShortcut("Meta+K","",j(t))},et=function(t){t.addButton("link",{active:!1,icon:"link",tooltip:"Insert/edit link",onclick:j(t),onpostrender:W(t)}),t.addButton("unlink",{active:!1,icon:"unlink",tooltip:"Remove link",onclick:P(t),onpostrender:W(t)}),t.addContextToolbar&&t.addButton("openlink",{icon:"newtab",tooltip:"Open link",onclick:G(t)})},nt=function(t){t.addMenuItem("openlink",{text:"Open link",icon:"newtab",onclick:G(t),onPostRender:Y(t),prependToContext:!0}),t.addMenuItem("link",{icon:"link",text:"Link",shortcut:"Meta+K",onclick:j(t),stateSelector:"a[href]",context:"insert",prependToContext:!0}),t.addMenuItem("unlink",{icon:"unlink",text:"Remove link",onclick:P(t),stateSelector:"a[href]"})},ot=function(t){t.addContextToolbar&&t.addContextToolbar(X(t),"openlink | link unlink")};t.add("link",function(t){et(t),nt(t),ot(t),Q(t),Z(t),tt(t)})}();!function(){"use strict";var r=function(e){var t=e,n=function(){return t};return{get:n,set:function(e){t=e},clone:function(){return r(n())}}},e=tinymce.util.Tools.resolve("tinymce.PluginManager"),n=function(e){return e.getParam("insertdatetime_timeformat",e.translate("%H:%M:%S"))},a=function(e){return e.getParam("insertdatetime_formats",["%H:%M:%S","%Y-%m-%d","%I:%M:%S %p","%D"])},t=function(e){return e.getParam("insertdatetime_dateformat",e.translate("%Y-%m-%d"))},i=n,o=a,u=function(e){var t=a(e);return 0<t.length?t[0]:n(e)},m=function(e){return e.getParam("insertdatetime_element",!1)},c="Sun Mon Tue Wed Thu Fri Sat Sun".split(" "),l="Sunday Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" "),s="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),d="January February March April May June July August September October November December".split(" "),p=function(e,t){if((e=""+e).length<t)for(var n=0;n<t-e.length;n++)e="0"+e;return e},f=function(e,t,n){return n=n||new Date,t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace("%D","%m/%d/%Y")).replace("%r","%I:%M:%S %p")).replace("%Y",""+n.getFullYear())).replace("%y",""+n.getYear())).replace("%m",p(n.getMonth()+1,2))).replace("%d",p(n.getDate(),2))).replace("%H",""+p(n.getHours(),2))).replace("%M",""+p(n.getMinutes(),2))).replace("%S",""+p(n.getSeconds(),2))).replace("%I",""+((n.getHours()+11)%12+1))).replace("%p",n.getHours()<12?"AM":"PM")).replace("%B",""+e.translate(d[n.getMonth()]))).replace("%b",""+e.translate(s[n.getMonth()]))).replace("%A",""+e.translate(l[n.getDay()]))).replace("%a",""+e.translate(c[n.getDay()]))).replace("%%","%")},g=function(e,t){if(m(e)){var n=f(e,t),r=void 0;r=/%[HMSIp]/.test(t)?f(e,"%Y-%m-%dT%H:%M"):f(e,"%Y-%m-%d");var a=e.dom.getParent(e.selection.getStart(),"time");a?(o=a,u=r,c=n,l=(i=e).dom.create("time",{datetime:u},c),o.parentNode.insertBefore(l,o),i.dom.remove(o),i.selection.select(l,!0),i.selection.collapse(!1)):e.insertContent('<time datetime="'+r+'">'+n+"</time>")}else e.insertContent(f(e,t));var i,o,u,c,l},y=f,M=function(e){e.addCommand("mceInsertDate",function(){g(e,t(e))}),e.addCommand("mceInsertTime",function(){g(e,i(e))})},v=tinymce.util.Tools.resolve("tinymce.util.Tools"),S=function(t,n){var r,a,e,i=(a=n,e=o(r=t),v.map(e,function(e){return{text:y(r,e),onclick:function(){a.set(e),g(r,e)}}}));t.addButton("insertdatetime",{type:"splitbutton",title:"Insert date/time",menu:i,onclick:function(){var e=n.get();g(t,e||u(t))}}),t.addMenuItem("insertdatetime",{icon:"date",text:"Date/time",menu:i,context:"insert"})};e.add("insertdatetime",function(e){var t=r(null);M(e),S(e,t)})}();!function(){"use strict";var r=function(t){var e=t,n=function(){return e};return{get:n,set:function(t){e=t},clone:function(){return r(n())}}},t=tinymce.util.Tools.resolve("tinymce.PluginManager"),$=tinymce.util.Tools.resolve("tinymce.util.Tools");function n(t,e){return i(document.createElement("canvas"),t,e)}function o(t){return t.getContext("2d")}function i(t,e,n){return t.width=e,t.height=n,t}var h={create:n,clone:function(t){var e;return o(e=n(t.width,t.height)).drawImage(t,0,0),e},resize:i,get2dContext:o,get3dContext:function(t){var e=null;try{e=t.getContext("webgl")||t.getContext("experimental-webgl")}catch(n){}return e||(e=null),e}},p={getWidth:function(t){return t.naturalWidth||t.width},getHeight:function(t){return t.naturalHeight||t.height}},g=window.Promise?window.Promise:function(){var t=function(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],l(t,r(o,this),r(a,this))},e=t.immediateFn||"function"==typeof window.setImmediate&&window.setImmediate||function(t){setTimeout(t,1)};function r(t,e){return function(){t.apply(e,arguments)}}var n=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function i(r){var o=this;null!==this._state?e(function(){var t=o._state?r.onFulfilled:r.onRejected;if(null!==t){var e;try{e=t(o._value)}catch(n){return void r.reject(n)}r.resolve(e)}else(o._state?r.resolve:r.reject)(o._value)}):this._deferreds.push(r)}function o(t){try{if(t===this)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var e=t.then;if("function"==typeof e)return void l(r(e,t),r(o,this),r(a,this))}this._state=!0,this._value=t,u.call(this)}catch(n){a.call(this,n)}}function a(t){this._state=!1,this._value=t,u.call(this)}function u(){for(var t=0,e=this._deferreds.length;t<e;t++)i.call(this,this._deferreds[t]);this._deferreds=null}function c(t,e,n,r){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.resolve=n,this.reject=r}function l(t,e,n){var r=!1;try{t(function(t){r||(r=!0,e(t))},function(t){r||(r=!0,n(t))})}catch(o){if(r)return;r=!0,n(o)}}return t.prototype["catch"]=function(t){return this.then(null,t)},t.prototype.then=function(n,r){var o=this;return new t(function(t,e){i.call(o,new c(n,r,t,e))})},t.all=function(){var c=Array.prototype.slice.call(1===arguments.length&&n(arguments[0])?arguments[0]:arguments);return new t(function(o,i){if(0===c.length)return o([]);var a=c.length;function u(e,t){try{if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if("function"==typeof n)return void n.call(t,function(t){u(e,t)},i)}c[e]=t,0==--a&&o(c)}catch(r){i(r)}}for(var t=0;t<c.length;t++)u(t,c[t])})},t.resolve=function(e){return e&&"object"==typeof e&&e.constructor===t?e:new t(function(t){t(e)})},t.reject=function(n){return new t(function(t,e){e(n)})},t.race=function(o){return new t(function(t,e){for(var n=0,r=o.length;n<r;n++)o[n].then(t,e)})},t}(),a=function(t){return function(){return t}};function u(r){for(var o=[],t=1;t<arguments.length;t++)o[t-1]=arguments[t];return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=o.concat(t);return r.apply(null,n)}}var c,l,s,f,d=a(!1),m=a(!0),y=d,v=m,b=function(){return w},w=(f={fold:function(t,e){return t()},is:y,isSome:y,isNone:v,getOr:s=function(t){return t},getOrThunk:l=function(t){return t()},getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:function(){return null},getOrUndefined:function(){return undefined},or:s,orThunk:l,map:b,ap:b,each:function(){},bind:b,flatten:b,exists:y,forall:v,filter:b,equals:c=function(t){return t.isNone()},equals_:c,toArray:function(){return[]},toString:a("none()")},Object.freeze&&Object.freeze(f),f),x=function(n){var t=function(){return n},e=function(){return o},r=function(t){return t(n)},o={fold:function(t,e){return e(n)},is:function(t){return n===t},isSome:v,isNone:y,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:e,orThunk:e,map:function(t){return x(t(n))},ap:function(t){return t.fold(b,function(t){return x(t(n))})},each:function(t){t(n)},bind:r,flatten:t,exists:r,forall:r,filter:function(t){return t(n)?o:w},equals:function(t){return t.is(n)},equals_:function(t,e){return t.fold(y,function(t){return e(n,t)})},toArray:function(){return[n]},toString:function(){return"some("+n+")"}};return o},I={some:x,none:b,from:function(t){return null===t||t===undefined?w:x(t)}},T="undefined"!=typeof window?window:Function("return this;")(),R=function(t,e){return function(t,e){for(var n=e!==undefined&&null!==e?e:T,r=0;r<t.length&&n!==undefined&&null!==n;++r)n=n[t[r]];return n}(t.split("."),e)},S={getOrDie:function(t,e){var n=R(t,e);if(n===undefined||null===n)throw t+" not available on this browser";return n}};function O(){return new(S.getOrDie("FileReader"))}var F={atob:function(t){return S.getOrDie("atob")(t)},requestAnimationFrame:function(t){S.getOrDie("requestAnimationFrame")(t)}};function C(u){return new g(function(t,e){var n=URL.createObjectURL(u),r=new Image,o=function(){r.removeEventListener("load",i),r.removeEventListener("error",a)};function i(){o(),t(r)}function a(){o(),e("Unable to load data of type "+u.type+": "+n)}r.addEventListener("load",i),r.addEventListener("error",a),r.src=n,r.complete&&i()})}function E(r){return new g(function(t,n){var e=new XMLHttpRequest;e.open("GET",r,!0),e.responseType="blob",e.onload=function(){200==this.status&&t(this.response)},e.onerror=function(){var t,e=this;n(0===this.status?((t=new Error("No access to download image")).code=18,t.name="SecurityError",t):new Error("Error "+e.status+" downloading image"))},e.send()})}function D(t){var e=t.split(","),n=/data:([^;]+)/.exec(e[0]);if(!n)return I.none();for(var r,o,i,a=n[1],u=e[1],c=F.atob(u),l=c.length,s=Math.ceil(l/1024),f=new Array(s),d=0;d<s;++d){for(var h=1024*d,p=Math.min(h+1024,l),g=new Array(p-h),m=h,y=0;m<p;++y,++m)g[y]=c[m].charCodeAt(0);f[d]=(r=g,new(S.getOrDie("Uint8Array"))(r))}return I.some((o=f,i={type:a},new(S.getOrDie("Blob"))(o,i)))}function A(n){return new g(function(t,e){D(n).fold(function(){e("uri is not base64: "+n)},t)})}function _(n){return new g(function(t){var e=O();e.onloadend=function(){t(e.result)},e.readAsDataURL(n)})}var k={blobToImage:C,imageToBlob:function(t){var e=t.src;return 0===e.indexOf("data:")?A(e):E(e)},blobToArrayBuffer:function(n){return new g(function(t){var e=O();e.onloadend=function(){t(e.result)},e.readAsArrayBuffer(n)})},blobToDataUri:_,blobToBase64:function(t){return _(t).then(function(t){return t.split(",")[1]})},dataUriToBlobSync:D,canvasToBlob:function(t,n,r){return n=n||"image/png",HTMLCanvasElement.prototype.toBlob?new g(function(e){t.toBlob(function(t){e(t)},n,r)}):A(t.toDataURL(n,r))},canvasToDataURL:function(t,e,n){return e=e||"image/png",t.then(function(t){return t.toDataURL(e,n)})},blobToCanvas:function(t){return C(t).then(function(t){var e,n;return e=t,URL.revokeObjectURL(e.src),n=h.create(p.getWidth(t),p.getHeight(t)),h.get2dContext(n).drawImage(t,0,0),n})},uriToBlob:function(t){return 0===t.indexOf("blob:")?E(t):0===t.indexOf("data:")?A(t):null}},L=function(t){return k.blobToImage(t)},P=function(t){return k.imageToBlob(t)};function B(t,e,n){var r=e.type;function o(e,n){return t.then(function(t){return k.canvasToDataURL(t,e,n)})}return{getType:a(r),toBlob:function(){return g.resolve(e)},toDataURL:function(){return n},toBase64:function(){return n.split(",")[1]},toAdjustedBlob:function(e,n){return t.then(function(t){return k.canvasToBlob(t,e,n)})},toAdjustedDataURL:o,toAdjustedBase64:function(t,e){return o(t,e).then(function(t){return t.split(",")[1]})},toCanvas:function(){return t.then(h.clone)}}}function H(e){return k.blobToDataUri(e).then(function(t){return B(k.blobToCanvas(e),e,t)})}var M={fromBlob:H,fromCanvas:function(e,t){return k.canvasToBlob(e,t).then(function(t){return B(g.resolve(e),t,e.toDataURL())})},fromImage:function(t){return k.imageToBlob(t).then(function(t){return H(t)})},fromBlobAndUrlSync:function(t,e){return B(k.blobToCanvas(t),t,e)}};function N(t,e,n){return n<(t=parseFloat(t))?t=n:t<e&&(t=e),t}var U=[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10];function j(t,e){var n,r,o,i,a=[],u=new Array(10);for(n=0;n<5;n++){for(r=0;r<5;r++)a[r]=e[r+5*n];for(r=0;r<5;r++){for(o=i=0;o<5;o++)i+=t[r+5*o]*a[o];u[r+5*n]=i}}return u}function G(t,n){return n=N(n,0,1),t.map(function(t,e){return e%6==0?t=1-(1-t)*n:t*=n,N(t,0,1)})}var z={identity:function(){return[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1]},adjust:G,multiply:j,adjustContrast:function(t,e){var n;return e=N(e,-1,1),j(t,[(n=(e*=100)<0?127+e/100*127:127*(n=0==(n=e%1)?U[e]:U[Math.floor(e)]*(1-n)+U[Math.floor(e)+1]*n)+127)/127,0,0,0,.5*(127-n),0,n/127,0,0,.5*(127-n),0,0,n/127,0,.5*(127-n),0,0,0,1,0,0,0,0,0,1])},adjustBrightness:function(t,e){return j(t,[1,0,0,0,e=N(255*e,-255,255),0,1,0,0,e,0,0,1,0,e,0,0,0,1,0,0,0,0,0,1])},adjustSaturation:function(t,e){var n;return j(t,[.3086*(1-(n=1+(0<(e=N(e,-1,1))?3*e:e)))+n,.6094*(1-n),.082*(1-n),0,0,.3086*(1-n),.6094*(1-n)+n,.082*(1-n),0,0,.3086*(1-n),.6094*(1-n),.082*(1-n)+n,0,0,0,0,0,1,0,0,0,0,0,1])},adjustHue:function(t,e){var n,r,o,i,a;return e=N(e,-180,180)/180*Math.PI,j(t,[(o=.213)+.787*(n=Math.cos(e))+(r=Math.sin(e))*-o,(i=.715)+n*-i+r*-i,(a=.072)+n*-a+.928*r,0,0,o+n*-o+.143*r,i+n*(1-i)+.14*r,a+n*-a+-.283*r,0,0,o+n*-o+-.787*r,i+n*-i+r*i,a+.928*n+r*a,0,0,0,0,0,1,0,0,0,0,0,1])},adjustColors:function(t,e,n,r){return j(t,[e=N(e,0,2),0,0,0,0,0,n=N(n,0,2),0,0,0,0,0,r=N(r,0,2),0,0,0,0,0,1,0,0,0,0,0,1])},adjustSepia:function(t,e){return j(t,G([.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0,0,0,0,0,1],e=N(e,0,1)))},adjustGrayscale:function(t,e){return j(t,G([.33,.34,.33,0,0,.33,.34,.33,0,0,.33,.34,.33,0,0,0,0,0,1,0,0,0,0,0,1],e=N(e,0,1)))}};function V(a,u){return a.toCanvas().then(function(t){return e=t,n=a.getType(),r=u,i=h.get2dContext(e),o=function(t,e){var n,r,o,i,a,u=t.data,c=e[0],l=e[1],s=e[2],f=e[3],d=e[4],h=e[5],p=e[6],g=e[7],m=e[8],y=e[9],v=e[10],b=e[11],w=e[12],x=e[13],I=e[14],T=e[15],R=e[16],S=e[17],O=e[18],F=e[19];for(a=0;a<u.length;a+=4)n=u[a],r=u[a+1],o=u[a+2],i=u[a+3],u[a]=n*c+r*l+o*s+i*f+d,u[a+1]=n*h+r*p+o*g+i*m+y,u[a+2]=n*v+r*b+o*w+i*x+I,u[a+3]=n*T+r*R+o*S+i*O+F;return t}(i.getImageData(0,0,e.width,e.height),r),i.putImageData(o,0,0),M.fromCanvas(e,n);var e,n,r,o,i})}function W(u,c){return u.toCanvas().then(function(t){return e=t,n=u.getType(),r=c,a=h.get2dContext(e),o=a.getImageData(0,0,e.width,e.height),i=a.getImageData(0,0,e.width,e.height),i=function(t,e,n){var r,o,i,a,u,c,l,s,f,d,h,p,g,m,y,v,b;function w(t,e,n){return n<t?t=n:t<e&&(t=e),t}for(i=Math.round(Math.sqrt(n.length)),a=Math.floor(i/2),r=t.data,o=e.data,v=t.width,b=t.height,c=0;c<b;c++)for(u=0;u<v;u++){for(l=s=f=0,h=0;h<i;h++)for(d=0;d<i;d++)p=w(u+d-a,0,v-1),g=w(c+h-a,0,b-1),m=4*(g*v+p),y=n[h*i+d],l+=r[m]*y,s+=r[m+1]*y,f+=r[m+2]*y;o[m=4*(c*v+u)]=w(l,0,255),o[m+1]=w(s,0,255),o[m+2]=w(f,0,255)}return e}(o,i,r),a.putImageData(i,0,0),M.fromCanvas(e,n);var e,n,r,o,i,a})}function q(u){return function(e,n){return e.toCanvas().then(function(t){return function(t,e,n){var r,o,i=h.get2dContext(t),a=new Array(256);for(o=0;o<a.length;o++)a[o]=u(o,n);return r=function(t,e){var n,r=t.data;for(n=0;n<r.length;n+=4)r[n]=e[r[n]],r[n+1]=e[r[n+1]],r[n+2]=e[r[n+2]];return t}(i.getImageData(0,0,t.width,t.height),a),i.putImageData(r,0,0),M.fromCanvas(t,e)}(t,e.getType(),n)})}}function Y(n){return function(t,e){return V(t,n(z.identity(),e))}}function X(e){return function(t){return W(t,e)}}var J,K={invert:(J=[-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0],function(t){return V(t,J)}),brightness:Y(z.adjustBrightness),hue:Y(z.adjustHue),saturate:Y(z.adjustSaturation),contrast:Y(z.adjustContrast),grayscale:Y(z.adjustGrayscale),sepia:Y(z.adjustSepia),colorize:function(t,e,n,r){return V(t,z.adjustColors(z.identity(),e,n,r))},sharpen:X([0,-1,0,-1,5,-1,0,-1,0]),emboss:X([-2,-1,0,-1,1,1,0,1,2]),gamma:q(function(t,e){return 255*Math.pow(t/255,1-e)}),exposure:q(function(t,e){return 255*(1-Math.exp(-t/255*e))}),colorFilter:V,convoluteFilter:W},Z={scale:function e(t,n,r){var o=p.getWidth(t),i=p.getHeight(t),a=n/o,u=r/i,c=!1;(a<.5||2<a)&&(a=a<.5?.5:2,c=!0),(u<.5||2<u)&&(u=u<.5?.5:2,c=!0);var l,s,f,d=(l=t,s=a,f=u,new g(function(t){var e=p.getWidth(l),n=p.getHeight(l),r=Math.floor(e*s),o=Math.floor(n*f),i=h.create(r,o),a=h.get2dContext(i);a.drawImage(l,0,0,e,n,0,0,r,o),t(i)}));return c?d.then(function(t){return e(t,n,r)}):d}},Q={rotate:function(c,l){return c.toCanvas().then(function(t){return e=t,n=c.getType(),r=l,o=h.create(e.width,e.height),i=h.get2dContext(o),90!=(r=r<(u=a=0)?360+r:r)&&270!=r||h.resize(o,o.height,o.width),90!=r&&180!=r||(a=o.width),270!=r&&180!=r||(u=o.height),i.translate(a,u),i.rotate(r*Math.PI/180),i.drawImage(e,0,0),M.fromCanvas(o,n);var e,n,r,o,i,a,u})},flip:function(a,u){return a.toCanvas().then(function(t){return e=t,n=a.getType(),r=u,o=h.create(e.width,e.height),i=h.get2dContext(o),"v"==r?(i.scale(1,-1),i.drawImage(e,0,-o.height)):(i.scale(-1,1),i.drawImage(e,-o.width,0)),M.fromCanvas(o,n);var e,n,r,o,i})},crop:function(c,l,s,f,d){return c.toCanvas().then(function(t){return e=t,n=c.getType(),r=l,o=s,i=f,a=d,u=h.create(i,a),h.get2dContext(u).drawImage(e,-r,-o),M.fromCanvas(u,n);var e,n,r,o,i,a,u})},resize:function(e,n,r){return e.toCanvas().then(function(t){return Z.scale(t,n,r).then(function(t){return M.fromCanvas(t,e.getType())})})}},tt=function(){function t(t){this.littleEndian=!1,this._dv=new DataView(t)}return t.prototype.readByteAt=function(t){return this._dv.getUint8(t)},t.prototype.read=function(t,e){if(t+e>this.length())return null;for(var n=this.littleEndian?0:-8*(e-1),r=0,o=0;r<e;r++)o|=this.readByteAt(t+r)<<Math.abs(n+8*r);return o},t.prototype.BYTE=function(t){return this.read(t,1)},t.prototype.SHORT=function(t){return this.read(t,2)},t.prototype.LONG=function(t){return this.read(t,4)},t.prototype.SLONG=function(t){var e=this.read(t,4);return 2147483647<e?e-4294967296:e},t.prototype.CHAR=function(t){return String.fromCharCode(this.read(t,1))},t.prototype.STRING=function(t,e){return this.asArray("CHAR",t,e).join("")},t.prototype.SEGMENT=function(t,e){var n=this._dv.buffer;switch(arguments.length){case 2:return n.slice(t,t+e);case 1:return n.slice(t);default:return n}},t.prototype.asArray=function(t,e,n){for(var r=[],o=0;o<n;o++)r[o]=this[t](e+o);return r},t.prototype.length=function(){return this._dv?this._dv.byteLength:0},t}(),et={274:"Orientation",270:"ImageDescription",271:"Make",272:"Model",305:"Software",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer"},nt={36864:"ExifVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",36867:"DateTimeOriginal",33434:"ExposureTime",33437:"FNumber",34855:"ISOSpeedRatings",37377:"ShutterSpeedValue",37378:"ApertureValue",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",41988:"DigitalZoomRatio",41992:"Contrast",41993:"Saturation",41994:"Sharpness"},rt={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude"},ot={513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength"},it={ColorSpace:{1:"sRGB",0:"Uncalibrated"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{1:"Daylight",2:"Fliorescent",3:"Tungsten",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 -5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},ExposureMode:{0:"Auto exposure",1:"Manual exposure",2:"Auto bracket"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},GPSLatitudeRef:{N:"North latitude",S:"South latitude"},GPSLongitudeRef:{E:"East longitude",W:"West longitude"}},at=function(){function t(t){this._offsets={tiffHeader:10,IFD0:null,IFD1:null,exifIFD:null,gpsIFD:null},this._tiffTags={};var e=this;if(e._reader=new tt(t),e._idx=e._offsets.tiffHeader,65505!==e.SHORT(0)||"EXIF\0"!==e.STRING(4,5).toUpperCase())throw new Error("Exif data cannot be read or not available.");if(e._reader.littleEndian=18761==e.SHORT(e._idx),42!==e.SHORT(e._idx+=2))throw new Error("Invalid Exif data.");e._offsets.IFD0=e._offsets.tiffHeader+e.LONG(e._idx+=2),e._tiffTags=e.extractTags(e._offsets.IFD0,et),"ExifIFDPointer"in e._tiffTags&&(e._offsets.exifIFD=e._offsets.tiffHeader+e._tiffTags.ExifIFDPointer,delete e._tiffTags.ExifIFDPointer),"GPSInfoIFDPointer"in e._tiffTags&&(e._offsets.gpsIFD=e._offsets.tiffHeader+e._tiffTags.GPSInfoIFDPointer,delete e._tiffTags.GPSInfoIFDPointer);var n=e.LONG(e._offsets.IFD0+12*e.SHORT(e._offsets.IFD0)+2);n&&(e._offsets.IFD1=e._offsets.tiffHeader+n)}return t.prototype.BYTE=function(t){return this._reader.BYTE(t)},t.prototype.SHORT=function(t){return this._reader.SHORT(t)},t.prototype.LONG=function(t){return this._reader.LONG(t)},t.prototype.SLONG=function(t){return this._reader.SLONG(t)},t.prototype.CHAR=function(t){return this._reader.CHAR(t)},t.prototype.STRING=function(t,e){return this._reader.STRING(t,e)},t.prototype.SEGMENT=function(t,e){return this._reader.SEGMENT(t,e)},t.prototype.asArray=function(t,e,n){for(var r=[],o=0;o<n;o++)r[o]=this[t](e+o);return r},t.prototype.length=function(){return this._reader.length()},t.prototype.UNDEFINED=function(){return this.BYTE.apply(this,arguments)},t.prototype.RATIONAL=function(t){return this.LONG(t)/this.LONG(t+4)},t.prototype.SRATIONAL=function(t){return this.SLONG(t)/this.SLONG(t+4)},t.prototype.ASCII=function(t){return this.CHAR(t)},t.prototype.TIFF=function(){return this._tiffTags},t.prototype.EXIF=function(){var t=null;if(this._offsets.exifIFD){try{t=this.extractTags(this._offsets.exifIFD,nt)}catch(r){return null}if(t.ExifVersion&&Array.isArray(t.ExifVersion)){for(var e=0,n="";e<t.ExifVersion.length;e++)n+=String.fromCharCode(t.ExifVersion[e]);t.ExifVersion=n}}return t},t.prototype.GPS=function(){var t=null;if(this._offsets.gpsIFD){try{t=this.extractTags(this._offsets.gpsIFD,rt)}catch(e){return null}t.GPSVersionID&&Array.isArray(t.GPSVersionID)&&(t.GPSVersionID=t.GPSVersionID.join("."))}return t},t.prototype.thumb=function(){var t=this;if(t._offsets.IFD1)try{var e=t.extractTags(t._offsets.IFD1,ot);if("JPEGInterchangeFormat"in e)return t.SEGMENT(t._offsets.tiffHeader+e.JPEGInterchangeFormat,e.JPEGInterchangeFormatLength)}catch(n){}return null},t.prototype.extractTags=function(t,e){var n,r,o,i,a,u,c,l,s=this,f=[],d={},h={1:"BYTE",7:"UNDEFINED",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",9:"SLONG",10:"SRATIONAL"},p={BYTE:1,UNDEFINED:1,ASCII:1,SHORT:2,LONG:4,RATIONAL:8,SLONG:4,SRATIONAL:8};for(n=s.SHORT(t),r=0;r<n;r++)if(f=[],c=t+2+12*r,(o=e[s.SHORT(c)])!==undefined){if(i=h[s.SHORT(c+=2)],a=s.LONG(c+=2),!(u=p[i]))throw new Error("Invalid Exif data.");if(c+=4,4<u*a&&(c=s.LONG(c)+s._offsets.tiffHeader),c+u*a>=s.length())throw new Error("Invalid Exif data.");"ASCII"!==i?(f=s.asArray(i,c,a),l=1==a?f[0]:f,it.hasOwnProperty(o)&&"object"!=typeof l?d[o]=it[o][l]:d[o]=l):d[o]=s.STRING(c,a).replace(/\0$/,"").trim()}return d},t}(),ut=function(t){var e,n,r=[],o=0;for(e=2;e<=t.length();)if(65488<=(n=t.SHORT(e))&&n<=65495)e+=2;else{if(65498===n||65497===n)break;o=t.SHORT(e+2)+2,65505<=n&&n<=65519&&r.push({hex:n,name:"APP"+(15&n),start:e,length:o,segment:t.SEGMENT(e,o)}),e+=o}return r},ct=function(u){return k.blobToArrayBuffer(u).then(function(t){try{var e=new tt(t);if(65496===e.SHORT(0)){var n=ut(e),r=n.filter(function(t){return"APP1"===t.name}),o={};if(!r.length)return g.reject("Headers did not include required information");var i=new at(r[0].segment);return(o={tiff:i.TIFF(),exif:i.EXIF(),gps:i.GPS(),thumb:i.thumb()}).rawHeaders=n,o}return g.reject("Image was not a jpeg")}catch(a){return g.reject("Unsupported format or not an image: "+u.type+" (Exception: "+a.message+")")}})},lt=function(t,e){return Q.rotate(t,e)},st={invert:function(t){return K.invert(t)},sharpen:function(t){return K.sharpen(t)},emboss:function(t){return K.emboss(t)},brightness:function(t,e){return K.brightness(t,e)},hue:function(t,e){return K.hue(t,e)},saturate:function(t,e){return K.saturate(t,e)},contrast:function(t,e){return K.contrast(t,e)},grayscale:function(t,e){return K.grayscale(t,e)},sepia:function(t,e){return K.sepia(t,e)},colorize:function(t,e,n,r){return K.colorize(t,e,n,r)},gamma:function(t,e){return K.gamma(t,e)},exposure:function(t,e){return K.exposure(t,e)},flip:function(t,e){return Q.flip(t,e)},crop:function(t,e,n,r,o){return Q.crop(t,e,n,r,o)},resize:function(t,e,n){return Q.resize(t,e,n)},rotate:lt,exifRotate:function(e){return e.toBlob().then(ct).then(function(t){switch(t.tiff.Orientation){case 6:return lt(e,90);case 3:return lt(e,180);case 8:return lt(e,270);default:return e}},function(){return e})}},ft=function(t){return t.toBlob()},dt={blobToImageResult:function(t){return M.fromBlob(t)},fromBlobAndUrlSync:function(t,e){return M.fromBlobAndUrlSync(t,e)},imageToImageResult:function(t){return M.fromImage(t)},imageResultToBlob:function(t,e,n){return e===undefined&&n===undefined?ft(t):t.toAdjustedBlob(e,n)},imageResultToOriginalBlob:ft,imageResultToDataURL:function(t){return t.toDataURL()}},ht=function(){return S.getOrDie("URL")},pt={createObjectURL:function(t){return ht().createObjectURL(t)},revokeObjectURL:function(t){ht().revokeObjectURL(t)}},gt=tinymce.util.Tools.resolve("tinymce.util.Delay"),mt=tinymce.util.Tools.resolve("tinymce.util.Promise"),yt=tinymce.util.Tools.resolve("tinymce.util.URI"),vt=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),bt=tinymce.util.Tools.resolve("tinymce.ui.Factory"),wt=tinymce.util.Tools.resolve("tinymce.geom.Rect"),xt=function(n){return new mt(function(t){var e=function(){n.removeEventListener("load",e),t(n)};n.complete?t(n):n.addEventListener("load",e)})},It=tinymce.util.Tools.resolve("tinymce.dom.DomQuery"),Tt=tinymce.util.Tools.resolve("tinymce.util.Observable"),Rt=tinymce.util.Tools.resolve("tinymce.util.VK"),St=0,Ot={create:function(t){return new(bt.get("Control").extend({Defaults:{classes:"imagepanel"},selection:function(t){return arguments.length?(this.state.set("rect",t),this):this.state.get("rect")},imageSize:function(){var t=this.state.get("viewRect");return{w:t.w,h:t.h}},toggleCropRect:function(t){this.state.set("cropEnabled",t)},imageSrc:function(t){var o=this,i=new Image;i.src=t,xt(i).then(function(){var t,e,n=o.state.get("viewRect");if((e=o.$el.find("img"))[0])e.replaceWith(i);else{var r=document.createElement("div");r.className="mce-imagepanel-bg",o.getEl().appendChild(r),o.getEl().appendChild(i)}t={x:0,y:0,w:i.naturalWidth,h:i.naturalHeight},o.state.set("viewRect",t),o.state.set("rect",wt.inflate(t,-20,-20)),n&&n.w===t.w&&n.h===t.h||o.zoomFit(),o.repaintImage(),o.fire("load")})},zoom:function(t){return arguments.length?(this.state.set("zoom",t),this):this.state.get("zoom")},postRender:function(){return this.imageSrc(this.settings.imageSrc),this._super()},zoomFit:function(){var t,e,n,r,o,i;t=this.$el.find("img"),e=this.getEl().clientWidth,n=this.getEl().clientHeight,r=t[0].naturalWidth,o=t[0].naturalHeight,1<=(i=Math.min((e-10)/r,(n-10)/o))&&(i=1),this.zoom(i)},repaintImage:function(){var t,e,n,r,o,i,a,u,c,l,s;s=this.getEl(),c=this.zoom(),l=this.state.get("rect"),a=this.$el.find("img"),u=this.$el.find(".mce-imagepanel-bg"),o=s.offsetWidth,i=s.offsetHeight,n=a[0].naturalWidth*c,r=a[0].naturalHeight*c,t=Math.max(0,o/2-n/2),e=Math.max(0,i/2-r/2),a.css({left:t,top:e,width:n,height:r}),u.css({left:t,top:e,width:n,height:r}),this.cropRect&&(this.cropRect.setRect({x:l.x*c+t,y:l.y*c+e,w:l.w*c,h:l.h*c}),this.cropRect.setClampRect({x:t,y:e,w:n,h:r}),this.cropRect.setViewPortRect({x:0,y:0,w:o,h:i}))},bindStates:function(){var r=this;function n(t){r.cropRect=function(l,n,s,r,o){var f,a,t,i,e="mce-",u=e+"crid-"+St++;function d(t,e){return{x:e.x-t.x,y:e.y-t.y,w:e.w,h:e.h}}function c(t,e,n,r){var o,i,a,u,c;o=e.x,i=e.y,a=e.w,u=e.h,o+=n*t.deltaX,i+=r*t.deltaY,(a+=n*t.deltaW)<20&&(a=20),(u+=r*t.deltaH)<20&&(u=20),c=l=wt.clamp({x:o,y:i,w:a,h:u},s,"move"===t.name),c=d(s,c),f.fire("updateRect",{rect:c}),g(c)}function h(e){function t(t,e){e.h<0&&(e.h=0),e.w<0&&(e.w=0),It("#"+u+"-"+t,r).css({left:e.x,top:e.y,width:e.w,height:e.h})}$.each(a,function(t){It("#"+u+"-"+t.name,r).css({left:e.w*t.xMul+e.x,top:e.h*t.yMul+e.y})}),t("top",{x:n.x,y:n.y,w:n.w,h:e.y-n.y}),t("right",{x:e.x+e.w,y:e.y,w:n.w-e.x-e.w+n.x,h:e.h}),t("bottom",{x:n.x,y:e.y+e.h,w:n.w,h:n.h-e.y-e.h+n.y}),t("left",{x:n.x,y:e.y,w:e.x-n.x,h:e.h}),t("move",e)}function p(t){h(l=t)}function g(t){var e,n;p((e=s,{x:(n=t).x+e.x,y:n.y+e.y,w:n.w,h:n.h}))}return a=[{name:"move",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:0,deltaH:0,label:"Crop Mask"},{name:"nw",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:-1,deltaH:-1,label:"Top Left Crop Handle"},{name:"ne",xMul:1,yMul:0,deltaX:0,deltaY:1,deltaW:1,deltaH:-1,label:"Top Right Crop Handle"},{name:"sw",xMul:0,yMul:1,deltaX:1,deltaY:0,deltaW:-1,deltaH:1,label:"Bottom Left Crop Handle"},{name:"se",xMul:1,yMul:1,deltaX:0,deltaY:0,deltaW:1,deltaH:1,label:"Bottom Right Crop Handle"}],i=["top","right","bottom","left"],It('<div id="'+u+'" class="'+e+'croprect-container" role="grid" aria-dropeffect="execute">').appendTo(r),$.each(i,function(t){It("#"+u,r).append('<div id="'+u+"-"+t+'"class="'+e+'croprect-block" style="display: none" data-mce-bogus="all">')}),$.each(a,function(t){It("#"+u,r).append('<div id="'+u+"-"+t.name+'" class="'+e+"croprect-handle "+e+"croprect-handle-"+t.name+'"style="display: none" data-mce-bogus="all" role="gridcell" tabindex="-1" aria-label="'+t.label+'" aria-grabbed="false">')}),t=$.map(a,function(e){var n;return new(bt.get("DragHelper"))(u,{document:r.ownerDocument,handle:u+"-"+e.name,start:function(){n=l},drag:function(t){c(e,n,t.deltaX,t.deltaY)}})}),h(l),It(r).on("focusin focusout",function(t){It(t.target).attr("aria-grabbed","focus"===t.type)}),It(r).on("keydown",function(e){var i;function t(t,e,n,r,o){t.stopPropagation(),t.preventDefault(),c(i,n,r,o)}switch($.each(a,function(t){if(e.target.id===u+"-"+t.name)return i=t,!1}),e.keyCode){case Rt.LEFT:t(e,0,l,-10,0);break;case Rt.RIGHT:t(e,0,l,10,0);break;case Rt.UP:t(e,0,l,0,-10);break;case Rt.DOWN:t(e,0,l,0,10);break;case Rt.ENTER:case Rt.SPACEBAR:e.preventDefault(),o()}}),f=$.extend({toggleVisibility:function(t){var e;e=$.map(a,function(t){return"#"+u+"-"+t.name}).concat($.map(i,function(t){return"#"+u+"-"+t})).join(","),t?It(e,r).show():It(e,r).hide()},setClampRect:function(t){s=t,h(l)},setRect:p,getInnerRect:function(){return d(s,l)},setInnerRect:g,setViewPortRect:function(t){n=t,h(l)},destroy:function(){$.each(t,function(t){t.destroy()}),t=[]}},Tt)}(t,r.state.get("viewRect"),r.state.get("viewRect"),r.getEl(),function(){r.fire("crop")}),r.cropRect.on("updateRect",function(t){var e=t.rect,n=r.zoom();e={x:Math.round(e.x/n),y:Math.round(e.y/n),w:Math.round(e.w/n),h:Math.round(e.h/n)},r.state.set("rect",e)}),r.on("remove",r.cropRect.destroy)}r.state.on("change:cropEnabled",function(t){r.cropRect.toggleVisibility(t.value),r.repaintImage()}),r.state.on("change:zoom",function(){r.repaintImage()}),r.state.on("change:rect",function(t){var e=t.value;r.cropRect||n(e),r.cropRect.setRect(e)})}}))(t)}};function Ft(t){return{blob:t,url:pt.createObjectURL(t)}}function Ct(t){t&&pt.revokeObjectURL(t.url)}function Et(t){$.each(t,Ct)}function Dt(i,a,t,e){var u,n,r,c,o,l,s,f,d,h,p,g,m,y,v,b,w,x,I,T,R,S,O,F,C,E,D,A=function(){var n=[],r=-1;function t(){return 0<r}function e(){return-1!==r&&r<n.length-1}return{data:n,add:function(t){var e;return e=n.splice(++r),n.push(t),{state:t,removed:e}},undo:function(){if(t())return n[--r]},redo:function(){if(e())return n[++r]},canUndo:t,canRedo:e}}(),_=function(t){return i.rtl?t.reverse():t};function k(t){var e,n,r,o;e=u.find("#w")[0],n=u.find("#h")[0],r=parseInt(e.value(),10),o=parseInt(n.value(),10),u.find("#constrain")[0].checked()&&F&&C&&r&&o&&("w"===t.control.settings.name?(o=Math.round(r*E),n.value(o)):(r=Math.round(o*D),e.value(r))),F=r,C=o}function L(t){return Math.round(100*t)+"%"}function P(){u.find("#undo").disabled(!A.canUndo()),u.find("#redo").disabled(!A.canRedo()),u.statusbar.find("#save").disabled(!A.canUndo())}function B(){u.find("#undo").disabled(!0),u.find("#redo").disabled(!0)}function H(t){t&&f.imageSrc(t.url)}function M(e){return function(){var t=$.grep(O,function(t){return t.settings.name!==e});$.each(t,function(t){t.hide()}),e.show(),e.focus()}}function N(t){H(c=Ft(t))}function U(t){H(a=Ft(t)),Et(A.add(a).removed),P()}function j(){var e=f.selection();dt.blobToImageResult(a.blob).then(function(t){st.crop(t,e.x,e.y,e.w,e.h).then(q).then(function(t){U(t),z()})})}var G=function(e){var n=[].slice.call(arguments,1);return function(){var t=c||a;dt.blobToImageResult(t.blob).then(function(t){e.apply(this,[t].concat(n)).then(q).then(N)})}};function z(){H(a),Ct(c),M(n)(),P()}function V(){c?(U(c.blob),z()):function t(e,n){c?n():setTimeout(function(){0<e--?t(e,n):i.windowManager.alert("Error: failed to apply image operation.")},10)}(100,V)}function W(t){return bt.create("Form",{layout:"flex",direction:"row",labelGap:5,border:"0 0 1 0",align:"center",pack:"center",padding:"0 10 0 10",spacing:5,flex:0,minHeight:60,defaults:{classes:"imagetool",type:"button"},items:t})}var q=function(t){return t.toBlob()};function Y(t,e){return W(_([{text:"Back",onclick:z},{type:"spacer",flex:1},{text:"Apply",subtype:"primary",onclick:V}])).hide().on("show",function(){B(),dt.blobToImageResult(a.blob).then(function(t){return e(t)}).then(q).then(function(t){var e=Ft(t);H(e),Ct(c),c=e})})}function X(t,n,e,r,o){return W(_([{text:"Back",onclick:z},{type:"spacer",flex:1},{type:"slider",flex:1,ondragend:function(t){var e;e=t.value,dt.blobToImageResult(a.blob).then(function(t){return n(t,e)}).then(q).then(function(t){var e=Ft(t);H(e),Ct(c),c=e})},minValue:i.rtl?o:r,maxValue:i.rtl?r:o,value:e,previewFilter:L},{type:"spacer",flex:1},{text:"Apply",subtype:"primary",onclick:V}])).hide().on("show",function(){this.find("slider").value(e),B()})}o=W(_([{text:"Back",onclick:z},{type:"spacer",flex:1},{text:"Apply",subtype:"primary",onclick:j}])).hide().on("show hide",function(t){f.toggleCropRect("show"===t.type)}).on("show",B),l=W(_([{text:"Back",onclick:z},{type:"spacer",flex:1},{type:"textbox",name:"w",label:"Width",size:4,onkeyup:k},{type:"textbox",name:"h",label:"Height",size:4,onkeyup:k},{type:"checkbox",name:"constrain",text:"Constrain proportions",checked:!0,onchange:function(t){!0===t.control.value()&&(E=C/F,D=F/C)}},{type:"spacer",flex:1},{text:"Apply",subtype:"primary",onclick:"submit"}])).hide().on("submit",function(t){var e=parseInt(u.find("#w").value(),10),n=parseInt(u.find("#h").value(),10);t.preventDefault(),function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=[].slice.call(arguments,1);return function(){dt.blobToImageResult(a.blob).then(function(t){e.apply(this,[t].concat(r)).then(q).then(U)})}}(st.resize,e,n)(),z()}).on("show",B),s=W(_([{text:"Back",onclick:z},{type:"spacer",flex:1},{icon:"fliph",tooltip:"Flip horizontally",onclick:G(st.flip,"h")},{icon:"flipv",tooltip:"Flip vertically",onclick:G(st.flip,"v")},{icon:"rotateleft",tooltip:"Rotate counterclockwise",onclick:G(st.rotate,-90)},{icon:"rotateright",tooltip:"Rotate clockwise",onclick:G(st.rotate,90)},{type:"spacer",flex:1},{text:"Apply",subtype:"primary",onclick:V}])).hide().on("show",B),p=Y(0,st.invert),I=Y(0,st.sharpen),T=Y(0,st.emboss),g=X(0,st.brightness,0,-1,1),m=X(0,st.hue,180,0,360),y=X(0,st.saturate,0,-1,1),v=X(0,st.contrast,0,-1,1),b=X(0,st.grayscale,0,0,1),w=X(0,st.sepia,0,0,1),x=function(t,o){function e(){var e,n,r;e=u.find("#r")[0].value(),n=u.find("#g")[0].value(),r=u.find("#b")[0].value(),dt.blobToImageResult(a.blob).then(function(t){return o(t,e,n,r)}).then(q).then(function(t){var e=Ft(t);H(e),Ct(c),c=e})}var n=i.rtl?2:0,r=i.rtl?0:2;return W(_([{text:"Back",onclick:z},{type:"spacer",flex:1},{type:"slider",label:"R",name:"r",minValue:n,value:1,maxValue:r,ondragend:e,previewFilter:L},{type:"slider",label:"G",name:"g",minValue:n,value:1,maxValue:r,ondragend:e,previewFilter:L},{type:"slider",label:"B",name:"b",minValue:n,value:1,maxValue:r,ondragend:e,previewFilter:L},{type:"spacer",flex:1},{text:"Apply",subtype:"primary",onclick:V}])).hide().on("show",function(){u.find("#r,#g,#b").value(1),B()})}(0,st.colorize),R=X(0,st.gamma,0,-1,1),S=X(0,st.exposure,1,0,2),r=W(_([{text:"Back",onclick:z},{type:"spacer",flex:1},{text:"hue",icon:"hue",onclick:M(m)},{text:"saturate",icon:"saturate",onclick:M(y)},{text:"sepia",icon:"sepia",onclick:M(w)},{text:"emboss",icon:"emboss",onclick:M(T)},{text:"exposure",icon:"exposure",onclick:M(S)},{type:"spacer",flex:1}])).hide(),n=W(_([{tooltip:"Crop",icon:"crop",onclick:M(o)},{tooltip:"Resize",icon:"resize2",onclick:M(l)},{tooltip:"Orientation",icon:"orientation",onclick:M(s)},{tooltip:"Brightness",icon:"sun",onclick:M(g)},{tooltip:"Sharpen",icon:"sharpen",onclick:M(I)},{tooltip:"Contrast",icon:"contrast",onclick:M(v)},{tooltip:"Color levels",icon:"drop",onclick:M(x)},{tooltip:"Gamma",icon:"gamma",onclick:M(R)},{tooltip:"Invert",icon:"invert",onclick:M(p)}])),f=Ot.create({flex:1,imageSrc:a.url}),d=bt.create("Container",{layout:"flex",direction:"column",pack:"start",border:"0 1 0 0",padding:5,spacing:5,items:[{type:"button",icon:"undo",tooltip:"Undo",name:"undo",onclick:function(){H(a=A.undo()),P()}},{type:"button",icon:"redo",tooltip:"Redo",name:"redo",onclick:function(){H(a=A.redo()),P()}},{type:"button",icon:"zoomin",tooltip:"Zoom in",onclick:function(){var t=f.zoom();t<2&&(t+=.1),f.zoom(t)}},{type:"button",icon:"zoomout",tooltip:"Zoom out",onclick:function(){var t=f.zoom();.1<t&&(t-=.1),f.zoom(t)}}]}),h=bt.create("Container",{type:"container",layout:"flex",direction:"row",align:"stretch",flex:1,items:_([d,f])}),O=[n,o,l,s,r,p,g,m,y,v,b,w,x,I,T,R,S],(u=i.windowManager.open({layout:"flex",direction:"column",align:"stretch",minWidth:Math.min(vt.DOM.getViewPort().w,800),minHeight:Math.min(vt.DOM.getViewPort().h,650),title:"Edit image",items:O.concat([h]),buttons:_([{text:"Save",name:"save",subtype:"primary",onclick:function(){t(a.blob),u.close()}},{text:"Cancel",onclick:"close"}])})).on("close",function(){e(),Et(A.data),c=A=null}),A.add(a),P(),f.on("load",function(){F=f.imageSize().w,C=f.imageSize().h,E=C/F,D=F/C,u.find("#w").value(F),u.find("#h").value(C)}),f.on("crop",j)}var At,_t={edit:function(r,t){return new mt(function(e,n){return t.toBlob().then(function(t){Dt(r,Ft(t),e,n)})})}},kt={getImageSize:function(t){var e,n;function r(t){return/^[0-9\.]+px$/.test(t)}return e=t.style.width,n=t.style.height,e||n?r(e)&&r(n)?{w:parseInt(e,10),h:parseInt(n,10)}:null:(e=t.width,n=t.height,e&&n?{w:parseInt(e,10),h:parseInt(n,10)}:null)},setImageSize:function(t,e){var n,r;e&&(n=t.style.width,r=t.style.height,(n||r)&&(t.style.width=e.w+"px",t.style.height=e.h+"px",t.removeAttribute("data-mce-style")),n=t.width,r=t.height,(n||r)&&(t.setAttribute("width",e.w),t.setAttribute("height",e.h)))},getNaturalImageSize:function(t){return{w:t.naturalWidth,h:t.naturalHeight}}},Lt=(At="function",function(t){return function(t){if(null===t)return"null";var e=typeof t;return"object"===e&&Array.prototype.isPrototypeOf(t)?"array":"object"===e&&String.prototype.isPrototypeOf(t)?"string":e}(t)===At}),Pt=function(t,e){for(var n=0,r=t.length;n<r;n++){var o=t[n];if(e(o,n,t))return I.some(o)}return I.none()};Array.prototype.slice;Lt(Array.from)&&Array.from;var Bt=function(t){return null!==t&&t!==undefined},Ht=function(t,e){var n;return n=e.reduce(function(t,e){return Bt(t)?t[e]:undefined},t),Bt(n)?n:null},Mt=function(e){return new mt(function(n){var t=O();t.onload=function(t){var e=t.target;n(e.result)},t.readAsText(e)})},Nt=function(e,r,o){return new mt(function(t){var n;(n=new(S.getOrDie("XMLHttpRequest"))).onreadystatechange=function(){4===n.readyState&&t({status:n.status,blob:this.response})},n.open("GET",e,!0),n.withCredentials=o,$.each(r,function(t,e){n.setRequestHeader(e,t)}),n.responseType="blob",n.send()})},Ut=function(t){var e;try{e=JSON.parse(t)}catch(n){}return e},jt=[{code:404,message:"Could not find Image Proxy"},{code:403,message:"Rejected request"},{code:0,message:"Incorrect Image Proxy URL"}],Gt=[{type:"key_missing",message:"The request did not include an api key."},{type:"key_not_found",message:"The provided api key could not be found."},{type:"domain_not_trusted",message:"The api key is not valid for the request origins."}],zt=function(e){return"ImageProxy HTTP error: "+Pt(jt,function(t){return e===t.code}).fold(a("Unknown ImageProxy error"),function(t){return t.message})},Vt=function(t){var e=zt(t);return mt.reject(e)},Wt=function(e){return Pt(Gt,function(t){return t.type===e}).fold(a("Unknown service error"),function(t){return t.message})},qt=function(t,e){return Mt(e).then(function(t){var e,n,r=(e=Ut(t),"ImageProxy Service error: "+((n=Ht(e,["error","type"]))?Wt(n):"Invalid JSON in service error message"));return mt.reject(r)})},Yt=function(t,e){return 400===(n=t)||403===n||500===n?qt(0,e):Vt(t);var n},Xt=Vt,$t=function(t,e){var n,r,o,i={"Content-Type":"application/json;charset=UTF-8","tiny-api-key":e};return Nt((n=t,r=e,o=-1===n.indexOf("?")?"?":"&",/[?&]apiKey=/.test(n)||!r?n:n+o+"apiKey="+encodeURIComponent(r)),i,!1).then(function(t){return t.status<200||300<=t.status?Yt(t.status,t.blob):mt.resolve(t.blob)})},Jt=function(t,e,n){return e?$t(t,e):Nt(t,{},n).then(function(t){return t.status<200||300<=t.status?Xt(t.status):mt.resolve(t.blob)})},Kt=0,Zt=function(t,e){t.notificationManager.open({text:e,type:"error"})},Qt=function(t){return t.selection.getNode()},te=function(t,e){var n=e.src;return 0===n.indexOf("data:")||0===n.indexOf("blob:")||new yt(n).host===t.documentBaseURI.host},ee=function(t,e){return-1!==$.inArray(t.getParam("imagetools_cors_hosts",[],"string[]"),new yt(e.src).host)},ne=function(t,e){var n,r,o,i,a=e.src;return ee(t,e)?Jt(e.src,null,(r=t,o=e,-1!==$.inArray(r.getParam("imagetools_credentials_hosts",[],"string[]"),new yt(o.src).host))):te(t,e)?P(e):(a=t.getParam("imagetools_proxy"),a+=(-1===a.indexOf("?")?"?":"&")+"url="+encodeURIComponent(e.src),n=(i=t).getParam("api_key",i.getParam("imagetools_api_key","","string"),"string"),Jt(a,n,!1))},re=function(t){var e;return(e=t.editorUpload.blobCache.getByUri(Qt(t).src))?mt.resolve(e.blob()):ne(t,Qt(t))},oe=function(t){clearTimeout(t.get())},ie=function(c,l,s,f,d){return l.toBlob().then(function(t){var e,n,r,o,i,a,u;return r=c.editorUpload.blobCache,e=(i=Qt(c)).src,c.getParam("images_reuse_filename",!1,"boolean")&&((o=r.getByUri(e))?(e=o.uri(),n=o.name()):(a=c,n=(u=e.match(/\/([^\/\?]+)?\.(?:jpeg|jpg|png|gif)(?:\?|$)/i))?a.dom.encode(u[1]):null)),o=r.create({id:"imagetools"+Kt++,blob:t,base64:l.toBase64(),uri:e,name:n}),r.add(o),c.undoManager.transact(function(){c.$(i).on("load",function t(){var e,n,r;c.$(i).off("load",t),c.nodeChanged(),s?c.editorUpload.uploadImagesAuto():(oe(f),e=c,n=f,r=gt.setEditorTimeout(e,function(){e.editorUpload.uploadImagesAuto()},e.getParam("images_upload_timeout",3e4,"number")),n.set(r))}),d&&c.$(i).attr({width:d.w,height:d.h}),c.$(i).attr({src:o.blobUri()}).removeAttr("data-mce-src")}),o})},ae=function(e,n,t,r){return function(){return e._scanForImages().then(u(re,e)).then(dt.blobToImageResult).then(t).then(function(t){return ie(e,t,!1,n,r)},function(t){Zt(e,t)})}},ue=function(n,r,o){return function(){var t=kt.getImageSize(Qt(n)),e=t?{w:t.h,h:t.w}:null;return ae(n,r,function(t){return st.rotate(t,o)},e)()}},ce=function(t,e,n){return function(){return ae(t,e,function(t){return st.flip(t,n)})()}},le=function(e,r){return function(){var o=Qt(e),i=kt.getNaturalImageSize(o),n=function(r){return new mt(function(n){L(r).then(function(t){var e=kt.getNaturalImageSize(t);i.w===e.w&&i.h===e.h||kt.getImageSize(o)&&kt.setImageSize(o,e),pt.revokeObjectURL(t.src),n(r)})})};re(e).then(dt.blobToImageResult).then(u(function(e,t){return _t.edit(e,t).then(n).then(dt.blobToImageResult).then(function(t){return ie(e,t,!0,r)},function(){})},e),function(t){Zt(e,t)})}},se=function(t,e){return t.dom.is(e,"img:not([data-mce-object],[data-mce-placeholder])")&&(te(t,e)||ee(t,e)||t.settings.imagetools_proxy)},fe=oe,de=function(n,t){$.each({mceImageRotateLeft:ue(n,t,-90),mceImageRotateRight:ue(n,t,90),mceImageFlipVertical:ce(n,t,"v"),mceImageFlipHorizontal:ce(n,t,"h"),mceEditImage:le(n,t)},function(t,e){n.addCommand(e,t)})},he=function(n,r,o){n.on("NodeChange",function(t){var e=o.get();e&&e.src!==t.element.src&&(fe(r),n.editorUpload.uploadImagesAuto(),o.set(null)),se(n,t.element)&&o.set(t.element)})},pe=function(t){t.addButton("rotateleft",{title:"Rotate counterclockwise",cmd:"mceImageRotateLeft"}),t.addButton("rotateright",{title:"Rotate clockwise",cmd:"mceImageRotateRight"}),t.addButton("flipv",{title:"Flip vertically",cmd:"mceImageFlipVertical"}),t.addButton("fliph",{title:"Flip horizontally",cmd:"mceImageFlipHorizontal"}),t.addButton("editimage",{title:"Edit image",cmd:"mceEditImage"}),t.addButton("imageoptions",{title:"Image options",icon:"options",cmd:"mceImage"})},ge=function(t){t.addContextToolbar(u(se,t),t.getParam("imagetools_toolbar","rotateleft rotateright | flipv fliph | crop editimage imageoptions"))};t.add("imagetools",function(t){var e=r(0),n=r(null);de(t,e),pe(t),ge(t),he(t,e,n)})}();!function(){"use strict";var i,e=tinymce.util.Tools.resolve("tinymce.PluginManager"),d=function(e){return!1!==e.settings.image_dimensions},l=function(e){return!0===e.settings.image_advtab},m=function(e){return e.getParam("image_prepend_url","")},n=function(e){return e.getParam("image_class_list")},r=function(e){return!1!==e.settings.image_description},a=function(e){return!0===e.settings.image_title},o=function(e){return!0===e.settings.image_caption},u=function(e){return e.getParam("image_list",!1)},c=function(e){return e.getParam("images_upload_url",!1)},s=function(e){return e.getParam("images_upload_handler",!1)},g=function(e){return e.getParam("images_upload_url")},f=function(e){return e.getParam("images_upload_handler")},p=function(e){return e.getParam("images_upload_base_path")},h=function(e){return e.getParam("images_upload_credentials")},v="undefined"!=typeof window?window:Function("return this;")(),b=function(e,t){return function(e,t){for(var n=t!==undefined&&null!==t?t:v,r=0;r<e.length&&n!==undefined&&null!==n;++r)n=n[e[r]];return n}(e.split("."),t)},y={getOrDie:function(e,t){var n=b(e,t);if(n===undefined||null===n)throw e+" not available on this browser";return n}},x=tinymce.util.Tools.resolve("tinymce.util.Promise"),w=tinymce.util.Tools.resolve("tinymce.util.Tools"),C=tinymce.util.Tools.resolve("tinymce.util.XHR"),S=function(e,t){return Math.max(parseInt(e,10),parseInt(t,10))},N=function(e,n){var r=document.createElement("img");function t(e,t){r.parentNode&&r.parentNode.removeChild(r),n({width:e,height:t})}r.onload=function(){t(S(r.width,r.clientWidth),S(r.height,r.clientHeight))},r.onerror=function(){t(0,0)};var a=r.style;a.visibility="hidden",a.position="fixed",a.bottom=a.left="0px",a.width=a.height="auto",document.body.appendChild(r),r.src=e},_=function(e,a,t){return function n(e,r){return r=r||[],w.each(e,function(e){var t={text:e.text||e.title};e.menu?t.menu=n(e.menu):(t.value=e.value,a(t)),r.push(t)}),r}(e,t||[])},T=function(e){return e&&(e=e.replace(/px$/,"")),e},A=function(e){return 0<e.length&&/^[0-9]+$/.test(e)&&(e+="px"),e},R=function(e){if(e.margin){var t=e.margin.split(" ");switch(t.length){case 1:e["margin-top"]=e["margin-top"]||t[0],e["margin-right"]=e["margin-right"]||t[0],e["margin-bottom"]=e["margin-bottom"]||t[0],e["margin-left"]=e["margin-left"]||t[0];break;case 2:e["margin-top"]=e["margin-top"]||t[0],e["margin-right"]=e["margin-right"]||t[1],e["margin-bottom"]=e["margin-bottom"]||t[0],e["margin-left"]=e["margin-left"]||t[1];break;case 3:e["margin-top"]=e["margin-top"]||t[0],e["margin-right"]=e["margin-right"]||t[1],e["margin-bottom"]=e["margin-bottom"]||t[2],e["margin-left"]=e["margin-left"]||t[1];break;case 4:e["margin-top"]=e["margin-top"]||t[0],e["margin-right"]=e["margin-right"]||t[1],e["margin-bottom"]=e["margin-bottom"]||t[2],e["margin-left"]=e["margin-left"]||t[3]}delete e.margin}return e},t=function(e,t){var n=u(e);"string"==typeof n?C.send({url:n,success:function(e){t(JSON.parse(e))}}):"function"==typeof n?n(t):t(n)},I=function(e,t,n){function r(){n.onload=n.onerror=null,e.selection&&(e.selection.select(n),e.nodeChanged())}n.onload=function(){t.width||t.height||!d(e)||e.dom.setAttribs(n,{width:n.clientWidth,height:n.clientHeight}),r()},n.onerror=r},O=function(r){return new x(function(e,t){var n=new(y.getOrDie("FileReader"));n.onload=function(){e(n.result)},n.onerror=function(){t(n.error.message)},n.readAsDataURL(r)})},L=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),P=Object.prototype.hasOwnProperty,U=(i=function(e,t){return t},function(){for(var e=new Array(arguments.length),t=0;t<e.length;t++)e[t]=arguments[t];if(0===e.length)throw new Error("Can't merge zero objects");for(var n={},r=0;r<e.length;r++){var a=e[r];for(var o in a)P.call(a,o)&&(n[o]=i(n[o],a[o]))}return n}),E=L.DOM,k=function(e){return e.style.marginLeft&&e.style.marginRight&&e.style.marginLeft===e.style.marginRight?T(e.style.marginLeft):""},M=function(e){return e.style.marginTop&&e.style.marginBottom&&e.style.marginTop===e.style.marginBottom?T(e.style.marginTop):""},D=function(e){return e.style.borderWidth?T(e.style.borderWidth):""},z=function(e,t){return e.hasAttribute(t)?e.getAttribute(t):""},B=function(e,t){return e.style[t]?e.style[t]:""},H=function(e){return null!==e.parentNode&&"FIGURE"===e.parentNode.nodeName},j=function(e,t,n){e.setAttribute(t,n)},F=function(e){var t,n,r,a;H(e)?(a=(r=e).parentNode,E.insertAfter(r,a),E.remove(a)):(t=e,n=E.create("figure",{"class":"image"}),E.insertAfter(n,t),n.appendChild(t),n.appendChild(E.create("figcaption",{contentEditable:!0},"Caption")),n.contentEditable="false")},W=function(e,t){var n=e.getAttribute("style"),r=t(null!==n?n:"");0<r.length?(e.setAttribute("style",r),e.setAttribute("data-mce-style",r)):e.removeAttribute("style")},J=function(e,r){return function(e,t,n){e.style[t]?(e.style[t]=A(n),W(e,r)):j(e,t,n)}},V=function(e,t){return e.style[t]?T(e.style[t]):z(e,t)},G=function(e,t){var n=A(t);e.style.marginLeft=n,e.style.marginRight=n},$=function(e,t){var n=A(t);e.style.marginTop=n,e.style.marginBottom=n},X=function(e,t){var n=A(t);e.style.borderWidth=n},q=function(e,t){e.style.borderStyle=t},K=function(e){return"FIGURE"===e.nodeName},Q=function(e,t){var n=document.createElement("img");return j(n,"style",t.style),(k(n)||""!==t.hspace)&&G(n,t.hspace),(M(n)||""!==t.vspace)&&$(n,t.vspace),(D(n)||""!==t.border)&&X(n,t.border),(B(n,"borderStyle")||""!==t.borderStyle)&&q(n,t.borderStyle),e(n.getAttribute("style"))},Y=function(e,t){return{src:z(t,"src"),alt:z(t,"alt"),title:z(t,"title"),width:V(t,"width"),height:V(t,"height"),"class":z(t,"class"),style:e(z(t,"style")),caption:H(t),hspace:k(t),vspace:M(t),border:D(t),borderStyle:B(t,"borderStyle")}},Z=function(e,t,n,r,a){n[r]!==t[r]&&a(e,r,n[r])},ee=function(r,a){return function(e,t,n){r(e,n),W(e,a)}},te=function(e,t,n){var r=Y(e,n);Z(n,r,t,"caption",function(e,t,n){return F(e)}),Z(n,r,t,"src",j),Z(n,r,t,"alt",j),Z(n,r,t,"title",j),Z(n,r,t,"width",J(0,e)),Z(n,r,t,"height",J(0,e)),Z(n,r,t,"class",j),Z(n,r,t,"style",ee(function(e,t){return j(e,"style",t)},e)),Z(n,r,t,"hspace",ee(G,e)),Z(n,r,t,"vspace",ee($,e)),Z(n,r,t,"border",ee(X,e)),Z(n,r,t,"borderStyle",ee(q,e))},ne=function(e,t){var n=e.dom.styles.parse(t),r=R(n),a=e.dom.styles.parse(e.dom.styles.serialize(r));return e.dom.styles.serialize(a)},re=function(e){var t=e.selection.getNode(),n=e.dom.getParent(t,"figure.image");return n?e.dom.select("img",n)[0]:t&&("IMG"!==t.nodeName||t.getAttribute("data-mce-object")||t.getAttribute("data-mce-placeholder"))?null:t},ae=function(t,e){var n=t.dom,r=n.getParent(e.parentNode,function(e){return t.schema.getTextBlockElements()[e.nodeName]},t.getBody());return r?n.split(r,e):e},oe=function(t){var e=re(t);return e?Y(function(e){return ne(t,e)},e):{src:"",alt:"",title:"",width:"",height:"","class":"",style:"",caption:!1,hspace:"",vspace:"",border:"",borderStyle:""}},ie=function(t,e){var n=function(e,t){var n=document.createElement("img");if(te(e,U(t,{caption:!1}),n),j(n,"alt",t.alt),t.caption){var r=E.create("figure",{"class":"image"});return r.appendChild(n),r.appendChild(E.create("figcaption",{contentEditable:!0},"Caption")),r.contentEditable="false",r}return n}(function(e){return ne(t,e)},e);t.dom.setAttrib(n,"data-mce-id","__mcenew"),t.focus(),t.selection.setContent(n.outerHTML);var r=t.dom.select('*[data-mce-id="__mcenew"]')[0];if(t.dom.setAttrib(r,"data-mce-id",null),K(r)){var a=ae(t,r);t.selection.select(a)}else t.selection.select(r)},le=function(e,t){var n=re(e);n?t.src?function(t,e){var n,r=re(t);if(te(function(e){return ne(t,e)},e,r),n=r,t.dom.setAttrib(n,"src",n.getAttribute("src")),K(r.parentNode)){var a=r.parentNode;ae(t,a),t.selection.select(r.parentNode)}else t.selection.select(r),I(t,e,r)}(e,t):function(e,t){if(t){var n=e.dom.is(t.parentNode,"figure.image")?t.parentNode:t;e.dom.remove(n),e.focus(),e.nodeChanged(),e.dom.isEmpty(e.getBody())&&(e.setContent(""),e.selection.setCursorLocation())}}(e,n):t.src&&ie(e,t)},ue=function(n,r){r.find("#style").each(function(e){var t=Q(function(e){return ne(n,e)},U({src:"",alt:"",title:"",width:"",height:"","class":"",style:"",caption:!1,hspace:"",vspace:"",border:"",borderStyle:""},r.toJSON()));e.value(t)})},ce=function(t){return{title:"Advanced",type:"form",pack:"start",items:[{label:"Style",name:"style",type:"textbox",onchange:(o=t,function(e){var t=o.dom,n=e.control.rootControl;if(l(o)){var r=n.toJSON(),a=t.parseStyle(r.style);n.find("#vspace").value(""),n.find("#hspace").value(""),((a=R(a))["margin-top"]&&a["margin-bottom"]||a["margin-right"]&&a["margin-left"])&&(a["margin-top"]===a["margin-bottom"]?n.find("#vspace").value(T(a["margin-top"])):n.find("#vspace").value(""),a["margin-right"]===a["margin-left"]?n.find("#hspace").value(T(a["margin-right"])):n.find("#hspace").value("")),a["border-width"]?n.find("#border").value(T(a["border-width"])):n.find("#border").value(""),a["border-style"]?n.find("#borderStyle").value(a["border-style"]):n.find("#borderStyle").value(""),n.find("#style").value(t.serializeStyle(t.parseStyle(t.serializeStyle(a))))}})},{type:"form",layout:"grid",packV:"start",columns:2,padding:0,defaults:{type:"textbox",maxWidth:50,onchange:function(e){ue(t,e.control.rootControl)}},items:[{label:"Vertical space",name:"vspace"},{label:"Border width",name:"border"},{label:"Horizontal space",name:"hspace"},{label:"Border style",type:"listbox",name:"borderStyle",width:90,maxWidth:90,onselect:function(e){ue(t,e.control.rootControl)},values:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]}]}]};var o},se=function(e,t){e.state.set("oldVal",e.value()),t.state.set("oldVal",t.value())},de=function(e,t){var n=e.find("#width")[0],r=e.find("#height")[0],a=e.find("#constrain")[0];n&&r&&a&&t(n,r,a.checked())},me=function(e,t,n){var r=e.state.get("oldVal"),a=t.state.get("oldVal"),o=e.value(),i=t.value();n&&r&&a&&o&&i&&(o!==r?(i=Math.round(o/r*i),isNaN(i)||t.value(i)):(o=Math.round(i/a*o),isNaN(o)||e.value(o))),se(e,t)},ge=function(e){de(e,me)},fe=function(){var e=function(e){ge(e.control.rootControl)};return{type:"container",label:"Dimensions",layout:"flex",align:"center",spacing:5,items:[{name:"width",type:"textbox",maxLength:5,size:5,onchange:e,ariaLabel:"Width"},{type:"label",text:"x"},{name:"height",type:"textbox",maxLength:5,size:5,onchange:e,ariaLabel:"Height"},{name:"constrain",type:"checkbox",checked:!0,text:"Constrain proportions"}]}},pe=function(e){de(e,se)},he=ge,ve=function(e){e.meta=e.control.rootControl.toJSON()},be=function(s,e){var t=[{name:"src",type:"filepicker",filetype:"image",label:"Source",autofocus:!0,onchange:function(e){var t,n,r,a,o,i,l,u,c;n=s,i=(t=e).meta||{},l=t.control,u=l.rootControl,(c=u.find("#image-list")[0])&&c.value(n.convertURL(l.value(),"src")),w.each(i,function(e,t){u.find("#"+t).value(e)}),i.width||i.height||(r=n.convertURL(l.value(),"src"),a=m(n),o=new RegExp("^(?:[a-z]+:)?//","i"),a&&!o.test(r)&&r.substring(0,a.length)!==a&&(r=a+r),l.value(r),N(n.documentBaseURI.toAbsolute(l.value()),function(e){e.width&&e.height&&d(n)&&(u.find("#width").value(e.width),u.find("#height").value(e.height),pe(u))}))},onbeforecall:ve},e];return r(s)&&t.push({name:"alt",type:"textbox",label:"Image description"}),a(s)&&t.push({name:"title",type:"textbox",label:"Image Title"}),d(s)&&t.push(fe()),n(s)&&t.push({name:"class",type:"listbox",label:"Class",values:_(n(s),function(e){e.value&&(e.textStyle=function(){return s.formatter.getCssText({inline:"img",classes:[e.value]})})})}),o(s)&&t.push({name:"caption",type:"checkbox",label:"Caption"}),t},ye=function(e,t){return{title:"General",type:"form",items:be(e,t)}},xe=be,we=function(){return y.getOrDie("URL")},Ce=function(e){return we().createObjectURL(e)},Se=function(e){we().revokeObjectURL(e)},Ne=tinymce.util.Tools.resolve("tinymce.ui.Factory"),_e=function(){};function Te(i){var t=function(e,r,a,t){var o,n;(o=new(y.getOrDie("XMLHttpRequest"))).open("POST",i.url),o.withCredentials=i.credentials,o.upload.onprogress=function(e){t(e.loaded/e.total*100)},o.onerror=function(){a("Image upload failed due to a XHR Transport error. Code: "+o.status)},o.onload=function(){var e,t,n;o.status<200||300<=o.status?a("HTTP Error: "+o.status):(e=JSON.parse(o.responseText))&&"string"==typeof e.location?r((t=i.basePath,n=e.location,t?t.replace(/\/$/,"")+"/"+n.replace(/^\//,""):n)):a("Invalid JSON: "+o.responseText)},(n=new FormData).append("file",e.blob(),e.filename()),o.send(n)};return i=w.extend({credentials:!1,handler:t},i),{upload:function(e){return i.url||i.handler!==t?(r=e,a=i.handler,new x(function(e,t){try{a(r,e,t,_e)}catch(n){t(n.message)}})):x.reject("Upload url missing from the settings.");var r,a}}}var Ae=function(u){return function(e){var t=Ne.get("Throbber"),n=e.control.rootControl,r=new t(n.getEl()),a=e.control.value(),o=Ce(a),i=Te({url:g(u),basePath:p(u),credentials:h(u),handler:f(u)}),l=function(){r.hide(),Se(o)};return r.show(),O(a).then(function(e){var t=u.editorUpload.blobCache.create({blob:a,blobUri:o,name:a.name?a.name.replace(/\.[^\.]+$/,""):null,base64:e.split(",")[1]});return i.upload(t).then(function(e){var t=n.find("#src");return t.value(e),n.find("tabpanel")[0].activateTab(0),t.fire("change"),l(),e})})["catch"](function(e){u.windowManager.alert(e),l()})}},Re=".jpg,.jpeg,.png,.gif",Ie=function(e){return{title:"Upload",type:"form",layout:"flex",direction:"column",align:"stretch",padding:"20 20 20 20",items:[{type:"container",layout:"flex",direction:"column",align:"center",spacing:10,items:[{text:"Browse for an image",type:"browsebutton",accept:Re,onchange:Ae(e)},{text:"OR",type:"label"}]},{text:"Drop an image here",type:"dropzone",accept:Re,height:100,onchange:Ae(e)}]}};function Oe(r){for(var a=[],e=1;e<arguments.length;e++)a[e-1]=arguments[e];return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=a.concat(e);return r.apply(null,n)}}var Le=function(t,e){var n=e.control.getRoot();he(n),t.undoManager.transact(function(){var e=U(oe(t),n.toJSON());le(t,e)}),t.editorUpload.uploadImagesAuto()};function Pe(o){function e(e){var n,t,r=oe(o);if(e&&(t={type:"listbox",label:"Image list",name:"image-list",values:_(e,function(e){e.value=o.convertURL(e.value||e.url,"src")},[{text:"None",value:""}]),value:r.src&&o.convertURL(r.src,"src"),onselect:function(e){var t=n.find("#alt");(!t.value()||e.lastControl&&t.value()===e.lastControl.text())&&t.value(e.control.text()),n.find("#src").value(e.control.value()).fire("change")},onPostRender:function(){t=this}}),l(o)||c(o)||s(o)){var a=[ye(o,t)];l(o)&&a.push(ce(o)),(c(o)||s(o))&&a.push(Ie(o)),n=o.windowManager.open({title:"Insert/edit image",data:r,bodyType:"tabpanel",body:a,onSubmit:Oe(Le,o)})}else n=o.windowManager.open({title:"Insert/edit image",data:r,body:xe(o,t),onSubmit:Oe(Le,o)});pe(n)}return{open:function(){t(o,e)}}}var Ue=function(e){e.addCommand("mceImage",Pe(e).open)},Ee=function(o){return function(e){for(var t,n,r=e.length,a=function(e){e.attr("contenteditable",o?"true":null)};r--;)t=e[r],(n=t.attr("class"))&&/\bimage\b/.test(n)&&(t.attr("contenteditable",o?"false":null),w.each(t.getAll("figcaption"),a))}},ke=function(e){e.on("preInit",function(){e.parser.addNodeFilter("figure",Ee(!0)),e.serializer.addNodeFilter("figure",Ee(!1))})},Me=function(e){e.addButton("image",{icon:"image",tooltip:"Insert/edit image",onclick:Pe(e).open,stateSelector:"img:not([data-mce-object],[data-mce-placeholder]),figure.image"}),e.addMenuItem("image",{icon:"image",text:"Image",onclick:Pe(e).open,context:"insert",prependToContext:!0})};e.add("image",function(e){ke(e),Me(e),Ue(e)})}();!function(){"use strict";var n=tinymce.util.Tools.resolve("tinymce.PluginManager"),t=function(n){n.addCommand("InsertHorizontalRule",function(){n.execCommand("mceInsertContent",!1,"<hr />")})},o=function(n){n.addButton("hr",{icon:"hr",tooltip:"Horizontal line",cmd:"InsertHorizontalRule"}),n.addMenuItem("hr",{icon:"hr",text:"Horizontal line",cmd:"InsertHorizontalRule",context:"insert"})};n.add("hr",function(n){t(n),o(n)})}();!function(){"use strict";var i=function(e){var n=e,t=function(){return n};return{get:t,set:function(e){n=e},clone:function(){return i(t())}}},e=tinymce.util.Tools.resolve("tinymce.PluginManager"),t=function(e){return{isFullscreen:function(){return null!==e.get()}}},n=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),m=function(e,n){e.fire("FullscreenStateChanged",{state:n})},g=n.DOM,r=function(e,n){var t,r,l,i,o,c,s=document.body,u=document.documentElement,d=n.get(),a=function(){var e,n,t,i;g.setStyle(l,"height",(t=window,i=document.body,i.offsetWidth&&(e=i.offsetWidth,n=i.offsetHeight),t.innerWidth&&t.innerHeight&&(e=t.innerWidth,n=t.innerHeight),{w:e,h:n}).h-(r.clientHeight-l.clientHeight))},h=function(){g.unbind(window,"resize",a)};if(t=(r=e.getContainer()).style,i=(l=e.getContentAreaContainer().firstChild).style,d)i.width=d.iframeWidth,i.height=d.iframeHeight,d.containerWidth&&(t.width=d.containerWidth),d.containerHeight&&(t.height=d.containerHeight),g.removeClass(s,"mce-fullscreen"),g.removeClass(u,"mce-fullscreen"),g.removeClass(r,"mce-fullscreen"),o=d.scrollPos,window.scrollTo(o.x,o.y),g.unbind(window,"resize",d.resizeHandler),e.off("remove",d.removeHandler),n.set(null),m(e,!1);else{var f={scrollPos:(c=g.getViewPort(),{x:c.x,y:c.y}),containerWidth:t.width,containerHeight:t.height,iframeWidth:i.width,iframeHeight:i.height,resizeHandler:a,removeHandler:h};i.width=i.height="100%",t.width=t.height="",g.addClass(s,"mce-fullscreen"),g.addClass(u,"mce-fullscreen"),g.addClass(r,"mce-fullscreen"),g.bind(window,"resize",a),e.on("remove",h),a(),n.set(f),m(e,!0)}},l=function(e,n){e.addCommand("mceFullScreen",function(){r(e,n)})},o=function(t){return function(e){var n=e.control;t.on("FullscreenStateChanged",function(e){n.active(e.state)})}},c=function(e){e.addMenuItem("fullscreen",{text:"Fullscreen",shortcut:"Ctrl+Shift+F",selectable:!0,cmd:"mceFullScreen",onPostRender:o(e),context:"view"}),e.addButton("fullscreen",{active:!1,tooltip:"Fullscreen",cmd:"mceFullScreen",onPostRender:o(e)})};e.add("fullscreen",function(e){var n=i(null);return e.settings.inline||(l(e,n),c(e),e.addShortcut("Ctrl+Shift+F","","mceFullScreen")),t(n)})}();!function(){"use strict";var t=tinymce.util.Tools.resolve("tinymce.PluginManager"),c=tinymce.util.Tools.resolve("tinymce.util.Tools"),e=function(t,e){var i,n=t.dom,o=t.selection.getSelectedBlocks();o.length&&(i=n.getAttrib(o[0],"dir"),c.each(o,function(t){n.getParent(t.parentNode,'*[dir="'+e+'"]',n.getRoot())||n.setAttrib(t,"dir",i!==e?e:null)}),t.nodeChanged())},i=function(t){t.addCommand("mceDirectionLTR",function(){e(t,"ltr")}),t.addCommand("mceDirectionRTL",function(){e(t,"rtl")})},n=function(e){var i=[];return c.each("h1 h2 h3 h4 h5 h6 div p".split(" "),function(t){i.push(t+"[dir="+e+"]")}),i.join(",")},o=function(t){t.addButton("ltr",{title:"Left to right",cmd:"mceDirectionLTR",stateSelector:n("ltr")}),t.addButton("rtl",{title:"Right to left",cmd:"mceDirectionRTL",stateSelector:n("rtl")})};t.add("directionality",function(t){i(t),o(t)})}();!function(){"use strict";var o=function(t){var n=t,e=function(){return n};return{get:e,set:function(t){n=t},clone:function(){return o(e())}}},t=tinymce.util.Tools.resolve("tinymce.PluginManager"),i=function(t){return{isContextMenuVisible:function(){return t.get()}}},r=function(t){return t.settings.contextmenu_never_use_native},u=function(t){return t.getParam("contextmenu","link openlink image inserttable | cell row column deletetable")},l=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),s=function(t){return l.DOM.select(t.settings.ui_container)[0]},a=function(t,n){return{x:t,y:n}},f=function(t,n,e){return a(t.x+n,t.y+e)},m=function(t,n){if(t&&"static"!==l.DOM.getStyle(t,"position",!0)){var e=l.DOM.getPos(t),o=e.x-t.scrollLeft,i=e.y-t.scrollTop;return f(n,-o,-i)}return f(n,0,0)},c=function(t,n){if(t.inline)return m(s(t),a((u=n).pageX,u.pageY));var e,o,i,r,u,c=(e=t.getContentAreaContainer(),o=a((r=n).clientX,r.clientY),i=l.DOM.getPos(e),f(o,i.x,i.y));return m(s(t),c)},g=tinymce.util.Tools.resolve("tinymce.ui.Factory"),v=tinymce.util.Tools.resolve("tinymce.util.Tools"),y=function(t,n,e,o){null===o.get()?o.set(function(e,n){var t,o,i=[];o=u(e),v.each(o.split(/[ ,]/),function(t){var n=e.menuItems[t];"|"===t&&(n={text:t}),n&&(n.shortcut="",i.push(n))});for(var r=0;r<i.length;r++)"|"===i[r].text&&(0!==r&&r!==i.length-1||i.splice(r,1));return(t=g.create("menu",{items:i,context:"contextmenu",classes:"contextmenu"})).uiContainer=s(e),t.renderTo(s(e)),t.on("hide",function(t){t.control===this&&n.set(!1)}),e.on("remove",function(){t.remove(),t=null}),t}(t,e)):o.get().show(),o.get().moveTo(n.x,n.y),e.set(!0)},x=function(e,o,i){e.on("contextmenu",function(t){var n;n=e,(!t.ctrlKey||r(n))&&(t.preventDefault(),y(e,c(e,t),o,i))})};t.add("contextmenu",function(t){var n=o(null),e=o(!1);return x(t,e,n),i(e)})}();!function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager"),l=tinymce.util.Tools.resolve("tinymce.util.Color"),a=function(e,n){e.find("#preview")[0].getEl().style.background=n},o=function(e,n){var i=l(n),t=i.toRgb();e.fromJSON({r:t.r,g:t.g,b:t.b,hex:i.toHex().substr(1)}),a(e,i.toHex())},t=function(e,n,i){var t=e.windowManager.open({title:"Color",items:{type:"container",layout:"flex",direction:"row",align:"stretch",padding:5,spacing:10,items:[{type:"colorpicker",value:i,onchange:function(){var e=this.rgb();t&&(t.find("#r").value(e.r),t.find("#g").value(e.g),t.find("#b").value(e.b),t.find("#hex").value(this.value().substr(1)),a(t,this.value()))}},{type:"form",padding:0,labelGap:5,defaults:{type:"textbox",size:7,value:"0",flex:1,spellcheck:!1,onchange:function(){var e,n,i=t.find("colorpicker")[0];if(e=this.name(),n=this.value(),"hex"===e)return o(t,n="#"+n),void i.value(n);n={r:t.find("#r").value(),g:t.find("#g").value(),b:t.find("#b").value()},i.value(n),o(t,n)}},items:[{name:"r",label:"R",autofocus:1},{name:"g",label:"G"},{name:"b",label:"B"},{name:"hex",label:"#",value:"000000"},{name:"preview",type:"container",border:1}]}]},onSubmit:function(){n("#"+t.toJSON().hex)}});o(t,i)};e.add("colorpicker",function(i){i.settings.color_picker_callback||(i.settings.color_picker_callback=function(e,n){t(i,e,n)})})}();!function(){"use strict";var a=function(t){var e=t,n=function(){return e};return{get:n,set:function(t){e=t},clone:function(){return a(n())}}},t=tinymce.util.Tools.resolve("tinymce.PluginManager"),r=tinymce.util.Tools.resolve("tinymce.util.LocalStorage"),o=tinymce.util.Tools.resolve("tinymce.util.Tools"),i=function(t,e){var n=t||e,r=/^(\d+)([ms]?)$/.exec(""+n);return(r[2]?{s:1e3,m:6e4}[r[2]]:1)*parseInt(n,10)},u=function(t){var e=t.getParam("autosave_prefix","tinymce-autosave-{path}{query}{hash}-{id}-");return e=(e=(e=(e=e.replace(/\{path\}/g,document.location.pathname)).replace(/\{query\}/g,document.location.search)).replace(/\{hash\}/g,document.location.hash)).replace(/\{id\}/g,t.id)},s=function(t,e){var n=t.settings.forced_root_block;return""===(e=o.trim(void 0===e?t.getBody().innerHTML:e))||new RegExp("^<"+n+"[^>]*>((\xa0|&nbsp;|[ \t]|<br[^>]*>)+?|)</"+n+">|<br>$","i").test(e)},c=function(t){var e=parseInt(r.getItem(u(t)+"time"),10)||0;return!((new Date).getTime()-e>i(t.settings.autosave_retention,"20m")&&(f(t,!1),1))},f=function(t,e){var n=u(t);r.removeItem(n+"draft"),r.removeItem(n+"time"),!1!==e&&t.fire("RemoveDraft")},l=function(t){var e=u(t);!s(t)&&t.isDirty()&&(r.setItem(e+"draft",t.getContent({format:"raw",no_events:!0})),r.setItem(e+"time",(new Date).getTime().toString()),t.fire("StoreDraft"))},m=function(t){var e=u(t);c(t)&&(t.setContent(r.getItem(e+"draft"),{format:"raw"}),t.fire("RestoreDraft"))},v=function(t,e){var n=i(t.settings.autosave_interval,"30s");e.get()||(setInterval(function(){t.removed||l(t)},n),e.set(!0))},d=function(t){t.undoManager.transact(function(){m(t),f(t)}),t.focus()};function g(r){for(var o=[],t=1;t<arguments.length;t++)o[t-1]=arguments[t];return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=o.concat(t);return r.apply(null,n)}}var y=tinymce.util.Tools.resolve("tinymce.EditorManager");y._beforeUnloadHandler=function(){var e;return o.each(y.get(),function(t){t.plugins.autosave&&t.plugins.autosave.storeDraft(),!e&&t.isDirty()&&t.getParam("autosave_ask_before_unload",!0)&&(e=t.translate("You have unsaved changes are you sure you want to navigate away?"))}),e};var p=function(n,r){return function(t){var e=t.control;e.disabled(!c(n)),n.on("StoreDraft RestoreDraft RemoveDraft",function(){e.disabled(!c(n))}),v(n,r)}};t.add("autosave",function(t){var e,n,r,o=a(!1);return window.onbeforeunload=y._beforeUnloadHandler,n=o,(e=t).addButton("restoredraft",{title:"Restore last draft",onclick:function(){d(e)},onPostRender:p(e,n)}),e.addMenuItem("restoredraft",{text:"Restore last draft",onclick:function(){d(e)},onPostRender:p(e,n),context:"file"}),t.on("init",function(){t.getParam("autosave_restore_when_empty",!1)&&t.dom.isEmpty(t.getBody())&&m(t)}),{hasDraft:g(c,r=t),storeDraft:g(l,r),restoreDraft:g(m,r),removeDraft:g(f,r),isEmpty:g(s,r)}})}();!function(){"use strict";var i=function(t){var e=t,n=function(){return e};return{get:n,set:function(t){e=t},clone:function(){return i(n())}}},t=tinymce.util.Tools.resolve("tinymce.PluginManager"),y=tinymce.util.Tools.resolve("tinymce.Env"),r=tinymce.util.Tools.resolve("tinymce.util.Delay"),h=function(t){return parseInt(t.getParam("autoresize_min_height",t.getElement().offsetHeight),10)},v=function(t){return parseInt(t.getParam("autoresize_max_height",0),10)},o=function(t){return t.getParam("autoresize_overflow_padding",1)},a=function(t){return t.getParam("autoresize_bottom_margin",50)},n=function(t){return t.getParam("autoresize_on_init",!0)},u=function(t,e,n,i,o){r.setEditorTimeout(t,function(){_(t,e),n--?u(t,e,n,i,o):o&&o()},i)},S=function(t,e){var n=t.getBody();n&&(n.style.overflowY=e?"":"hidden",e||(n.scrollTop=0))},_=function(t,e){var n,i,o,r,a,u,s,l,g,c,f,d=t.dom;if(i=t.getDoc())if((m=t).plugins.fullscreen&&m.plugins.fullscreen.isFullscreen())S(t,!0);else{var m;o=i.body,r=h(t),u=d.getStyle(o,"margin-top",!0),s=d.getStyle(o,"margin-bottom",!0),l=d.getStyle(o,"padding-top",!0),g=d.getStyle(o,"padding-bottom",!0),c=d.getStyle(o,"border-top-width",!0),f=d.getStyle(o,"border-bottom-width",!0),a=o.offsetHeight+parseInt(u,10)+parseInt(s,10)+parseInt(l,10)+parseInt(g,10)+parseInt(c,10)+parseInt(f,10),(isNaN(a)||a<=0)&&(a=y.ie?o.scrollHeight:y.webkit&&0===o.clientHeight?0:o.offsetHeight),a>h(t)&&(r=a);var p=v(t);p&&p<a?(r=p,S(t,!0)):S(t,!1),r!==e.get()&&(n=r-e.get(),d.setStyle(t.iframeElement,"height",r+"px"),e.set(r),y.webkit&&n<0&&_(t,e))}},s={setup:function(i,e){i.on("init",function(){var t,e,n=i.dom;t=o(i),e=a(i),!1!==t&&n.setStyles(i.getBody(),{paddingLeft:t,paddingRight:t}),!1!==e&&n.setStyles(i.getBody(),{paddingBottom:e})}),i.on("nodechange setcontent keyup FullscreenStateChanged",function(t){_(i,e)}),n(i)&&i.on("init",function(){u(i,e,20,100,function(){u(i,e,5,1e3)})})},resize:_},l=function(t,e){t.addCommand("mceAutoResize",function(){s.resize(t,e)})};t.add("autoresize",function(t){if(!t.inline){var e=i(0);l(t,e),s.setup(t,e)}})}();!function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager"),i=tinymce.util.Tools.resolve("tinymce.Env"),m=function(e){return e.getParam("autolink_pattern",/^(https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.|(?:mailto:)?[A-Z0-9._%+\-]+@)(.+)$/i)},y=function(e){return e.getParam("default_link_target","")},o=function(e,t){if(t<0&&(t=0),3===e.nodeType){var n=e.data.length;n<t&&(t=n)}return t},k=function(e,t,n){1!==t.nodeType||t.hasChildNodes()?e.setStart(t,o(t,n)):e.setStartBefore(t)},p=function(e,t,n){1!==t.nodeType||t.hasChildNodes()?e.setEnd(t,o(t,n)):e.setEndAfter(t)},r=function(e,t,n){var i,o,r,a,f,s,d,l,c,u,g=m(e),h=y(e);if("A"!==e.selection.getNode().tagName){if((i=e.selection.getRng(!0).cloneRange()).startOffset<5){if(!(l=i.endContainer.previousSibling)){if(!i.endContainer.firstChild||!i.endContainer.firstChild.nextSibling)return;l=i.endContainer.firstChild.nextSibling}if(c=l.length,k(i,l,c),p(i,l,c),i.endOffset<5)return;o=i.endOffset,a=l}else{if(3!==(a=i.endContainer).nodeType&&a.firstChild){for(;3!==a.nodeType&&a.firstChild;)a=a.firstChild;3===a.nodeType&&(k(i,a,0),p(i,a,a.nodeValue.length))}o=1===i.endOffset?2:i.endOffset-1-t}for(r=o;k(i,a,2<=o?o-2:0),p(i,a,1<=o?o-1:0),o-=1," "!==(u=i.toString())&&""!==u&&160!==u.charCodeAt(0)&&0<=o-2&&u!==n;);var C;(C=i.toString())===n||" "===C||160===C.charCodeAt(0)?(k(i,a,o),p(i,a,r),o+=1):(0===i.startOffset?k(i,a,0):k(i,a,o),p(i,a,r)),"."===(s=i.toString()).charAt(s.length-1)&&p(i,a,r-1),(d=(s=i.toString().trim()).match(g))&&("www."===d[1]?d[1]="http://www.":/@$/.test(d[1])&&!/^mailto:/.test(d[1])&&(d[1]="mailto:"+d[1]),f=e.selection.getBookmark(),e.selection.setRng(i),e.execCommand("createlink",!1,d[1]+d[2]),h&&e.dom.setAttrib(e.selection.getNode(),"target",h),e.selection.moveToBookmark(f),e.nodeChanged())}},t=function(t){var n;t.on("keydown",function(e){13!==e.keyCode||r(t,-1,"")}),i.ie?t.on("focus",function(){if(!n){n=!0;try{t.execCommand("AutoUrlDetect",!1,!0)}catch(e){}}}):(t.on("keypress",function(e){41!==e.keyCode||r(t,-1,"(")}),t.on("keyup",function(e){32!==e.keyCode||r(t,0,"")}))};e.add("autolink",function(e){t(e)})}();!function(){"use strict";var t=tinymce.util.Tools.resolve("tinymce.PluginManager"),a=function(t){return/^[A-Za-z][A-Za-z0-9\-:._]*$/.test(t)},e=function(t){var e=t.selection.getNode();return"A"===e.tagName&&""===t.dom.getAttrib(e,"href")?e.id||e.name:""},i=function(t,e){var n=t.selection.getNode();"A"===n.tagName&&""===t.dom.getAttrib(n,"href")?(n.removeAttribute("name"),n.id=e,t.undoManager.add()):(t.focus(),t.selection.collapse(!0),t.execCommand("mceInsertContent",!1,t.dom.createHTML("a",{id:e})))},n=function(r){var t=e(r);r.windowManager.open({title:"Anchor",body:{type:"textbox",name:"id",size:40,label:"Id",value:t},onsubmit:function(t){var e,n,o=t.data.id;e=r,(a(n=o)?(i(e,n),0):(e.windowManager.alert("Id should start with a letter, followed only by letters, numbers, dashes, dots, colons or underscores."),1))&&t.preventDefault()}})},o=function(t){t.addCommand("mceAnchor",function(){n(t)})},r=function(o){return function(t){for(var e=0;e<t.length;e++)(n=t[e]).attr("href")||!n.attr("id")&&!n.attr("name")||n.firstChild||t[e].attr("contenteditable",o);var n}},c=function(t){t.on("PreInit",function(){t.parser.addNodeFilter("a",r("false")),t.serializer.addNodeFilter("a",r(null))})},d=function(t){t.addButton("anchor",{icon:"anchor",tooltip:"Anchor",cmd:"mceAnchor",stateSelector:"a:not([href])"}),t.addMenuItem("anchor",{icon:"anchor",text:"Anchor",context:"insert",cmd:"mceAnchor"})};t.add("anchor",function(t){c(t),o(t),d(t)})}();!function(){"use strict";var t=tinymce.util.Tools.resolve("tinymce.PluginManager"),a=tinymce.util.Tools.resolve("tinymce.util.Tools"),s=function(t,e,n){var r="UL"===e?"InsertUnorderedList":"InsertOrderedList";t.execCommand(r,!1,!1===n?null:{"list-style-type":n})},o=function(n){n.addCommand("ApplyUnorderedListStyle",function(t,e){s(n,"UL",e["list-style-type"])}),n.addCommand("ApplyOrderedListStyle",function(t,e){s(n,"OL",e["list-style-type"])})},e=function(t){var e=t.getParam("advlist_number_styles","default,lower-alpha,lower-greek,lower-roman,upper-alpha,upper-roman");return e?e.split(/[ ,]/):[]},n=function(t){var e=t.getParam("advlist_bullet_styles","default,circle,disc,square");return e?e.split(/[ ,]/):[]},u=function(t){return t&&/^(TH|TD)$/.test(t.nodeName)},c=function(r){return function(t){return t&&/^(OL|UL|DL)$/.test(t.nodeName)&&(n=t,(e=r).$.contains(e.getBody(),n));var e,n}},d=function(t){var e=t.dom.getParent(t.selection.getNode(),"ol,ul");return t.dom.getStyle(e,"listStyleType")||""},p=function(t){return a.map(t,function(t){return{text:t.replace(/\-/g," ").replace(/\b\w/g,function(t){return t.toUpperCase()}),data:"default"===t?"":t}})},f=function(i,l){return function(t){var o=t.control;i.on("NodeChange",function(t){var e=function(t,e){for(var n=0;n<t.length;n++)if(e(t[n]))return n;return-1}(t.parents,u),n=-1!==e?t.parents.slice(0,e):t.parents,r=a.grep(n,c(i));o.active(0<r.length&&r[0].nodeName===l)})}},m=function(e,t,n,r,o,i){var l;e.addButton(t,{active:!1,type:"splitbutton",tooltip:n,menu:p(i),onPostRender:f(e,o),onshow:(l=e,function(t){var e=d(l);t.control.items().each(function(t){t.active(t.settings.data===e)})}),onselect:function(t){s(e,o,t.control.settings.data)},onclick:function(){e.execCommand(r)}})},r=function(t,e,n,r,o,i){var l,a,s,u,c;0<i.length?m(t,e,n,r,o,i):(a=e,s=n,u=r,c=o,(l=t).addButton(a,{active:!1,type:"button",tooltip:s,onPostRender:f(l,c),onclick:function(){l.execCommand(u)}}))},i=function(t){r(t,"numlist","Numbered list","InsertOrderedList","OL",e(t)),r(t,"bullist","Bullet list","InsertUnorderedList","UL",n(t))};t.add("advlist",function(t){var e,n,r;n="lists",r=(e=t).settings.plugins?e.settings.plugins:"",-1!==a.inArray(r.split(/[ ,]/),n)&&(i(t),o(t))})}();!function(){"use strict";var e,t,n,i,r,o=tinymce.util.Tools.resolve("tinymce.ThemeManager"),h=tinymce.util.Tools.resolve("tinymce.EditorManager"),w=tinymce.util.Tools.resolve("tinymce.util.Tools"),d=function(e){return!1!==c(e)},c=function(e){return e.getParam("menubar")},f=function(e){return e.getParam("toolbar_items_size")},m=function(e){return e.getParam("menu")},g=function(e){return!1===e.settings.skin},p=function(e){var t=e.getParam("resize","vertical");return!1===t?"none":"both"===t?"both":"vertical"},v=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),b=tinymce.util.Tools.resolve("tinymce.ui.Factory"),y=tinymce.util.Tools.resolve("tinymce.util.I18n"),s=function(e){return e.fire("SkinLoaded")},x=function(e){return e.fire("ResizeEditor")},_=function(e){return e.fire("BeforeRenderUI")},a=function(t,n){return function(){var e=t.find(n)[0];e&&e.focus(!0)}},R=function(e,t){e.shortcuts.add("Alt+F9","",a(t,"menubar")),e.shortcuts.add("Alt+F10,F10","",a(t,"toolbar")),e.shortcuts.add("Alt+F11","",a(t,"elementpath")),t.on("cancel",function(){e.focus()})},C=tinymce.util.Tools.resolve("tinymce.geom.Rect"),u=tinymce.util.Tools.resolve("tinymce.util.Delay"),E=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},k=function(e){return function(){return e}},l=k(!1),H=k(!0),S=l,T=H,M=function(){return N},N=(i={fold:function(e,t){return e()},is:S,isSome:S,isNone:T,getOr:n=function(e){return e},getOrThunk:t=function(e){return e()},getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:function(){return null},getOrUndefined:function(){return undefined},or:n,orThunk:t,map:M,ap:M,each:function(){},bind:M,flatten:M,exists:S,forall:T,filter:M,equals:e=function(e){return e.isNone()},equals_:e,toArray:function(){return[]},toString:k("none()")},Object.freeze&&Object.freeze(i),i),P=function(n){var e=function(){return n},t=function(){return r},i=function(e){return e(n)},r={fold:function(e,t){return t(n)},is:function(e){return n===e},isSome:T,isNone:S,getOr:e,getOrThunk:e,getOrDie:e,getOrNull:e,getOrUndefined:e,or:t,orThunk:t,map:function(e){return P(e(n))},ap:function(e){return e.fold(M,function(e){return P(e(n))})},each:function(e){e(n)},bind:i,flatten:e,exists:i,forall:i,filter:function(e){return e(n)?r:N},equals:function(e){return e.is(n)},equals_:function(e,t){return e.fold(S,function(e){return t(n,e)})},toArray:function(){return[n]},toString:function(){return"some("+n+")"}};return r},W={some:P,none:M,from:function(e){return null===e||e===undefined?N:P(e)}},D=function(e){return e?e.getRoot().uiContainer:null},O={getUiContainerDelta:function(e){var t=D(e);if(t&&"static"!==v.DOM.getStyle(t,"position",!0)){var n=v.DOM.getPos(t),i=t.scrollLeft-n.x,r=t.scrollTop-n.y;return W.some({x:i,y:r})}return W.none()},setUiContainer:function(e,t){var n=v.DOM.select(e.settings.ui_container)[0];t.getRoot().uiContainer=n},getUiContainer:D,inheritUiContainer:function(e,t){return t.uiContainer=D(e)}},A=function(i,e,r){var o,s=[];if(e)return w.each(e.split(/[ ,]/),function(t){var e,n=function(){var e=i.selection;t.settings.stateSelector&&e.selectorChanged(t.settings.stateSelector,function(e){t.active(e)},!0),t.settings.disabledStateSelector&&e.selectorChanged(t.settings.disabledStateSelector,function(e){t.disabled(e)})};"|"===t?o=null:(o||(o={type:"buttongroup",items:[]},s.push(o)),i.buttons[t]&&(e=t,"function"==typeof(t=i.buttons[e])&&(t=t()),t.type=t.type||"button",t.size=r,t=b.create(t),o.items.push(t),i.initialized?n():i.on("init",n)))}),{type:"toolbar",layout:"flow",items:s}},B=A,L=function(n,i){var e,t,r=[];if(w.each(!1===(t=(e=n).getParam("toolbar"))?[]:w.isArray(t)?w.grep(t,function(e){return 0<e.length}):function(e,t){for(var n=[],i=1;i<10;i++){var r=e["toolbar"+i];if(!r)break;n.push(r)}var o=e.toolbar?[e.toolbar]:[t];return 0<n.length?n:o}(e.settings,"undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image"),function(e){var t;(t=e)&&r.push(A(n,t,i))}),r.length)return{type:"panel",layout:"stack",classes:"toolbar-grp",ariaRoot:!0,ariaRemember:!0,items:r}},z=v.DOM,I=function(e){return{left:e.x,top:e.y,width:e.w,height:e.h,right:e.x+e.w,bottom:e.y+e.h}},F=function(e,t){e.moveTo(t.left,t.top)},U=function(e,t,n,i,r,o){return o=I({x:t,y:n,w:o.w,h:o.h}),e&&(o=e({elementRect:I(i),contentAreaRect:I(r),panelRect:o})),o},V=function(x){var i,o=function(){return x.contextToolbars||[]},n=function(e,t){var n,i,r,o,s,a,l,u=x.getParam("inline_toolbar_position_handler");if(!x.removed){if(!e||!e.toolbar.panel)return c=x,void w.each(c.contextToolbars,function(e){e.panel&&e.panel.hide()});var c,d,f,h,m;l=["bc-tc","tc-bc","tl-bl","bl-tl","tr-br","br-tr"],s=e.toolbar.panel,t&&s.show(),d=e.element,f=z.getPos(x.getContentAreaContainer()),h=x.dom.getRect(d),"BODY"===(m=x.dom.getRoot()).nodeName&&(h.x-=m.ownerDocument.documentElement.scrollLeft||m.scrollLeft,h.y-=m.ownerDocument.documentElement.scrollTop||m.scrollTop),h.x+=f.x,h.y+=f.y,r=h,i=z.getRect(s.getEl()),o=z.getRect(x.getContentAreaContainer()||x.getBody());var g,p,v,b=O.getUiContainerDelta(s).getOr({x:0,y:0});if(r.x+=b.x,r.y+=b.y,i.x+=b.x,i.y+=b.y,o.x+=b.x,o.y+=b.y,"inline"!==z.getStyle(e.element,"display",!0)){var y=e.element.getBoundingClientRect();r.w=y.width,r.h=y.height}x.inline||(o.w=x.getDoc().documentElement.offsetWidth),x.selection.controlSelection.isResizable(e.element)&&r.w<25&&(r=C.inflate(r,0,8)),n=C.findBestRelativePosition(i,r,o,l),r=C.clamp(r,o),n?(a=C.relativePosition(i,r,n),F(s,U(u,a.x,a.y,r,o,i))):(o.h+=i.h,(r=C.intersect(o,r))?(n=C.findBestRelativePosition(i,r,o,["bc-tc","bl-tl","br-tr"]))?(a=C.relativePosition(i,r,n),F(s,U(u,a.x,a.y,r,o,i))):F(s,U(u,r.x,r.y,r,o,i)):s.hide()),g=s,v=function(e,t){return e===t},p=(p=n)?p.substr(0,2):"",w.each({t:"down",b:"up"},function(e,t){g.classes.toggle("arrow-"+e,v(t,p.substr(0,1)))}),w.each({l:"left",r:"right"},function(e,t){g.classes.toggle("arrow-"+e,v(t,p.substr(1,1)))})}},r=function(e){return function(){u.requestAnimationFrame(function(){x.selection&&n(a(x.selection.getNode()),e)})}},t=function(e){var t;if(e.toolbar.panel)return e.toolbar.panel.show(),void n(e);t=b.create({type:"floatpanel",role:"dialog",classes:"tinymce tinymce-inline arrow",ariaLabel:"Inline toolbar",layout:"flex",direction:"column",align:"stretch",autohide:!1,autofix:!0,fixed:!0,border:1,items:B(x,e.toolbar.items),oncancel:function(){x.focus()}}),O.setUiContainer(x,t),function(e){if(!i){var t=r(!0),n=O.getUiContainer(e);i=x.selection.getScrollContainer()||x.getWin(),z.bind(i,"scroll",t),z.bind(n,"scroll",t),x.on("remove",function(){z.unbind(i,"scroll",t),z.unbind(n,"scroll",t)})}}(t),(e.toolbar.panel=t).renderTo().reflow(),n(e)},s=function(){w.each(o(),function(e){e.panel&&e.panel.hide()})},a=function(e){var t,n,i,r=o();for(t=(i=x.$(e).parents().add(e)).length-1;0<=t;t--)for(n=r.length-1;0<=n;n--)if(r[n].predicate(i[t]))return{toolbar:r[n],element:i[t]};return null};x.on("click keyup setContent ObjectResized",function(e){("setcontent"!==e.type||e.selection)&&u.setEditorTimeout(x,function(){var e;(e=a(x.selection.getNode()))?(s(),t(e)):s()})}),x.on("blur hide contextmenu",s),x.on("ObjectResizeStart",function(){var e=a(x.selection.getNode());e&&e.toolbar.panel&&e.toolbar.panel.hide()}),x.on("ResizeEditor ResizeWindow",r(!0)),x.on("nodeChange",r(!1)),x.on("remove",function(){w.each(o(),function(e){e.panel&&e.panel.remove()}),x.contextToolbars={}}),x.shortcuts.add("ctrl+F9","",function(){var e=a(x.selection.getNode());e&&e.toolbar.panel&&e.toolbar.panel.items()[0].focus()})},Y=function(t){return function(e){return function(e){if(null===e)return"null";var t=typeof e;return"object"===t&&Array.prototype.isPrototypeOf(e)?"array":"object"===t&&String.prototype.isPrototypeOf(e)?"string":t}(e)===t}},$=Y("function"),q=Y("number"),X=(r=Array.prototype.indexOf)===undefined?function(e,t){return Q(e,t)}:function(e,t){return r.call(e,t)},j=function(e,t){return Z(e,t).isSome()},J=function(e,t){for(var n=e.length,i=new Array(n),r=0;r<n;r++){var o=e[r];i[r]=t(o,r,e)}return i},G=function(e,t){for(var n=0,i=e.length;n<i;n++)t(e[n],n,e)},K=function(e,t){for(var n=[],i=0,r=e.length;i<r;i++){var o=e[i];t(o,i,e)&&n.push(o)}return n},Z=function(e,t){for(var n=0,i=e.length;n<i;n++)if(t(e[n],n,e))return W.some(n);return W.none()},Q=function(e,t){for(var n=0,i=e.length;n<i;++n)if(e[n]===t)return n;return-1},ee=Array.prototype.push,te=(Array.prototype.slice,$(Array.from)&&Array.from,{file:{title:"File",items:"newdocument restoredraft | preview | print"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall"},view:{title:"View",items:"code | visualaid visualchars visualblocks | spellchecker | preview fullscreen"},insert:{title:"Insert",items:"image link media template codesample inserttable | charmap hr | pagebreak nonbreaking anchor toc | insertdatetime"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript codeformat | blockformats align | removeformat"},tools:{title:"Tools",items:"spellchecker spellcheckerlanguage | a11ycheck code"},table:{title:"Table"},help:{title:"Help"}}),ne=function(e,t){return"|"===e?{name:"|",item:{text:"|"}}:t?{name:e,item:t}:null},ie=function(e){return e&&"|"===e.item.text},re=function(n,e,t,i){var r,o,s,a,l,u,c;return e?(o=e[i],a=!0):o=te[i],o&&(r={text:o.title},s=[],w.each((o.items||"").split(/[ ,]/),function(e){var t=ne(e,n[e]);t&&s.push(t)}),a||w.each(n,function(e,t){var n;e.context!==i||(n=t,Z(s,function(e){return e.name===n}).isSome())||("before"===e.separator&&s.push({name:"|",item:{text:"|"}}),e.prependToContext?s.unshift(ne(t,e)):s.push(ne(t,e)),"after"===e.separator&&s.push({name:"|",item:{text:"|"}}))}),r.menu=J((l=t,u=K(s,function(e){return!1===l.hasOwnProperty(e.name)}),c=K(u,function(e,t,n){return!ie(e)||!ie(n[t-1])}),K(c,function(e,t,n){return!ie(e)||0<t&&t<n.length-1})),function(e){return e.item}),!r.menu.length)?null:r},oe=function(e){for(var t,n=[],i=function(e){var t,n=[],i=m(e);if(i)for(t in i)n.push(t);else for(t in te)n.push(t);return n}(e),r=w.makeMap((t=e,t.getParam("removed_menuitems","")).split(/[ ,]/)),o=c(e),s="string"==typeof o?o.split(/[ ,]/):i,a=0;a<s.length;a++){var l=s[a],u=re(e.menuItems,m(e),r,l);u&&n.push(u)}return n},se=v.DOM,ae=function(e){return{width:e.clientWidth,height:e.clientHeight}},le=function(e,t,n){var i,r,o,s;i=e.getContainer(),r=e.getContentAreaContainer().firstChild,o=ae(i),s=ae(r),null!==t&&(t=Math.max(e.getParam("min_width",100,"number"),t),t=Math.min(e.getParam("max_width",65535,"number"),t),se.setStyle(i,"width",t+(o.width-s.width)),se.setStyle(r,"width",t)),n=Math.max(e.getParam("min_height",100,"number"),n),n=Math.min(e.getParam("max_height",65535,"number"),n),se.setStyle(r,"height",n),x(e)},ue=le,ce=function(e,t,n){var i=e.getContentAreaContainer();le(e,i.clientWidth+t,i.clientHeight+n)},de=tinymce.util.Tools.resolve("tinymce.Env"),fe=function(e,t,n){var i,r=e.settings[n];r&&r((i=t.getEl("body"),{element:function(){return i}}))},he=function(c,d,f){return function(e){var t,n,i,r,o,s=e.control,a=s.parents().filter("panel")[0],l=a.find("#"+d)[0],u=(t=f,n=d,w.grep(t,function(e){return e.name===n})[0]);i=d,r=a,o=f,w.each(o,function(e){var t=r.items().filter("#"+e.name)[0];t&&t.visible()&&e.name!==i&&(fe(e,t,"onhide"),t.visible(!1))}),s.parent().items().each(function(e){e.active(!1)}),l&&l.visible()?(fe(u,l,"onhide"),l.hide(),s.active(!1)):(l?l.show():(l=b.create({type:"container",name:d,layout:"stack",classes:"sidebar-panel",html:""}),a.prepend(l),fe(u,l,"onrender")),fe(u,l,"onshow"),s.active(!0)),x(c)}},me=function(e){return!(de.ie&&!(11<=de.ie)||!e.sidebars)&&0<e.sidebars.length},ge=function(n){return{type:"panel",name:"sidebar",layout:"stack",classes:"sidebar",items:[{type:"toolbar",layout:"stack",classes:"sidebar-toolbar",items:w.map(n.sidebars,function(e){var t=e.settings;return{type:"button",icon:t.icon,image:t.image,tooltip:t.tooltip,onclick:he(n,e.name,n.sidebars)}})}]}},pe=function(e){var t=function(){e._skinLoaded=!0,s(e)};return function(){e.initialized?t():e.on("init",t)}},ve=v.DOM,be=function(e){return{type:"panel",name:"iframe",layout:"stack",classes:"edit-area",border:e,html:""}},ye=function(t,e,n){var i,r,o,s,a;if(!1===g(t)&&n.skinUiCss?ve.styleSheetLoader.load(n.skinUiCss,pe(t)):pe(t)(),i=e.panel=b.create({type:"panel",role:"application",classes:"tinymce",style:"visibility: hidden",layout:"stack",border:1,items:[{type:"container",classes:"top-part",items:[!1===d(t)?null:{type:"menubar",border:"0 0 1 0",items:oe(t)},L(t,f(t))]},me(t)?(s=t,{type:"panel",layout:"stack",classes:"edit-aria-container",border:"1 0 0 0",items:[be("0"),ge(s)]}):be("1 0 0 0")]}),O.setUiContainer(t,i),"none"!==p(t)&&(r={type:"resizehandle",direction:p(t),onResizeStart:function(){var e=t.getContentAreaContainer().firstChild;o={width:e.clientWidth,height:e.clientHeight}},onResize:function(e){"both"===p(t)?ue(t,o.width+e.deltaX,o.height+e.deltaY):ue(t,null,o.height+e.deltaY)}}),t.getParam("statusbar",!0,"boolean")){var l=y.translate(["Powered by {0}",'<a href="https://www.tiny.cloud/?utm_campaign=editor_referral&amp;utm_medium=poweredby&amp;utm_source=tinymce" rel="noopener" target="_blank" role="presentation" tabindex="-1">Tiny</a>']),u=t.getParam("branding",!0,"boolean")?{type:"label",classes:"branding",html:" "+l}:null;i.add({type:"panel",name:"statusbar",classes:"statusbar",layout:"flow",border:"1 0 0 0",ariaRoot:!0,items:[{type:"elementpath",editor:t},r,u]})}return _(t),t.on("SwitchMode",(a=i,function(e){a.find("*").disabled("readonly"===e.mode)})),i.renderBefore(n.targetNode).reflow(),t.getParam("readonly",!1,"boolean")&&t.setMode("readonly"),n.width&&ve.setStyle(i.getEl(),"width",n.width),t.on("remove",function(){i.remove(),i=null}),R(t,i),V(t),{iframeContainer:i.find("#iframe")[0].getEl(),editorContainer:i.getEl()}},xe=tinymce.util.Tools.resolve("tinymce.dom.DomQuery"),we=0,_e={id:function(){return"mceu_"+we++},create:function(e,t,n){var i=document.createElement(e);return v.DOM.setAttribs(i,t),"string"==typeof n?i.innerHTML=n:w.each(n,function(e){e.nodeType&&i.appendChild(e)}),i},createFragment:function(e){return v.DOM.createFragment(e)},getWindowSize:function(){return v.DOM.getViewPort()},getSize:function(e){var t,n;if(e.getBoundingClientRect){var i=e.getBoundingClientRect();t=Math.max(i.width||i.right-i.left,e.offsetWidth),n=Math.max(i.height||i.bottom-i.bottom,e.offsetHeight)}else t=e.offsetWidth,n=e.offsetHeight;return{width:t,height:n}},getPos:function(e,t){return v.DOM.getPos(e,t||_e.getContainer())},getContainer:function(){return de.container?de.container:document.body},getViewPort:function(e){return v.DOM.getViewPort(e)},get:function(e){return document.getElementById(e)},addClass:function(e,t){return v.DOM.addClass(e,t)},removeClass:function(e,t){return v.DOM.removeClass(e,t)},hasClass:function(e,t){return v.DOM.hasClass(e,t)},toggleClass:function(e,t,n){return v.DOM.toggleClass(e,t,n)},css:function(e,t,n){return v.DOM.setStyle(e,t,n)},getRuntimeStyle:function(e,t){return v.DOM.getStyle(e,t,!0)},on:function(e,t,n,i){return v.DOM.bind(e,t,n,i)},off:function(e,t,n){return v.DOM.unbind(e,t,n)},fire:function(e,t,n){return v.DOM.fire(e,t,n)},innerHtml:function(e,t){v.DOM.setHTML(e,t)}},Re=function(e){return"static"===_e.getRuntimeStyle(e,"position")},Ce=function(e){return e.state.get("fixed")};function Ee(e,t,n){var i,r,o,s,a,l,u,c,d,f;return d=ke(),o=(r=_e.getPos(t,O.getUiContainer(e))).x,s=r.y,Ce(e)&&Re(document.body)&&(o-=d.x,s-=d.y),i=e.getEl(),a=(f=_e.getSize(i)).width,l=f.height,u=(f=_e.getSize(t)).width,c=f.height,"b"===(n=(n||"").split(""))[0]&&(s+=c),"r"===n[1]&&(o+=u),"c"===n[0]&&(s+=Math.round(c/2)),"c"===n[1]&&(o+=Math.round(u/2)),"b"===n[3]&&(s-=l),"r"===n[4]&&(o-=a),"c"===n[3]&&(s-=Math.round(l/2)),"c"===n[4]&&(o-=Math.round(a/2)),{x:o,y:s,w:a,h:l}}var ke=function(){var e=window;return{x:Math.max(e.pageXOffset,document.body.scrollLeft,document.documentElement.scrollLeft),y:Math.max(e.pageYOffset,document.body.scrollTop,document.documentElement.scrollTop),w:e.innerWidth||document.documentElement.clientWidth,h:e.innerHeight||document.documentElement.clientHeight}},He=function(e){var t,n=O.getUiContainer(e);return n&&!Ce(e)?{x:0,y:0,w:(t=n).scrollWidth-1,h:t.scrollHeight-1}:ke()},Se={testMoveRel:function(e,t){for(var n=He(this),i=0;i<t.length;i++){var r=Ee(this,e,t[i]);if(Ce(this)){if(0<r.x&&r.x+r.w<n.w&&0<r.y&&r.y+r.h<n.h)return t[i]}else if(r.x>n.x&&r.x+r.w<n.w+n.x&&r.y>n.y&&r.y+r.h<n.h+n.y)return t[i]}return t[0]},moveRel:function(e,t){"string"!=typeof t&&(t=this.testMoveRel(e,t));var n=Ee(this,e,t);return this.moveTo(n.x,n.y)},moveBy:function(e,t){var n=this.layoutRect();return this.moveTo(n.x+e,n.y+t),this},moveTo:function(e,t){var n=this;function i(e,t,n){return e<0?0:t<e+n&&(e=t-n)<0?0:e}if(n.settings.constrainToViewport){var r=He(this),o=n.layoutRect();e=i(e,r.w+r.x,o.w),t=i(t,r.h+r.y,o.h)}var s=O.getUiContainer(n);return s&&Re(s)&&!Ce(n)&&(e-=s.scrollLeft,t-=s.scrollTop),s&&(e+=1,t+=1),n.state.get("rendered")?n.layoutRect({x:e,y:t}).repaint():(n.settings.x=e,n.settings.y=t),n.fire("move",{x:e,y:t}),n}},Te=tinymce.util.Tools.resolve("tinymce.util.Class"),Me=tinymce.util.Tools.resolve("tinymce.util.EventDispatcher"),Ne=function(e){var t;if(e)return"number"==typeof e?{top:e=e||0,left:e,bottom:e,right:e}:(1===(t=(e=e.split(" ")).length)?e[1]=e[2]=e[3]=e[0]:2===t?(e[2]=e[0],e[3]=e[1]):3===t&&(e[3]=e[1]),{top:parseInt(e[0],10)||0,right:parseInt(e[1],10)||0,bottom:parseInt(e[2],10)||0,left:parseInt(e[3],10)||0})},Pe=function(i,e){function t(e){var t=parseFloat(function(e){var t=i.ownerDocument.defaultView;if(t){var n=t.getComputedStyle(i,null);return n?(e=e.replace(/[A-Z]/g,function(e){return"-"+e}),n.getPropertyValue(e)):null}return i.currentStyle[e]}(e));return isNaN(t)?0:t}return{top:t(e+"TopWidth"),right:t(e+"RightWidth"),bottom:t(e+"BottomWidth"),left:t(e+"LeftWidth")}};function We(){}function De(e){this.cls=[],this.cls._map={},this.onchange=e||We,this.prefix=""}w.extend(De.prototype,{add:function(e){return e&&!this.contains(e)&&(this.cls._map[e]=!0,this.cls.push(e),this._change()),this},remove:function(e){if(this.contains(e)){var t=void 0;for(t=0;t<this.cls.length&&this.cls[t]!==e;t++);this.cls.splice(t,1),delete this.cls._map[e],this._change()}return this},toggle:function(e,t){var n=this.contains(e);return n!==t&&(n?this.remove(e):this.add(e),this._change()),this},contains:function(e){return!!this.cls._map[e]},_change:function(){delete this.clsValue,this.onchange.call(this)}}),De.prototype.toString=function(){var e;if(this.clsValue)return this.clsValue;e="";for(var t=0;t<this.cls.length;t++)0<t&&(e+=" "),e+=this.prefix+this.cls[t];return e};var Oe,Ae,Be,Le=/^([\w\\*]+)?(?:#([\w\-\\]+))?(?:\.([\w\\\.]+))?(?:\[\@?([\w\\]+)([\^\$\*!~]?=)([\w\\]+)\])?(?:\:(.+))?/i,ze=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,Ie=/^\s*|\s*$/g,Fe=Te.extend({init:function(e){var o=this.match;function s(e,t,n){var i;function r(e){e&&t.push(e)}return r(function(t){if(t)return t=t.toLowerCase(),function(e){return"*"===t||e.type===t}}((i=Le.exec(e.replace(Ie,"")))[1])),r(function(t){if(t)return function(e){return e._name===t}}(i[2])),r(function(n){if(n)return n=n.split("."),function(e){for(var t=n.length;t--;)if(!e.classes.contains(n[t]))return!1;return!0}}(i[3])),r(function(n,i,r){if(n)return function(e){var t=e[n]?e[n]():"";return i?"="===i?t===r:"*="===i?0<=t.indexOf(r):"~="===i?0<=(" "+t+" ").indexOf(" "+r+" "):"!="===i?t!==r:"^="===i?0===t.indexOf(r):"$="===i&&t.substr(t.length-r.length)===r:!!r}}(i[4],i[5],i[6])),r(function(i){var t;if(i)return(i=/(?:not\((.+)\))|(.+)/i.exec(i))[1]?(t=a(i[1],[]),function(e){return!o(e,t)}):(i=i[2],function(e,t,n){return"first"===i?0===t:"last"===i?t===n-1:"even"===i?t%2==0:"odd"===i?t%2==1:!!e[i]&&e[i]()})}(i[7])),t.pseudo=!!i[7],t.direct=n,t}function a(e,t){var n,i,r,o=[];do{if(ze.exec(""),(i=ze.exec(e))&&(e=i[3],o.push(i[1]),i[2])){n=i[3];break}}while(i);for(n&&a(n,t),e=[],r=0;r<o.length;r++)">"!==o[r]&&e.push(s(o[r],[],">"===o[r-1]));return t.push(e),t}this._selectors=a(e,[])},match:function(e,t){var n,i,r,o,s,a,l,u,c,d,f,h,m;for(n=0,i=(t=t||this._selectors).length;n<i;n++){for(m=e,h=0,r=(o=(s=t[n]).length)-1;0<=r;r--)for(u=s[r];m;){if(u.pseudo)for(c=d=(f=m.parent().items()).length;c--&&f[c]!==m;);for(a=0,l=u.length;a<l;a++)if(!u[a](m,c,d)){a=l+1;break}if(a===l){h++;break}if(r===o-1)break;m=m.parent()}if(h===o)return!0}return!1},find:function(e){var t,n,u=[],i=this._selectors;function c(e,t,n){var i,r,o,s,a,l=t[n];for(i=0,r=e.length;i<r;i++){for(a=e[i],o=0,s=l.length;o<s;o++)if(!l[o](a,i,r)){o=s+1;break}if(o===s)n===t.length-1?u.push(a):a.items&&c(a.items(),t,n+1);else if(l.direct)return;a.items&&c(a.items(),t,n)}}if(e.items){for(t=0,n=i.length;t<n;t++)c(e.items(),i[t],0);1<n&&(u=function(e){for(var t,n=[],i=e.length;i--;)(t=e[i]).__checked||(n.push(t),t.__checked=1);for(i=n.length;i--;)delete n[i].__checked;return n}(u))}return Oe||(Oe=Fe.Collection),new Oe(u)}}),Ue=Array.prototype.push,Ve=Array.prototype.slice;Be={length:0,init:function(e){e&&this.add(e)},add:function(e){return w.isArray(e)?Ue.apply(this,e):e instanceof Ae?this.add(e.toArray()):Ue.call(this,e),this},set:function(e){var t,n=this,i=n.length;for(n.length=0,n.add(e),t=n.length;t<i;t++)delete n[t];return n},filter:function(t){var e,n,i,r,o=[];for("string"==typeof t?(t=new Fe(t),r=function(e){return t.match(e)}):r=t,e=0,n=this.length;e<n;e++)r(i=this[e])&&o.push(i);return new Ae(o)},slice:function(){return new Ae(Ve.apply(this,arguments))},eq:function(e){return-1===e?this.slice(e):this.slice(e,+e+1)},each:function(e){return w.each(this,e),this},toArray:function(){return w.toArray(this)},indexOf:function(e){for(var t=this.length;t--&&this[t]!==e;);return t},reverse:function(){return new Ae(w.toArray(this).reverse())},hasClass:function(e){return!!this[0]&&this[0].classes.contains(e)},prop:function(t,n){var e;return n!==undefined?(this.each(function(e){e[t]&&e[t](n)}),this):(e=this[0])&&e[t]?e[t]():void 0},exec:function(t){var n=w.toArray(arguments).slice(1);return this.each(function(e){e[t]&&e[t].apply(e,n)}),this},remove:function(){for(var e=this.length;e--;)this[e].remove();return this},addClass:function(t){return this.each(function(e){e.classes.add(t)})},removeClass:function(t){return this.each(function(e){e.classes.remove(t)})}},w.each("fire on off show hide append prepend before after reflow".split(" "),function(n){Be[n]=function(){var t=w.toArray(arguments);return this.each(function(e){n in e&&e[n].apply(e,t)}),this}}),w.each("text name disabled active selected checked visible parent value data".split(" "),function(t){Be[t]=function(e){return this.prop(t,e)}}),Ae=Te.extend(Be);var Ye=Fe.Collection=Ae,$e=function(e){this.create=e.create};$e.create=function(r,o){return new $e({create:function(t,n){var i,e=function(e){t.set(n,e.value)};return t.on("change:"+n,function(e){r.set(o,e.value)}),r.on("change:"+o,e),(i=t._bindings)||(i=t._bindings=[],t.on("destroy",function(){for(var e=i.length;e--;)i[e]()})),i.push(function(){r.off("change:"+o,e)}),r.get(o)}})};var qe=tinymce.util.Tools.resolve("tinymce.util.Observable");function Xe(e){return 0<e.nodeType}var je,Je,Ge=Te.extend({Mixins:[qe],init:function(e){var t,n;for(t in e=e||{})(n=e[t])instanceof $e&&(e[t]=n.create(this,t));this.data=e},set:function(t,n){var i,r,o=this.data[t];if(n instanceof $e&&(n=n.create(this,t)),"object"==typeof t){for(i in t)this.set(i,t[i]);return this}return function e(t,n){var i,r;if(t===n)return!0;if(null===t||null===n)return t===n;if("object"!=typeof t||"object"!=typeof n)return t===n;if(w.isArray(n)){if(t.length!==n.length)return!1;for(i=t.length;i--;)if(!e(t[i],n[i]))return!1}if(Xe(t)||Xe(n))return t===n;for(i in r={},n){if(!e(t[i],n[i]))return!1;r[i]=!0}for(i in t)if(!r[i]&&!e(t[i],n[i]))return!1;return!0}(o,n)||(this.data[t]=n,r={target:this,name:t,value:n,oldValue:o},this.fire("change:"+t,r),this.fire("change",r)),this},get:function(e){return this.data[e]},has:function(e){return e in this.data},bind:function(e){return $e.create(this,e)},destroy:function(){this.fire("destroy")}}),Ke={},Ze={add:function(e){var t=e.parent();if(t){if(!t._layout||t._layout.isNative())return;Ke[t._id]||(Ke[t._id]=t),je||(je=!0,u.requestAnimationFrame(function(){var e,t;for(e in je=!1,Ke)(t=Ke[e]).state.get("rendered")&&t.reflow();Ke={}},document.body))}},remove:function(e){Ke[e._id]&&delete Ke[e._id]}},Qe="onmousewheel"in document,et=!1,tt=0,nt={Statics:{classPrefix:"mce-"},isRtl:function(){return Je.rtl},classPrefix:"mce-",init:function(t){var e,n,i=this;function r(e){var t;for(e=e.split(" "),t=0;t<e.length;t++)i.classes.add(e[t])}i.settings=t=w.extend({},i.Defaults,t),i._id=t.id||"mceu_"+tt++,i._aria={role:t.role},i._elmCache={},i.$=xe,i.state=new Ge({visible:!0,active:!1,disabled:!1,value:""}),i.data=new Ge(t.data),i.classes=new De(function(){i.state.get("rendered")&&(i.getEl().className=this.toString())}),i.classes.prefix=i.classPrefix,(e=t.classes)&&(i.Defaults&&(n=i.Defaults.classes)&&e!==n&&r(n),r(e)),w.each("title text name visible disabled active value".split(" "),function(e){e in t&&i[e](t[e])}),i.on("click",function(){if(i.disabled())return!1}),i.settings=t,i.borderBox=Ne(t.border),i.paddingBox=Ne(t.padding),i.marginBox=Ne(t.margin),t.hidden&&i.hide()},Properties:"parent,name",getContainerElm:function(){var e=O.getUiContainer(this);return e||_e.getContainer()},getParentCtrl:function(e){for(var t,n=this.getRoot().controlIdLookup;e&&n&&!(t=n[e.id]);)e=e.parentNode;return t},initLayoutRect:function(){var e,t,n,i,r,o,s,a,l,u,c=this,d=c.settings,f=c.getEl();e=c.borderBox=c.borderBox||Pe(f,"border"),c.paddingBox=c.paddingBox||Pe(f,"padding"),c.marginBox=c.marginBox||Pe(f,"margin"),u=_e.getSize(f),a=d.minWidth,l=d.minHeight,r=a||u.width,o=l||u.height,n=d.width,i=d.height,s=void 0!==(s=d.autoResize)?s:!n&&!i,n=n||r,i=i||o;var h=e.left+e.right,m=e.top+e.bottom,g=d.maxWidth||65535,p=d.maxHeight||65535;return c._layoutRect=t={x:d.x||0,y:d.y||0,w:n,h:i,deltaW:h,deltaH:m,contentW:n-h,contentH:i-m,innerW:n-h,innerH:i-m,startMinWidth:a||0,startMinHeight:l||0,minW:Math.min(r,g),minH:Math.min(o,p),maxW:g,maxH:p,autoResize:s,scrollW:0},c._lastLayoutRect={},t},layoutRect:function(e){var t,n,i,r,o,s=this,a=s._layoutRect;return a||(a=s.initLayoutRect()),e?(i=a.deltaW,r=a.deltaH,e.x!==undefined&&(a.x=e.x),e.y!==undefined&&(a.y=e.y),e.minW!==undefined&&(a.minW=e.minW),e.minH!==undefined&&(a.minH=e.minH),(n=e.w)!==undefined&&(n=(n=n<a.minW?a.minW:n)>a.maxW?a.maxW:n,a.w=n,a.innerW=n-i),(n=e.h)!==undefined&&(n=(n=n<a.minH?a.minH:n)>a.maxH?a.maxH:n,a.h=n,a.innerH=n-r),(n=e.innerW)!==undefined&&(n=(n=n<a.minW-i?a.minW-i:n)>a.maxW-i?a.maxW-i:n,a.innerW=n,a.w=n+i),(n=e.innerH)!==undefined&&(n=(n=n<a.minH-r?a.minH-r:n)>a.maxH-r?a.maxH-r:n,a.innerH=n,a.h=n+r),e.contentW!==undefined&&(a.contentW=e.contentW),e.contentH!==undefined&&(a.contentH=e.contentH),(t=s._lastLayoutRect).x===a.x&&t.y===a.y&&t.w===a.w&&t.h===a.h||((o=Je.repaintControls)&&o.map&&!o.map[s._id]&&(o.push(s),o.map[s._id]=!0),t.x=a.x,t.y=a.y,t.w=a.w,t.h=a.h),s):a},repaint:function(){var e,t,n,i,r,o,s,a,l,u,c=this;l=document.createRange?function(e){return e}:Math.round,e=c.getEl().style,i=c._layoutRect,a=c._lastRepaintRect||{},o=(r=c.borderBox).left+r.right,s=r.top+r.bottom,i.x!==a.x&&(e.left=l(i.x)+"px",a.x=i.x),i.y!==a.y&&(e.top=l(i.y)+"px",a.y=i.y),i.w!==a.w&&(u=l(i.w-o),e.width=(0<=u?u:0)+"px",a.w=i.w),i.h!==a.h&&(u=l(i.h-s),e.height=(0<=u?u:0)+"px",a.h=i.h),c._hasBody&&i.innerW!==a.innerW&&(u=l(i.innerW),(n=c.getEl("body"))&&((t=n.style).width=(0<=u?u:0)+"px"),a.innerW=i.innerW),c._hasBody&&i.innerH!==a.innerH&&(u=l(i.innerH),(n=n||c.getEl("body"))&&((t=t||n.style).height=(0<=u?u:0)+"px"),a.innerH=i.innerH),c._lastRepaintRect=a,c.fire("repaint",{},!1)},updateLayoutRect:function(){var e=this;e.parent()._lastRect=null,_e.css(e.getEl(),{width:"",height:""}),e._layoutRect=e._lastRepaintRect=e._lastLayoutRect=null,e.initLayoutRect()},on:function(e,t){var n,i,r,o=this;return it(o).on(e,"string"!=typeof(n=t)?n:function(e){return i||o.parentsAndSelf().each(function(e){var t=e.settings.callbacks;if(t&&(i=t[n]))return r=e,!1}),i?i.call(r,e):(e.action=n,void this.fire("execute",e))}),o},off:function(e,t){return it(this).off(e,t),this},fire:function(e,t,n){if((t=t||{}).control||(t.control=this),t=it(this).fire(e,t),!1!==n&&this.parent)for(var i=this.parent();i&&!t.isPropagationStopped();)i.fire(e,t,!1),i=i.parent();return t},hasEventListeners:function(e){return it(this).has(e)},parents:function(e){var t,n=new Ye;for(t=this.parent();t;t=t.parent())n.add(t);return e&&(n=n.filter(e)),n},parentsAndSelf:function(e){return new Ye(this).add(this.parents(e))},next:function(){var e=this.parent().items();return e[e.indexOf(this)+1]},prev:function(){var e=this.parent().items();return e[e.indexOf(this)-1]},innerHtml:function(e){return this.$el.html(e),this},getEl:function(e){var t=e?this._id+"-"+e:this._id;return this._elmCache[t]||(this._elmCache[t]=xe("#"+t)[0]),this._elmCache[t]},show:function(){return this.visible(!0)},hide:function(){return this.visible(!1)},focus:function(){try{this.getEl().focus()}catch(e){}return this},blur:function(){return this.getEl().blur(),this},aria:function(e,t){var n=this,i=n.getEl(n.ariaTarget);return void 0===t?n._aria[e]:(n._aria[e]=t,n.state.get("rendered")&&i.setAttribute("role"===e?e:"aria-"+e,t),n)},encode:function(e,t){return!1!==t&&(e=this.translate(e)),(e||"").replace(/[&<>"]/g,function(e){return"&#"+e.charCodeAt(0)+";"})},translate:function(e){return Je.translate?Je.translate(e):e},before:function(e){var t=this.parent();return t&&t.insert(e,t.items().indexOf(this),!0),this},after:function(e){var t=this.parent();return t&&t.insert(e,t.items().indexOf(this)),this},remove:function(){var t,e,n=this,i=n.getEl(),r=n.parent();if(n.items){var o=n.items().toArray();for(e=o.length;e--;)o[e].remove()}r&&r.items&&(t=[],r.items().each(function(e){e!==n&&t.push(e)}),r.items().set(t),r._lastRect=null),n._eventsRoot&&n._eventsRoot===n&&xe(i).off();var s=n.getRoot().controlIdLookup;return s&&delete s[n._id],i&&i.parentNode&&i.parentNode.removeChild(i),n.state.set("rendered",!1),n.state.destroy(),n.fire("remove"),n},renderBefore:function(e){return xe(e).before(this.renderHtml()),this.postRender(),this},renderTo:function(e){return xe(e||this.getContainerElm()).append(this.renderHtml()),this.postRender(),this},preRender:function(){},render:function(){},renderHtml:function(){return'<div id="'+this._id+'" class="'+this.classes+'"></div>'},postRender:function(){var e,t,n,i,r,o=this,s=o.settings;for(i in o.$el=xe(o.getEl()),o.state.set("rendered",!0),s)0===i.indexOf("on")&&o.on(i.substr(2),s[i]);if(o._eventsRoot){for(n=o.parent();!r&&n;n=n.parent())r=n._eventsRoot;if(r)for(i in r._nativeEvents)o._nativeEvents[i]=!0}rt(o),s.style&&(e=o.getEl())&&(e.setAttribute("style",s.style),e.style.cssText=s.style),o.settings.border&&(t=o.borderBox,o.$el.css({"border-top-width":t.top,"border-right-width":t.right,"border-bottom-width":t.bottom,"border-left-width":t.left}));var a=o.getRoot();for(var l in a.controlIdLookup||(a.controlIdLookup={}),(a.controlIdLookup[o._id]=o)._aria)o.aria(l,o._aria[l]);!1===o.state.get("visible")&&(o.getEl().style.display="none"),o.bindStates(),o.state.on("change:visible",function(e){var t,n=e.value;o.state.get("rendered")&&(o.getEl().style.display=!1===n?"none":"",o.getEl().getBoundingClientRect()),(t=o.parent())&&(t._lastRect=null),o.fire(n?"show":"hide"),Ze.add(o)}),o.fire("postrender",{},!1)},bindStates:function(){},scrollIntoView:function(e){var t,n,i,r,o,s,a=this.getEl(),l=a.parentNode,u=function(e,t){var n,i,r=e;for(n=i=0;r&&r!==t&&r.nodeType;)n+=r.offsetLeft||0,i+=r.offsetTop||0,r=r.offsetParent;return{x:n,y:i}}(a,l);return t=u.x,n=u.y,i=a.offsetWidth,r=a.offsetHeight,o=l.clientWidth,s=l.clientHeight,"end"===e?(t-=o-i,n-=s-r):"center"===e&&(t-=o/2-i/2,n-=s/2-r/2),l.scrollLeft=t,l.scrollTop=n,this},getRoot:function(){for(var e,t=this,n=[];t;){if(t.rootControl){e=t.rootControl;break}n.push(t),t=(e=t).parent()}e||(e=this);for(var i=n.length;i--;)n[i].rootControl=e;return e},reflow:function(){Ze.remove(this);var e=this.parent();return e&&e._layout&&!e._layout.isNative()&&e.reflow(),this}};function it(n){return n._eventDispatcher||(n._eventDispatcher=new Me({scope:n,toggleEvent:function(e,t){t&&Me.isNative(e)&&(n._nativeEvents||(n._nativeEvents={}),n._nativeEvents[e]=!0,n.state.get("rendered")&&rt(n))}})),n._eventDispatcher}function rt(a){var e,t,n,l,i,r;function o(e){var t=a.getParentCtrl(e.target);t&&t.fire(e.type,e)}function s(){var e=l._lastHoverCtrl;e&&(e.fire("mouseleave",{target:e.getEl()}),e.parents().each(function(e){e.fire("mouseleave",{target:e.getEl()})}),l._lastHoverCtrl=null)}function u(e){var t,n,i,r=a.getParentCtrl(e.target),o=l._lastHoverCtrl,s=0;if(r!==o){if((n=(l._lastHoverCtrl=r).parents().toArray().reverse()).push(r),o){for((i=o.parents().toArray().reverse()).push(o),s=0;s<i.length&&n[s]===i[s];s++);for(t=i.length-1;s<=t;t--)(o=i[t]).fire("mouseleave",{target:o.getEl()})}for(t=s;t<n.length;t++)(r=n[t]).fire("mouseenter",{target:r.getEl()})}}function c(e){e.preventDefault(),"mousewheel"===e.type?(e.deltaY=-.025*e.wheelDelta,e.wheelDeltaX&&(e.deltaX=-.025*e.wheelDeltaX)):(e.deltaX=0,e.deltaY=e.detail),e=a.fire("wheel",e)}if(i=a._nativeEvents){for((n=a.parents().toArray()).unshift(a),e=0,t=n.length;!l&&e<t;e++)l=n[e]._eventsRoot;for(l||(l=n[n.length-1]||a),a._eventsRoot=l,t=e,e=0;e<t;e++)n[e]._eventsRoot=l;var d=l._delegates;for(r in d||(d=l._delegates={}),i){if(!i)return!1;"wheel"!==r||et?("mouseenter"===r||"mouseleave"===r?l._hasMouseEnter||(xe(l.getEl()).on("mouseleave",s).on("mouseover",u),l._hasMouseEnter=1):d[r]||(xe(l.getEl()).on(r,o),d[r]=!0),i[r]=!1):Qe?xe(a.getEl()).on("mousewheel",c):xe(a.getEl()).on("DOMMouseScroll",c)}}}w.each("text title visible disabled active value".split(" "),function(t){nt[t]=function(e){return 0===arguments.length?this.state.get(t):(void 0!==e&&this.state.set(t,e),this)}});var ot=Je=Te.extend(nt),st=function(e){return!!e.getAttribute("data-mce-tabstop")};function at(e){var o,r,n=e.root;function i(e){return e&&1===e.nodeType}try{o=document.activeElement}catch(t){o=document.body}function s(e){return i(e=e||o)?e.getAttribute("role"):null}function a(e){for(var t,n=e||o;n=n.parentNode;)if(t=s(n))return t}function l(e){var t=o;if(i(t))return t.getAttribute("aria-"+e)}function u(e){var t=e.tagName.toUpperCase();return"INPUT"===t||"TEXTAREA"===t||"SELECT"===t}function c(t){var r=[];return function e(t){if(1===t.nodeType&&"none"!==t.style.display&&!t.disabled){var n;(u(n=t)&&!n.hidden||st(n)||/^(button|menuitem|checkbox|tab|menuitemcheckbox|option|gridcell|slider)$/.test(s(n)))&&r.push(t);for(var i=0;i<t.childNodes.length;i++)e(t.childNodes[i])}}(t||n.getEl()),r}function d(e){var t,n;(n=(e=e||r).parents().toArray()).unshift(e);for(var i=0;i<n.length&&!(t=n[i]).settings.ariaRoot;i++);return t}function f(e,t){return e<0?e=t.length-1:e>=t.length&&(e=0),t[e]&&t[e].focus(),e}function h(e,t){var n=-1,i=d();t=t||c(i.getEl());for(var r=0;r<t.length;r++)t[r]===o&&(n=r);n+=e,i.lastAriaIndex=f(n,t)}function m(){"tablist"===a()?h(-1,c(o.parentNode)):r.parent().submenu?b():h(-1)}function g(){var e=s(),t=a();"tablist"===t?h(1,c(o.parentNode)):"menuitem"===e&&"menu"===t&&l("haspopup")?y():h(1)}function p(){h(-1)}function v(){var e=s(),t=a();"menuitem"===e&&"menubar"===t?y():"button"===e&&l("haspopup")?y({key:"down"}):h(1)}function b(){r.fire("cancel")}function y(e){e=e||{},r.fire("click",{target:o,aria:e})}return r=n.getParentCtrl(o),n.on("keydown",function(e){function t(e,t){u(o)||st(o)||"slider"!==s(o)&&!1!==t(e)&&e.preventDefault()}if(!e.isDefaultPrevented())switch(e.keyCode){case 37:t(e,m);break;case 39:t(e,g);break;case 38:t(e,p);break;case 40:t(e,v);break;case 27:b();break;case 14:case 13:case 32:t(e,y);break;case 9:!function(e){if("tablist"===a()){var t=c(r.getEl("body"))[0];t&&t.focus()}else h(e.shiftKey?-1:1)}(e),e.preventDefault()}}),n.on("focusin",function(e){o=e.target,r=e.control}),{focusFirst:function(e){var t=d(e),n=c(t.getEl());t.settings.ariaRemember&&"lastAriaIndex"in t?f(t.lastAriaIndex,n):f(0,n)}}}var lt={},ut=ot.extend({init:function(e){var t=this;t._super(e),(e=t.settings).fixed&&t.state.set("fixed",!0),t._items=new Ye,t.isRtl()&&t.classes.add("rtl"),t.bodyClasses=new De(function(){t.state.get("rendered")&&(t.getEl("body").className=this.toString())}),t.bodyClasses.prefix=t.classPrefix,t.classes.add("container"),t.bodyClasses.add("container-body"),e.containerCls&&t.classes.add(e.containerCls),t._layout=b.create((e.layout||"")+"layout"),t.settings.items?t.add(t.settings.items):t.add(t.render()),t._hasBody=!0},items:function(){return this._items},find:function(e){return(e=lt[e]=lt[e]||new Fe(e)).find(this)},add:function(e){return this.items().add(this.create(e)).parent(this),this},focus:function(e){var t,n,i,r=this;if(!e||!(n=r.keyboardNav||r.parents().eq(-1)[0].keyboardNav))return i=r.find("*"),r.statusbar&&i.add(r.statusbar.items()),i.each(function(e){if(e.settings.autofocus)return t=null,!1;e.canFocus&&(t=t||e)}),t&&t.focus(),r;n.focusFirst(r)},replace:function(e,t){for(var n,i=this.items(),r=i.length;r--;)if(i[r]===e){i[r]=t;break}0<=r&&((n=t.getEl())&&n.parentNode.removeChild(n),(n=e.getEl())&&n.parentNode.removeChild(n)),t.parent(this)},create:function(e){var t,n=this,i=[];return w.isArray(e)||(e=[e]),w.each(e,function(e){e&&(e instanceof ot||("string"==typeof e&&(e={type:e}),t=w.extend({},n.settings.defaults,e),e.type=t.type=t.type||e.type||n.settings.defaultType||(t.defaults?t.defaults.type:null),e=b.create(t)),i.push(e))}),i},renderNew:function(){var i=this;return i.items().each(function(e,t){var n;e.parent(i),e.state.get("rendered")||((n=i.getEl("body")).hasChildNodes()&&t<=n.childNodes.length-1?xe(n.childNodes[t]).before(e.renderHtml()):xe(n).append(e.renderHtml()),e.postRender(),Ze.add(e))}),i._layout.applyClasses(i.items().filter(":visible")),i._lastRect=null,i},append:function(e){return this.add(e).renderNew()},prepend:function(e){return this.items().set(this.create(e).concat(this.items().toArray())),this.renderNew()},insert:function(e,t,n){var i,r,o;return e=this.create(e),i=this.items(),!n&&t<i.length-1&&(t+=1),0<=t&&t<i.length&&(r=i.slice(0,t).toArray(),o=i.slice(t).toArray(),i.set(r.concat(e,o))),this.renderNew()},fromJSON:function(e){for(var t in e)this.find("#"+t).value(e[t]);return this},toJSON:function(){var i={};return this.find("*").each(function(e){var t=e.name(),n=e.value();t&&void 0!==n&&(i[t]=n)}),i},renderHtml:function(){var e=this,t=e._layout,n=this.settings.role;return e.preRender(),t.preRender(e),'<div id="'+e._id+'" class="'+e.classes+'"'+(n?' role="'+this.settings.role+'"':"")+'><div id="'+e._id+'-body" class="'+e.bodyClasses+'">'+(e.settings.html||"")+t.renderHtml(e)+"</div></div>"},postRender:function(){var e,t=this;return t.items().exec("postRender"),t._super(),t._layout.postRender(t),t.state.set("rendered",!0),t.settings.style&&t.$el.css(t.settings.style),t.settings.border&&(e=t.borderBox,t.$el.css({"border-top-width":e.top,"border-right-width":e.right,"border-bottom-width":e.bottom,"border-left-width":e.left})),t.parent()||(t.keyboardNav=at({root:t})),t},initLayoutRect:function(){var e=this._super();return this._layout.recalc(this),e},recalc:function(){var e=this,t=e._layoutRect,n=e._lastRect;if(!n||n.w!==t.w||n.h!==t.h)return e._layout.recalc(e),t=e.layoutRect(),e._lastRect={x:t.x,y:t.y,w:t.w,h:t.h},!0},reflow:function(){var e;if(Ze.remove(this),this.visible()){for(ot.repaintControls=[],ot.repaintControls.map={},this.recalc(),e=ot.repaintControls.length;e--;)ot.repaintControls[e].repaint();"flow"!==this.settings.layout&&"stack"!==this.settings.layout&&this.repaint(),ot.repaintControls=[]}return this}});function ct(e){var t,n;if(e.changedTouches)for(t="screenX screenY pageX pageY clientX clientY".split(" "),n=0;n<t.length;n++)e[t[n]]=e.changedTouches[0][t[n]]}function dt(e,h){var m,g,t,p,v,b,y,x=h.document||document;h=h||{};var w=x.getElementById(h.handle||e);t=function(e){var t,n,i,r,o,s,a,l,u,c,d,f=(t=x,u=Math.max,n=t.documentElement,i=t.body,r=u(n.scrollWidth,i.scrollWidth),o=u(n.clientWidth,i.clientWidth),s=u(n.offsetWidth,i.offsetWidth),a=u(n.scrollHeight,i.scrollHeight),l=u(n.clientHeight,i.clientHeight),{width:r<s?o:r,height:a<u(n.offsetHeight,i.offsetHeight)?l:a});ct(e),e.preventDefault(),g=e.button,c=w,b=e.screenX,y=e.screenY,d=window.getComputedStyle?window.getComputedStyle(c,null).getPropertyValue("cursor"):c.runtimeStyle.cursor,m=xe("<div></div>").css({position:"absolute",top:0,left:0,width:f.width,height:f.height,zIndex:2147483647,opacity:1e-4,cursor:d}).appendTo(x.body),xe(x).on("mousemove touchmove",v).on("mouseup touchend",p),h.start(e)},v=function(e){if(ct(e),e.button!==g)return p(e);e.deltaX=e.screenX-b,e.deltaY=e.screenY-y,e.preventDefault(),h.drag(e)},p=function(e){ct(e),xe(x).off("mousemove touchmove",v).off("mouseup touchend",p),m.remove(),h.stop&&h.stop(e)},this.destroy=function(){xe(w).off()},xe(w).on("mousedown touchstart",t)}var ft,ht,mt,gt,pt={init:function(){this.on("repaint",this.renderScroll)},renderScroll:function(){var p=this,v=2;function n(){var m,g,e;function t(e,t,n,i,r,o){var s,a,l,u,c,d,f,h;if(a=p.getEl("scroll"+e)){if(f=t.toLowerCase(),h=n.toLowerCase(),xe(p.getEl("absend")).css(f,p.layoutRect()[i]-1),!r)return void xe(a).css("display","none");xe(a).css("display","block"),s=p.getEl("body"),l=p.getEl("scroll"+e+"t"),u=s["client"+n]-2*v,c=(u-=m&&g?a["client"+o]:0)/s["scroll"+n],(d={})[f]=s["offset"+t]+v,d[h]=u,xe(a).css(d),(d={})[f]=s["scroll"+t]*c,d[h]=u*c,xe(l).css(d)}}e=p.getEl("body"),m=e.scrollWidth>e.clientWidth,g=e.scrollHeight>e.clientHeight,t("h","Left","Width","contentW",m,"Height"),t("v","Top","Height","contentH",g,"Width")}p.settings.autoScroll&&(p._hasScroll||(p._hasScroll=!0,function(){function e(s,a,l,u,c){var d,e=p._id+"-scroll"+s,t=p.classPrefix;xe(p.getEl()).append('<div id="'+e+'" class="'+t+"scrollbar "+t+"scrollbar-"+s+'"><div id="'+e+'t" class="'+t+'scrollbar-thumb"></div></div>'),p.draghelper=new dt(e+"t",{start:function(){d=p.getEl("body")["scroll"+a],xe("#"+e).addClass(t+"active")},drag:function(e){var t,n,i,r,o=p.layoutRect();n=o.contentW>o.innerW,i=o.contentH>o.innerH,r=p.getEl("body")["client"+l]-2*v,t=(r-=n&&i?p.getEl("scroll"+s)["client"+c]:0)/p.getEl("body")["scroll"+l],p.getEl("body")["scroll"+a]=d+e["delta"+u]/t},stop:function(){xe("#"+e).removeClass(t+"active")}})}p.classes.add("scroll"),e("v","Top","Height","Y","Width"),e("h","Left","Width","X","Height")}(),p.on("wheel",function(e){var t=p.getEl("body");t.scrollLeft+=10*(e.deltaX||0),t.scrollTop+=10*e.deltaY,n()}),xe(p.getEl("body")).on("scroll",n)),n())}},vt=ut.extend({Defaults:{layout:"fit",containerCls:"panel"},Mixins:[pt],renderHtml:function(){var e=this,t=e._layout,n=e.settings.html;return e.preRender(),t.preRender(e),void 0===n?n='<div id="'+e._id+'-body" class="'+e.bodyClasses+'">'+t.renderHtml(e)+"</div>":("function"==typeof n&&(n=n.call(e)),e._hasBody=!1),'<div id="'+e._id+'" class="'+e.classes+'" hidefocus="1" tabindex="-1" role="group">'+(e._preBodyHtml||"")+n+"</div>"}}),bt={resizeToContent:function(){this._layoutRect.autoResize=!0,this._lastRect=null,this.reflow()},resizeTo:function(e,t){if(e<=1||t<=1){var n=_e.getWindowSize();e=e<=1?e*n.w:e,t=t<=1?t*n.h:t}return this._layoutRect.autoResize=!1,this.layoutRect({minW:e,minH:t,w:e,h:t}).reflow()},resizeBy:function(e,t){var n=this.layoutRect();return this.resizeTo(n.w+e,n.h+t)}},yt=[],xt=[];function wt(e,t){for(;e;){if(e===t)return!0;e=e.parent()}}function _t(){ft||(ft=function(e){2!==e.button&&function(e){for(var t=yt.length;t--;){var n=yt[t],i=n.getParentCtrl(e.target);if(n.settings.autohide){if(i&&(wt(i,n)||n.parent()===i))continue;(e=n.fire("autohide",{target:e.target})).isDefaultPrevented()||n.hide()}}}(e)},xe(document).on("click touchstart",ft))}function Rt(r){var e=_e.getViewPort().y;function t(e,t){for(var n,i=0;i<yt.length;i++)if(yt[i]!==r)for(n=yt[i].parent();n&&(n=n.parent());)n===r&&yt[i].fixed(e).moveBy(0,t).repaint()}r.settings.autofix&&(r.state.get("fixed")?r._autoFixY>e&&(r.fixed(!1).layoutRect({y:r._autoFixY}).repaint(),t(!1,r._autoFixY-e)):(r._autoFixY=r.layoutRect().y,r._autoFixY<e&&(r.fixed(!0).layoutRect({y:0}).repaint(),t(!0,e-r._autoFixY))))}function Ct(e,t){var n,i,r=Et.zIndex||65535;if(e)xt.push(t);else for(n=xt.length;n--;)xt[n]===t&&xt.splice(n,1);if(xt.length)for(n=0;n<xt.length;n++)xt[n].modal&&(r++,i=xt[n]),xt[n].getEl().style.zIndex=r,xt[n].zIndex=r,r++;var o=xe("#"+t.classPrefix+"modal-block",t.getContainerElm())[0];i?xe(o).css("z-index",i.zIndex-1):o&&(o.parentNode.removeChild(o),gt=!1),Et.currentZIndex=r}var Et=vt.extend({Mixins:[Se,bt],init:function(e){var i=this;i._super(e),(i._eventsRoot=i).classes.add("floatpanel"),e.autohide&&(_t(),function(){if(!mt){var e=document.documentElement,t=e.clientWidth,n=e.clientHeight;mt=function(){document.all&&t===e.clientWidth&&n===e.clientHeight||(t=e.clientWidth,n=e.clientHeight,Et.hideAll())},xe(window).on("resize",mt)}}(),yt.push(i)),e.autofix&&(ht||(ht=function(){var e;for(e=yt.length;e--;)Rt(yt[e])},xe(window).on("scroll",ht)),i.on("move",function(){Rt(this)})),i.on("postrender show",function(e){if(e.control===i){var t,n=i.classPrefix;i.modal&&!gt&&((t=xe("#"+n+"modal-block",i.getContainerElm()))[0]||(t=xe('<div id="'+n+'modal-block" class="'+n+"reset "+n+'fade"></div>').appendTo(i.getContainerElm())),u.setTimeout(function(){t.addClass(n+"in"),xe(i.getEl()).addClass(n+"in")}),gt=!0),Ct(!0,i)}}),i.on("show",function(){i.parents().each(function(e){if(e.state.get("fixed"))return i.fixed(!0),!1})}),e.popover&&(i._preBodyHtml='<div class="'+i.classPrefix+'arrow"></div>',i.classes.add("popover").add("bottom").add(i.isRtl()?"end":"start")),i.aria("label",e.ariaLabel),i.aria("labelledby",i._id),i.aria("describedby",i.describedBy||i._id+"-none")},fixed:function(e){var t=this;if(t.state.get("fixed")!==e){if(t.state.get("rendered")){var n=_e.getViewPort();e?t.layoutRect().y-=n.y:t.layoutRect().y+=n.y}t.classes.toggle("fixed",e),t.state.set("fixed",e)}return t},show:function(){var e,t=this._super();for(e=yt.length;e--&&yt[e]!==this;);return-1===e&&yt.push(this),t},hide:function(){return kt(this),Ct(!1,this),this._super()},hideAll:function(){Et.hideAll()},close:function(){return this.fire("close").isDefaultPrevented()||(this.remove(),Ct(!1,this)),this},remove:function(){kt(this),this._super()},postRender:function(){return this.settings.bodyRole&&this.getEl("body").setAttribute("role",this.settings.bodyRole),this._super()}});function kt(e){var t;for(t=yt.length;t--;)yt[t]===e&&yt.splice(t,1);for(t=xt.length;t--;)xt[t]===e&&xt.splice(t,1)}Et.hideAll=function(){for(var e=yt.length;e--;){var t=yt[e];t&&t.settings.autohide&&(t.hide(),yt.splice(e,1))}};var Ht=function(s,n,e){var a,i,l=v.DOM,t=s.getParam("fixed_toolbar_container");t&&(i=l.select(t)[0]);var r=function(){if(a&&a.moveRel&&a.visible()&&!a._fixed){var e=s.selection.getScrollContainer(),t=s.getBody(),n=0,i=0;if(e){var r=l.getPos(t),o=l.getPos(e);n=Math.max(0,o.x-r.x),i=Math.max(0,o.y-r.y)}a.fixed(!1).moveRel(t,s.rtl?["tr-br","br-tr"]:["tl-bl","bl-tl","tr-br"]).moveBy(n,i)}},o=function(){a&&(a.show(),r(),l.addClass(s.getBody(),"mce-edit-focus"))},u=function(){a&&(a.hide(),Et.hideAll(),l.removeClass(s.getBody(),"mce-edit-focus"))},c=function(){var e,t;a?a.visible()||o():(a=n.panel=b.create({type:i?"panel":"floatpanel",role:"application",classes:"tinymce tinymce-inline",layout:"flex",direction:"column",align:"stretch",autohide:!1,autofix:!0,fixed:(e=i,t=s,!(!e||t.settings.ui_container)),border:1,items:[!1===d(s)?null:{type:"menubar",border:"0 0 1 0",items:oe(s)},L(s,f(s))]}),O.setUiContainer(s,a),_(s),i?a.renderTo(i).reflow():a.renderTo().reflow(),R(s,a),o(),V(s),s.on("nodeChange",r),s.on("ResizeWindow",r),s.on("activate",o),s.on("deactivate",u),s.nodeChanged())};return s.settings.content_editable=!0,s.on("focus",function(){!1===g(s)&&e.skinUiCss?l.styleSheetLoader.load(e.skinUiCss,c,c):c()}),s.on("blur hide",u),s.on("remove",function(){a&&(a.remove(),a=null)}),!1===g(s)&&e.skinUiCss?l.styleSheetLoader.load(e.skinUiCss,pe(s)):pe(s)(),{}};function St(i,r){var o,s,a=this,l=ot.classPrefix;a.show=function(e,t){function n(){o&&(xe(i).append('<div class="'+l+"throbber"+(r?" "+l+"throbber-inline":"")+'"></div>'),t&&t())}return a.hide(),o=!0,e?s=u.setTimeout(n,e):n(),a},a.hide=function(){var e=i.lastChild;return u.clearTimeout(s),e&&-1!==e.className.indexOf("throbber")&&e.parentNode.removeChild(e),o=!1,a}}var Tt=function(e,t){var n;e.on("ProgressState",function(e){n=n||new St(t.panel.getEl("body")),e.state?n.show(e.time):n.hide()})},Mt=function(e,t,n){var i=function(e){var t=e.settings,n=t.skin,i=t.skin_url;if(!1!==n){var r=n||"lightgray";i=i?e.documentBaseURI.toAbsolute(i):h.baseURL+"/skins/"+r}return i}(e);return i&&(n.skinUiCss=i+"/skin.min.css",e.contentCSS.push(i+"/content"+(e.inline?".inline":"")+".min.css")),Tt(e,t),e.getParam("inline",!1,"boolean")?Ht(e,t,n):ye(e,t,n)},Nt=ot.extend({Mixins:[Se],Defaults:{classes:"widget tooltip tooltip-n"},renderHtml:function(){var e=this,t=e.classPrefix;return'<div id="'+e._id+'" class="'+e.classes+'" role="presentation"><div class="'+t+'tooltip-arrow"></div><div class="'+t+'tooltip-inner">'+e.encode(e.state.get("text"))+"</div></div>"},bindStates:function(){var t=this;return t.state.on("change:text",function(e){t.getEl().lastChild.innerHTML=t.encode(e.value)}),t._super()},repaint:function(){var e,t;e=this.getEl().style,t=this._layoutRect,e.left=t.x+"px",e.top=t.y+"px",e.zIndex=131070}}),Pt=ot.extend({init:function(i){var r=this;r._super(i),i=r.settings,r.canFocus=!0,i.tooltip&&!1!==Pt.tooltips&&(r.on("mouseenter",function(e){var t=r.tooltip().moveTo(-65535);if(e.control===r){var n=t.text(i.tooltip).show().testMoveRel(r.getEl(),["bc-tc","bc-tl","bc-tr"]);t.classes.toggle("tooltip-n","bc-tc"===n),t.classes.toggle("tooltip-nw","bc-tl"===n),t.classes.toggle("tooltip-ne","bc-tr"===n),t.moveRel(r.getEl(),n)}else t.hide()}),r.on("mouseleave mousedown click",function(){r.tooltip().remove(),r._tooltip=null})),r.aria("label",i.ariaLabel||i.tooltip)},tooltip:function(){return this._tooltip||(this._tooltip=new Nt({type:"tooltip"}),O.inheritUiContainer(this,this._tooltip),this._tooltip.renderTo()),this._tooltip},postRender:function(){var e=this,t=e.settings;e._super(),e.parent()||!t.width&&!t.height||(e.initLayoutRect(),e.repaint()),t.autofocus&&e.focus()},bindStates:function(){var t=this;function n(e){t.aria("disabled",e),t.classes.toggle("disabled",e)}function i(e){t.aria("pressed",e),t.classes.toggle("active",e)}return t.state.on("change:disabled",function(e){n(e.value)}),t.state.on("change:active",function(e){i(e.value)}),t.state.get("disabled")&&n(!0),t.state.get("active")&&i(!0),t._super()},remove:function(){this._super(),this._tooltip&&(this._tooltip.remove(),this._tooltip=null)}}),Wt=Pt.extend({Defaults:{value:0},init:function(e){this._super(e),this.classes.add("progress"),this.settings.filter||(this.settings.filter=function(e){return Math.round(e)})},renderHtml:function(){var e=this._id,t=this.classPrefix;return'<div id="'+e+'" class="'+this.classes+'"><div class="'+t+'bar-container"><div class="'+t+'bar"></div></div><div class="'+t+'text">0%</div></div>'},postRender:function(){return this._super(),this.value(this.settings.value),this},bindStates:function(){var t=this;function n(e){e=t.settings.filter(e),t.getEl().lastChild.innerHTML=e+"%",t.getEl().firstChild.firstChild.style.width=e+"%"}return t.state.on("change:value",function(e){n(e.value)}),n(t.state.get("value")),t._super()}}),Dt=function(e,t){e.getEl().lastChild.textContent=t+(e.progressBar?" "+e.progressBar.value()+"%":"")},Ot=ot.extend({Mixins:[Se],Defaults:{classes:"widget notification"},init:function(e){var t=this;t._super(e),t.maxWidth=e.maxWidth,e.text&&t.text(e.text),e.icon&&(t.icon=e.icon),e.color&&(t.color=e.color),e.type&&t.classes.add("notification-"+e.type),e.timeout&&(e.timeout<0||0<e.timeout)&&!e.closeButton?t.closeButton=!1:(t.classes.add("has-close"),t.closeButton=!0),e.progressBar&&(t.progressBar=new Wt),t.on("click",function(e){-1!==e.target.className.indexOf(t.classPrefix+"close")&&t.close()})},renderHtml:function(){var e,t=this,n=t.classPrefix,i="",r="",o="";return t.icon&&(i='<i class="'+n+"ico "+n+"i-"+t.icon+'"></i>'),e=' style="max-width: '+t.maxWidth+"px;"+(t.color?"background-color: "+t.color+';"':'"'),t.closeButton&&(r='<button type="button" class="'+n+'close" aria-hidden="true">\xd7</button>'),t.progressBar&&(o=t.progressBar.renderHtml()),'<div id="'+t._id+'" class="'+t.classes+'"'+e+' role="presentation">'+i+'<div class="'+n+'notification-inner">'+t.state.get("text")+"</div>"+o+r+'<div style="clip: rect(1px, 1px, 1px, 1px);height: 1px;overflow: hidden;position: absolute;width: 1px;" aria-live="assertive" aria-relevant="additions" aria-atomic="true"></div></div>'},postRender:function(){var e=this;return u.setTimeout(function(){e.$el.addClass(e.classPrefix+"in"),Dt(e,e.state.get("text"))},100),e._super()},bindStates:function(){var t=this;return t.state.on("change:text",function(e){t.getEl().firstChild.innerHTML=e.value,Dt(t,e.value)}),t.progressBar&&(t.progressBar.bindStates(),t.progressBar.state.on("change:value",function(e){Dt(t,t.state.get("text"))})),t._super()},close:function(){return this.fire("close").isDefaultPrevented()||this.remove(),this},repaint:function(){var e,t;e=this.getEl().style,t=this._layoutRect,e.left=t.x+"px",e.top=t.y+"px",e.zIndex=65534}});function At(o){var s=function(e){return e.inline?e.getElement():e.getContentAreaContainer()};return{open:function(e,t){var n,i=w.extend(e,{maxWidth:(n=s(o),_e.getSize(n).width)}),r=new Ot(i);return 0<(r.args=i).timeout&&(r.timer=setTimeout(function(){r.close(),t()},i.timeout)),r.on("close",function(){t()}),r.renderTo(),r},close:function(e){e.close()},reposition:function(e){G(e,function(e){e.moveTo(0,0)}),function(n){if(0<n.length){var e=n.slice(0,1)[0],t=s(o);e.moveRel(t,"tc-tc"),G(n,function(e,t){0<t&&e.moveRel(n[t-1].getEl(),"bc-tc")})}}(e)},getArgs:function(e){return e.args}}}var Bt=[],Lt="";function zt(e){var t,n=xe("meta[name=viewport]")[0];!1!==de.overrideViewPort&&(n||((n=document.createElement("meta")).setAttribute("name","viewport"),document.getElementsByTagName("head")[0].appendChild(n)),(t=n.getAttribute("content"))&&void 0!==Lt&&(Lt=t),n.setAttribute("content",e?"width=device-width,initial-scale=1.0,user-scalable=0,minimum-scale=1.0,maximum-scale=1.0":Lt))}function It(e,t){(function(){for(var e=0;e<Bt.length;e++)if(Bt[e]._fullscreen)return!0;return!1})()&&!1===t&&xe([document.documentElement,document.body]).removeClass(e+"fullscreen")}var Ft=Et.extend({modal:!0,Defaults:{border:1,layout:"flex",containerCls:"panel",role:"dialog",callbacks:{submit:function(){this.fire("submit",{data:this.toJSON()})},close:function(){this.close()}}},init:function(e){var n=this;n._super(e),n.isRtl()&&n.classes.add("rtl"),n.classes.add("window"),n.bodyClasses.add("window-body"),n.state.set("fixed",!0),e.buttons&&(n.statusbar=new vt({layout:"flex",border:"1 0 0 0",spacing:3,padding:10,align:"center",pack:n.isRtl()?"start":"end",defaults:{type:"button"},items:e.buttons}),n.statusbar.classes.add("foot"),n.statusbar.parent(n)),n.on("click",function(e){var t=n.classPrefix+"close";(_e.hasClass(e.target,t)||_e.hasClass(e.target.parentNode,t))&&n.close()}),n.on("cancel",function(){n.close()}),n.on("move",function(e){e.control===n&&Et.hideAll()}),n.aria("describedby",n.describedBy||n._id+"-none"),n.aria("label",e.title),n._fullscreen=!1},recalc:function(){var e,t,n,i,r=this,o=r.statusbar;r._fullscreen&&(r.layoutRect(_e.getWindowSize()),r.layoutRect().contentH=r.layoutRect().innerH),r._super(),e=r.layoutRect(),r.settings.title&&!r._fullscreen&&(t=e.headerW)>e.w&&(n=e.x-Math.max(0,t/2),r.layoutRect({w:t,x:n}),i=!0),o&&(o.layoutRect({w:r.layoutRect().innerW}).recalc(),(t=o.layoutRect().minW+e.deltaW)>e.w&&(n=e.x-Math.max(0,t-e.w),r.layoutRect({w:t,x:n}),i=!0)),i&&r.recalc()},initLayoutRect:function(){var e,t=this,n=t._super(),i=0;if(t.settings.title&&!t._fullscreen){e=t.getEl("head");var r=_e.getSize(e);n.headerW=r.width,n.headerH=r.height,i+=n.headerH}t.statusbar&&(i+=t.statusbar.layoutRect().h),n.deltaH+=i,n.minH+=i,n.h+=i;var o=_e.getWindowSize();return n.x=t.settings.x||Math.max(0,o.w/2-n.w/2),n.y=t.settings.y||Math.max(0,o.h/2-n.h/2),n},renderHtml:function(){var e=this,t=e._layout,n=e._id,i=e.classPrefix,r=e.settings,o="",s="",a=r.html;return e.preRender(),t.preRender(e),r.title&&(o='<div id="'+n+'-head" class="'+i+'window-head"><div id="'+n+'-title" class="'+i+'title">'+e.encode(r.title)+'</div><div id="'+n+'-dragh" class="'+i+'dragh"></div><button type="button" class="'+i+'close" aria-hidden="true"><i class="mce-ico mce-i-remove"></i></button></div>'),r.url&&(a='<iframe src="'+r.url+'" tabindex="-1"></iframe>'),void 0===a&&(a=t.renderHtml(e)),e.statusbar&&(s=e.statusbar.renderHtml()),'<div id="'+n+'" class="'+e.classes+'" hidefocus="1"><div class="'+e.classPrefix+'reset" role="application">'+o+'<div id="'+n+'-body" class="'+e.bodyClasses+'">'+a+"</div>"+s+"</div></div>"},fullscreen:function(e){var n,t,i=this,r=document.documentElement,o=i.classPrefix;if(e!==i._fullscreen)if(xe(window).on("resize",function(){var e;if(i._fullscreen)if(n)i._timer||(i._timer=u.setTimeout(function(){var e=_e.getWindowSize();i.moveTo(0,0).resizeTo(e.w,e.h),i._timer=0},50));else{e=(new Date).getTime();var t=_e.getWindowSize();i.moveTo(0,0).resizeTo(t.w,t.h),50<(new Date).getTime()-e&&(n=!0)}}),t=i.layoutRect(),i._fullscreen=e){i._initial={x:t.x,y:t.y,w:t.w,h:t.h},i.borderBox=Ne("0"),i.getEl("head").style.display="none",t.deltaH-=t.headerH+2,xe([r,document.body]).addClass(o+"fullscreen"),i.classes.add("fullscreen");var s=_e.getWindowSize();i.moveTo(0,0).resizeTo(s.w,s.h)}else i.borderBox=Ne(i.settings.border),i.getEl("head").style.display="",t.deltaH+=t.headerH,xe([r,document.body]).removeClass(o+"fullscreen"),i.classes.remove("fullscreen"),i.moveTo(i._initial.x,i._initial.y).resizeTo(i._initial.w,i._initial.h);return i.reflow()},postRender:function(){var t,n=this;setTimeout(function(){n.classes.add("in"),n.fire("open")},0),n._super(),n.statusbar&&n.statusbar.postRender(),n.focus(),this.dragHelper=new dt(n._id+"-dragh",{start:function(){t={x:n.layoutRect().x,y:n.layoutRect().y}},drag:function(e){n.moveTo(t.x+e.deltaX,t.y+e.deltaY)}}),n.on("submit",function(e){e.isDefaultPrevented()||n.close()}),Bt.push(n),zt(!0)},submit:function(){return this.fire("submit",{data:this.toJSON()})},remove:function(){var e,t=this;for(t.dragHelper.destroy(),t._super(),t.statusbar&&this.statusbar.remove(),It(t.classPrefix,!1),e=Bt.length;e--;)Bt[e]===t&&Bt.splice(e,1);zt(0<Bt.length)},getContentWindow:function(){var e=this.getEl().getElementsByTagName("iframe")[0];return e?e.contentWindow:null}});!function(){if(!de.desktop){var n={w:window.innerWidth,h:window.innerHeight};u.setInterval(function(){var e=window.innerWidth,t=window.innerHeight;n.w===e&&n.h===t||(n={w:e,h:t},xe(window).trigger("resize"))},100)}xe(window).on("resize",function(){var e,t,n=_e.getWindowSize();for(e=0;e<Bt.length;e++)t=Bt[e].layoutRect(),Bt[e].moveTo(Bt[e].settings.x||Math.max(0,n.w/2-t.w/2),Bt[e].settings.y||Math.max(0,n.h/2-t.h/2))})}();var Ut,Vt,Yt,$t=Ft.extend({init:function(e){e={border:1,padding:20,layout:"flex",pack:"center",align:"center",containerCls:"panel",autoScroll:!0,buttons:{type:"button",text:"Ok",action:"ok"},items:{type:"label",multiline:!0,maxWidth:500,maxHeight:200}},this._super(e)},Statics:{OK:1,OK_CANCEL:2,YES_NO:3,YES_NO_CANCEL:4,msgBox:function(e){var t,i=e.callback||function(){};function n(e,t,n){return{type:"button",text:e,subtype:n?"primary":"",onClick:function(e){e.control.parents()[1].close(),i(t)}}}switch(e.buttons){case $t.OK_CANCEL:t=[n("Ok",!0,!0),n("Cancel",!1)];break;case $t.YES_NO:case $t.YES_NO_CANCEL:t=[n("Yes",1,!0),n("No",0)],e.buttons===$t.YES_NO_CANCEL&&t.push(n("Cancel",-1));break;default:t=[n("Ok",!0,!0)]}return new Ft({padding:20,x:e.x,y:e.y,minWidth:300,minHeight:100,layout:"flex",pack:"center",align:"center",buttons:t,title:e.title,role:"alertdialog",items:{type:"label",multiline:!0,maxWidth:500,maxHeight:200,text:e.text},onPostRender:function(){this.aria("describedby",this.items()[0]._id)},onClose:e.onClose,onCancel:function(){i(!1)}}).renderTo(document.body).reflow()},alert:function(e,t){return"string"==typeof e&&(e={text:e}),e.callback=t,$t.msgBox(e)},confirm:function(e,t){return"string"==typeof e&&(e={text:e}),e.callback=t,e.buttons=$t.OK_CANCEL,$t.msgBox(e)}}}),qt=function(n){return{renderUI:function(e){return Mt(n,this,e)},resizeTo:function(e,t){return ue(n,e,t)},resizeBy:function(e,t){return ce(n,e,t)},getNotificationManagerImpl:function(){return At(n)},getWindowManagerImpl:function(){return{open:function(n,e,t){var i;return n.title=n.title||" ",n.url=n.url||n.file,n.url&&(n.width=parseInt(n.width||320,10),n.height=parseInt(n.height||240,10)),n.body&&(n.items={defaults:n.defaults,type:n.bodyType||"form",items:n.body,data:n.data,callbacks:n.commands}),n.url||n.buttons||(n.buttons=[{text:"Ok",subtype:"primary",onclick:function(){i.find("form")[0].submit()}},{text:"Cancel",onclick:function(){i.close()}}]),(i=new Ft(n)).on("close",function(){t(i)}),n.data&&i.on("postRender",function(){this.find("*").each(function(e){var t=e.name();t in n.data&&e.value(n.data[t])})}),i.features=n||{},i.params=e||{},i=i.renderTo(document.body).reflow()},alert:function(e,t,n){var i;return(i=$t.alert(e,function(){t()})).on("close",function(){n(i)}),i},confirm:function(e,t,n){var i;return(i=$t.confirm(e,function(e){t(e)})).on("close",function(){n(i)}),i},close:function(e){e.close()},getParams:function(e){return e.params},setParams:function(e,t){e.params=t}}}}},Xt=Te.extend({Defaults:{firstControlClass:"first",lastControlClass:"last"},init:function(e){this.settings=w.extend({},this.Defaults,e)},preRender:function(e){e.bodyClasses.add(this.settings.containerClass)},applyClasses:function(e){var t,n,i,r,o=this.settings;t=o.firstControlClass,n=o.lastControlClass,e.each(function(e){e.classes.remove(t).remove(n).add(o.controlClass),e.visible()&&(i||(i=e),r=e)}),i&&i.classes.add(t),r&&r.classes.add(n)},renderHtml:function(e){var t="";return this.applyClasses(e.items()),e.items().each(function(e){t+=e.renderHtml()}),t},recalc:function(){},postRender:function(){},isNative:function(){return!1}}),jt=Xt.extend({Defaults:{containerClass:"abs-layout",controlClass:"abs-layout-item"},recalc:function(e){e.items().filter(":visible").each(function(e){var t=e.settings;e.layoutRect({x:t.x,y:t.y,w:t.w,h:t.h}),e.recalc&&e.recalc()})},renderHtml:function(e){return'<div id="'+e._id+'-absend" class="'+e.classPrefix+'abs-end"></div>'+this._super(e)}}),Jt=Pt.extend({Defaults:{classes:"widget btn",role:"button"},init:function(e){var t,n=this;n._super(e),e=n.settings,t=n.settings.size,n.on("click mousedown",function(e){e.preventDefault()}),n.on("touchstart",function(e){n.fire("click",e),e.preventDefault()}),e.subtype&&n.classes.add(e.subtype),t&&n.classes.add("btn-"+t),e.icon&&n.icon(e.icon)},icon:function(e){return arguments.length?(this.state.set("icon",e),this):this.state.get("icon")},repaint:function(){var e,t=this.getEl().firstChild;t&&((e=t.style).width=e.height="100%"),this._super()},renderHtml:function(){var e,t,n=this,i=n._id,r=n.classPrefix,o=n.state.get("icon"),s=n.state.get("text"),a="",l=n.settings;return(e=l.image)?(o="none","string"!=typeof e&&(e=window.getSelection?e[0]:e[1]),e=" style=\"background-image: url('"+e+"')\""):e="",s&&(n.classes.add("btn-has-text"),a='<span class="'+r+'txt">'+n.encode(s)+"</span>"),o=o?r+"ico "+r+"i-"+o:"",t="boolean"==typeof l.active?' aria-pressed="'+l.active+'"':"",'<div id="'+i+'" class="'+n.classes+'" tabindex="-1"'+t+'><button id="'+i+'-button" role="presentation" type="button" tabindex="-1">'+(o?'<i class="'+o+'"'+e+"></i>":"")+a+"</button></div>"},bindStates:function(){var o=this,n=o.$,i=o.classPrefix+"txt";function s(e){var t=n("span."+i,o.getEl());e?(t[0]||(n("button:first",o.getEl()).append('<span class="'+i+'"></span>'),t=n("span."+i,o.getEl())),t.html(o.encode(e))):t.remove(),o.classes.toggle("btn-has-text",!!e)}return o.state.on("change:text",function(e){s(e.value)}),o.state.on("change:icon",function(e){var t=e.value,n=o.classPrefix;t=(o.settings.icon=t)?n+"ico "+n+"i-"+o.settings.icon:"";var i=o.getEl().firstChild,r=i.getElementsByTagName("i")[0];t?(r&&r===i.firstChild||(r=document.createElement("i"),i.insertBefore(r,i.firstChild)),r.className=t):r&&i.removeChild(r),s(o.state.get("text"))}),o._super()}}),Gt=Jt.extend({init:function(e){e=w.extend({text:"Browse...",multiple:!1,accept:null},e),this._super(e),this.classes.add("browsebutton"),e.multiple&&this.classes.add("multiple")},postRender:function(){var n=this,t=_e.create("input",{type:"file",id:n._id+"-browse",accept:n.settings.accept});n._super(),xe(t).on("change",function(e){var t=e.target.files;n.value=function(){return t.length?n.settings.multiple?t:t[0]:null},e.preventDefault(),t.length&&n.fire("change",e)}),xe(t).on("click",function(e){e.stopPropagation()}),xe(n.getEl("button")).on("click",function(e){e.stopPropagation(),t.click()}),n.getEl().appendChild(t)},remove:function(){xe(this.getEl("button")).off(),xe(this.getEl("input")).off(),this._super()}}),Kt=ut.extend({Defaults:{defaultType:"button",role:"group"},renderHtml:function(){var e=this,t=e._layout;return e.classes.add("btn-group"),e.preRender(),t.preRender(e),'<div id="'+e._id+'" class="'+e.classes+'"><div id="'+e._id+'-body">'+(e.settings.html||"")+t.renderHtml(e)+"</div></div>"}}),Zt=Pt.extend({Defaults:{classes:"checkbox",role:"checkbox",checked:!1},init:function(e){var t=this;t._super(e),t.on("click mousedown",function(e){e.preventDefault()}),t.on("click",function(e){e.preventDefault(),t.disabled()||t.checked(!t.checked())}),t.checked(t.settings.checked)},checked:function(e){return arguments.length?(this.state.set("checked",e),this):this.state.get("checked")},value:function(e){return arguments.length?this.checked(e):this.checked()},renderHtml:function(){var e=this,t=e._id,n=e.classPrefix;return'<div id="'+t+'" class="'+e.classes+'" unselectable="on" aria-labelledby="'+t+'-al" tabindex="-1"><i class="'+n+"ico "+n+'i-checkbox"></i><span id="'+t+'-al" class="'+n+'label">'+e.encode(e.state.get("text"))+"</span></div>"},bindStates:function(){var o=this;function t(e){o.classes.toggle("checked",e),o.aria("checked",e)}return o.state.on("change:text",function(e){o.getEl("al").firstChild.data=o.translate(e.value)}),o.state.on("change:checked change:value",function(e){o.fire("change"),t(e.value)}),o.state.on("change:icon",function(e){var t=e.value,n=o.classPrefix;if(void 0===t)return o.settings.icon;t=(o.settings.icon=t)?n+"ico "+n+"i-"+o.settings.icon:"";var i=o.getEl().firstChild,r=i.getElementsByTagName("i")[0];t?(r&&r===i.firstChild||(r=document.createElement("i"),i.insertBefore(r,i.firstChild)),r.className=t):r&&i.removeChild(r)}),o.state.get("checked")&&t(!0),o._super()}}),Qt=tinymce.util.Tools.resolve("tinymce.util.VK"),en=Pt.extend({init:function(i){var r=this;r._super(i),i=r.settings,r.classes.add("combobox"),r.subinput=!0,r.ariaTarget="inp",i.menu=i.menu||i.values,i.menu&&(i.icon="caret"),r.on("click",function(e){var t=e.target,n=r.getEl();if(xe.contains(n,t)||t===n)for(;t&&t!==n;)t.id&&-1!==t.id.indexOf("-open")&&(r.fire("action"),i.menu&&(r.showMenu(),e.aria&&r.menu.items()[0].focus())),t=t.parentNode}),r.on("keydown",function(e){var t;13===e.keyCode&&"INPUT"===e.target.nodeName&&(e.preventDefault(),r.parents().reverse().each(function(e){if(e.toJSON)return t=e,!1}),r.fire("submit",{data:t.toJSON()}))}),r.on("keyup",function(e){if("INPUT"===e.target.nodeName){var t=r.state.get("value"),n=e.target.value;n!==t&&(r.state.set("value",n),r.fire("autocomplete",e))}}),r.on("mouseover",function(e){var t=r.tooltip().moveTo(-65535);if(r.statusLevel()&&-1!==e.target.className.indexOf(r.classPrefix+"status")){var n=r.statusMessage()||"Ok",i=t.text(n).show().testMoveRel(e.target,["bc-tc","bc-tl","bc-tr"]);t.classes.toggle("tooltip-n","bc-tc"===i),t.classes.toggle("tooltip-nw","bc-tl"===i),t.classes.toggle("tooltip-ne","bc-tr"===i),t.moveRel(e.target,i)}})},statusLevel:function(e){return 0<arguments.length&&this.state.set("statusLevel",e),this.state.get("statusLevel")},statusMessage:function(e){return 0<arguments.length&&this.state.set("statusMessage",e),this.state.get("statusMessage")},showMenu:function(){var e,t=this,n=t.settings;t.menu||((e=n.menu||[]).length?e={type:"menu",items:e}:e.type=e.type||"menu",t.menu=b.create(e).parent(t).renderTo(t.getContainerElm()),t.fire("createmenu"),t.menu.reflow(),t.menu.on("cancel",function(e){e.control===t.menu&&t.focus()}),t.menu.on("show hide",function(e){e.control.items().each(function(e){e.active(e.value()===t.value())})}).fire("show"),t.menu.on("select",function(e){t.value(e.control.value())}),t.on("focusin",function(e){"INPUT"===e.target.tagName.toUpperCase()&&t.menu.hide()}),t.aria("expanded",!0)),t.menu.show(),t.menu.layoutRect({w:t.layoutRect().w}),t.menu.moveRel(t.getEl(),t.isRtl()?["br-tr","tr-br"]:["bl-tl","tl-bl"])},focus:function(){this.getEl("inp").focus()},repaint:function(){var e,t,n=this,i=n.getEl(),r=n.getEl("open"),o=n.layoutRect(),s=0,a=i.firstChild;n.statusLevel()&&"none"!==n.statusLevel()&&(s=parseInt(_e.getRuntimeStyle(a,"padding-right"),10)-parseInt(_e.getRuntimeStyle(a,"padding-left"),10)),e=r?o.w-_e.getSize(r).width-10:o.w-10;var l=document;return l.all&&(!l.documentMode||l.documentMode<=8)&&(t=n.layoutRect().h-2+"px"),xe(a).css({width:e-s,lineHeight:t}),n._super(),n},postRender:function(){var t=this;return xe(this.getEl("inp")).on("change",function(e){t.state.set("value",e.target.value),t.fire("change",e)}),t._super()},renderHtml:function(){var e,t,n,i=this,r=i._id,o=i.settings,s=i.classPrefix,a=i.state.get("value")||"",l="",u="";return"spellcheck"in o&&(u+=' spellcheck="'+o.spellcheck+'"'),o.maxLength&&(u+=' maxlength="'+o.maxLength+'"'),o.size&&(u+=' size="'+o.size+'"'),o.subtype&&(u+=' type="'+o.subtype+'"'),n='<i id="'+r+'-status" class="mce-status mce-ico" style="display: none"></i>',i.disabled()&&(u+=' disabled="disabled"'),(e=o.icon)&&"caret"!==e&&(e=s+"ico "+s+"i-"+o.icon),t=i.state.get("text"),(e||t)&&(l='<div id="'+r+'-open" class="'+s+"btn "+s+'open" tabIndex="-1" role="button"><button id="'+r+'-action" type="button" hidefocus="1" tabindex="-1">'+("caret"!==e?'<i class="'+e+'"></i>':'<i class="'+s+'caret"></i>')+(t?(e?" ":"")+t:"")+"</button></div>",i.classes.add("has-open")),'<div id="'+r+'" class="'+i.classes+'"><input id="'+r+'-inp" class="'+s+'textbox" value="'+i.encode(a,!1)+'" hidefocus="1"'+u+' placeholder="'+i.encode(o.placeholder)+'" />'+n+l+"</div>"},value:function(e){return arguments.length?(this.state.set("value",e),this):(this.state.get("rendered")&&this.state.set("value",this.getEl("inp").value),this.state.get("value"))},showAutoComplete:function(e,i){var r=this;if(0!==e.length){r.menu?r.menu.items().remove():r.menu=b.create({type:"menu",classes:"combobox-menu",layout:"flow"}).parent(r).renderTo(),w.each(e,function(e){var t,n;r.menu.add({text:e.title,url:e.previewUrl,match:i,classes:"menu-item-ellipsis",onclick:(t=e.value,n=e.title,function(){r.fire("selectitem",{title:n,value:t})})})}),r.menu.renderNew(),r.hideMenu(),r.menu.on("cancel",function(e){e.control.parent()===r.menu&&(e.stopPropagation(),r.focus(),r.hideMenu())}),r.menu.on("select",function(){r.focus()});var t=r.layoutRect().w;r.menu.layoutRect({w:t,minW:0,maxW:t}),r.menu.repaint(),r.menu.reflow(),r.menu.show(),r.menu.moveRel(r.getEl(),r.isRtl()?["br-tr","tr-br"]:["bl-tl","tl-bl"])}else r.hideMenu()},hideMenu:function(){this.menu&&this.menu.hide()},bindStates:function(){var r=this;r.state.on("change:value",function(e){r.getEl("inp").value!==e.value&&(r.getEl("inp").value=e.value)}),r.state.on("change:disabled",function(e){r.getEl("inp").disabled=e.value}),r.state.on("change:statusLevel",function(e){var t=r.getEl("status"),n=r.classPrefix,i=e.value;_e.css(t,"display","none"===i?"none":""),_e.toggleClass(t,n+"i-checkmark","ok"===i),_e.toggleClass(t,n+"i-warning","warn"===i),_e.toggleClass(t,n+"i-error","error"===i),r.classes.toggle("has-status","none"!==i),r.repaint()}),_e.on(r.getEl("status"),"mouseleave",function(){r.tooltip().hide()}),r.on("cancel",function(e){r.menu&&r.menu.visible()&&(e.stopPropagation(),r.hideMenu())});var n=function(e,t){t&&0<t.items().length&&t.items().eq(e)[0].focus()};return r.on("keydown",function(e){var t=e.keyCode;"INPUT"===e.target.nodeName&&(t===Qt.DOWN?(e.preventDefault(),r.fire("autocomplete"),n(0,r.menu)):t===Qt.UP&&(e.preventDefault(),n(-1,r.menu)))}),r._super()},remove:function(){xe(this.getEl("inp")).off(),this.menu&&this.menu.remove(),this._super()}}),tn=en.extend({init:function(e){var t=this;e.spellcheck=!1,e.onaction&&(e.icon="none"),t._super(e),t.classes.add("colorbox"),t.on("change keyup postrender",function(){t.repaintColor(t.value())})},repaintColor:function(e){var t=this.getEl("open"),n=t?t.getElementsByTagName("i")[0]:null;if(n)try{n.style.background=e}catch(i){}},bindStates:function(){var t=this;return t.state.on("change:value",function(e){t.state.get("rendered")&&t.repaintColor(e.value)}),t._super()}}),nn=Jt.extend({showPanel:function(){var t=this,e=t.settings;if(t.classes.add("opened"),t.panel)t.panel.show();else{var n=e.panel;n.type&&(n={layout:"grid",items:n}),n.role=n.role||"dialog",n.popover=!0,n.autohide=!0,n.ariaRoot=!0,t.panel=new Et(n).on("hide",function(){t.classes.remove("opened")}).on("cancel",function(e){e.stopPropagation(),t.focus(),t.hidePanel()}).parent(t).renderTo(t.getContainerElm()),t.panel.fire("show"),t.panel.reflow()}var i=t.panel.testMoveRel(t.getEl(),e.popoverAlign||(t.isRtl()?["bc-tc","bc-tl","bc-tr"]:["bc-tc","bc-tr","bc-tl","tc-bc","tc-br","tc-bl"]));t.panel.classes.toggle("start","l"===i.substr(-1)),t.panel.classes.toggle("end","r"===i.substr(-1));var r="t"===i.substr(0,1);t.panel.classes.toggle("bottom",!r),t.panel.classes.toggle("top",r),t.panel.moveRel(t.getEl(),i)},hidePanel:function(){this.panel&&this.panel.hide()},postRender:function(){var t=this;return t.aria("haspopup",!0),t.on("click",function(e){e.control===t&&(t.panel&&t.panel.visible()?t.hidePanel():(t.showPanel(),t.panel.focus(!!e.aria)))}),t._super()},remove:function(){return this.panel&&(this.panel.remove(),this.panel=null),this._super()}}),rn=v.DOM,on=nn.extend({init:function(e){this._super(e),this.classes.add("splitbtn"),this.classes.add("colorbutton")},color:function(e){return e?(this._color=e,this.getEl("preview").style.backgroundColor=e,this):this._color},resetColor:function(){return this._color=null,this.getEl("preview").style.backgroundColor=null,this},renderHtml:function(){var e=this,t=e._id,n=e.classPrefix,i=e.state.get("text"),r=e.settings.icon?n+"ico "+n+"i-"+e.settings.icon:"",o=e.settings.image?" style=\"background-image: url('"+e.settings.image+"')\"":"",s="";return i&&(e.classes.add("btn-has-text"),s='<span class="'+n+'txt">'+e.encode(i)+"</span>"),'<div id="'+t+'" class="'+e.classes+'" role="button" tabindex="-1" aria-haspopup="true"><button role="presentation" hidefocus="1" type="button" tabindex="-1">'+(r?'<i class="'+r+'"'+o+"></i>":"")+'<span id="'+t+'-preview" class="'+n+'preview"></span>'+s+'</button><button type="button" class="'+n+'open" hidefocus="1" tabindex="-1"> <i class="'+n+'caret"></i></button></div>'},postRender:function(){var t=this,n=t.settings.onclick;return t.on("click",function(e){e.aria&&"down"===e.aria.key||e.control!==t||rn.getParent(e.target,"."+t.classPrefix+"open")||(e.stopImmediatePropagation(),n.call(t,e))}),delete t.settings.onclick,t._super()}}),sn=tinymce.util.Tools.resolve("tinymce.util.Color"),an=Pt.extend({Defaults:{classes:"widget colorpicker"},init:function(e){this._super(e)},postRender:function(){var n,i,r,o,s,a=this,l=a.color();function u(e,t){var n,i,r=_e.getPos(e);return n=t.pageX-r.x,i=t.pageY-r.y,{x:n=Math.max(0,Math.min(n/e.clientWidth,1)),y:i=Math.max(0,Math.min(i/e.clientHeight,1))}}function c(e,t){var n=(360-e.h)/360;_e.css(r,{top:100*n+"%"}),t||_e.css(s,{left:e.s+"%",top:100-e.v+"%"}),o.style.background=sn({s:100,v:100,h:e.h}).toHex(),a.color().parse({s:e.s,v:e.v,h:e.h})}function e(e){var t;t=u(o,e),n.s=100*t.x,n.v=100*(1-t.y),c(n),a.fire("change")}function t(e){var t;t=u(i,e),(n=l.toHsv()).h=360*(1-t.y),c(n,!0),a.fire("change")}i=a.getEl("h"),r=a.getEl("hp"),o=a.getEl("sv"),s=a.getEl("svp"),a._repaint=function(){c(n=l.toHsv())},a._super(),a._svdraghelper=new dt(a._id+"-sv",{start:e,drag:e}),a._hdraghelper=new dt(a._id+"-h",{start:t,drag:t}),a._repaint()},rgb:function(){return this.color().toRgb()},value:function(e){if(!arguments.length)return this.color().toHex();this.color().parse(e),this._rendered&&this._repaint()},color:function(){return this._color||(this._color=sn()),this._color},renderHtml:function(){var e,t=this._id,o=this.classPrefix,s="#ff0000,#ff0080,#ff00ff,#8000ff,#0000ff,#0080ff,#00ffff,#00ff80,#00ff00,#80ff00,#ffff00,#ff8000,#ff0000";return e='<div id="'+t+'-h" class="'+o+'colorpicker-h" style="background: -ms-linear-gradient(top,'+s+");background: linear-gradient(to bottom,"+s+');">'+function(){var e,t,n,i,r="";for(n="filter:progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr=",e=0,t=(i=s.split(",")).length-1;e<t;e++)r+='<div class="'+o+'colorpicker-h-chunk" style="height:'+100/t+"%;"+n+i[e]+",endColorstr="+i[e+1]+");-ms-"+n+i[e]+",endColorstr="+i[e+1]+')"></div>';return r}()+'<div id="'+t+'-hp" class="'+o+'colorpicker-h-marker"></div></div>','<div id="'+t+'" class="'+this.classes+'"><div id="'+t+'-sv" class="'+o+'colorpicker-sv"><div class="'+o+'colorpicker-overlay1"><div class="'+o+'colorpicker-overlay2"><div id="'+t+'-svp" class="'+o+'colorpicker-selector1"><div class="'+o+'colorpicker-selector2"></div></div></div></div></div>'+e+"</div>"}}),ln=Pt.extend({init:function(e){e=w.extend({height:100,text:"Drop an image here",multiple:!1,accept:null},e),this._super(e),this.classes.add("dropzone"),e.multiple&&this.classes.add("multiple")},renderHtml:function(){var e,t,n=this.settings;return e={id:this._id,hidefocus:"1"},t=_e.create("div",e,"<span>"+this.translate(n.text)+"</span>"),n.height&&_e.css(t,"height",n.height+"px"),n.width&&_e.css(t,"width",n.width+"px"),t.className=this.classes,t.outerHTML},postRender:function(){var i=this,e=function(e){e.preventDefault(),i.classes.toggle("dragenter"),i.getEl().className=i.classes};i._super(),i.$el.on("dragover",function(e){e.preventDefault()}),i.$el.on("dragenter",e),i.$el.on("dragleave",e),i.$el.on("drop",function(e){if(e.preventDefault(),!i.state.get("disabled")){var t=function(e){var t=i.settings.accept;if("string"!=typeof t)return e;var n=new RegExp("("+t.split(/\s*,\s*/).join("|")+")$","i");return w.grep(e,function(e){return n.test(e.name)})}(e.dataTransfer.files);i.value=function(){return t.length?i.settings.multiple?t:t[0]:null},t.length&&i.fire("change",e)}})},remove:function(){this.$el.off(),this._super()}}),un=Pt.extend({init:function(e){var n=this;e.delimiter||(e.delimiter="\xbb"),n._super(e),n.classes.add("path"),n.canFocus=!0,n.on("click",function(e){var t;(t=e.target.getAttribute("data-index"))&&n.fire("select",{value:n.row()[t],index:t})}),n.row(n.settings.row)},focus:function(){return this.getEl().firstChild.focus(),this},row:function(e){return arguments.length?(this.state.set("row",e),this):this.state.get("row")},renderHtml:function(){return'<div id="'+this._id+'" class="'+this.classes+'">'+this._getDataPathHtml(this.state.get("row"))+"</div>"},bindStates:function(){var t=this;return t.state.on("change:row",function(e){t.innerHtml(t._getDataPathHtml(e.value))}),t._super()},_getDataPathHtml:function(e){var t,n,i=e||[],r="",o=this.classPrefix;for(t=0,n=i.length;t<n;t++)r+=(0<t?'<div class="'+o+'divider" aria-hidden="true"> '+this.settings.delimiter+" </div>":"")+'<div role="button" class="'+o+"path-item"+(t===n-1?" "+o+"last":"")+'" data-index="'+t+'" tabindex="-1" id="'+this._id+"-"+t+'" aria-level="'+(t+1)+'">'+i[t].name+"</div>";return r||(r='<div class="'+o+'path-item">\xa0</div>'),r}}),cn=un.extend({postRender:function(){var o=this,s=o.settings.editor;function a(e){if(1===e.nodeType){if("BR"===e.nodeName||e.getAttribute("data-mce-bogus"))return!0;if("bookmark"===e.getAttribute("data-mce-type"))return!0}return!1}return!1!==s.settings.elementpath&&(o.on("select",function(e){s.focus(),s.selection.select(this.row()[e.index].element),s.nodeChanged()}),s.on("nodeChange",function(e){for(var t=[],n=e.parents,i=n.length;i--;)if(1===n[i].nodeType&&!a(n[i])){var r=s.fire("ResolveName",{name:n[i].nodeName.toLowerCase(),target:n[i]});if(r.isDefaultPrevented()||t.push({name:r.name,element:n[i]}),r.isPropagationStopped())break}o.row(t)})),o._super()}}),dn=ut.extend({Defaults:{layout:"flex",align:"center",defaults:{flex:1}},renderHtml:function(){var e=this,t=e._layout,n=e.classPrefix;return e.classes.add("formitem"),t.preRender(e),'<div id="'+e._id+'" class="'+e.classes+'" hidefocus="1" tabindex="-1">'+(e.settings.title?'<div id="'+e._id+'-title" class="'+n+'title">'+e.settings.title+"</div>":"")+'<div id="'+e._id+'-body" class="'+e.bodyClasses+'">'+(e.settings.html||"")+t.renderHtml(e)+"</div></div>"}}),fn=ut.extend({Defaults:{containerCls:"form",layout:"flex",direction:"column",align:"stretch",flex:1,padding:15,labelGap:30,spacing:10,callbacks:{submit:function(){this.submit()}}},preRender:function(){var i=this,e=i.items();i.settings.formItemDefaults||(i.settings.formItemDefaults={layout:"flex",autoResize:"overflow",defaults:{flex:1}}),e.each(function(e){var t,n=e.settings.label;n&&((t=new dn(w.extend({items:{type:"label",id:e._id+"-l",text:n,flex:0,forId:e._id,disabled:e.disabled()}},i.settings.formItemDefaults))).type="formitem",e.aria("labelledby",e._id+"-l"),"undefined"==typeof e.settings.flex&&(e.settings.flex=1),i.replace(e,t),t.add(e))})},submit:function(){return this.fire("submit",{data:this.toJSON()})},postRender:function(){this._super(),this.fromJSON(this.settings.data)},bindStates:function(){var n=this;function e(){var e,t,i=0,r=[];if(!1!==n.settings.labelGapCalc)for(("children"===n.settings.labelGapCalc?n.find("formitem"):n.items()).filter("formitem").each(function(e){var t=e.items()[0],n=t.getEl().clientWidth;i=i<n?n:i,r.push(t)}),t=n.settings.labelGap||0,e=r.length;e--;)r[e].settings.minWidth=i+t}n._super(),n.on("show",e),e()}}),hn=fn.extend({Defaults:{containerCls:"fieldset",layout:"flex",direction:"column",align:"stretch",flex:1,padding:"25 15 5 15",labelGap:30,spacing:10,border:1},renderHtml:function(){var e=this,t=e._layout,n=e.classPrefix;return e.preRender(),t.preRender(e),'<fieldset id="'+e._id+'" class="'+e.classes+'" hidefocus="1" tabindex="-1">'+(e.settings.title?'<legend id="'+e._id+'-title" class="'+n+'fieldset-title">'+e.settings.title+"</legend>":"")+'<div id="'+e._id+'-body" class="'+e.bodyClasses+'">'+(e.settings.html||"")+t.renderHtml(e)+"</div></fieldset>"}}),mn=0,gn=function(e){if(null===e||e===undefined)throw new Error("Node cannot be null or undefined");return{dom:k(e)}},pn={fromHtml:function(e,t){var n=(t||document).createElement("div");if(n.innerHTML=e,!n.hasChildNodes()||1<n.childNodes.length)throw console.error("HTML does not have a single root node",e),"HTML must have a single root node";return gn(n.childNodes[0])},fromTag:function(e,t){var n=(t||document).createElement(e);return gn(n)},fromText:function(e,t){var n=(t||document).createTextNode(e);return gn(n)},fromDom:gn,fromPoint:function(e,t,n){var i=e.dom();return W.from(i.elementFromPoint(t,n)).map(gn)}},vn=(Node.ATTRIBUTE_NODE,Node.CDATA_SECTION_NODE,Node.COMMENT_NODE,Node.DOCUMENT_NODE),bn=(Node.DOCUMENT_TYPE_NODE,Node.DOCUMENT_FRAGMENT_NODE,Node.ELEMENT_NODE),yn=(Node.TEXT_NODE,Node.PROCESSING_INSTRUCTION_NODE,Node.ENTITY_REFERENCE_NODE,Node.ENTITY_NODE,Node.NOTATION_NODE,"undefined"!=typeof window?window:Function("return this;")(),function(e,t){var n=function(e,t){for(var n=0;n<e.length;n++){var i=e[n];if(i.test(t))return i}return undefined}(e,t);if(!n)return{major:0,minor:0};var i=function(e){return Number(t.replace(n,"$"+e))};return wn(i(1),i(2))}),xn=function(){return wn(0,0)},wn=function(e,t){return{major:e,minor:t}},_n={nu:wn,detect:function(e,t){var n=String(t).toLowerCase();return 0===e.length?xn():yn(e,n)},unknown:xn},Rn="Firefox",Cn=function(e,t){return function(){return t===e}},En=function(e){var t=e.current;return{current:t,version:e.version,isEdge:Cn("Edge",t),isChrome:Cn("Chrome",t),isIE:Cn("IE",t),isOpera:Cn("Opera",t),isFirefox:Cn(Rn,t),isSafari:Cn("Safari",t)}},kn={unknown:function(){return En({current:undefined,version:_n.unknown()})},nu:En,edge:k("Edge"),chrome:k("Chrome"),ie:k("IE"),opera:k("Opera"),firefox:k(Rn),safari:k("Safari")},Hn="Windows",Sn="Android",Tn="Solaris",Mn="FreeBSD",Nn=function(e,t){return function(){return t===e}},Pn=function(e){var t=e.current;return{current:t,version:e.version,isWindows:Nn(Hn,t),isiOS:Nn("iOS",t),isAndroid:Nn(Sn,t),isOSX:Nn("OSX",t),isLinux:Nn("Linux",t),isSolaris:Nn(Tn,t),isFreeBSD:Nn(Mn,t)}},Wn={unknown:function(){return Pn({current:undefined,version:_n.unknown()})},nu:Pn,windows:k(Hn),ios:k("iOS"),android:k(Sn),linux:k("Linux"),osx:k("OSX"),solaris:k(Tn),freebsd:k(Mn)},Dn=function(e,t){var n=String(t).toLowerCase();return function(e,t){for(var n=0,i=e.length;n<i;n++){var r=e[n];if(t(r,n,e))return W.some(r)}return W.none()}(e,function(e){return e.search(n)})},On=function(e,n){return Dn(e,n).map(function(e){var t=_n.detect(e.versionRegexes,n);return{current:e.name,version:t}})},An=function(e,n){return Dn(e,n).map(function(e){var t=_n.detect(e.versionRegexes,n);return{current:e.name,version:t}})},Bn=function(e,t){return-1!==e.indexOf(t)},Ln=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,zn=function(t){return function(e){return Bn(e,t)}},In=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return Bn(e,"edge/")&&Bn(e,"chrome")&&Bn(e,"safari")&&Bn(e,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Ln],search:function(e){return Bn(e,"chrome")&&!Bn(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return Bn(e,"msie")||Bn(e,"trident")}},{name:"Opera",versionRegexes:[Ln,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:zn("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:zn("firefox")},{name:"Safari",versionRegexes:[Ln,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(Bn(e,"safari")||Bn(e,"mobile/"))&&Bn(e,"applewebkit")}}],Fn=[{name:"Windows",search:zn("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return Bn(e,"iphone")||Bn(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:zn("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:zn("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:zn("linux"),versionRegexes:[]},{name:"Solaris",search:zn("sunos"),versionRegexes:[]},{name:"FreeBSD",search:zn("freebsd"),versionRegexes:[]}],Un={browsers:k(In),oses:k(Fn)},Vn=function(e){var t,n,i,r,o,s,a,l,u,c,d,f=Un.browsers(),h=Un.oses(),m=On(f,e).fold(kn.unknown,kn.nu),g=An(h,e).fold(Wn.unknown,Wn.nu);return{browser:m,os:g,deviceType:(n=m,i=e,r=(t=g).isiOS()&&!0===/ipad/i.test(i),o=t.isiOS()&&!r,s=t.isAndroid()&&3===t.version.major,a=t.isAndroid()&&4===t.version.major,l=r||s||a&&!0===/mobile/i.test(i),u=t.isiOS()||t.isAndroid(),c=u&&!l,d=n.isSafari()&&t.isiOS()&&!1===/safari/i.test(i),{isiPad:k(r),isiPhone:k(o),isTablet:k(l),isPhone:k(c),isTouch:k(u),isAndroid:t.isAndroid,isiOS:t.isiOS,isWebView:k(d)})}},Yn=(Yt=!(Ut=function(){var e=navigator.userAgent;return Vn(e)}),function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Yt||(Yt=!0,Vt=Ut.apply(null,e)),Vt}),$n=bn,qn=vn,Xn=function(e){return e.nodeType!==$n&&e.nodeType!==qn||0===e.childElementCount},jn=(Yn().browser.isIE(),function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]}("element","offset"),w.trim),Jn=function(t){return function(e){if(e&&1===e.nodeType){if(e.contentEditable===t)return!0;if(e.getAttribute("data-mce-contenteditable")===t)return!0}return!1}},Gn=Jn("true"),Kn=Jn("false"),Zn=function(e,t,n,i,r){return{type:e,title:t,url:n,level:i,attach:r}},Qn=function(e){return e.innerText||e.textContent},ei=function(e){return e.id?e.id:(t="h",n=(new Date).getTime(),t+"_"+Math.floor(1e9*Math.random())+ ++mn+String(n));var t,n},ti=function(e){return(t=e)&&"A"===t.nodeName&&(t.id||t.name)&&ii(e);var t},ni=function(e){return e&&/^(H[1-6])$/.test(e.nodeName)},ii=function(e){return function(e){for(;e=e.parentNode;){var t=e.contentEditable;if(t&&"inherit"!==t)return Gn(e)}return!1}(e)&&!Kn(e)},ri=function(e){return ni(e)&&ii(e)},oi=function(e){var t,n=ei(e);return Zn("header",Qn(e),"#"+n,ni(t=e)?parseInt(t.nodeName.substr(1),10):0,function(){e.id=n})},si=function(e){var t=e.id||e.name,n=Qn(e);return Zn("anchor",n||"#"+t,"#"+t,0,E)},ai=function(e){var t,n,i,r,o,s;return t="h1,h2,h3,h4,h5,h6,a:not([href])",n=e,J((Yn().browser.isIE(),function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]}("element","offset"),i=pn.fromDom(n),r=t,s=(o=i)===undefined?document:o.dom(),Xn(s)?[]:J(s.querySelectorAll(r),pn.fromDom)),function(e){return e.dom()})},li=function(e){return 0<jn(e.title).length},ui=function(e){var t,n=ai(e);return K((t=n,J(K(t,ri),oi)).concat(J(K(n,ti),si)),li)},ci={},di=function(e){return{title:e.title,value:{title:{raw:e.title},url:e.url,attach:e.attach}}},fi=function(e,t){return{title:e,value:{title:e,url:t,attach:E}}},hi=function(e,t,n){var i=t in e?e[t]:n;return!1===i?null:i},mi=function(e,i,r,t){var n,o,s,a,l,u,c={title:"-"},d=function(e){var t=e.hasOwnProperty(r)?e[r]:[],n=K(t,function(e){return t=e,!j(i,function(e){return e.url===t});var t});return w.map(n,function(e){return{title:e,value:{title:e,url:e,attach:E}}})},f=function(t){var e,n=K(i,function(e){return e.type===t});return e=n,w.map(e,di)};return!1===t.typeahead_urls?[]:"file"===r?(n=[pi(e,d(ci)),pi(e,f("header")),pi(e,(a=f("anchor"),l=hi(t,"anchor_top","#top"),u=hi(t,"anchor_bottom","#bottom"),null!==l&&a.unshift(fi("<top>",l)),null!==u&&a.push(fi("<bottom>",u)),a))],o=function(e,t){return 0===e.length||0===t.length?e.concat(t):e.concat(c,t)},s=[],G(n,function(e){s=o(s,e)}),s):pi(e,d(ci))},gi=function(e,t){var n,i,r,o=ci[t];/^https?/.test(e)&&(o?(n=o,i=e,r=X(n,i),-1===r?W.none():W.some(r)).isNone()&&(ci[t]=o.slice(0,5).concat(e)):ci[t]=[e])},pi=function(e,t){var n=e.toLowerCase(),i=w.grep(t,function(e){return-1!==e.title.toLowerCase().indexOf(n)});return 1===i.length&&i[0].title===e?[]:i},vi=function(o,e,n){var i=e.filepicker_validator_handler;i&&o.state.on("change:value",function(e){var t;0!==(t=e.value).length?i({url:t,type:n},function(e){var t,n,i,r=(n=(t=e).status,i=t.message,"valid"===n?{status:"ok",message:i}:"unknown"===n?{status:"warn",message:i}:"invalid"===n?{status:"warn",message:i}:{status:"none",message:""});o.statusMessage(r.message),o.statusLevel(r.status)}):o.statusLevel("none")})},bi=en.extend({Statics:{clearHistory:function(){ci={}}},init:function(e){var t,n,i,r,o,s,a,l,u=this,c=window.tinymce?window.tinymce.activeEditor:h.activeEditor,d=c.settings,f=e.filetype;e.spellcheck=!1,(i=d.file_picker_types||d.file_browser_callback_types)&&(i=w.makeMap(i,/[, ]/)),i&&!i[f]||(!(n=d.file_picker_callback)||i&&!i[f]?!(n=d.file_browser_callback)||i&&!i[f]||(t=function(){n(u.getEl("inp").id,u.value(),f,window)}):t=function(){var e=u.fire("beforecall").meta;e=w.extend({filetype:f},e),n.call(c,function(e,t){u.value(e).fire("change",{meta:t})},u.value(),e)}),t&&(e.icon="browse",e.onaction=t),u._super(e),u.classes.add("filepicker"),r=u,o=d,s=c.getBody(),a=f,l=function(e){var t=ui(s),n=mi(e,t,a,o);r.showAutoComplete(n,e)},r.on("autocomplete",function(){l(r.value())}),r.on("selectitem",function(e){var t=e.value;r.value(t.url);var n,i=(n=t.title).raw?n.raw:n;"image"===a?r.fire("change",{meta:{alt:i,attach:t.attach}}):r.fire("change",{meta:{text:i,attach:t.attach}}),r.focus()}),r.on("click",function(e){0===r.value().length&&"INPUT"===e.target.nodeName&&l("")}),r.on("PostRender",function(){r.getRoot().on("submit",function(e){e.isDefaultPrevented()||gi(r.value(),a)})}),vi(u,d,f)}}),yi=jt.extend({recalc:function(e){var t=e.layoutRect(),n=e.paddingBox;e.items().filter(":visible").each(function(e){e.layoutRect({x:n.left,y:n.top,w:t.innerW-n.right-n.left,h:t.innerH-n.top-n.bottom}),e.recalc&&e.recalc()})}}),xi=jt.extend({recalc:function(e){var t,n,i,r,o,s,a,l,u,c,d,f,h,m,g,p,v,b,y,x,w,_,R,C,E,k,H,S,T,M,N,P,W,D,O,A,B,L=[],z=Math.max,I=Math.min;for(i=e.items().filter(":visible"),r=e.layoutRect(),o=e.paddingBox,s=e.settings,f=e.isRtl()?s.direction||"row-reversed":s.direction,a=s.align,l=e.isRtl()?s.pack||"end":s.pack,u=s.spacing||0,"row-reversed"!==f&&"column-reverse"!==f||(i=i.set(i.toArray().reverse()),f=f.split("-")[0]),"column"===f?(C="y",_="h",R="minH",E="maxH",H="innerH",k="top",S="deltaH",T="contentH",D="left",P="w",M="x",N="innerW",W="minW",O="right",A="deltaW",B="contentW"):(C="x",_="w",R="minW",E="maxW",H="innerW",k="left",S="deltaW",T="contentW",D="top",P="h",M="y",N="innerH",W="minH",O="bottom",A="deltaH",B="contentH"),d=r[H]-o[k]-o[k],w=c=0,t=0,n=i.length;t<n;t++)m=(h=i[t]).layoutRect(),d-=t<n-1?u:0,0<(g=h.settings.flex)&&(c+=g,m[E]&&L.push(h),m.flex=g),d-=m[R],w<(p=o[D]+m[W]+o[O])&&(w=p);if((y={})[R]=d<0?r[R]-d+r[S]:r[H]-d+r[S],y[W]=w+r[A],y[T]=r[H]-d,y[B]=w,y.minW=I(y.minW,r.maxW),y.minH=I(y.minH,r.maxH),y.minW=z(y.minW,r.startMinWidth),y.minH=z(y.minH,r.startMinHeight),!r.autoResize||y.minW===r.minW&&y.minH===r.minH){for(b=d/c,t=0,n=L.length;t<n;t++)(v=(m=(h=L[t]).layoutRect())[E])<(p=m[R]+m.flex*b)?(d-=m[E]-m[R],c-=m.flex,m.flex=0,m.maxFlexSize=v):m.maxFlexSize=0;for(b=d/c,x=o[k],y={},0===c&&("end"===l?x=d+o[k]:"center"===l?(x=Math.round(r[H]/2-(r[H]-d)/2)+o[k])<0&&(x=o[k]):"justify"===l&&(x=o[k],u=Math.floor(d/(i.length-1)))),y[M]=o[D],t=0,n=i.length;t<n;t++)p=(m=(h=i[t]).layoutRect()).maxFlexSize||m[R],"center"===a?y[M]=Math.round(r[N]/2-m[P]/2):"stretch"===a?(y[P]=z(m[W]||0,r[N]-o[D]-o[O]),y[M]=o[D]):"end"===a&&(y[M]=r[N]-m[P]-o.top),0<m.flex&&(p+=m.flex*b),y[_]=p,y[C]=x,h.layoutRect(y),h.recalc&&h.recalc(),x+=p+u}else if(y.w=y.minW,y.h=y.minH,e.layoutRect(y),this.recalc(e),null===e._lastRect){var F=e.parent();F&&(F._lastRect=null,F.recalc())}}}),wi=Xt.extend({Defaults:{containerClass:"flow-layout",controlClass:"flow-layout-item",endClass:"break"},recalc:function(e){e.items().filter(":visible").each(function(e){e.recalc&&e.recalc()})},isNative:function(){return!0}}),_i=function(e,t){return n=t,r=(i=e)===undefined?document:i.dom(),Xn(r)?W.none():W.from(r.querySelector(n)).map(pn.fromDom);var n,i,r},Ri=function(e,t){return function(){e.execCommand("mceToggleFormat",!1,t)}},Ci=function(e,t,n){var i=function(e){n(e,t)};e.formatter?e.formatter.formatChanged(t,i):e.on("init",function(){e.formatter.formatChanged(t,i)})},Ei=function(e,n){return function(t){Ci(e,n,function(e){t.control.active(e)})}},ki=function(i){var t=["alignleft","aligncenter","alignright","alignjustify"],r="alignleft",e=[{text:"Left",icon:"alignleft",onclick:Ri(i,"alignleft")},{text:"Center",icon:"aligncenter",onclick:Ri(i,"aligncenter")},{text:"Right",icon:"alignright",onclick:Ri(i,"alignright")},{text:"Justify",icon:"alignjustify",onclick:Ri(i,"alignjustify")}];i.addMenuItem("align",{text:"Align",menu:e}),i.addButton("align",{type:"menubutton",icon:r,menu:e,onShowMenu:function(e){var n=e.control.menu;w.each(t,function(t,e){n.items().eq(e).each(function(e){return e.active(i.formatter.match(t))})})},onPostRender:function(e){var n=e.control;w.each(t,function(t,e){Ci(i,t,function(e){n.icon(r),e&&n.icon(t)})})}}),w.each({alignleft:["Align left","JustifyLeft"],aligncenter:["Align center","JustifyCenter"],alignright:["Align right","JustifyRight"],alignjustify:["Justify","JustifyFull"],alignnone:["No alignment","JustifyNone"]},function(e,t){i.addButton(t,{active:!1,tooltip:e[0],cmd:e[1],onPostRender:Ei(i,t)})})},Hi=function(e){return e?e.split(",")[0]:""},Si=function(l,u){return function(){var a=this;a.state.set("value",null),l.on("init nodeChange",function(e){var t,n,i,r,o=l.queryCommandValue("FontName"),s=(t=u,r=(n=o)?n.toLowerCase():"",w.each(t,function(e){e.value.toLowerCase()===r&&(i=e.value)}),w.each(t,function(e){i||Hi(e.value).toLowerCase()!==Hi(r).toLowerCase()||(i=e.value)}),i);a.value(s||null),!s&&o&&a.text(Hi(o))})}},Ti=function(n){n.addButton("fontselect",function(){var e,t=(e=function(e){for(var t=(e=e.replace(/;$/,"").split(";")).length;t--;)e[t]=e[t].split("=");return e}(n.settings.font_formats||"Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats"),w.map(e,function(e){return{text:{raw:e[0]},value:e[1],textStyle:-1===e[1].indexOf("dings")?"font-family:"+e[1]:""}}));return{type:"listbox",text:"Font Family",tooltip:"Font Family",values:t,fixedWidth:!0,onPostRender:Si(n,t),onselect:function(e){e.control.settings.value&&n.execCommand("FontName",!1,e.control.settings.value)}}})},Mi=function(e){Ti(e)},Ni=function(e,t){return/[0-9.]+px$/.test(e)?(n=72*parseInt(e,10)/96,i=t||0,r=Math.pow(10,i),Math.round(n*r)/r+"pt"):e;var n,i,r},Pi=function(e,t,n){var i;return w.each(e,function(e){e.value===n?i=n:e.value===t&&(i=t)}),i},Wi=function(n){n.addButton("fontsizeselect",function(){var e,s,a,t=(e=n.settings.fontsize_formats||"8pt 10pt 12pt 14pt 18pt 24pt 36pt",w.map(e.split(" "),function(e){var t=e,n=e,i=e.split("=");return 1<i.length&&(t=i[0],n=i[1]),{text:t,value:n}}));return{type:"listbox",text:"Font Sizes",tooltip:"Font Sizes",values:t,fixedWidth:!0,onPostRender:(s=n,a=t,function(){var o=this;s.on("init nodeChange",function(e){var t,n,i,r;if(t=s.queryCommandValue("FontSize"))for(i=3;!r&&0<=i;i--)n=Ni(t,i),r=Pi(a,n,t);o.value(r||null),r||o.text(n)})}),onclick:function(e){e.control.settings.value&&n.execCommand("FontSize",!1,e.control.settings.value)}}})},Di=function(e){Wi(e)},Oi=function(n,e){var i=e.length;return w.each(e,function(e){e.menu&&(e.hidden=0===Oi(n,e.menu));var t=e.format;t&&(e.hidden=!n.formatter.canApply(t)),e.hidden&&i--}),i},Ai=function(n,e){var i=e.items().length;return e.items().each(function(e){e.menu&&e.visible(0<Ai(n,e.menu)),!e.menu&&e.settings.menu&&e.visible(0<Oi(n,e.settings.menu));var t=e.settings.format;t&&e.visible(n.formatter.canApply(t)),e.visible()||i--}),i},Bi=function(e){var i,r,o,t,s,n,a,l,u=(r=0,o=[],t=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",icon:"bold",format:"bold"},{title:"Italic",icon:"italic",format:"italic"},{title:"Underline",icon:"underline",format:"underline"},{title:"Strikethrough",icon:"strikethrough",format:"strikethrough"},{title:"Superscript",icon:"superscript",format:"superscript"},{title:"Subscript",icon:"subscript",format:"subscript"},{title:"Code",icon:"code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Alignment",items:[{title:"Left",icon:"alignleft",format:"alignleft"},{title:"Center",icon:"aligncenter",format:"aligncenter"},{title:"Right",icon:"alignright",format:"alignright"},{title:"Justify",icon:"alignjustify",format:"alignjustify"}]}],s=function(e){var i=[];if(e)return w.each(e,function(e){var t={text:e.title,icon:e.icon};if(e.items)t.menu=s(e.items);else{var n=e.format||"custom"+r++;e.format||(e.name=n,o.push(e)),t.format=n,t.cmd=e.cmd}i.push(t)}),i},(i=e).on("init",function(){w.each(o,function(e){i.formatter.register(e.name,e)})}),{type:"menu",items:i.settings.style_formats_merge?i.settings.style_formats?s(t.concat(i.settings.style_formats)):s(t):s(i.settings.style_formats||t),onPostRender:function(e){i.fire("renderFormatsMenu",{control:e.control})},itemDefaults:{preview:!0,textStyle:function(){if(this.settings.format)return i.formatter.getCssText(this.settings.format)},onPostRender:function(){var n=this;n.parent().on("show",function(){var e,t;(e=n.settings.format)&&(n.disabled(!i.formatter.canApply(e)),n.active(i.formatter.match(e))),(t=n.settings.cmd)&&n.active(i.queryCommandState(t))})},onclick:function(){this.settings.format&&Ri(i,this.settings.format)(),this.settings.cmd&&i.execCommand(this.settings.cmd)}}});n=u,e.addMenuItem("formats",{text:"Formats",menu:n}),l=u,(a=e).addButton("styleselect",{type:"menubutton",text:"Formats",menu:l,onShowMenu:function(){a.settings.style_formats_autohide&&Ai(a,this.menu)}})},Li=function(n,e){return function(){var r,o,s,t=[];return w.each(e,function(e){t.push({text:e[0],value:e[1],textStyle:function(){return n.formatter.getCssText(e[1])}})}),{type:"listbox",text:e[0][0],values:t,fixedWidth:!0,onselect:function(e){if(e.control){var t=e.control.value();Ri(n,t)()}},onPostRender:(r=n,o=t,function(){var t=this;r.on("nodeChange",function(e){var n=r.formatter,i=null;w.each(e.parents,function(t){if(w.each(o,function(e){if(s?n.matchNode(t,s,{value:e.value})&&(i=e.value):n.matchNode(t,e.value)&&(i=e.value),i)return!1}),i)return!1}),t.value(i)})})}}},zi=function(e){var t,n,i=function(e){for(var t=(e=e.replace(/;$/,"").split(";")).length;t--;)e[t]=e[t].split("=");return e}(e.settings.block_formats||"Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6;Preformatted=pre");e.addMenuItem("blockformats",{text:"Blocks",menu:(t=e,n=i,w.map(n,function(e){return{text:e[0],onclick:Ri(t,e[1]),textStyle:function(){return t.formatter.getCssText(e[1])}}}))}),e.addButton("formatselect",Li(e,i))},Ii=function(t,e){var n,i;if("string"==typeof e)i=e.split(" ");else if(w.isArray(e))return function(e){for(var t=[],n=0,i=e.length;n<i;++n){if(!Array.prototype.isPrototypeOf(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);ee.apply(t,e[n])}return t}(w.map(e,function(e){return Ii(t,e)}));return n=w.grep(i,function(e){return"|"===e||e in t.menuItems}),w.map(n,function(e){return"|"===e?{text:"-"}:t.menuItems[e]})},Fi=function(e){return e&&"-"===e.text},Ui=function(e){var t=K(e,function(e,t,n){return!Fi(e)||!Fi(n[t-1])});return K(t,function(e,t,n){return!Fi(e)||0<t&&t<n.length-1})},Vi=function(e){var t,n,i,r,o=e.settings.insert_button_items;return Ui(o?Ii(e,o):(t=e,n="insert",i=[{text:"-"}],r=w.grep(t.menuItems,function(e){return e.context===n}),w.each(r,function(e){"before"===e.separator&&i.push({text:"|"}),e.prependToContext?i.unshift(e):i.push(e),"after"===e.separator&&i.push({text:"|"})}),i))},Yi=function(e){var t;(t=e).addButton("insert",{type:"menubutton",icon:"insert",menu:[],oncreatemenu:function(){this.menu.add(Vi(t)),this.menu.renderNew()}})},$i=function(e){var n,i,r;n=e,w.each({bold:"Bold",italic:"Italic",underline:"Underline",strikethrough:"Strikethrough",subscript:"Subscript",superscript:"Superscript"},function(e,t){n.addButton(t,{active:!1,tooltip:e,onPostRender:Ei(n,t),onclick:Ri(n,t)})}),i=e,w.each({outdent:["Decrease indent","Outdent"],indent:["Increase indent","Indent"],cut:["Cut","Cut"],copy:["Copy","Copy"],paste:["Paste","Paste"],help:["Help","mceHelp"],selectall:["Select all","SelectAll"],visualaid:["Visual aids","mceToggleVisualAid"],newdocument:["New document","mceNewDocument"],removeformat:["Clear formatting","RemoveFormat"],remove:["Remove","Delete"]},function(e,t){i.addButton(t,{tooltip:e[0],cmd:e[1]})}),r=e,w.each({blockquote:["Blockquote","mceBlockQuote"],subscript:["Subscript","Subscript"],superscript:["Superscript","Superscript"]},function(e,t){r.addButton(t,{active:!1,tooltip:e[0],cmd:e[1],onPostRender:Ei(r,t)})})},qi=function(e){var n;$i(e),n=e,w.each({bold:["Bold","Bold","Meta+B"],italic:["Italic","Italic","Meta+I"],underline:["Underline","Underline","Meta+U"],strikethrough:["Strikethrough","Strikethrough"],subscript:["Subscript","Subscript"],superscript:["Superscript","Superscript"],removeformat:["Clear formatting","RemoveFormat"],newdocument:["New document","mceNewDocument"],cut:["Cut","Cut","Meta+X"],copy:["Copy","Copy","Meta+C"],paste:["Paste","Paste","Meta+V"],selectall:["Select all","SelectAll","Meta+A"]},function(e,t){n.addMenuItem(t,{text:e[0],icon:t,shortcut:e[2],cmd:e[1]})}),n.addMenuItem("codeformat",{text:"Code",icon:"code",onclick:Ri(n,"code")})},Xi=function(n,i){return function(){var e=this,t=function(){var e="redo"===i?"hasRedo":"hasUndo";return!!n.undoManager&&n.undoManager[e]()};e.disabled(!t()),n.on("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",function(){e.disabled(n.readonly||!t())})}},ji=function(e){var t,n;(t=e).addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Meta+Z",onPostRender:Xi(t,"undo"),cmd:"undo"}),t.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Meta+Y",onPostRender:Xi(t,"redo"),cmd:"redo"}),(n=e).addButton("undo",{tooltip:"Undo",onPostRender:Xi(n,"undo"),cmd:"undo"}),n.addButton("redo",{tooltip:"Redo",onPostRender:Xi(n,"redo"),cmd:"redo"})},Ji=function(e){var t,n;(t=e).addMenuItem("visualaid",{text:"Visual aids",selectable:!0,onPostRender:(n=t,function(){var t=this;n.on("VisualAid",function(e){t.active(e.hasVisual)}),t.active(n.hasVisual)}),cmd:"mceToggleVisualAid"})},Gi={setup:function(e){var t;e.rtl&&(ot.rtl=!0),e.on("mousedown progressstate",function(){Et.hideAll()}),(t=e).settings.ui_container&&(de.container=_i(pn.fromDom(document.body),t.settings.ui_container).fold(k(null),function(e){return e.dom()})),Pt.tooltips=!de.iOS,ot.translate=function(e){return h.translate(e)},zi(e),ki(e),qi(e),ji(e),Di(e),Mi(e),Bi(e),Ji(e),Yi(e)}},Ki=jt.extend({recalc:function(e){var t,n,i,r,o,s,a,l,u,c,d,f,h,m,g,p,v,b,y,x,w,_,R,C,E,k,H,S,T=[],M=[];t=e.settings,r=e.items().filter(":visible"),o=e.layoutRect(),i=t.columns||Math.ceil(Math.sqrt(r.length)),n=Math.ceil(r.length/i),b=t.spacingH||t.spacing||0,y=t.spacingV||t.spacing||0,x=t.alignH||t.align,w=t.alignV||t.align,p=e.paddingBox,S="reverseRows"in t?t.reverseRows:e.isRtl(),x&&"string"==typeof x&&(x=[x]),w&&"string"==typeof w&&(w=[w]);for(d=0;d<i;d++)T.push(0);for(f=0;f<n;f++)M.push(0);for(f=0;f<n;f++)for(d=0;d<i&&(c=r[f*i+d]);d++)C=(u=c.layoutRect()).minW,E=u.minH,T[d]=C>T[d]?C:T[d],M[f]=E>M[f]?E:M[f];for(k=o.innerW-p.left-p.right,d=_=0;d<i;d++)_+=T[d]+(0<d?b:0),k-=(0<d?b:0)+T[d];for(H=o.innerH-p.top-p.bottom,f=R=0;f<n;f++)R+=M[f]+(0<f?y:0),H-=(0<f?y:0)+M[f];if(_+=p.left+p.right,R+=p.top+p.bottom,(l={}).minW=_+(o.w-o.innerW),l.minH=R+(o.h-o.innerH),l.contentW=l.minW-o.deltaW,l.contentH=l.minH-o.deltaH,l.minW=Math.min(l.minW,o.maxW),l.minH=Math.min(l.minH,o.maxH),l.minW=Math.max(l.minW,o.startMinWidth),l.minH=Math.max(l.minH,o.startMinHeight),!o.autoResize||l.minW===o.minW&&l.minH===o.minH){var N;o.autoResize&&((l=e.layoutRect(l)).contentW=l.minW-o.deltaW,l.contentH=l.minH-o.deltaH),N="start"===t.packV?0:0<H?Math.floor(H/n):0;var P=0,W=t.flexWidths;if(W)for(d=0;d<W.length;d++)P+=W[d];else P=i;var D=k/P;for(d=0;d<i;d++)T[d]+=W?W[d]*D:D;for(m=p.top,f=0;f<n;f++){for(h=p.left,a=M[f]+N,d=0;d<i&&(c=r[S?f*i+i-1-d:f*i+d]);d++)g=c.settings,u=c.layoutRect(),s=Math.max(T[d],u.startMinWidth),u.x=h,u.y=m,"center"===(v=g.alignH||(x?x[d]||x[0]:null))?u.x=h+s/2-u.w/2:"right"===v?u.x=h+s-u.w:"stretch"===v&&(u.w=s),"center"===(v=g.alignV||(w?w[d]||w[0]:null))?u.y=m+a/2-u.h/2:"bottom"===v?u.y=m+a-u.h:"stretch"===v&&(u.h=a),c.layoutRect(u),h+=s+b,c.recalc&&c.recalc();m+=a+y}}else if(l.w=l.minW,l.h=l.minH,e.layoutRect(l),this.recalc(e),null===e._lastRect){var O=e.parent();O&&(O._lastRect=null,O.recalc())}}}),Zi=Pt.extend({renderHtml:function(){var e=this;return e.classes.add("iframe"),e.canFocus=!1,'<iframe id="'+e._id+'" class="'+e.classes+'" tabindex="-1" src="'+(e.settings.url||"javascript:''")+'" frameborder="0"></iframe>'},src:function(e){this.getEl().src=e},html:function(e,t){var n=this,i=this.getEl().contentWindow.document.body;return i?(i.innerHTML=e,t&&t()):u.setTimeout(function(){n.html(e)}),this}}),Qi=Pt.extend({init:function(e){this._super(e),this.classes.add("widget").add("infobox"),this.canFocus=!1},severity:function(e){this.classes.remove("error"),this.classes.remove("warning"),this.classes.remove("success"),this.classes.add(e)},help:function(e){this.state.set("help",e)},renderHtml:function(){var e=this,t=e.classPrefix;return'<div id="'+e._id+'" class="'+e.classes+'"><div id="'+e._id+'-body">'+e.encode(e.state.get("text"))+'<button role="button" tabindex="-1"><i class="'+t+"ico "+t+'i-help"></i></button></div></div>'},bindStates:function(){var t=this;return t.state.on("change:text",function(e){t.getEl("body").firstChild.data=t.encode(e.value),t.state.get("rendered")&&t.updateLayoutRect()}),t.state.on("change:help",function(e){t.classes.toggle("has-help",e.value),t.state.get("rendered")&&t.updateLayoutRect()}),t._super()}}),er=Pt.extend({init:function(e){var t=this;t._super(e),t.classes.add("widget").add("label"),t.canFocus=!1,e.multiline&&t.classes.add("autoscroll"),e.strong&&t.classes.add("strong")},initLayoutRect:function(){var e=this,t=e._super();return e.settings.multiline&&(_e.getSize(e.getEl()).width>t.maxW&&(t.minW=t.maxW,e.classes.add("multiline")),e.getEl().style.width=t.minW+"px",t.startMinH=t.h=t.minH=Math.min(t.maxH,_e.getSize(e.getEl()).height)),t},repaint:function(){return this.settings.multiline||(this.getEl().style.lineHeight=this.layoutRect().h+"px"),this._super()},severity:function(e){this.classes.remove("error"),this.classes.remove("warning"),this.classes.remove("success"),this.classes.add(e)},renderHtml:function(){var e,t,n=this,i=n.settings.forId,r=n.settings.html?n.settings.html:n.encode(n.state.get("text"));return!i&&(t=n.settings.forName)&&(e=n.getRoot().find("#"+t)[0])&&(i=e._id),i?'<label id="'+n._id+'" class="'+n.classes+'"'+(i?' for="'+i+'"':"")+">"+r+"</label>":'<span id="'+n._id+'" class="'+n.classes+'">'+r+"</span>"},bindStates:function(){var t=this;return t.state.on("change:text",function(e){t.innerHtml(t.encode(e.value)),t.state.get("rendered")&&t.updateLayoutRect()}),t._super()}}),tr=ut.extend({Defaults:{role:"toolbar",layout:"flow"},init:function(e){this._super(e),this.classes.add("toolbar")},postRender:function(){return this.items().each(function(e){e.classes.add("toolbar-item")}),this._super()}}),nr=tr.extend({Defaults:{role:"menubar",containerCls:"menubar",ariaRoot:!0,defaults:{type:"menubutton"}}}),ir=Jt.extend({init:function(e){var t=this;t._renderOpen=!0,t._super(e),e=t.settings,t.classes.add("menubtn"),e.fixedWidth&&t.classes.add("fixed-width"),t.aria("haspopup",!0),t.state.set("menu",e.menu||t.render())},showMenu:function(e){var t,n=this;if(n.menu&&n.menu.visible()&&!1!==e)return n.hideMenu();n.menu||(t=n.state.get("menu")||[],n.classes.add("opened"),t.length?t={type:"menu",animate:!0,items:t}:(t.type=t.type||"menu",t.animate=!0),t.renderTo?n.menu=t.parent(n).show().renderTo():n.menu=b.create(t).parent(n).renderTo(),n.fire("createmenu"),n.menu.reflow(),n.menu.on("cancel",function(e){e.control.parent()===n.menu&&(e.stopPropagation(),n.focus(),n.hideMenu())}),n.menu.on("select",function(){n.focus()}),n.menu.on("show hide",function(e){"hide"===e.type&&e.control.parent()===n&&n.classes.remove("opened-under"),e.control===n.menu&&(n.activeMenu("show"===e.type),n.classes.toggle("opened","show"===e.type)),n.aria("expanded","show"===e.type)}).fire("show")),n.menu.show(),n.menu.layoutRect({w:n.layoutRect().w}),n.menu.repaint(),n.menu.moveRel(n.getEl(),n.isRtl()?["br-tr","tr-br"]:["bl-tl","tl-bl"]);var i=n.menu.layoutRect(),r=n.$el.offset().top+n.layoutRect().h;r>i.y&&r<i.y+i.h&&n.classes.add("opened-under"),n.fire("showmenu")},hideMenu:function(){this.menu&&(this.menu.items().each(function(e){e.hideMenu&&e.hideMenu()}),this.menu.hide())},activeMenu:function(e){this.classes.toggle("active",e)},renderHtml:function(){var e,t=this,n=t._id,i=t.classPrefix,r=t.settings.icon,o=t.state.get("text"),s="";return(e=t.settings.image)?(r="none","string"!=typeof e&&(e=window.getSelection?e[0]:e[1]),e=" style=\"background-image: url('"+e+"')\""):e="",o&&(t.classes.add("btn-has-text"),s='<span class="'+i+'txt">'+t.encode(o)+"</span>"),r=t.settings.icon?i+"ico "+i+"i-"+r:"",t.aria("role",t.parent()instanceof nr?"menuitem":"button"),'<div id="'+n+'" class="'+t.classes+'" tabindex="-1" aria-labelledby="'+n+'"><button id="'+n+'-open" role="presentation" type="button" tabindex="-1">'+(r?'<i class="'+r+'"'+e+"></i>":"")+s+' <i class="'+i+'caret"></i></button></div>'},postRender:function(){var r=this;return r.on("click",function(e){e.control===r&&function(e,t){for(;e;){if(t===e)return!0;e=e.parentNode}return!1}(e.target,r.getEl())&&(r.focus(),r.showMenu(!e.aria),e.aria&&r.menu.items().filter(":visible")[0].focus())}),r.on("mouseenter",function(e){var t,n=e.control,i=r.parent();n&&i&&n instanceof ir&&n.parent()===i&&(i.items().filter("MenuButton").each(function(e){e.hideMenu&&e!==n&&(e.menu&&e.menu.visible()&&(t=!0),e.hideMenu())}),t&&(n.focus(),n.showMenu()))}),r._super()},bindStates:function(){var e=this;return e.state.on("change:menu",function(){e.menu&&e.menu.remove(),e.menu=null}),e._super()},remove:function(){this._super(),this.menu&&this.menu.remove()}}),rr=Et.extend({Defaults:{defaultType:"menuitem",border:1,layout:"stack",role:"application",bodyRole:"menu",ariaRoot:!0},init:function(e){if(e.autohide=!0,e.constrainToViewport=!0,"function"==typeof e.items&&(e.itemsFactory=e.items,e.items=[]),e.itemDefaults)for(var t=e.items,n=t.length;n--;)t[n]=w.extend({},e.itemDefaults,t[n]);this._super(e),this.classes.add("menu"),e.animate&&11!==de.ie&&this.classes.add("animate")},repaint:function(){return this.classes.toggle("menu-align",!0),this._super(),this.getEl().style.height="",this.getEl("body").style.height="",this},cancel:function(){this.hideAll(),this.fire("select")},load:function(){var t,n=this;function i(){n.throbber&&(n.throbber.hide(),n.throbber=null)}n.settings.itemsFactory&&(n.throbber||(n.throbber=new St(n.getEl("body"),!0),0===n.items().length?(n.throbber.show(),n.fire("loading")):n.throbber.show(100,function(){n.items().remove(),n.fire("loading")}),n.on("hide close",i)),n.requestTime=t=(new Date).getTime(),n.settings.itemsFactory(function(e){0!==e.length?n.requestTime===t&&(n.getEl().style.width="",n.getEl("body").style.width="",i(),n.items().remove(),n.getEl("body").innerHTML="",n.add(e),n.renderNew(),n.fire("loaded")):n.hide()}))},hideAll:function(){return this.find("menuitem").exec("hideMenu"),this._super()},preRender:function(){var n=this;return n.items().each(function(e){var t=e.settings;if(t.icon||t.image||t.selectable)return!(n._hasIcons=!0)}),n.settings.itemsFactory&&n.on("postrender",function(){n.settings.itemsFactory&&n.load()}),n.on("show hide",function(e){e.control===n&&("show"===e.type?u.setTimeout(function(){n.classes.add("in")},0):n.classes.remove("in"))}),n._super()}}),or=ir.extend({init:function(i){var t,r,o,n,s=this;s._super(i),i=s.settings,s._values=t=i.values,t&&("undefined"!=typeof i.value&&function e(t){for(var n=0;n<t.length;n++){if(r=t[n].selected||i.value===t[n].value)return o=o||t[n].text,s.state.set("value",t[n].value),!0;if(t[n].menu&&e(t[n].menu))return!0}}(t),!r&&0<t.length&&(o=t[0].text,s.state.set("value",t[0].value)),s.state.set("menu",t)),s.state.set("text",i.text||o),s.classes.add("listbox"),s.on("select",function(e){var t=e.control;n&&(e.lastControl=n),i.multiple?t.active(!t.active()):s.value(e.control.value()),n=t})},value:function(n){return 0===arguments.length?this.state.get("value"):(void 0===n||(this.settings.values&&!function t(e){return j(e,function(e){return e.menu?t(e.menu):e.value===n})}(this.settings.values)?null===n&&this.state.set("value",null):this.state.set("value",n)),this)},bindStates:function(){var i=this;return i.on("show",function(e){var t,n;t=e.control,n=i.value(),t instanceof rr&&t.items().each(function(e){e.hasMenus()||e.active(e.value()===n)})}),i.state.on("change:value",function(t){var n=function e(t,n){var i;if(t)for(var r=0;r<t.length;r++){if(t[r].value===n)return t[r];if(t[r].menu&&(i=e(t[r].menu,n)))return i}}(i.state.get("menu"),t.value);n?i.text(n.text):i.text(i.settings.text)}),i._super()}}),sr=Pt.extend({Defaults:{border:0,role:"menuitem"},init:function(e){var t,n=this;n._super(e),e=n.settings,n.classes.add("menu-item"),e.menu&&n.classes.add("menu-item-expand"),e.preview&&n.classes.add("menu-item-preview"),"-"!==(t=n.state.get("text"))&&"|"!==t||(n.classes.add("menu-item-sep"),n.aria("role","separator"),n.state.set("text","-")),e.selectable&&(n.aria("role","menuitemcheckbox"),n.classes.add("menu-item-checkbox"),e.icon="selected"),e.preview||e.selectable||n.classes.add("menu-item-normal"),n.on("mousedown",function(e){e.preventDefault()}),e.menu&&!e.ariaHideMenu&&n.aria("haspopup",!0)},hasMenus:function(){return!!this.settings.menu},showMenu:function(){var t,n=this,e=n.settings,i=n.parent();if(i.items().each(function(e){e!==n&&e.hideMenu()}),e.menu){(t=n.menu)?t.show():((t=e.menu).length?t={type:"menu",items:t}:t.type=t.type||"menu",i.settings.itemDefaults&&(t.itemDefaults=i.settings.itemDefaults),(t=n.menu=b.create(t).parent(n).renderTo()).reflow(),t.on("cancel",function(e){e.stopPropagation(),n.focus(),t.hide()}),t.on("show hide",function(e){e.control.items&&e.control.items().each(function(e){e.active(e.settings.selected)})}).fire("show"),t.on("hide",function(e){e.control===t&&n.classes.remove("selected")}),t.submenu=!0),t._parentMenu=i,t.classes.add("menu-sub");var r=t.testMoveRel(n.getEl(),n.isRtl()?["tl-tr","bl-br","tr-tl","br-bl"]:["tr-tl","br-bl","tl-tr","bl-br"]);t.moveRel(n.getEl(),r),r="menu-sub-"+(t.rel=r),t.classes.remove(t._lastRel).add(r),t._lastRel=r,n.classes.add("selected"),n.aria("expanded",!0)}},hideMenu:function(){var e=this;return e.menu&&(e.menu.items().each(function(e){e.hideMenu&&e.hideMenu()}),e.menu.hide(),e.aria("expanded",!1)),e},renderHtml:function(){var e,t=this,n=t._id,i=t.settings,r=t.classPrefix,o=t.state.get("text"),s=t.settings.icon,a="",l=i.shortcut,u=t.encode(i.url);function c(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function d(e){var t=i.match||"";return t?e.replace(new RegExp(c(t),"gi"),function(e){return"!mce~match["+e+"]mce~match!"}):e}function f(e){return e.replace(new RegExp(c("!mce~match["),"g"),"<b>").replace(new RegExp(c("]mce~match!"),"g"),"</b>")}return s&&t.parent().classes.add("menu-has-icons"),i.image&&(a=" style=\"background-image: url('"+i.image+"')\""),l&&(l=function(e){var t,n,i={};for(i=de.mac?{alt:"&#x2325;",ctrl:"&#x2318;",shift:"&#x21E7;",meta:"&#x2318;"}:{meta:"Ctrl"},e=e.split("+"),t=0;t<e.length;t++)(n=i[e[t].toLowerCase()])&&(e[t]=n);return e.join("+")}(l)),s=r+"ico "+r+"i-"+(t.settings.icon||"none"),e="-"!==o?'<i class="'+s+'"'+a+"></i>\xa0":"",o=f(t.encode(d(o))),u=f(t.encode(d(u))),'<div id="'+n+'" class="'+t.classes+'" tabindex="-1">'+e+("-"!==o?'<span id="'+n+'-text" class="'+r+'text">'+o+"</span>":"")+(l?'<div id="'+n+'-shortcut" class="'+r+'menu-shortcut">'+l+"</div>":"")+(i.menu?'<div class="'+r+'caret"></div>':"")+(u?'<div class="'+r+'menu-item-link">'+u+"</div>":"")+"</div>"},postRender:function(){var t=this,n=t.settings,e=n.textStyle;if("function"==typeof e&&(e=e.call(this)),e){var i=t.getEl("text");i&&(i.setAttribute("style",e),t._textStyle=e)}return t.on("mouseenter click",function(e){e.control===t&&(n.menu||"click"!==e.type?(t.showMenu(),e.aria&&t.menu.focus(!0)):(t.fire("select"),u.requestAnimationFrame(function(){t.parent().hideAll()})))}),t._super(),t},hover:function(){return this.parent().items().each(function(e){e.classes.remove("selected")}),this.classes.toggle("selected",!0),this},active:function(e){return function(e,t){var n=e._textStyle;if(n){var i=e.getEl("text");i.setAttribute("style",n),t&&(i.style.color="",i.style.backgroundColor="")}}(this,e),void 0!==e&&this.aria("checked",e),this._super(e)},remove:function(){this._super(),this.menu&&this.menu.remove()}}),ar=Zt.extend({Defaults:{classes:"radio",role:"radio"}}),lr=Pt.extend({renderHtml:function(){var e=this,t=e.classPrefix;return e.classes.add("resizehandle"),"both"===e.settings.direction&&e.classes.add("resizehandle-both"),e.canFocus=!1,'<div id="'+e._id+'" class="'+e.classes+'"><i class="'+t+"ico "+t+'i-resize"></i></div>'},postRender:function(){var t=this;t._super(),t.resizeDragHelper=new dt(this._id,{start:function(){t.fire("ResizeStart")},drag:function(e){"both"!==t.settings.direction&&(e.deltaX=0),t.fire("Resize",e)},stop:function(){t.fire("ResizeEnd")}})},remove:function(){return this.resizeDragHelper&&this.resizeDragHelper.destroy(),this._super()}});function ur(e){var t="";if(e)for(var n=0;n<e.length;n++)t+='<option value="'+e[n]+'">'+e[n]+"</option>";return t}var cr=Pt.extend({Defaults:{classes:"selectbox",role:"selectbox",options:[]},init:function(e){var n=this;n._super(e),n.settings.size&&(n.size=n.settings.size),n.settings.options&&(n._options=n.settings.options),n.on("keydown",function(e){var t;13===e.keyCode&&(e.preventDefault(),n.parents().reverse().each(function(e){if(e.toJSON)return t=e,!1}),n.fire("submit",{data:t.toJSON()}))})},options:function(e){return arguments.length?(this.state.set("options",e),this):this.state.get("options")},renderHtml:function(){var e,t=this,n="";return e=ur(t._options),t.size&&(n=' size = "'+t.size+'"'),'<select id="'+t._id+'" class="'+t.classes+'"'+n+">"+e+"</select>"},bindStates:function(){var t=this;return t.state.on("change:options",function(e){t.getEl().innerHTML=ur(e.value)}),t._super()}});function dr(e,t,n){return e<t&&(e=t),n<e&&(e=n),e}function fr(e,t,n){e.setAttribute("aria-"+t,n)}function hr(e,t){var n,i,r,o,s;"v"===e.settings.orientation?(r="top",i="height",n="h"):(r="left",i="width",n="w"),s=e.getEl("handle"),o=((e.layoutRect()[n]||100)-_e.getSize(s)[i])*((t-e._minValue)/(e._maxValue-e._minValue))+"px",s.style[r]=o,s.style.height=e.layoutRect().h+"px",fr(s,"valuenow",t),fr(s,"valuetext",""+e.settings.previewFilter(t)),fr(s,"valuemin",e._minValue),fr(s,"valuemax",e._maxValue)}var mr=Pt.extend({init:function(e){var t=this;e.previewFilter||(e.previewFilter=function(e){return Math.round(100*e)/100}),t._super(e),t.classes.add("slider"),"v"===e.orientation&&t.classes.add("vertical"),t._minValue=q(e.minValue)?e.minValue:0,t._maxValue=q(e.maxValue)?e.maxValue:100,t._initValue=t.state.get("value")},renderHtml:function(){var e=this._id,t=this.classPrefix;return'<div id="'+e+'" class="'+this.classes+'"><div id="'+e+'-handle" class="'+t+'slider-handle" role="slider" tabindex="-1"></div></div>'},reset:function(){this.value(this._initValue).repaint()},postRender:function(){var e,t,n,i,r,o,s,a,l,u,c,d,f,h,m=this;e=m._minValue,t=m._maxValue,"v"===m.settings.orientation?(n="screenY",i="top",r="height",o="h"):(n="screenX",i="left",r="width",o="w"),m._super(),function(o,s){function t(e){var t,n,i,r;t=dr(t=(((t=m.value())+(r=n=o))/((i=s)-r)+.05*e)*(i-n)-n,o,s),m.value(t),m.fire("dragstart",{value:t}),m.fire("drag",{value:t}),m.fire("dragend",{value:t})}m.on("keydown",function(e){switch(e.keyCode){case 37:case 38:t(-1);break;case 39:case 40:t(1)}})}(e,t),s=e,a=t,l=m.getEl("handle"),m._dragHelper=new dt(m._id,{handle:m._id+"-handle",start:function(e){u=e[n],c=parseInt(m.getEl("handle").style[i],10),d=(m.layoutRect()[o]||100)-_e.getSize(l)[r],m.fire("dragstart",{value:h})},drag:function(e){var t=e[n]-u;f=dr(c+t,0,d),l.style[i]=f+"px",h=s+f/d*(a-s),m.value(h),m.tooltip().text(""+m.settings.previewFilter(h)).show().moveRel(l,"bc tc"),m.fire("drag",{value:h})},stop:function(){m.tooltip().hide(),m.fire("dragend",{value:h})}})},repaint:function(){this._super(),hr(this,this.value())},bindStates:function(){var t=this;return t.state.on("change:value",function(e){hr(t,e.value)}),t._super()}}),gr=Pt.extend({renderHtml:function(){return this.classes.add("spacer"),this.canFocus=!1,'<div id="'+this._id+'" class="'+this.classes+'"></div>'}}),pr=ir.extend({Defaults:{classes:"widget btn splitbtn",role:"button"},repaint:function(){var e,t,n=this.getEl(),i=this.layoutRect();return this._super(),e=n.firstChild,t=n.lastChild,xe(e).css({width:i.w-_e.getSize(t).width,height:i.h-2}),xe(t).css({height:i.h-2}),this},activeMenu:function(e){xe(this.getEl().lastChild).toggleClass(this.classPrefix+"active",e)},renderHtml:function(){var e,t,n=this,i=n._id,r=n.classPrefix,o=n.state.get("icon"),s=n.state.get("text"),a=n.settings,l="";return(e=a.image)?(o="none","string"!=typeof e&&(e=window.getSelection?e[0]:e[1]),e=" style=\"background-image: url('"+e+"')\""):e="",o=a.icon?r+"ico "+r+"i-"+o:"",s&&(n.classes.add("btn-has-text"),l='<span class="'+r+'txt">'+n.encode(s)+"</span>"),t="boolean"==typeof a.active?' aria-pressed="'+a.active+'"':"",'<div id="'+i+'" class="'+n.classes+'" role="button"'+t+' tabindex="-1"><button type="button" hidefocus="1" tabindex="-1">'+(o?'<i class="'+o+'"'+e+"></i>":"")+l+'</button><button type="button" class="'+r+'open" hidefocus="1" tabindex="-1">'+(n._menuBtnText?(o?"\xa0":"")+n._menuBtnText:"")+' <i class="'+r+'caret"></i></button></div>'},postRender:function(){var n=this.settings.onclick;return this.on("click",function(e){var t=e.target;if(e.control===this)for(;t;){if(e.aria&&"down"!==e.aria.key||"BUTTON"===t.nodeName&&-1===t.className.indexOf("open"))return e.stopImmediatePropagation(),void(n&&n.call(this,e));t=t.parentNode}}),delete this.settings.onclick,this._super()}}),vr=wi.extend({Defaults:{containerClass:"stack-layout",controlClass:"stack-layout-item",endClass:"break"},isNative:function(){return!0}}),br=vt.extend({Defaults:{layout:"absolute",defaults:{type:"panel"}},activateTab:function(n){var e;this.activeTabId&&(e=this.getEl(this.activeTabId),xe(e).removeClass(this.classPrefix+"active"),e.setAttribute("aria-selected","false")),this.activeTabId="t"+n,(e=this.getEl("t"+n)).setAttribute("aria-selected","true"),xe(e).addClass(this.classPrefix+"active"),this.items()[n].show().fire("showtab"),this.reflow(),this.items().each(function(e,t){n!==t&&e.hide()})},renderHtml:function(){var i=this,e=i._layout,r="",o=i.classPrefix;return i.preRender(),e.preRender(i),i.items().each(function(e,t){var n=i._id+"-t"+t;e.aria("role","tabpanel"),e.aria("labelledby",n),r+='<div id="'+n+'" class="'+o+'tab" unselectable="on" role="tab" aria-controls="'+e._id+'" aria-selected="false" tabIndex="-1">'+i.encode(e.settings.title)+"</div>"}),'<div id="'+i._id+'" class="'+i.classes+'" hidefocus="1" tabindex="-1"><div id="'+i._id+'-head" class="'+o+'tabs" role="tablist">'+r+'</div><div id="'+i._id+'-body" class="'+i.bodyClasses+'">'+e.renderHtml(i)+"</div></div>"},postRender:function(){var i=this;i._super(),i.settings.activeTab=i.settings.activeTab||0,i.activateTab(i.settings.activeTab),this.on("click",function(e){var t=e.target.parentNode;if(t&&t.id===i._id+"-head")for(var n=t.childNodes.length;n--;)t.childNodes[n]===e.target&&i.activateTab(n)})},initLayoutRect:function(){var e,t,n,i=this;t=(t=_e.getSize(i.getEl("head")).width)<0?0:t,n=0,i.items().each(function(e){t=Math.max(t,e.layoutRect().minW),n=Math.max(n,e.layoutRect().minH)}),i.items().each(function(e){e.settings.x=0,e.settings.y=0,e.settings.w=t,e.settings.h=n,e.layoutRect({x:0,y:0,w:t,h:n})});var r=_e.getSize(i.getEl("head")).height;return i.settings.minWidth=t,i.settings.minHeight=n+r,(e=i._super()).deltaH+=r,e.innerH=e.h-e.deltaH,e}}),yr=Pt.extend({init:function(e){var n=this;n._super(e),n.classes.add("textbox"),e.multiline?n.classes.add("multiline"):(n.on("keydown",function(e){var t;13===e.keyCode&&(e.preventDefault(),n.parents().reverse().each(function(e){if(e.toJSON)return t=e,!1}),n.fire("submit",{data:t.toJSON()}))}),n.on("keyup",function(e){n.state.set("value",e.target.value)}))},repaint:function(){var e,t,n,i,r,o=this,s=0;e=o.getEl().style,t=o._layoutRect,r=o._lastRepaintRect||{};var a=document;return!o.settings.multiline&&a.all&&(!a.documentMode||a.documentMode<=8)&&(e.lineHeight=t.h-s+"px"),i=(n=o.borderBox).left+n.right+8,s=n.top+n.bottom+(o.settings.multiline?8:0),t.x!==r.x&&(e.left=t.x+"px",r.x=t.x),t.y!==r.y&&(e.top=t.y+"px",r.y=t.y),t.w!==r.w&&(e.width=t.w-i+"px",r.w=t.w),t.h!==r.h&&(e.height=t.h-s+"px",r.h=t.h),o._lastRepaintRect=r,o.fire("repaint",{},!1),o},renderHtml:function(){var t,e,n=this,i=n.settings;return t={id:n._id,hidefocus:"1"},w.each(["rows","spellcheck","maxLength","size","readonly","min","max","step","list","pattern","placeholder","required","multiple"],function(e){t[e]=i[e]}),n.disabled()&&(t.disabled="disabled"),i.subtype&&(t.type=i.subtype),(e=_e.create(i.multiline?"textarea":"input",t)).value=n.state.get("value"),e.className=n.classes.toString(),e.outerHTML},value:function(e){return arguments.length?(this.state.set("value",e),this):(this.state.get("rendered")&&this.state.set("value",this.getEl().value),this.state.get("value"))},postRender:function(){var t=this;t.getEl().value=t.state.get("value"),t._super(),t.$el.on("change",function(e){t.state.set("value",e.target.value),t.fire("change",e)})},bindStates:function(){var t=this;return t.state.on("change:value",function(e){t.getEl().value!==e.value&&(t.getEl().value=e.value)}),t.state.on("change:disabled",function(e){t.getEl().disabled=e.value}),t._super()},remove:function(){this.$el.off(),this._super()}}),xr=function(){return{Selector:Fe,Collection:Ye,ReflowQueue:Ze,Control:ot,Factory:b,KeyboardNavigation:at,Container:ut,DragHelper:dt,Scrollable:pt,Panel:vt,Movable:Se,Resizable:bt,FloatPanel:Et,Window:Ft,MessageBox:$t,Tooltip:Nt,Widget:Pt,Progress:Wt,Notification:Ot,Layout:Xt,AbsoluteLayout:jt,Button:Jt,ButtonGroup:Kt,Checkbox:Zt,ComboBox:en,ColorBox:tn,PanelButton:nn,ColorButton:on,ColorPicker:an,Path:un,ElementPath:cn,FormItem:dn,Form:fn,FieldSet:hn,FilePicker:bi,FitLayout:yi,FlexLayout:xi,FlowLayout:wi,FormatControls:Gi,GridLayout:Ki,Iframe:Zi,InfoBox:Qi,Label:er,Toolbar:tr,MenuBar:nr,MenuButton:ir,MenuItem:sr,Throbber:St,Menu:rr,ListBox:or,Radio:ar,ResizeHandle:lr,SelectBox:cr,Slider:mr,Spacer:gr,SplitButton:pr,StackLayout:vr,TabPanel:br,TextBox:yr,DropZone:ln,BrowseButton:Gt}},wr=function(n){n.ui?w.each(xr(),function(e,t){n.ui[t]=e}):n.ui=xr()};w.each(xr(),function(e,t){b.add(t,e)}),wr(window.tinymce?window.tinymce:{}),o.add("modern",function(e){return Gi.setup(e),qt(e)})}();
